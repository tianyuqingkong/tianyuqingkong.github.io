<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2 dockeråº”ç”¨</title>
    <url>/2020/05/17/2docker%E5%BA%94%E7%94%A8/</url>
    <content><![CDATA[<p>å‰ç«¯åŒå­¦çš„æƒ³äº†è§£çš„å¯ä»¥çœ‹ä¸‹é¢çš„é˜®è€å¸ˆä¸¤ç¯‡æ–‡ç« </p>
<h2 id="level-0"><a href="#level-0" class="headerlink" title="level 0"></a>level 0</h2><ul>
<li><a href="http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html">Docker å…¥é—¨æ•™ç¨‹</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html">Docker å¾®æœåŠ¡æ•™ç¨‹</a><h2 id="level-1"><a href="#level-1" class="headerlink" title="level 1"></a>level 1</h2></li>
<li><a href="https://yeasy.gitbooks.io/docker_practice/content/container/import_export.html">Docker â€”â€” ä»å…¥é—¨åˆ°å®è·µ</a> </li>
<li><a href="https://docs.docker.com/">Docker Documentation</a></li>
</ul>
]]></content>
      <categories>
        <category>jenkins docker</category>
      </categories>
  </entry>
  <entry>
    <title>1 jenkinsåœ¨GVP_docé¡¹ç›®ä¸­çš„å®é™…ä½¿ç”¨</title>
    <url>/2020/05/16/1jenkins%E5%AE%9E%E4%BE%8B%E9%A1%B9%E7%9B%AE%E6%8C%87%E5%8D%97/</url>
    <content><![CDATA[<h2 id="jenkinsåœ¨é¡¹ç›®ä¸­çš„å®é™…ä½¿ç”¨"><a href="#jenkinsåœ¨é¡¹ç›®ä¸­çš„å®é™…ä½¿ç”¨" class="headerlink" title="jenkinsåœ¨é¡¹ç›®ä¸­çš„å®é™…ä½¿ç”¨"></a>jenkinsåœ¨é¡¹ç›®ä¸­çš„å®é™…ä½¿ç”¨</h2><p>  åœ¨é¡¹ç›®ä¸­æœ‰å¤§ä½“æ¥è¯´ä¸‰ç§éƒ¨ç½²æ–¹å¼ï¼Œç¬¬ä¸€ç§é€šè¿‡æ¨é€ä»£ç åˆ°ç‰¹å®šåˆ†æ”¯å®Œæˆè‡ªåŠ¨éƒ¨ç½²çº¿ä¸Šç¯å¢ƒåŠ ä¸Šæœ¬åœ°éƒ¨ç½²ç¯å¢ƒï¼Œç¬¬äºŒç§æ˜¯æ‰‹åŠ¨ä¸€é”®å¼éƒ¨ç½²çº¿ä¸Šç¯å¢ƒï¼Œç¬¬ä¸‰ç§æ˜¯æ‰‹åŠ¨ä¸€é”®å¼éƒ¨ç½²æœ¬åœ°ç¯å¢ƒã€‚ä¸‹é¢æœ‰è¿™ä¸‰ç§æ–¹å¼çš„ç®€å•è¯´æ˜ã€‚</p>
<span id="more"></span>
<p>  è¿™ä¸‰ç§éƒ¨ç½²æ–¹å¼è§¦å‘æ—¶éƒ½å¯ä»¥ç™»å½•<a href="http://10.201.81.83:8098/">jenkinsç½‘ç«™</a>æŸ¥çœ‹å…¶è¿‡ç¨‹æƒ…å†µï¼Œç›®å‰æœ‰ä¸€ä¸ªè´¦å·åé¢ä¼šå¢åŠ ã€‚<br>  è´¦å·ï¼šchenkuan å¯†ç ï¼šxxxxxxx</p>
<ul>
<li><p>æ¨é€ä»£ç è‡ªåŠ¨éƒ¨ç½²ï¼š å½“ä»£ç æ¨é€åˆ°masteråˆ†æ”¯æ—¶ï¼Œ<code>çº¿ä¸Šç¯å¢ƒ</code>å’Œ<code>æœ¬åœ°éƒ¨ç½²ç¯å¢ƒ</code>ä¼šè‡ªåŠ¨éƒ¨ç½²å¦‚æœéƒ¨ç½²æˆåŠŸæˆ–è€…å¤±è´¥ä¼šæœ‰é‚®ä»¶å‘ç»™æ¨é€ä»£ç çš„äººã€‚éƒ¨ç½²æˆåŠŸå…·ä½“è¡¨ç°æ˜¯çº¿ä¸Šç¯å¢ƒçš„ç½‘ç«™å†…å®¹å‘ç”Ÿäº†å˜åŒ–ï¼Œå·²ç»æœ¬åœ°éƒ¨ç½²ç¯å¢ƒçš„gitlabåº“taråŒ…å‘ç”Ÿäº†æ›¿æ¢ã€‚ä¸‹é¢æ˜¯æ³¨æ„äº‹é¡¹ã€‚</p>
<ul>
<li><p>å¦‚æœåªæƒ³éƒ¨ç½²ä¸€ä¸ªç¯å¢ƒå¯ä»¥åœ¨ä¸‹å›¾å¯¹åº”ä»£ç æ³¨é‡Šï¼Œå¦‚ä¸‹é¢å°±æ˜¯æ³¨é‡Šäº†è‡ªåŠ¨æœ¬åœ°éƒ¨ç½²ã€‚<br><img src="/2020/05/16/1jenkins%E5%AE%9E%E4%BE%8B%E9%A1%B9%E7%9B%AE%E6%8C%87%E5%8D%97/choice.png" alt="choice">  </p>
</li>
<li><p>ä»£ç æ¨é€ç‰¹å®šåˆ†æ”¯å‘ç”Ÿè‡ªåŠ¨éƒ¨ç½²ï¼Œ è¿™ä¸ªç‰¹å®šåˆ†æ”¯æ˜¯å¯ä»¥é…ç½®çš„ç›®å‰æ˜¯é…ç½®çš„masterï¼Œå¦‚æœæƒ³æ”¹å˜æœ‰ä¸‹é¢æ­¥éª¤ï¼š<br>  ç™»å½•åˆ°jenkinsç½‘ç«™ -&gt; auto_online_deploy -&gt;auto_online_GVPdocs -&gt; Configure -&gt; Buid Triggers -&gt; Advanced -&gt; Allowed branches -&gt; Filter branches by name -&gt; Include<br>  <img src="/2020/05/16/1jenkins%E5%AE%9E%E4%BE%8B%E9%A1%B9%E7%9B%AE%E6%8C%87%E5%8D%97/config.png" alt="config"></p>
</li>
</ul>
</li>
<li><p>æ‰‹åŠ¨ä¸€é”®å¼éƒ¨ç½²çº¿ä¸Šç¯å¢ƒï¼Œè¿™ä¸ªæ˜¯ä¸€é”®ç‚¹å‡»å®Œæˆå°†ç‰¹å®šåˆ†æ”¯çš„ä»£ç ï¼ˆç›®å‰è®¾ç½®æ˜¯masterï¼‰éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒï¼Œç‚¹å‡»å®Œæ¯•åçœ‹ä¸‹é¢çš„jobè·‘å®Œå°±æ˜¯å‘å¸ƒæˆåŠŸã€‚éƒ¨ç½²æˆåŠŸå…·ä½“è¡¨ç°æ˜¯çº¿ä¸Šç¯å¢ƒçš„ç½‘ç«™å†…å®¹å‘ç”Ÿäº†å˜åŒ–ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯è¦æœ‰ä¸¤ä¸ªæ­¥éª¤ä¸€ä¸ªæ˜¯ç¡®è®¤å‘å¸ƒçš„åˆ†æ”¯æ˜¯å¦æ˜¯ä½ æƒ³è¦å‘å¸ƒçš„åˆ†æ”¯ï¼Œå¦ä¸€ä¸ªå°±æ˜¯ç‚¹å‡»æŒ‰é’®ã€‚  </p>
<ul>
<li><p>ç¡®è®¤åˆ†æ”¯<br>ç™»å½•åˆ°jenkinsç½‘ç«™ -&gt; manual_online_deploy -&gt; manual_online_GVPdocs -&gt; Configure -&gt; Source Code Management -&gt; Branches to build<br><img src="/2020/05/16/1jenkins%E5%AE%9E%E4%BE%8B%E9%A1%B9%E7%9B%AE%E6%8C%87%E5%8D%97/vertifyConfig.png" alt="vertifyConfig">  </p>
</li>
<li><p>ç‚¹å‡»ç«‹å³æ„å»º<br>ç™»å½•åˆ°jenkinsç½‘ç«™ -&gt; manual_online_deploy -&gt; manual_online_GVPdocs -&gt; ç‚¹å‡»ç«‹å³æ„å»º<br><img src="/2020/05/16/1jenkins%E5%AE%9E%E4%BE%8B%E9%A1%B9%E7%9B%AE%E6%8C%87%E5%8D%97/trigger.png" alt="trigger"></p>
</li>
</ul>
</li>
<li><p>æ‰‹åŠ¨ä¸€é”®å¼æœ¬åœ°éƒ¨ç½²ï¼Œå’Œä¸Šé¢çš„æ‰‹åŠ¨ä¸€é”®å¼éƒ¨ç½²çº¿ä¸Šç¯å¢ƒåªæ˜¯åå­—çš„ä¸åŒç”±manual_online_GVPdocså˜ä¸ºmanual_local_GVP_docs</p>
</li>
</ul>
]]></content>
      <categories>
        <category>jenkins</category>
      </categories>
  </entry>
  <entry>
    <title>3 jenkinså¤šç¯å¢ƒå¤šé¡¹ç›®å‘å¸ƒç®€æ˜</title>
    <url>/2020/05/19/3jenkins%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%A1%B9%E7%9B%AE%E5%8F%91%E5%B8%83%E7%AE%80%E6%98%8E/</url>
    <content><![CDATA[<h2 id="GVP-frond-webä¾‹å­"><a href="#GVP-frond-webä¾‹å­" class="headerlink" title="GVP_frond_webä¾‹å­"></a>GVP_frond_webä¾‹å­</h2><h3 id="ï¼ˆ1ï¼‰è‡ªåŠ¨å‘å¸ƒï¼šä»£ç æ¨é€åˆ°ç‰¹å®šåˆ†æ”¯åè‡ªåŠ¨å‘å¸ƒä¸€ä¸ªç¯å¢ƒ"><a href="#ï¼ˆ1ï¼‰è‡ªåŠ¨å‘å¸ƒï¼šä»£ç æ¨é€åˆ°ç‰¹å®šåˆ†æ”¯åè‡ªåŠ¨å‘å¸ƒä¸€ä¸ªç¯å¢ƒ" class="headerlink" title="ï¼ˆ1ï¼‰è‡ªåŠ¨å‘å¸ƒï¼šä»£ç æ¨é€åˆ°ç‰¹å®šåˆ†æ”¯åè‡ªåŠ¨å‘å¸ƒä¸€ä¸ªç¯å¢ƒ"></a>ï¼ˆ1ï¼‰è‡ªåŠ¨å‘å¸ƒï¼šä»£ç æ¨é€åˆ°ç‰¹å®šåˆ†æ”¯åè‡ªåŠ¨å‘å¸ƒä¸€ä¸ªç¯å¢ƒ</h3><span id="more"></span>
<ul>
<li><p>å½“ä»£ç æ¨é€åˆ°ç‰¹å®šæŒ‡å®šåˆ†æ”¯åï¼Œwebå‰ç«¯é¡¹ç›®å°†ä¼šè‡ªåŠ¨è¿›è¡Œçº¿ä¸ŠæŸä¸ªæŒ‡å®šç¯å¢ƒçš„å‘å¸ƒ </p>
</li>
<li><p>ä¸Šé¢è¯´çš„æŒ‡å®šå†…å®¹éƒ½æ˜¯åœ¨é¡¹ç›®é¡¶çº§ç›®å½•çš„cicdæ–‡ä»¶ä¸‹è¿›è¡Œé…ç½®çš„ï¼Œå…·ä½“æ˜¯cicd&#x2F;envConfig.jsoné‡Œé¢<br><img src="/2020/05/19/3jenkins%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%A1%B9%E7%9B%AE%E5%8F%91%E5%B8%83%E7%AE%80%E6%98%8E/envConfig.png" alt="envConfig"><br>åœ¨ä¸Šé¢æ–‡ä»¶ä¸­æœ‰ä¸¤ä¸ªåˆ†æ”¯åˆ†åˆ«æ˜¯feature&#x2F;cicdä»¥åŠfeature&#x2F;cicdAlphaä»–ä»¬åˆ†åˆ«å¯¹åº”ç€ä¸¤ä¸ªä¸åŒç¯å¢ƒdevå’Œalphaï¼Œå½“ä»»ä½•ä»£ç å‘è¿™ä¸¤ä¸ªåˆ†æ”¯æ¨é€æ—¶ä¸¤ä¸ªç¯å¢ƒå°±ä¼šå‘ç”Ÿè‡ªåŠ¨éƒ¨ç½²ã€‚  </p>
</li>
<li><p>ä¸Šé¢çš„ä¸¤ä¸ªåˆ†æ”¯å…¶å®è¿˜éœ€è¦åœ¨jenkinsè¿›è¡Œé…ç½®ä»¥ä¾¿è¿™ä¸¤ä¸ªåˆ†æ”¯å‘ç”Ÿå˜åŒ–ï¼Œè¿›è€Œè§¦å‘jinkinsæµç¨‹<br><img src="/2020/05/19/3jenkins%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%A1%B9%E7%9B%AE%E5%8F%91%E5%B8%83%E7%AE%80%E6%98%8E/jenkinsConfig.png" alt="envConfig"></p>
</li>
</ul>
<h3 id="2-æ‰‹åŠ¨å‘å¸ƒï¼šç™»å½•åˆ°jenkinsç½‘ç«™åæ‰‹åŠ¨ä¸€é”®å‘å¸ƒ"><a href="#2-æ‰‹åŠ¨å‘å¸ƒï¼šç™»å½•åˆ°jenkinsç½‘ç«™åæ‰‹åŠ¨ä¸€é”®å‘å¸ƒ" class="headerlink" title="(2)æ‰‹åŠ¨å‘å¸ƒï¼šç™»å½•åˆ°jenkinsç½‘ç«™åæ‰‹åŠ¨ä¸€é”®å‘å¸ƒ"></a>(2)æ‰‹åŠ¨å‘å¸ƒï¼šç™»å½•åˆ°jenkinsç½‘ç«™åæ‰‹åŠ¨ä¸€é”®å‘å¸ƒ</h3><ul>
<li><p>é¦–å…ˆç™»å½•åˆ°jenkinsç½‘ç«™ è´¦å·ï¼š chenkuan  å¯†ç ï¼šwearetheone11<br><img src="/2020/05/19/3jenkins%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%A1%B9%E7%9B%AE%E5%8F%91%E5%B8%83%E7%AE%80%E6%98%8E/loginJenkins.png" alt="loginJenkins"></p>
</li>
<li><p>æ‰¾åˆ°æƒ³å‘å¸ƒé¡¹ç›®ç‚¹å‡»è¿›å…¥ï¼Œä¸‹å›¾æ‰¾åˆ°çš„æ˜¯webå‰ç«¯çš„devç¯å¢ƒ<br><img src="/2020/05/19/3jenkins%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%A1%B9%E7%9B%AE%E5%8F%91%E5%B8%83%E7%AE%80%E6%98%8E/findJob.png" alt="findJob"></p>
</li>
<li><p>ç‚¹å‡»å·¦è¾¹Configureç¡®è®¤æ˜¯è‡ªå·±æƒ³è¦å‘å¸ƒçš„åˆ†æ”¯ï¼Œæˆ–è€…ä¿®æ”¹é…ç½®åˆ†æ”¯<br><img src="/2020/05/19/3jenkins%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%A1%B9%E7%9B%AE%E5%8F%91%E5%B8%83%E7%AE%80%E6%98%8E/ensureBranch.jpg" alt="ensureBranchfindJob"></p>
</li>
<li><p>ç¡®è®¤åå›åˆ°ä¸Šçº§é¡µé¢ç‚¹å‡»ç«‹å³æ„å»ºæŒ‰é’®,è¿›è¡Œä¸€é”®è‡ªåŠ¨å‘å¸ƒ<br><img src="/2020/05/19/3jenkins%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%A1%B9%E7%9B%AE%E5%8F%91%E5%B8%83%E7%AE%80%E6%98%8E/trigger.png" alt="trigger"></p>
</li>
</ul>
<h3 id="ï¼ˆ3ï¼‰æ€»ç»“ï¼šæ ¸å¿ƒç†å¿µæ˜¯ä¸€ä¸ªåˆ†æ”¯å¯¹åº”ç€ä¸€ä¸ªç¯å¢ƒï¼Œå¹¶ä¸”è¿™äº›åˆ†æ”¯æ˜¯å¯ä»¥é…ç½®çš„"><a href="#ï¼ˆ3ï¼‰æ€»ç»“ï¼šæ ¸å¿ƒç†å¿µæ˜¯ä¸€ä¸ªåˆ†æ”¯å¯¹åº”ç€ä¸€ä¸ªç¯å¢ƒï¼Œå¹¶ä¸”è¿™äº›åˆ†æ”¯æ˜¯å¯ä»¥é…ç½®çš„" class="headerlink" title="ï¼ˆ3ï¼‰æ€»ç»“ï¼šæ ¸å¿ƒç†å¿µæ˜¯ä¸€ä¸ªåˆ†æ”¯å¯¹åº”ç€ä¸€ä¸ªç¯å¢ƒï¼Œå¹¶ä¸”è¿™äº›åˆ†æ”¯æ˜¯å¯ä»¥é…ç½®çš„"></a>ï¼ˆ3ï¼‰æ€»ç»“ï¼šæ ¸å¿ƒç†å¿µæ˜¯ä¸€ä¸ªåˆ†æ”¯å¯¹åº”ç€ä¸€ä¸ªç¯å¢ƒï¼Œå¹¶ä¸”è¿™äº›åˆ†æ”¯æ˜¯å¯ä»¥é…ç½®çš„</h3>]]></content>
      <categories>
        <category>jenkins</category>
      </categories>
  </entry>
  <entry>
    <title>0 å®‰è£…å’Œé…ç½®jenkins</title>
    <url>/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/</url>
    <content><![CDATA[<h2 id="jenkinsåœ¨linuxçš„å®‰è£…ä¸é…ç½®ï¼ˆ10-201-81-83ï¼‰ï¼š-æ³¨æ„å¦‚æœä¸æƒ³äº†è§£å…¨éƒ¨æ­¥éª¤å¯ä»¥ç›´æ¥è·³åˆ°ç¬¬ä¸ƒæ­¥"><a href="#jenkinsåœ¨linuxçš„å®‰è£…ä¸é…ç½®ï¼ˆ10-201-81-83ï¼‰ï¼š-æ³¨æ„å¦‚æœä¸æƒ³äº†è§£å…¨éƒ¨æ­¥éª¤å¯ä»¥ç›´æ¥è·³åˆ°ç¬¬ä¸ƒæ­¥" class="headerlink" title="jenkinsåœ¨linuxçš„å®‰è£…ä¸é…ç½®ï¼ˆ10.201.81.83ï¼‰ï¼š æ³¨æ„å¦‚æœä¸æƒ³äº†è§£å…¨éƒ¨æ­¥éª¤å¯ä»¥ç›´æ¥è·³åˆ°ç¬¬ä¸ƒæ­¥"></a>jenkinsåœ¨linuxçš„å®‰è£…ä¸é…ç½®ï¼ˆ10.201.81.83ï¼‰ï¼š æ³¨æ„å¦‚æœä¸æƒ³äº†è§£å…¨éƒ¨æ­¥éª¤å¯ä»¥ç›´æ¥è·³åˆ°ç¬¬ä¸ƒæ­¥</h2><ul>
<li><p>1 ç¡®è®¤è¯¥æœºå™¨å·²ç»å®‰è£…jdkï¼šjenkinsæ˜¯javaå¼€å‘çš„å·¥ä¸šçº§cicdå·¥å…·</p>
<ul>
<li>java -version, æ³¨æ„ï¼šæœ‰äº›ç‰ˆæœ¬çš„jenkinsä¸èƒ½ä½¿ç”¨1.6çš„jdk</li>
</ul>
</li>
<li><p>2 åœ¨çº¿å®‰è£…</p>
<ul>
<li>sudo wget -O &#x2F;etc&#x2F;yum.repos.d&#x2F;jenkins.repo <a href="http://jenkins-ci.org/redhat/jenkins.repo">http://jenkins-ci.org/redhat/jenkins.repo</a>  </li>
<li>sudo rpm â€“import <a href="http://pkg.jenkins-ci.org/redhat/jenkins-ci.org.key">http://pkg.jenkins-ci.org/redhat/jenkins-ci.org.key</a> </li>
<li>sudo yum install jenkins</li>
<li>sudo service jenkins start</li>
<li>sudo service jenkins status</li>
</ul>
</li>
</ul>
<span id="more"></span>  

<ul>
<li><p>3 ä¿®æ”¹ç«¯å£é…ç½®ï¼šå› ä¸ºjenkinsçš„é»˜è®¤ç«¯å£ä¸º8080ï¼Œè¿™ä¸ªç«¯å£åœ¨æœåŠ¡å™¨å¤§å¤šæ•°éƒ½è¢«å ç”¨ï¼Œè¿™é‡Œæ”¹ä¸º8089(å¯ä»¥ä¸ºå…¶ä»–æ²¡æœ‰å ç”¨çš„ç«¯å£)</p>
<ul>
<li>sudo vim &#x2F;etc&#x2F;sysconfig&#x2F;jenkins &#x2F;&#x2F;ä¿®æ”¹JENKINS_PORT&#x3D;â€8089â€</li>
<li>sudo service jenkins restart &#x2F;&#x2F; é‡å¯æœåŠ¡æ›´æ–°é…ç½®</li>
</ul>
</li>
<li><p>4 ä¿®æ”¹jenkinsåœ¨linuxä¸­çš„è§’è‰²ï¼šjenkineé»˜è®¤è§’è‰²ä¸ºjenkinsï¼Œåœ¨linuxä¸­æƒé™æ¯”è¾ƒä¸¥æ ¼ï¼Œè¿™é‡Œè®¾ç½®ä¸ºrootæ¯”è¾ƒæ–¹ä¾¿å¦‚åæ¥é…ç½®gitçš„å…å¯†å°±æ¯”è¾ƒæ–¹ä¾¿äº†</p>
<ul>
<li>sudo vim &#x2F;etc&#x2F;sysconfig&#x2F;jenkins &#x2F;&#x2F;ä¿®æ”¹JENKINS_USER&#x3D;â€rootâ€</li>
<li>sudo service jenkins restart &#x2F;&#x2F; é‡å¯æœåŠ¡æ›´æ–°é…ç½®</li>
</ul>
</li>
<li><p>5 jenkinsåˆå§‹åŒ–</p>
<ul>
<li>è¿›å…¥ <a href="http://10.201.81.83:8098/">http://10.201.81.83:8098/</a> æ ¹æ®æç¤ºåˆå§‹åŒ–å¯†ç ï¼Œä»¥åŠå®‰è£…ä¸€äº›é»˜è®¤çš„æ’ä»¶ã€‚å®Œåé‡åˆ°ä¸€ä¸ªç©ºç™½é¡µã€‚</li>
<li>è¿›å…¥<a href="http://10.201.81.83:8098/restart%EF%BC%8C%E7%82%B9%E5%87%BB%E9%A1%B5%E9%9D%A2%E4%B8%8A%E7%9A%84%E9%87%8D%E5%90%AFjenkins%EF%BC%8C%E8%BF%9B%E5%85%A5%E7%99%BB%E5%BD%95%E7%95%8C%E9%9D%A2">http://10.201.81.83:8098/restartï¼Œç‚¹å‡»é¡µé¢ä¸Šçš„é‡å¯jenkinsï¼Œè¿›å…¥ç™»å½•ç•Œé¢</a></li>
</ul>
</li>
<li><p>6 jenkinsä¸gitçš„sshå…å¯†é…ç½®ï¼šä¸€èˆ¬jenkinséœ€è¦ä»gitè‡ªåŠ¨æ‹‰å–ä»£ç éœ€è¦æå‰åŠ ä¸Šå…å¯†æœºåˆ¶ï¼Œä¸‹é¢çš„æµç¨‹éœ€è¦è¿™ä¸ªé…ç½®ï¼ˆæœ‰å…´è¶£çš„å¯ä»¥googelä¸‹sshï¼‰</p>
<ul>
<li><p>ä¸€èˆ¬linuxä¸­æœ‰git(å¦‚æœæ²¡æœ‰è‡ªè¡Œå®‰è£…),æ‰¾åˆ°gitå®‰è£…çš„è·¯å¾„å¹¶ä¸”é…ç½®åœ¨jenkinsä¸­è¿™æ ·jenkinså°±å¯ä»¥ä½¿ç”¨gitå‘½ä»¤ï¼Œé»˜è®¤gitå®‰è£…è·¯å¾„ä¸º&#x2F;usr&#x2F;libexec&#x2F;git-core&#x2F;git</p>
</li>
<li><p>jenkins-&gt; ç³»ç»Ÿç®¡ç† -&gt; å…¨å±€å·¥å…·é…ç½® -&gt; ä¸‹å›¾ -&gt; ä¿å­˜<br><img src="/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/gitInJenkinsConfig.png" alt="gitInJenkinsConfig" title="rrr"></p>
</li>
<li><p>sudo su :è¿›å…¥æœåŠ¡å™¨åˆ‡æ¢ä¸ºrootç”¨æˆ· (ä¸Šé¢ç¬¬æ­¥4ä¸­jenkinsè§’è‰²é…ç½®ä¸ºrootï¼Œè¿™é‡Œå…å¯†å°±æ˜¯ä½¿ç”¨rootç”¨æˆ·)</p>
</li>
<li><p>cd ~&#x2F;.ssh : è¿›å…¥æ ¹ç›®å½•çš„.sshæ–‡ä»¶å¤¹(å¦‚æœä¸å­˜åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹æˆ–è€…æ–‡ä»¶å¤¹é‡Œé¢æ²¡æœ‰ä¸œè¥¿è¯æ˜rootç”¨æˆ·æ²¡æœ‰åŠ sshï¼Œå¯ä»¥ä½¿ç”¨ssh-keygen -t rsa ç”Ÿæˆ)</p>
</li>
<li><p>cat id_rsa.pub ï¼š å°†è¾“å‡ºçš„å…¬é’¥å¤åˆ¶ï¼ˆä¸‹å›¾ï¼‰<br><img src="/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/pubKey.png" alt="pubKey"></p>
</li>
<li><p>å°†å¤åˆ¶å…¬é’¥æ·»åŠ åˆ°gitç”¨æˆ·çš„sshä¸­ï¼šuserLogo -&gt; Settings -&gt; SSH Keys -&gt; Key -&gt; add Keysc(è¿™æ ·é…ç½®åjenkinsä¸­gitçš„æƒé™å°±æ˜¯å½“å‰ä½ é…ç½®gitlabç”¨æˆ·æ‰€æ‹¥æœ‰çš„æƒé™ï¼Œå¦‚æ‹‰å–æŸä¸ªé¡¹ç›®çš„æƒé™)<br> <img src="/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/gitKeys.png" alt="gitKeys"></p>
</li>
<li><p>ä»¥ç®¡ç†å‘˜èº«ä»½è¿›å…¥jinkinsç½‘ç«™(<a href="http://10.201.81.83:8098/):%E8%BF%99%E9%87%8C%E5%BF%85%E9%A1%BB%E4%B8%BA%E7%AE%A1%E7%90%86%E5%91%98%E4%B8%8D%E7%84%B6%E6%97%A0%E6%B3%95%E6%B7%BB%E5%8A%A0%E5%87%AD%E8%AF%81">http://10.201.81.83:8098/):è¿™é‡Œå¿…é¡»ä¸ºç®¡ç†å‘˜ä¸ç„¶æ— æ³•æ·»åŠ å‡­è¯</a></p>
</li>
<li><p>å‡­è¯ -&gt; ç³»ç»Ÿ -&gt; æ·»åŠ åŸŸ â€”&gt; å¡«å†™åŸŸåï¼ˆè¿™é‡Œéšä¾¿å¡«å†™ï¼‰<br><img src="/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/credentials.png" alt="credentials"></p>
</li>
<li><p>æ·»åŠ å‡­è¯<br><img src="/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/addCredential.png" alt="addCredential"></p>
</li>
<li><p>å¤åˆ¶linuxä¸­rootç”¨æˆ·çš„ç§é’¥ (å’Œå‰é¢ä¸€æ · sudo cd ~&#x2F;.ssh  cat id_rsa)<br> <img src="/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/priKey.png" alt="priKey"></p>
</li>
<li><p>å°†åˆšåˆšå¤åˆ¶çš„ç§é’¥å¡«å†™åˆ°å›¾ä¸­å¯¹åº”ä½ç½®ï¼šæ³¨æ„é€‰æ‹©ç±»å‹çš„æ—¶å€™é€‰æ‹©ssh<br><img src="/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/addPrikey.png" alt="addPrikey"></p>
</li>
</ul>
</li>
<li><p>7 jenkin æµç¨‹æ„å»ºï¼šè¿™ä¸ªæ­¥éª¤æ˜¯å¤§éƒ¨åˆ†äººjenkinsç”¨æˆ·éƒ½è¦å…³æ³¨çš„éƒ¨åˆ†ï¼Œå…¶ä»–ä¸Šé¢6ä¸ªæ­¥éª¤åªè¦jenkinç®¡ç†å‘˜å…³æ³¨ï¼Œæˆ–è€…æƒ³è‡ªå·±æ­å»ºä¸€ä¸ªè‡ªå·±jenkinçš„åŒå­¦å¯ä»¥äº†è§£</p>
<ul>
<li><p>é¦–å…ˆé€šè¿‡ä¸€ä¸ªè´¦æˆ·ç™»å½•åˆ°jenkinsç½‘ç«™<br><img src="/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/login.png" alt="login"></p>
</li>
<li><p>Newä»»åŠ¡ -&gt; é€‰æ‹©æµæ°´çº¿<br> <img src="/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/addSCM.png" alt="addSCM"></p>
</li>
<li><p>é…ç½®æµæ°´çº¿<br><img src="/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/configSCM.png" alt="configSCM"></p>
<ul>
<li>1ï¼šè¿™é‡Œä¸»è¦å…³æ³¨Pipeline,å…¶ä»–éƒ½æ˜¯å¯é€‰é¡¹</li>
<li>2ï¼š é€‰æ‹©Definitionï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©Pipeline script from SCMæ„æ€å°±æ˜¯åˆ©ç”¨é¡¹ç›®ä¸­çš„Jenkinfileæ¥æ‰§è¡Œcicdã€‚</li>
<li>3ï¼š é€‰æ‹©æ‹‰å–ä»£ç çš„æ–¹å¼ï¼Œè¿™é‡Œé€‰æ‹©git</li>
<li>4ï¼š å¡«å†™äº§åº“åœ°å€,æ³¨æ„è¿™é‡Œå¡«å†™ä»“åº“åœ°å€çš„å½¢å¼æ˜¯äº¦git@å¼€å¤´çš„ä¹Ÿå°±æ˜¯ä»¥sshåè®®è¿æ¥çš„ï¼Œå½“ç„¶å¦‚æœæƒ³è¦æ¯æ¬¡å¡«å†™ç”¨æˆ·åå’Œå¯†ç ä¹Ÿå¯ä»¥æ˜¯ä½¿ç”¨httpåè®®</li>
<li>5ï¼š å¡«å†™Credentialsï¼Œè¿™é‡Œæ˜¯ä¸Šé¢ç¬¬6éƒ¨æ·»åŠ å‡­è¯åæ‰æœ‰çš„ç»“æœï¼Œå¦‚æœä¸Šé¢æ·»åŠ å‡­è¯çš„ç”¨æˆ·æ²¡æœ‰è¿™ä¸ªä»“åº“çš„æƒé™ï¼Œè¿™é‡Œä¼šæŠ¥é”™</li>
<li>6ï¼šè¿™é‡ŒæŒ‡å®šcicdæ‰§è¡Œæ‰§è¡Œçš„åˆ†æ”¯ï¼Œæ¢å¥è¯è¯´è¿™ä¸ªåˆ†æ”¯ä¸Šå¿…é¡»è¦æœ‰Jenkinsç›¸å…³é…ç½®æ–‡ä»¶ï¼Œåœ¨æˆ‘ä»¬è¿™é‡Œè¿™ä¸ªæ–‡ä»¶å°±æŒ‡çš„æ˜¯ä¸‹é¢çš„Jenkinsfile</li>
<li>7:è¿™é‡Œå°±æ˜¯é…ç½®Jenkinsfileçš„è·¯å¾„å’Œæ–‡ä»¶åäº†ï¼Œè¿™é‡Œçš„è¯åªå¡«å†™äº†Jenkinsfileï¼Œæ‰€ä»¥cicdçš„è„šæœ¬éƒ½åœ¨é¡¹ç›®é¡¶çº§ç›®å½•çš„Jenkinsfileã€‚å¦‚æœä½ ä¸æƒ³ä½ çš„cicdå‘½ä»¤æ”¾åœ¨é¡¶çº§ç›®å½•è¿™é‡Œå°±å¯ä»¥åšä¿®æ”¹</li>
<li>8:æœ€åä¿å­˜</li>
</ul>
</li>
</ul>
</li>
<li><p>8 ä½¿ç”¨jenkinsæ‰§è¡Œcicd</p>
<ul>
<li>åœ¨é¡¹ç›®ç›¸åº”çš„ç›®å½•æ·»åŠ ç›¸åº”çš„cicdè„šæœ¬æ–‡ä»¶ï¼Œåœ¨ç¬¬7éƒ¨æˆ‘ä»¬æŒ‡å®šäº†åœ¨é¡¹ç›®çš„é¡¶çº§ç›®å½•çš„Jenkinfileæ–‡ä»¶å†™cicdè„šæœ¬æ–‡ä»¶ ï¼ˆå¦‚ä½•å†™è„šæœ¬åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­æœ‰ï¼‰<br><img src="/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/jenkinsfileDic.png" alt="jenkinsfileDic"></li>
<li>é€šè¿‡ç”¨æˆ·åå’Œå¯†ç ç™»å½•åˆ°<a href="http://10.201.81.83:8098/%EF%BC%8C%E8%BF%9B%E5%85%A5%E7%9B%B8%E5%BA%94%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%AD%EF%BC%8C%E7%82%B9%E5%87%BB%E7%AB%8B%E5%8D%B3%E6%9E%84%E5%BB%BA%E5%B0%B1%E4%BC%9A%E6%89%A7%E8%A1%8C%E9%A1%B9%E7%9B%AE%E4%B8%ADJenkinfile%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E8%84%9A%E6%9C%AC">http://10.201.81.83:8098/ï¼Œè¿›å…¥ç›¸åº”çš„é¡¹ç›®ä¸­ï¼Œç‚¹å‡»ç«‹å³æ„å»ºå°±ä¼šæ‰§è¡Œé¡¹ç›®ä¸­Jenkinfileæ–‡ä»¶ä¸­çš„è„šæœ¬</a> (å…¶å®è§¦å‘jenkinsè§¦å‘çš„æ–¹å¼ç”±å¾ˆå¤šç§ï¼Œè¿™é‡Œæ˜¯é‡‡ç”¨æ‰‹åŠ¨è§¦å‘)<br><img src="/2020/05/15/0%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjenkins/activeProject.png" alt="activeProject"></li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>jenkins linux</category>
      </categories>
  </entry>
  <entry>
    <title>unicode</title>
    <url>/2017/11/24/Nuicode/</url>
    <content><![CDATA[<h2 id="Unicodeçš„ä½œç”¨"><a href="#Unicodeçš„ä½œç”¨" class="headerlink" title="Unicodeçš„ä½œç”¨"></a>Unicodeçš„ä½œç”¨</h2><p>  Unicodeæ˜¯ä¸€ä¸ªä¸–ç•Œé€šç”¨çš„å­—ç¬¦é›†ï¼Œå®ƒå®šä¹‰äº†å…¨ä¸–ç•Œå¤§éƒ¨åˆ†ä¹¦å†™ä½“ç³»çš„å­—ç¬¦é›†ï¼Œå¹¶ä¸ºæ¯ä¸€ä¸ªå­—ç¬¦åˆ†é…äº†ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ•°å­—ï¼ˆä»£ç ç‚¹ï¼‰ã€‚</p>
<span id="more"></span>
<h2 id="UnicodeåŸºæœ¬æ¦‚å¿µ"><a href="#UnicodeåŸºæœ¬æ¦‚å¿µ" class="headerlink" title="UnicodeåŸºæœ¬æ¦‚å¿µ"></a>UnicodeåŸºæœ¬æ¦‚å¿µ</h2><h3 id="å­—ç¬¦ï¼ˆcharactersï¼‰ä¸ä»£ç ç‚¹-code-points"><a href="#å­—ç¬¦ï¼ˆcharactersï¼‰ä¸ä»£ç ç‚¹-code-points" class="headerlink" title="å­—ç¬¦ï¼ˆcharactersï¼‰ä¸ä»£ç ç‚¹(code points)"></a>å­—ç¬¦ï¼ˆcharactersï¼‰ä¸ä»£ç ç‚¹(code points)</h3><pre><code>* Unicodeä¸­çš„å­—ç¬¦æ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µã€‚æ¯ä¸€ä¸ªæŠ½è±¡å­—ç¬¦éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„åç§°ï¼Œä¾‹å¦‚LATIN SMALL LETTER Aã€‚è¯¥æŠ½è±¡å­—ç¬¦çš„å›¾åƒè¡¨ç°å½¢å¼ï¼ˆglyphï¼‰æ˜¯aã€‚
* ä»£ç ç‚¹æ˜¯æŒ‡è¢«åˆ†é…ç»™æŸä¸ªæŠ½è±¡å­—ç¬¦çš„æ•°å­—ï¼šä»£ç ç‚¹ä»¥U+&lt;hex&gt;çš„å½¢å¼è¡¨ç¤ºï¼ŒU+æ˜¯ä»£è¡¨Unicodeçš„å‰ç¼€ï¼Œè€Œ&lt;hex&gt;æ˜¯ä¸€ä¸ª16è¿›åˆ¶æ•°ã€‚ä¾‹å¦‚U+0041å’ŒU+2603éƒ½æ˜¯ä»£ç ç‚¹ã€‚ä»£ç ç‚¹çš„å–å€¼èŒƒå›´æ˜¯ä»U+0000åˆ°U+10FFFFã€‚
noteï¼š å¹¶éæ‰€æœ‰çš„ä»£ç ç‚¹éƒ½æœ‰å¯¹åº”çš„æŠ½è±¡å­—ç¬¦ï¼Œå¯ç”¨çš„ä»£ç ç‚¹æœ‰1114112ä¸ªï¼Œä½†åˆ†é…äº†æŠ½è±¡å­—ç¬¦çš„åªæœ‰128237ä¸ªã€‚
</code></pre>
<h3 id="Unicodeå¹³é¢"><a href="#Unicodeå¹³é¢" class="headerlink" title="Unicodeå¹³é¢"></a>Unicodeå¹³é¢</h3><p>å¹³é¢æ˜¯æŒ‡ä»U+n0000åˆ°U+nFFFFçš„åŒºé—´ï¼Œæ¯ä¸ªåŒºé—´ç›¸éš”65536(0x10000),å…¶ä¸­çš„nå¯ä»¥ä»0x0å–åˆ°0x10</p>
<pre><code>* å¹³é¢0åŒ…å«ä»U+0000åˆ°U+FFFFçš„ä»£ç ç‚¹
* å¹³é¢1åŒ…å«ä»U+10000åˆ°U+1FFFFçš„ä»£ç ç‚¹
* å¹³é¢16åŒ…å«ä»U+100000åˆ°U+10FFFFçš„ä»£ç ç‚¹
</code></pre>
<p><img src="/Unicode/Unicode-planes.png" alt="uncode_planes"></p>
<p>å¹³é¢0æ¯”è¾ƒç‰¹æ®Šï¼Œè¢«ç§°ä¸ºåŸºæœ¬å¤šæ–‡ç§å¹³é¢æˆ–ç®€ç§°BMPã€‚å®ƒåŒ…å«äº†å¤§å¤šæ•°ç°ä»£è¯­è¨€çš„å­—ç¬¦ (åŸºæœ¬æ‹‰ä¸å­—æ¯, è¥¿é‡Œå°”å­—æ¯, å¸Œè…Šå­—æ¯ç­‰)å’Œå¤§é‡çš„ç¬¦å·  </p>
<pre><code>*  eå¯¹åº”ä»£ç ç‚¹U+0065 æŠ½è±¡å­—ç¬¦åï¼š LATIN SMALL LETTER E
*  |å¯¹åº”ä»£ç ç‚¹U+007C æŠ½è±¡å­—ç¬¦åï¼š VERTICAL BAR
*  â– å¯¹åº”ä»£ç ç‚¹U+25A0 æŠ½è±¡å­—ç¬¦åï¼š BLACK SQUARE
*  â˜‚å¯¹åº”ä»£ç ç‚¹U+2602 æŠ½è±¡å­—ç¬¦åï¼š UMBRELLA
</code></pre>
<p>BMPä¹‹åçš„16ä¸ªå¹³é¢ï¼ˆå¹³é¢1ï¼Œå¹³é¢2ï¼Œâ€¦ï¼Œå¹³é¢16ï¼‰è¢«ç§°ä¸ºæ˜Ÿå…‰å¹³é¢æˆ–è¾…åŠ©å¹³é¢ã€‚æ˜Ÿå…‰å¹³é¢çš„ä»£ç ç‚¹è¢«ç§°ä¸ºæ˜Ÿå…‰ä»£ç ç‚¹ã€‚è¿™äº›ä»£ç ç‚¹çš„å–å€¼èŒƒå›´æ˜¯ä»U+10000åˆ°U+10FFFFã€‚</p>
<h3 id="ç å…ƒ-code-units"><a href="#ç å…ƒ-code-units" class="headerlink" title="ç å…ƒ(code units)"></a>ç å…ƒ(code units)</h3><p>ç å…ƒæ˜¯æŒ‡ä½¿ç”¨æŸç§ç»™å®šçš„ç¼–ç è§„åˆ™ç»™å­—ç¬¦ç¼–ç åå¾—åˆ°çš„æ¯”ç‰¹åºåˆ—ã€‚</p>
<p>å­—ç¬¦ç¼–ç å°†æŠ½è±¡å±‚é¢çš„ç ç‚¹è½¬æ¢ä¸ºç‰©ç†å±‚é¢çš„æ¯”ç‰¹åºåˆ—ï¼šç å…ƒã€‚</p>
<p>å¸¸ç”¨çš„å­—ç¬¦ç¼–ç æœ‰UTF-8, UTF-16 å’Œ UTF-32.</p>
<p>å¤§å¤šæ•°JavaScriptå¼•æ“ä½¿ç”¨UTF-16ç¼–ç å­—ç¬¦ã€‚å®ƒä¼šå½±å“JavaScriptå¤„ç†Unicodeçš„æ–¹å¼ã€‚  </p>
<ul>
<li>BMPä¸­çš„ç ç‚¹ç¼–ç ä¸ºå•ä¸ª16ä½çš„ç å…ƒ</li>
<li>æ˜Ÿå…‰å¹³é¢çš„ç ç‚¹ç¼–ç ä¸ºä¸¤ä¸ª16ä½çš„ç å…ƒ<br>BMPä¸­çš„ä»£ç ç‚¹åˆšå¥½èƒ½å­˜è¿›ä¸€ä¸ª16ä½çš„ç å…ƒã€‚ç¼–ç BMPå¯è°“å°èœä¸€ç¢Ÿã€‚</li>
</ul>
<h3 id="ä»£ç†å¯¹-surrogate-pairs"><a href="#ä»£ç†å¯¹-surrogate-pairs" class="headerlink" title="ä»£ç†å¯¹(surrogate pairs)"></a>ä»£ç†å¯¹(surrogate pairs)</h3><p>å­˜å‚¨ä¸€ä¸ªæ˜Ÿå…‰ä»£ç ç‚¹ï¼ˆå±äºæ˜Ÿå…‰å¹³é¢ï¼‰ï¼š GRINNING FACE character ã€‚è¯¥å­—ç¬¦å¯¹åº”çš„ä»£ç ç‚¹æ˜¯ U+1F600ã€‚UTF-16éœ€è¦ä¸¤ä¸ªç å…ƒæ¥ç¼–ç ï¼Œæ¯ä¸ª16æ¯”ç‰¹ã€‚ä»£ç ç‚¹ U+1F600 è¢«æ‹†åˆ†ä¸ºæ‰€è°“çš„ä»£ç†å¯¹ï¼š0xD83Dï¼ˆé«˜ä½ä»£ç†ç å…ƒï¼‰ä¸ 0xDE00ï¼ˆä½ä½ä»£ç†ç å…ƒï¼‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">console.log(&#x27;\uD83D\uDE00&#x27;);</span><br></pre></td></tr></table></figure>
<p>ä»£ç†å¯¹ä¸ç ç‚¹ä¹‹é—´äº’ç›¸è½¬æ¢çš„ç®—æ³•å¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function getSurrogatePair(astralCodePoint) &#123;  </span><br><span class="line">  let highSurrogate = </span><br><span class="line">     Math.floor((astralCodePoint - 0x10000) / 0x400) + 0xD800;</span><br><span class="line">  let lowSurrogate = (astralCodePoint - 0x10000) % 0x400 + 0xDC00;</span><br><span class="line">  return [highSurrogate, lowSurrogate];</span><br><span class="line">&#125;</span><br><span class="line">getSurrogatePair(0x1F600); // =&gt; [0xDC00, 0xDFFF]</span><br><span class="line"></span><br><span class="line">function getAstralCodePoint(highSurrogate, lowSurrogate) &#123;  </span><br><span class="line">  return (highSurrogate - 0xD800) * 0x400 </span><br><span class="line">      + lowSurrogate - 0xDC00 + 0x10000;</span><br><span class="line">&#125;</span><br><span class="line">getAstralCodePoint(0xD83D, 0xDE00); // =&gt; 0x1F600</span><br></pre></td></tr></table></figure>

<h3 id="ç»„åˆç”¨å­—ç¬¦-combining-marks"><a href="#ç»„åˆç”¨å­—ç¬¦-combining-marks" class="headerlink" title="ç»„åˆç”¨å­—ç¬¦(combining marks)"></a>ç»„åˆç”¨å­—ç¬¦(combining marks)</h3><p>å­—ç´ å°±æ˜¯ç”¨æˆ·æ‰€è®¤ä¸ºçš„ä¸€ä¸ªå­—ç¬¦ã€‚å±å¹•ä¸Šæ‰€å±•ç¤ºçš„ä¸€ä¸ªæœ‰å½¢çš„å­—ç´ ç§°ä¸ºå›¾åƒå­—ç¬¦ï¼ˆglyphï¼‰ã€‚</p>
<p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸€ä¸ªUnicodeå­—ç¬¦å°±ä»£è¡¨ä¸€ä¸ªå­—ç´ ã€‚ä¾‹å¦‚ U+0066 LATIN SMALL LETTER Få°±æ˜¯ä¸€ä¸ªè‹±æ–‡å­—æ¯fã€‚</p>
<p>ä½†æœ‰æ—¶å€™ä¸€ä¸ªå­—ç´ ä¼šåŒ…å«ä¸€ç³»åˆ—å­—ç¬¦ã€‚</p>
<p>ä¾‹å¦‚Ã¥åœ¨ä¸¹éº¦è¯­ä¹¦å†™ç³»ç»Ÿä¸­æ˜¯ä¸€ä¸ªä¸å¯å†åˆ†çš„å­—ç´ ã€‚ä½†å®ƒæ˜¯ç”¨U+0061 LATIN SMALL LETTER A (æ¸²æŸ“ä¸ºa) ç»“åˆä¸€ä¸ªç‰¹æ®Šå­—ç¬¦U+030A COMBINING RING ABOVEï¼ˆæ¸²æŸ“ä¸ºâ—ŒÌŠï¼‰æ¥æ˜¾ç¤ºçš„ã€‚</p>
<p>U+030Aç”¨æ¥ä¿®é¥°å‰ä¸€ä¸ªå­—ç¬¦ï¼Œè¿™ç§å­—ç¬¦ç§°ä¸ºç»„åˆç”¨å­—ç¬¦ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">console.log(&#x27;\u0061\u030A&#x27;); // =&gt; &#x27;aÌŠ&#x27;  </span><br><span class="line">console.log(&#x27;\u0061&#x27;);       // =&gt; &#x27;a&#x27;</span><br></pre></td></tr></table></figure>
<p>åœ¨ç”¨æˆ·çœ‹æ¥ä¸€ä¸ªç»„åˆå­—ç¬¦åºåˆ—ï¼ˆåŸºç¡€å­—ç¬¦+ç»„åˆç”¨å­—ç¬¦ï¼‰æ˜¯â€ä¸€â€ä¸ªç¬¦å·ï¼ˆä¾‹å¦‚â€™\u0061\u030Aâ€™å°±æ˜¯â€™aÌŠâ€™ï¼‰ã€‚ä½†å¼€å‘è€…å¿…é¡»æ¸…æ¥šå®é™…ä¸Šè¦ç”¨åˆ°ä¸¤ä¸ªä»£ç ç‚¹U+0061å’ŒU+030Aæ¥ç”ŸæˆaÌŠã€‚<br><img src="/Unicode/terms.png" alt="terms"></p>
<h2 id="javascript-ä¸­çš„Unicode"><a href="#javascript-ä¸­çš„Unicode" class="headerlink" title="javascript ä¸­çš„Unicode"></a>javascript ä¸­çš„Unicode</h2><p>ä¸€èˆ¬æºç çš„å­˜å‚¨å’Œäº¤æ¢é€šå¸¸ä½¿ç”¨UTF-8(webé€šå¸¸ç¼–ç å½¢å¼),stringç±»å‹(å­—ç¬¦ä¸²)æ˜¯ç”±16æ¯”ç‰¹æ— ç¬¦å·æ•´æ•°å€¼(â€œå…ƒç´ â€)ç»„æˆçš„é›†åˆï¼Œæ¯ä¸ªåœ¨å­—ç¬¦ä¸²çš„å…ƒç´ è¢«å½“åšUTF-16ç å…ƒï¼Œè€Œå­—ç¬¦ä¸²çš„é•¿åº¦å°±æ˜¯ç å…ƒçš„ä¸ªæ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let smile = &#x27;\uD83D\uDE00&#x27;;  </span><br><span class="line">console.log(smile);        // =&gt; &#x27;ğŸ˜€&#x27;  </span><br><span class="line">console.log(smile.length); // =&gt; 2</span><br><span class="line"></span><br><span class="line">let letter = &#x27;e\u0301&#x27;;  </span><br><span class="line">console.log(letter);        // =&gt; &#x27;eÌ&#x27;  </span><br><span class="line">console.log(letter.length); // =&gt; 2  </span><br></pre></td></tr></table></figure>
<p>å§‹ç»ˆå°†JavaScriptä¸­çš„å­—ç¬¦ä¸²è§†ä¸ºä¸€ä¸²ç å…ƒåºåˆ—ã€‚å­—ç¬¦ä¸²æ¸²æŸ“çš„ç»“æœå¹¶ä¸èƒ½æ¸…æ™°åœ°è¡¨æ˜å®ƒåŒ…å«äº†æ€æ ·çš„ç å…ƒã€‚</p>
<p>å¤§å¤šæ•°JavaScriptå­—ç¬¦ä¸²æ–¹æ³•éƒ½ä¸èƒ½ æ™ºèƒ½è¯†åˆ«Unicode ã€‚å¦‚æœå­—ç¬¦ä¸²å«æœ‰æ··åˆçš„Unicodeå­—ç¬¦ï¼Œåœ¨è°ƒç”¨myString.slice()ã€myString.substring()ç­‰æ–¹æ³•æ—¶å°±è¦å°å¿ƒäº†ã€‚</p>
<h3 id="è½¬ä¹‰åºåˆ—"><a href="#è½¬ä¹‰åºåˆ—" class="headerlink" title="è½¬ä¹‰åºåˆ—"></a>è½¬ä¹‰åºåˆ—</h3><p>åœ¨jså­—ç¬¦ä¸²ä¸­è½¬ä¹‰åºåˆ—é€šå¸¸æ˜¯å°†ç ç‚¹è½¬ä¸ºç å…ƒï¼Œä¸€å…±æœ‰ä¸‰ç§æ–¹å¼</p>
<h4 id="16è¿›åˆ¶è½¬ä¹‰åºåˆ—-Hexadecimal-escape-sequence-ï¼š-x-xä¸ºå‰ç¼€ï¼Œåé¢è·Ÿä¸€ä¸ª2ä½çš„16è¿›åˆ¶æ•°"><a href="#16è¿›åˆ¶è½¬ä¹‰åºåˆ—-Hexadecimal-escape-sequence-ï¼š-x-xä¸ºå‰ç¼€ï¼Œåé¢è·Ÿä¸€ä¸ª2ä½çš„16è¿›åˆ¶æ•°" class="headerlink" title="16è¿›åˆ¶è½¬ä¹‰åºåˆ—(Hexadecimal escape sequence)ï¼š\x. \xä¸ºå‰ç¼€ï¼Œåé¢è·Ÿä¸€ä¸ª2ä½çš„16è¿›åˆ¶æ•°"></a>16è¿›åˆ¶è½¬ä¹‰åºåˆ—(Hexadecimal escape sequence)ï¼š\x<hex>. \xä¸ºå‰ç¼€ï¼Œåé¢è·Ÿä¸€ä¸ª2ä½çš„16è¿›åˆ¶æ•°</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var str = &#x27;\x4A\x61vaScript&#x27;;  </span><br><span class="line">console.log(str);                    // =&gt; &#x27;JavaScript&#x27;  </span><br><span class="line">var reg = /\x4A\x61va.*/;  </span><br><span class="line">console.log(reg.test(&#x27;JavaScript&#x27;)); // =&gt; true </span><br></pre></td></tr></table></figure>
<p>6è¿›åˆ¶è½¬ä¹‰åºåˆ—åªèƒ½ç¼–ç ä»U+00åˆ°U+FFçš„æœ‰é™æ•°é‡çš„ä»£ç ç‚¹ï¼Œå› ä¸ºå®ƒåªèƒ½æœ‰2ä½æ•°å­—ã€‚ä½†16è¿›åˆ¶è½¬ä¹‰åºåˆ—çš„å¥½å¤„æ˜¯å®ƒå¾ˆçŸ­ã€‚</p>
<h4 id="Unicodeè½¬ä¹‰åºåˆ—-Unicode-escape-sequence-ï¼šä½ æƒ³è½¬ä¹‰æ•´ä¸ªBMPä¸­çš„ä»£ç ç‚¹ï¼Œè½¬ä¹‰å½¢å¼æ˜¯-u-uä¸ºå‰ç¼€ï¼Œåé¢è·Ÿä¸€ä¸ª4ä½çš„16è¿›åˆ¶æ•°ã€‚"><a href="#Unicodeè½¬ä¹‰åºåˆ—-Unicode-escape-sequence-ï¼šä½ æƒ³è½¬ä¹‰æ•´ä¸ªBMPä¸­çš„ä»£ç ç‚¹ï¼Œè½¬ä¹‰å½¢å¼æ˜¯-u-uä¸ºå‰ç¼€ï¼Œåé¢è·Ÿä¸€ä¸ª4ä½çš„16è¿›åˆ¶æ•°ã€‚" class="headerlink" title="Unicodeè½¬ä¹‰åºåˆ—(Unicode escape sequence)ï¼šä½ æƒ³è½¬ä¹‰æ•´ä¸ªBMPä¸­çš„ä»£ç ç‚¹ï¼Œè½¬ä¹‰å½¢å¼æ˜¯\u,\uä¸ºå‰ç¼€ï¼Œåé¢è·Ÿä¸€ä¸ª4ä½çš„16è¿›åˆ¶æ•°ã€‚"></a>Unicodeè½¬ä¹‰åºåˆ—(Unicode escape sequence)ï¼šä½ æƒ³è½¬ä¹‰æ•´ä¸ªBMPä¸­çš„ä»£ç ç‚¹ï¼Œè½¬ä¹‰å½¢å¼æ˜¯\u<hex>,\uä¸ºå‰ç¼€ï¼Œåé¢è·Ÿä¸€ä¸ª4ä½çš„16è¿›åˆ¶æ•°ã€‚</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var str = &#x27;I\u0020learn \u0055nicode&#x27;;  </span><br><span class="line">console.log(str);                 // =&gt; &#x27;I learn Unicode&#x27;  </span><br><span class="line">var reg = /\u0055ni.*/;  </span><br><span class="line">console.log(reg.test(&#x27;Unicode&#x27;)); // =&gt; true</span><br></pre></td></tr></table></figure>
<p>æƒ³è¦åœ¨JavaScriptæ–‡æœ¬ä¸­è¡¨ç¤ºæ˜Ÿå…‰å­—ç¬¦ï¼Œå¯ä»¥ç”¨ä¸¤ä¸ªè¿ç»­çš„Unicodeè½¬ä¹‰åºåˆ—ï¼ˆé«˜ä½ä»£ç†ä¸ä½ä½ä»£ç†ï¼‰ï¼Œç”Ÿæˆä»£ç†å¯¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var str = &#x27;My face \uD83D\uDE00&#x27;;  </span><br><span class="line">console.log(str); // =&gt; &#x27;My face ğŸ˜€&#x27;  </span><br></pre></td></tr></table></figure>

<h4 id="ç ç‚¹è½¬ä¹‰åºåˆ—-Code-point-escape-sequence-ï¼š-ECMAScript-2015æä¾›äº†èƒ½å¤Ÿè¡¨ç¤ºæ•´ä¸ªUnicodeç©ºé—´ï¼šä»U-0000åˆ°U-10FFFFï¼Œä¹Ÿå°±æ˜¯BMPä¸æ˜Ÿå…‰å¹³é¢çš„è½¬ä¹‰åºåˆ—ã€‚-u-ï¼Œæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º1è‡³6ä½çš„16è¿›åˆ¶æ•°ã€‚"><a href="#ç ç‚¹è½¬ä¹‰åºåˆ—-Code-point-escape-sequence-ï¼š-ECMAScript-2015æä¾›äº†èƒ½å¤Ÿè¡¨ç¤ºæ•´ä¸ªUnicodeç©ºé—´ï¼šä»U-0000åˆ°U-10FFFFï¼Œä¹Ÿå°±æ˜¯BMPä¸æ˜Ÿå…‰å¹³é¢çš„è½¬ä¹‰åºåˆ—ã€‚-u-ï¼Œæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º1è‡³6ä½çš„16è¿›åˆ¶æ•°ã€‚" class="headerlink" title="ç ç‚¹è½¬ä¹‰åºåˆ—(Code point escape sequence)ï¼š ECMAScript 2015æä¾›äº†èƒ½å¤Ÿè¡¨ç¤ºæ•´ä¸ªUnicodeç©ºé—´ï¼šä»U+0000åˆ°U+10FFFFï¼Œä¹Ÿå°±æ˜¯BMPä¸æ˜Ÿå…‰å¹³é¢çš„è½¬ä¹‰åºåˆ—ã€‚\u{}ï¼Œæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º1è‡³6ä½çš„16è¿›åˆ¶æ•°ã€‚"></a>ç ç‚¹è½¬ä¹‰åºåˆ—(Code point escape sequence)ï¼š ECMAScript 2015æä¾›äº†èƒ½å¤Ÿè¡¨ç¤ºæ•´ä¸ªUnicodeç©ºé—´ï¼šä»U+0000åˆ°U+10FFFFï¼Œä¹Ÿå°±æ˜¯BMPä¸æ˜Ÿå…‰å¹³é¢çš„è½¬ä¹‰åºåˆ—ã€‚\u{<hex>}ï¼Œ<hex>æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º1è‡³6ä½çš„16è¿›åˆ¶æ•°ã€‚</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var str = &#x27;Funny cat \u&#123;1F639&#125;&#x27;;  </span><br><span class="line">console.log(str);                      // =&gt; &#x27;Funny cat ğŸ˜¹&#x27;  </span><br><span class="line">var reg = /\u&#123;1F639&#125;/u;  </span><br><span class="line">console.log(reg.test(&#x27;Funny cat ğŸ˜¹&#x27;)); // =&gt; true  </span><br></pre></td></tr></table></figure>
<p><img src="/Unicode/EscapeSequences.png" alt="escapeSequences"></p>
<h3 id="å­—ç¬¦ä¸²æ¯”è¾ƒ"><a href="#å­—ç¬¦ä¸²æ¯”è¾ƒ" class="headerlink" title="å­—ç¬¦ä¸²æ¯”è¾ƒ"></a>å­—ç¬¦ä¸²æ¯”è¾ƒ</h3><p>JavaScriptä¸­çš„å­—ç¬¦ä¸²æ˜¯ç å…ƒçš„åºåˆ—ã€‚å› æ­¤å­—ç¬¦ä¸²çš„æ¯”è¾ƒå¯ä»¥çœ‹ä½œæ˜¯ç å…ƒçš„è®¡ç®—ä¸åŒ¹é…ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var firstStr = &#x27;hello&#x27;;  </span><br><span class="line">var secondStr = &#x27;\u0068ell\u006F&#x27;;  </span><br><span class="line">console.log(firstStr === secondStr); // =&gt; true</span><br></pre></td></tr></table></figure>

<p>å‡è®¾ä½ æƒ³æ¯”è¾ƒä¸¤ä¸ªæ¸²æŸ“ç»“æœç›¸åŒï¼Œä½†åŒ…å«ä¸åŒç å…ƒåºåˆ—çš„å­—ç¬¦ä¸²ã€‚å› ä¸ºçœ‹ä¸Šå»ç›¸åŒçš„å­—ç¬¦ä¸²ç»è¿‡æ¯”è¾ƒå´ä¸ç›¸ç­‰.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var str1 = &#x27;Ã§a va bien&#x27;;  </span><br><span class="line">var str2 = &#x27;c\u0327a va bien&#x27;;  </span><br><span class="line">console.log(str1);          // =&gt; &#x27;Ã§a va bien&#x27;  </span><br><span class="line">console.log(str2);          // =&gt; &#x27;cÌ§a va bien&#x27;  </span><br><span class="line">console.log(str1 === str2); // =&gt; false</span><br></pre></td></tr></table></figure>
<p>str1å’Œstr2æ¸²æŸ“ç»“æœçœ‹èµ·æ¥ç›¸åŒï¼Œä½†åŒ…å«ä¸åŒçš„ç å…ƒã€‚</p>
<p>å› ä¸ºå­—ç´ Ã§å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹æ³•ç”Ÿæˆï¼š</p>
<ul>
<li>ä½¿ç”¨U+00E7 LATIN SMALL LETTER C WITH CEDILLA</li>
<li>æˆ–è€…ç”¨ç»„åˆå­—ç¬¦åºåˆ—ï¼šU+0063 LATIN SMALL LETTER C åŠ ä¸Šç»„åˆç”¨å­—ç¬¦U+0327 COMBINING CEDILLA.</li>
</ul>
<h3 id="æ ‡å‡†åŒ–ï¼šæ ‡å‡†åŒ–æ˜¯æŒ‡å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºç»Ÿä¸€çš„è¡¨ç¤ºå½¢å¼ï¼Œä»¥ä¿è¯å…·æœ‰æ ‡å‡†ç­‰ä»·æ€§ï¼ˆæˆ–å…¼å®¹ç­‰ä»·æ€§ï¼‰çš„å­—ç¬¦ä¸²åªæœ‰ä¸€ç§è¡¨ç¤ºå½¢å¼ã€‚"><a href="#æ ‡å‡†åŒ–ï¼šæ ‡å‡†åŒ–æ˜¯æŒ‡å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºç»Ÿä¸€çš„è¡¨ç¤ºå½¢å¼ï¼Œä»¥ä¿è¯å…·æœ‰æ ‡å‡†ç­‰ä»·æ€§ï¼ˆæˆ–å…¼å®¹ç­‰ä»·æ€§ï¼‰çš„å­—ç¬¦ä¸²åªæœ‰ä¸€ç§è¡¨ç¤ºå½¢å¼ã€‚" class="headerlink" title="æ ‡å‡†åŒ–ï¼šæ ‡å‡†åŒ–æ˜¯æŒ‡å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºç»Ÿä¸€çš„è¡¨ç¤ºå½¢å¼ï¼Œä»¥ä¿è¯å…·æœ‰æ ‡å‡†ç­‰ä»·æ€§ï¼ˆæˆ–å…¼å®¹ç­‰ä»·æ€§ï¼‰çš„å­—ç¬¦ä¸²åªæœ‰ä¸€ç§è¡¨ç¤ºå½¢å¼ã€‚"></a>æ ‡å‡†åŒ–ï¼šæ ‡å‡†åŒ–æ˜¯æŒ‡å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºç»Ÿä¸€çš„è¡¨ç¤ºå½¢å¼ï¼Œä»¥ä¿è¯å…·æœ‰æ ‡å‡†ç­‰ä»·æ€§ï¼ˆæˆ–å…¼å®¹ç­‰ä»·æ€§ï¼‰çš„å­—ç¬¦ä¸²åªæœ‰ä¸€ç§è¡¨ç¤ºå½¢å¼ã€‚</h3><p>åœ¨JavaScriptä¸­å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ ‡å‡†åŒ–éœ€è¦è°ƒç”¨ES2015æä¾›çš„myString.normalize([normForm])æ–¹æ³•ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var str1 = &#x27;Ã§a va bien&#x27;;  </span><br><span class="line">var str2 = &#x27;c\u0327a va bien&#x27;;  </span><br><span class="line">console.log(str1 === str2.normalize()); // =&gt; true  </span><br><span class="line">console.log(str1 === str2);             // =&gt; false</span><br></pre></td></tr></table></figure>
<p>â€˜Ã§â€™ä¸â€™c\u0327â€™å…·æœ‰æ ‡å‡†ç­‰ä»·æ€§ã€‚<br>è°ƒç”¨str2.normalize()ï¼Œä¼šè¿”å›ä¸€ä¸ªstr2 çš„æ ‡å‡†å½¢å¼å‰¯æœ¬ï¼ˆâ€™c\u0327â€™æ›¿æ¢ä¸ºâ€™Ã§â€™ï¼‰ã€‚å› æ­¤æ¯”è¾ƒè¯­å¥str1 &#x3D;&#x3D;&#x3D; str2.normalize()ä¼šå¦‚é¢„æœŸä¸€èˆ¬è¿”å›true.<br>ä½†ä¸ºäº†ä½¿æ“ä½œç¬¦ä¸¤ç«¯éƒ½å–å¾—æ ‡å‡†åŒ–å­—ç¬¦ä¸²ï¼Œå°†å¾…æ¯”è¾ƒçš„2ä¸ªå­—ç¬¦ä¸²éƒ½æ ‡å‡†åŒ–ä¹Ÿæ˜¯åˆç†çš„ã€‚</p>
<h3 id="å­—ç¬¦ä¸²é•¿åº¦"><a href="#å­—ç¬¦ä¸²é•¿åº¦" class="headerlink" title="å­—ç¬¦ä¸²é•¿åº¦"></a>å­—ç¬¦ä¸²é•¿åº¦</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var str = &#x27;cat\u&#123;1F639&#125;&#x27;;  </span><br><span class="line">console.log(str);        // =&gt; &#x27;catğŸ˜¹&#x27;  </span><br><span class="line">console.log(str.length); // =&gt; 5  </span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œsmile.lengthç­‰äº5ï¼Œå› ä¸ºU+1F639æ˜¯ä¸€ä¸ªæ˜Ÿå…‰ä»£ç ç‚¹ï¼Œå®ƒè¢«ç¼–ç æˆäº†2ä¸ªç å…ƒï¼ˆä¸€ä¸ªä»£ç†å¯¹ï¼‰ã€‚<br>ECMAScript 2015å¼•å…¥äº†ä¸€ç§èƒ½å¤Ÿè¯†åˆ«æ˜Ÿå…‰å­—ç¬¦çš„ç®—æ³•ã€‚æ˜Ÿå…‰å­—ç¬¦å³ä½¿è¢«ç¼–è¯‘ä¸º2ä¸ªç å…ƒï¼Œä¹Ÿä¼šè¢«è®¡ç®—ä¸ºä¸€ä¸ªå­—ç¬¦ã€‚<br>è¿™ä¸ªèƒ½å¤Ÿè¯†åˆ«Unicodeçš„åˆ©å™¨å°±æ˜¯å­—ç¬¦è¿­ä»£å™¨String.prototype<a href="">@@iterator</a>ã€‚ä½ å¯ä»¥ç»™å­—ç¬¦ä¸²åŠ ä¸Šæ‰©å±•æ“ä½œç¬¦[â€¦str]æˆ–Array.from(str)å‡½æ•°ï¼ˆä¸¤è€…éƒ½ä¼šè°ƒç”¨å­—ç¬¦ä¸²è¿­ä»£å™¨ï¼‰ã€‚ç„¶åå†è®¡ç®—è¿”å›æ•°ç»„ä¸­çš„å­—ç¬¦ä¸ªæ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var str = &#x27;cat\u&#123;1F639&#125;&#x27;;  </span><br><span class="line">console.log(str);             // =&gt; &#x27;cat?&#x27;  </span><br><span class="line">console.log([...str]);        // =&gt; [&#x27;c&#x27;, &#x27;a&#x27;, &#x27;t&#x27;, &#x27;?&#x27;]  </span><br><span class="line">console.log([...str].length); // =&gt; 4</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆç»„åˆå­—ç¬¦åºåˆ—å‘¢ï¼Ÿç”±äºæ¯ä¸ªç»„åˆç”¨å­—ç¬¦éƒ½æ˜¯ä¸€ä¸ªç å…ƒï¼Œå› æ­¤ä½ ä¼šé‡åˆ°åŒæ ·çš„å›°éš¾ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var drink = &#x27;cafe\u0327\u0301&#x27;;  </span><br><span class="line">console.log(drink);                    // =&gt; &#x27;cafeÌ§Ì&#x27;  </span><br><span class="line">console.log(drink.length);             // =&gt; 6  </span><br><span class="line">console.log(drink.normalize());        // =&gt; &#x27;cafÈ©Ì&#x27;  </span><br><span class="line">console.log(drink.normalize().length); // =&gt; 5</span><br></pre></td></tr></table></figure>
<p>äºæ˜¯æˆ‘ä»¬å¾ˆéš¾è¿‡åœ°å‘ç°drink.normalize().lengthçš„å€¼ä¸º5ï¼Œä»ç„¶ä¸èƒ½æ­£ç¡®åœ°è®¡ç®—å­—ç¬¦çš„ä¸ªæ•°ã€‚</p>
<h3 id="å­—ç¬¦å®šä½"><a href="#å­—ç¬¦å®šä½" class="headerlink" title="å­—ç¬¦å®šä½"></a>å­—ç¬¦å®šä½</h3><p>ç”±äºå­—ç¬¦ä¸²æ˜¯ç å…ƒçš„åºåˆ—ï¼Œé€šè¿‡å­—ç¬¦ä¸²ç´¢å¼•æ¥è®¿é—®å­—ç¬¦åŒæ ·ä¼šæœ‰å›°éš¾ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var omega = &#x27;\u&#123;1D6C0&#125; is omega&#x27;;  </span><br><span class="line">console.log(omega);        // =&gt; &#x27;ğ›€ is omega&#x27;  </span><br><span class="line">console.log(omega[0]);     // =&gt; &#x27;&#x27; (unprintable symbol)  </span><br><span class="line">console.log(omega[1]);     // =&gt; &#x27;&#x27; (unprintable symbol)  </span><br></pre></td></tr></table></figure>

<p>æƒ³è¦æ­£ç¡®åœ°è®¿é—®å­—ç¬¦ä¸²ä¸­æ˜Ÿå…‰å­—ç¬¦ï¼Œæœ‰2ç§æ–¹æ³•ï¼š</p>
<ul>
<li>ä½¿ç”¨èƒ½å¤Ÿè¯†åˆ«Unicodeçš„å­—ç¬¦ä¸²è¿­ä»£å™¨ç”Ÿæˆä¸€ä¸ªå­—ç¬¦æ•°ç»„[â€¦str][index]</li>
<li>ç”¨number &#x3D; myString.codePointAt(index)è·å–ä»£ç ç‚¹ï¼Œç„¶åç”¨String.fromCodePoint(number)å°†ä»£ç ç‚¹è½¬æ¢ä¸ºå­—ç¬¦ï¼ˆæ¨èæ–¹æ³•ï¼‰</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var omega = &#x27;\u&#123;1D6C0&#125; is omega&#x27;;  </span><br><span class="line">console.log(omega);                        // =&gt; &#x27;ğ›€ is omega&#x27;  </span><br><span class="line">// Option 1</span><br><span class="line">console.log([...omega][0]);                // =&gt; &#x27;ğ›€&#x27;  </span><br><span class="line">// Option 2</span><br><span class="line">var number = omega.codePointAt(0);  </span><br><span class="line">console.log(number.toString(16));          // =&gt; &#x27;1d6c0&#x27;  </span><br><span class="line">console.log(String.fromCodePoint(number)); // =&gt; &#x27;ğ›€&#x27;  </span><br></pre></td></tr></table></figure>
<p>å‡½æ•°omega.codePointAt(0)èƒ½å¤Ÿè¯†åˆ«Unicodeï¼Œå› æ­¤å®ƒè¿”å›äº†å­—ç¬¦ä¸²omegaç¬¬ä¸€ä¸ªå­—ç¬¦çš„æ˜Ÿå…‰ä»£ç ç‚¹æ•°å­—0x1D6C0ã€‚å‡½æ•°String.fromCodePoint(number)åˆ™è¿”å›äº†è¿™ä¸ªä»£ç ç‚¹å¯¹åº”çš„å­—ç¬¦ï¼šâ€™ğ›€â€™.</p>
<p>å­—ç¬¦å®šä½åœ¨é‡åˆ°ç»„åˆç”¨å­—ç¬¦æ—¶ä¼šå‡ºç°å’Œä¸Šé¢ä¸€æ ·çš„é—®é¢˜ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var drink = &#x27;cafe\u0301&#x27;;  </span><br><span class="line">console.log(drink.normalize());        // =&gt; &#x27;cafeÌ&#x27;  </span><br><span class="line">console.log(drink.normalize().length); // =&gt; 4  </span><br><span class="line">console.log(drink.normalize()[3]);     // =&gt; &#x27;Ã©&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="æ­£åˆ™åŒ¹é…"><a href="#æ­£åˆ™åŒ¹é…" class="headerlink" title="æ­£åˆ™åŒ¹é…"></a>æ­£åˆ™åŒ¹é…</h3><p>æ­£åˆ™è¡¨è¾¾å¼ä¸å­—ç¬¦ä¸²ä¸€æ ·ï¼Œæ˜¯åŸºäºç å…ƒå·¥ä½œçš„ã€‚å› æ­¤ä¸ä¸Šæ–‡æè¿°çš„æƒ…å½¢ç›¸ä¼¼ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åœ¨å¤„ç†ä»£ç†å¯¹å’Œç»„åˆå­—ç¬¦åºåˆ—æ—¶ä¹Ÿä¼šé‡åˆ°å›°éš¾ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var smile = &#x27;ğŸ˜€&#x27;;  </span><br><span class="line">var regex = /^.$/;  </span><br><span class="line">console.log(regex.test(smile)); // =&gt; false  </span><br></pre></td></tr></table></figure>
<p>smileåŒ…å«æ˜Ÿå…‰å­—ç¬¦U+1F600 GRINNING FACEã€‚U+1F600è¢«ç¼–ç ä¸ºä¸€ä¸ªä»£ç†å¯¹0xD83D 0xDE00ã€‚</p>
<p>ç„¶è€Œæ­£åˆ™è¡¨è¾¾å¼&#x2F;^.$&#x2F;æœŸæœ›çš„æ˜¯1ä¸ªç å…ƒï¼Œäºæ˜¯æ­£åˆ™åŒ¹é…regexp.test(smile)å¤±è´¥äº†ã€‚</p>
<p>åœ¨å®šä¹‰å­—ç¬¦åŒºé—´çš„æ—¶å€™æƒ…å†µä¼šæ›´ç³Ÿã€‚JavaScriptç›´æ¥æŠ¥é”™äº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var regex = /[ğŸ˜€-ğŸ˜]/;  </span><br><span class="line">// =&gt; SyntaxError: Invalid regular expression: /[ğŸ˜€-ğŸ˜]/: </span><br><span class="line">// Range out of order in character class</span><br></pre></td></tr></table></figure>
<p>æ˜Ÿå…‰ä»£ç ç‚¹ä¼šè¢«ç¼–ç ä¸ºä»£ç†å¯¹ï¼Œå› æ­¤JavaScriptä¼šç”¨ç å…ƒ&#x2F;[\uD83D\uDE00-\uD83D\uDE0E]&#x2F;æ¥è¡¨ç¤ºè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚è€Œåœ¨patternä¸­æ¯ä¸ªç å…ƒè¢«è§†ä¸ºä¸€ä¸ªå•ç‹¬çš„å…ƒç´ ï¼Œæ‰€ä»¥æ­£åˆ™è¡¨è¾¾å¼ä¼šå¿½ç•¥ä»£ç†å¯¹è¿™ä¸ªæ¦‚å¿µã€‚</p>
<p>å¥½åœ¨ECMAScript 2015å¼•å…¥äº†uæ ‡å¿—ï¼Œä½¿å¾—æ­£åˆ™è¡¨è¾¾å¼èƒ½å¤Ÿè¯†åˆ«Unicodeã€‚è¿™ä¸ªæ ‡å¿—è®©æˆ‘ä»¬èƒ½å¤Ÿæ­£ç¡®å¤„ç†æ˜Ÿå…‰å­—ç¬¦ã€‚</p>
<p>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å¯ä»¥ä½¿ç”¨Unicodeè½¬ä¹‰åºåˆ—&#x2F;u{1F600}&#x2F;uã€‚è¿™æ ·æ¯”å†™é«˜ä½ä»£ç†å’Œä½ä½ä»£ç†&#x2F;\uD83D\uDE00&#x2F;è¦çŸ­ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var smile = &#x27;ğŸ˜€&#x27;;  </span><br><span class="line">var regex = /^.$/u;  </span><br><span class="line">console.log(regex.test(smile)); // =&gt; true  </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var smile = &#x27;ğŸ˜€&#x27;;  </span><br><span class="line">var regex = /[ğŸ˜€-ğŸ˜]/u;  </span><br><span class="line">var regexEscape = /[\u&#123;1F600&#125;-\u&#123;1F60E&#125;]/u;  </span><br><span class="line">var regexSpEscape = /[\uD83D\uDE00-\uD83D\uDE0E]/u;  </span><br><span class="line">console.log(regex.test(smile));         // =&gt; true  </span><br><span class="line">console.log(regexEscape.test(smile));   // =&gt; true  </span><br><span class="line">console.log(regexSpEscape.test(smile)); // =&gt; true  </span><br></pre></td></tr></table></figure>

<h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>ä¹Ÿè®¸åœ¨JavaScriptä¸­æœ‰å…³Unicodeçš„æœ€é‡è¦çš„æ¦‚å¿µå°±æ˜¯å°†å­—ç¬¦ä¸²è§†ä¸ºç å…ƒåºåˆ—ï¼Œäº‹å®ä¹Ÿç¡®å®å¦‚æ­¤ã€‚</p>
<p>å¦‚æœå¼€å‘è€…è®¤ä¸ºå­—ç¬¦ä¸²æ˜¯ç”±å­—ç´ ï¼ˆæˆ–å­—ç¬¦ï¼‰ç»„æˆï¼Œå¿½ç•¥ç å…ƒåºåˆ—è¿™ä¸ªæ¦‚å¿µï¼Œå°±ä¼šæ„Ÿåˆ°å›°æƒ‘ã€‚</p>
]]></content>
      <categories>
        <category>ç¼–ç </category>
      </categories>
  </entry>
  <entry>
    <title>ä½¿ç”¨Async/Awaitä¼˜åŒ–Promise</title>
    <url>/2017/10/17/Async_Await/</url>
    <content><![CDATA[<p>ï¼ˆæœ¬æ¥æƒ³åæ§½ä¸‹å»å¹´æ‰ç†Ÿç»ƒä½¿ç”¨Promiseä½†æ˜¯åˆè¦ç”¨async-awaitï¼Œä½†æ˜¯async-awaitç‚’é¸¡å¥½ç”¨ï¼Œé»˜é»˜æµæ³ªï¼‰</p>
<h3 id="Async-x2F-Awaitä¸Promiseçš„å…³ç³»"><a href="#Async-x2F-Awaitä¸Promiseçš„å…³ç³»" class="headerlink" title="Async&#x2F;Awaitä¸Promiseçš„å…³ç³»"></a>Async&#x2F;Awaitä¸Promiseçš„å…³ç³»</h3><p>  async-awaitæ˜¯promiseå’Œgeneratorçš„è¯­æ³•ç³–ï¼Œæ„åœ¨ä¼˜åŒ–promiseçš„å†™æ³•ï¼Œç®€å•çš„è¯´async-awaitæ˜¯ç”¨æ¥ç®€åŒ–pormiseå†™æ³•çš„ï¼Œå¹¶ä¸æ˜¯å–ä»£å…³ç³»ã€‚</p>
<h3 id="Async-x2F-AwaitåŸºæœ¬è¯­æ³•"><a href="#Async-x2F-AwaitåŸºæœ¬è¯­æ³•" class="headerlink" title="Async&#x2F;AwaitåŸºæœ¬è¯­æ³•"></a>Async&#x2F;AwaitåŸºæœ¬è¯­æ³•</h3><p>  Asyncæ”¾åœ¨functionå…³é”®å­—å‰é¢ï¼Œawaitæ”¾åœ¨Asyncå…³é”®å­—çš„å‡½æ•°é‡Œï¼Œå¹¶ä¸”æœ€ç»ˆè¿”å›ä¸€ä¸ªpromiseå¯¹è±¡ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š<br>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">async function asyncAwaitDemo()&#123;</span><br><span class="line">    const result = await new Promise((resolve, reject)=&gt;&#123;</span><br><span class="line">        setTimeout(()=&gt;&#123;</span><br><span class="line">            resolve(&#x27;test&#x27;)</span><br><span class="line">        &#125;,200)</span><br><span class="line">    &#125;)</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br><span class="line">asyncAwaitDemo().then((r)=&gt;&#123;</span><br><span class="line">    console.log(&#x27;result:&#x27;,r);</span><br><span class="line">&#125;)</span><br><span class="line">// result: test</span><br></pre></td></tr></table></figure></p>
<span id="more"></span>


<p>  éœ€è¦æ³¨æ„çš„æ˜¯awaitåªèƒ½æ”¾åœ¨asyncå…³é”®å£°æ˜çš„å‡½æ•°é‡Œï¼ˆè¿™ç‚¹å’Œyieldä¸*çš„å…³ç³»ä¸€è‡´ï¼‰<br>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// æ­£å¸¸ for å¾ªç¯</span><br><span class="line">async function demo() &#123;</span><br><span class="line">    let arr = [1, 2, 3, 4, 5];</span><br><span class="line">    for (let i = 0, len = arr.length; i &lt; len; i ++) &#123;</span><br><span class="line">        await arr[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">demo();//æ­£å¸¸è¾“å‡º</span><br><span class="line">//å¦‚æœforå¾ªç¯å†™æˆä¸‹é¢è¿™æ ·</span><br><span class="line">async function bugDemo() &#123;</span><br><span class="line">    let arr = [1, 2, 3, 4, 5];</span><br><span class="line">    arr.forEach(item =&gt; &#123;</span><br><span class="line">        await item;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">bugDemo();// Uncaught SyntaxError: Unexpected identifier</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h3 id="åœºæ™¯ç¤ºä¾‹"><a href="#åœºæ™¯ç¤ºä¾‹" class="headerlink" title="åœºæ™¯ç¤ºä¾‹"></a>åœºæ™¯ç¤ºä¾‹</h3><p>  è¿™é‡Œå†™ä¸€ä¸ªç®€å•æ¨¡æ‹Ÿå¼‚æ­¥api<br>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  class Api &#123;</span><br><span class="line">  constructor () &#123;</span><br><span class="line">    this.user = &#123; id: 1, name: &#x27;test&#x27; &#125;</span><br><span class="line">    this.friends = [ this.user, this.user, this.user ]</span><br><span class="line">    this.photo = &#x27;not a real photo&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  getUser () &#123;</span><br><span class="line">    return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">      setTimeout(() =&gt; resolve(this.user), 200)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  getFriends (userId) &#123;</span><br><span class="line">    return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">      setTimeout(() =&gt; resolve(this.friends.slice()), 200)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  getPhoto (userId) &#123;</span><br><span class="line">    return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">      setTimeout(() =&gt; resolve(this.photo), 200)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  throwError () &#123;</span><br><span class="line">    return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">      setTimeout(() =&gt; reject(new Error(&#x27;Intentional Error&#x27;)), 200)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="éœ€æ±‚1ï¼šè·å¾—ç”¨æˆ·ä¿¡æ¯"><a href="#éœ€æ±‚1ï¼šè·å¾—ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="éœ€æ±‚1ï¼šè·å¾—ç”¨æˆ·ä¿¡æ¯"></a>éœ€æ±‚1ï¼šè·å¾—ç”¨æˆ·ä¿¡æ¯</h4><p>  promiseé“¾å†™æ³•<br>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  function promiseChain () &#123;</span><br><span class="line">  const api = new Api()</span><br><span class="line">  let user, friends</span><br><span class="line">  api.getUser()</span><br><span class="line">    .then((returnedUser) =&gt; &#123;</span><br><span class="line">      user = returnedUser</span><br><span class="line">      return api.getFriends(user.id)</span><br><span class="line">    &#125;)</span><br><span class="line">    .then((returnedFriends) =&gt; &#123;</span><br><span class="line">      friends = returnedFriends</span><br><span class="line">      return api.getPhoto(user.id)</span><br><span class="line">    &#125;)</span><br><span class="line">    .then((photo) =&gt; &#123;</span><br><span class="line">      console.log(&#x27;promiseChain&#x27;, &#123; user, friends, photo &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Async&#x2F;Awaitå†™æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">async function asyncAwaitIsYourNewBestFriend () &#123;</span><br><span class="line">  const api = new Api()</span><br><span class="line">  const user = await api.getUser()</span><br><span class="line">  const friends = await api.getFriends(user.id)</span><br><span class="line">  const photo = await api.getPhoto(user.id)</span><br><span class="line">  console.log(&#x27;asyncAwaitIsYourNewBestFriend&#x27;, &#123; user, friends, photo &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="éœ€æ±‚2ï¼šè·å¾—æœ‹å‹çš„æœ‹å‹"><a href="#éœ€æ±‚2ï¼šè·å¾—æœ‹å‹çš„æœ‹å‹" class="headerlink" title="éœ€æ±‚2ï¼šè·å¾—æœ‹å‹çš„æœ‹å‹"></a>éœ€æ±‚2ï¼šè·å¾—æœ‹å‹çš„æœ‹å‹</h4><p> promiseé“¾å†™æ³•:è¿™é‡Œä½¿ç”¨çš„æ˜¯è¿­ä»£å¾ªç¯<br> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> function promiseLoops () &#123;  </span><br><span class="line">  const api = new Api()</span><br><span class="line">  api.getUser()</span><br><span class="line">    .then((user) =&gt; &#123;</span><br><span class="line">      return api.getFriends(user.id)</span><br><span class="line">    &#125;)</span><br><span class="line">    .then((returnedFriends) =&gt; &#123;</span><br><span class="line">      const getFriendsOfFriends = (friends) =&gt; &#123;</span><br><span class="line">        if (friends.length &gt; 0) &#123;</span><br><span class="line">          let friend = friends.pop()</span><br><span class="line">          return api.getFriends(friend.id)</span><br><span class="line">            .then((moreFriends) =&gt; &#123;</span><br><span class="line">              console.log(&#x27;promiseLoops&#x27;, moreFriends)</span><br><span class="line">              return getFriendsOfFriends(friends)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      return getFriendsOfFriends(returnedFriends)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br> Async&#x2F;Awaitå†™æ³•:<br> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> async function asyncAwaitLoops () &#123;</span><br><span class="line">  const api = new Api()</span><br><span class="line">  const user = await api.getUser()</span><br><span class="line">  const friends = await api.getFriends(user.id)</span><br><span class="line">  for (let friend of friends) &#123;</span><br><span class="line">    let moreFriends = await api.getFriends(friend.id)</span><br><span class="line">    console.log(&#x27;asyncAwaitLoops&#x27;, moreFriends)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>  Async&#x2F;Awaitå†™æ³•ç®€åŒ–å¹¶å‘<br>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  async function asyncAwaitLoopsParallel () &#123;</span><br><span class="line">  const api = new Api()</span><br><span class="line">  const user = await api.getUser()</span><br><span class="line">  const friends = await api.getFriends(user.id)</span><br><span class="line">  const friendPromises = friends.map(friend =&gt; api.getFriends(friend.id))</span><br><span class="line">  const moreFriends = await Promise.all(friendPromises)</span><br><span class="line">  console.log(&#x27;asyncAwaitLoopsParallel&#x27;, moreFriends)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>  å‚è€ƒï¼š</p>
<ul>
<li><a href="https://promisesaplus.com/">Promises&#x2F;A+</a></li>
<li><a href="https://blog.patricktriest.com/what-is-async-await-why-should-you-care/">ASYNC&#x2F;AWAIT WILL MAKE YOUR CODE SIMPLER</a></li>
</ul>
]]></content>
      <categories>
        <category>javscript</category>
      </categories>
  </entry>
  <entry>
    <title>SSL/TLS</title>
    <url>/2020/03/06/SSL_TLS/</url>
    <content><![CDATA[<p>å› ä¸ºè¦ç»™æœåŠ¡å™¨çš„ä¸€äº›åŸŸåæ·»åŠ httpså€Ÿæ­¤æœºä¼šäº†è§£ä¸‹SSL&#x2F;TLS</p>
<span id="more"></span>

<h2 id="åŸå§‹åŠ å¯†"><a href="#åŸå§‹åŠ å¯†" class="headerlink" title="åŸå§‹åŠ å¯†"></a>åŸå§‹åŠ å¯†</h2><p>å‡è®¾Aå‘Bé€šä¿¡æ²¡æœ‰ä»»ä½•çš„åŠ å¯†ï¼Œä¸­é—´ä¸€ä¸ªCæ‹¦æˆªæ‰Açš„æ¶ˆæ¯åï¼Œé‚£ä¹ˆAä¸Bä¹‹é—´çš„é€šä¿¡æ¯«æ— éšç§å¯è¨€ã€‚é‚£ä¹ˆå°±å‡ºç°äº†ç¬¬ä¸€ç§åŠ å¯†æ–¹å¼ã€‚  </p>
<p><code>å¯¹ç§°åŠ å¯†</code>ï¼šåŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥ã€‚<br>æ¥ä¸‹æ¥çš„Aå‘Bé€šä¿¡æ–¹å¼æ˜¯ï¼š</p>
<ul>
<li>1 åå•†ä¸€ä¸ªä¸¤è€…éƒ½æœ‰çš„å¯†é’¥  </li>
<li>2 Aç”¨å¯†é’¥å°†æ¶ˆæ¯åŠ å¯†åä¼ è¾“  </li>
<li>3 Bå¾—åˆ°åŠ å¯†åçš„æ¶ˆæ¯ï¼Œç”¨åŒä¸€ä¸ªå¯†é’¥è§£å¯†å¾—åˆ°åŸå§‹æ¶ˆæ¯</li>
</ul>
<p>ä¼˜ç‚¹ï¼š<br>å°±ç®—Cæ‹¦æˆªæ‰äº†Aå‘ç»™BåŠ å¯†çš„ä¿¡æ¯ï¼Œæ²¡æœ‰å¯†é’¥é‚£ä¹ˆCä¹Ÿæ²¡åŠæ³•è·å–åˆ°åŸå§‹ä¿¡æ¯</p>
<p>ç¼ºç‚¹:  </p>
<ul>
<li>1 åå•†å¯†é’¥åªèƒ½çº¿ä¸‹è·å–ï¼Œå¦åˆ™å¯†é’¥è¢«Cæ‹¿åˆ°åˆ°äº†ä¸€æ ·Cå°±å¯ä»¥å¾—åˆ°Aå’ŒBä¹‹é—´é€šä¿¡çš„æ¶ˆæ¯</li>
<li>2 é€šè¿‡æš´åŠ›ç ´è§£çš„æ–¹å¼å¯ä»¥ç ´è§£56bitçš„DESåŠ å¯†ä¿¡æ¯ï¼Œä¸ºäº†åº”å¯¹è¿™æ ·çš„æƒ…å†µåªå¥½æå‡ºæ–°çš„åè®®å¦‚ triple-DES(æœ€é•¿168bit)ã€AES(æœ€é•¿256bit)ï¼Œåœ¨ç›®å‰çš„è®¡ç®—æœºè®¡ç®—æ¥çœ‹æ— æ³•çŸ­æœŸå†…è¢«æš´åŠ›ç ´è§£</li>
</ul>
<h2 id="å‡çº§åŠ å¯†"><a href="#å‡çº§åŠ å¯†" class="headerlink" title="å‡çº§åŠ å¯†"></a>å‡çº§åŠ å¯†</h2><p>ç”±äºAå¯èƒ½å’Œå¾ˆå¤šäººé€šä¿¡ï¼Œä¸å¯èƒ½æ¯æ¬¡é€šä¿¡å‰å¿…é¡»çº¿ä¸‹äº¤æ¢å¯†é’¥ã€‚æ¥ä¸‹æ¥å‡ºç°äº†å¯ä»¥å°†è‡ªå·±çš„ pulic keyï¼ˆå…¬é’¥ï¼‰åœ¨ç½‘ä¸Šä¼ æ’­çš„åŠ å¯†æ–¹å¼ã€‚ </p>
<p><code>éå¯¹ç§°åŠ å¯†</code>ï¼š æ¯ä¸ªç”¨æˆ·æœ‰ä¸¤ä¸ªå¯†é’¥ä¸€ä¸ªpublic key(å…¬é’¥)å¦ä¸€ä¸ªprivate keyï¼ˆç§é’¥ï¼‰ï¼ŒåŠ å¯†ç”¨å…¶ä¸­çš„ä¸€ä¸ªkeyè§£å¯†å¿…é¡»ç”¨å¦ä¸€ä¸ªkeyã€‚ï¼ˆæ¯”å¦‚ä½¿ç”¨pulick keyåŠ å¯†çš„ä¿¡æ¯å°±åªèƒ½ç”¨private keyæ¥è§£å¯†ï¼ŒæŠ‘æˆ–åŠ å¯†ç”¨private keyè§£å¯†å°±åªèƒ½ç”¨public keyï¼‰åŒæ–¹å„æ‰§æŒæœ‰å¯¹æ–¹çš„public keyï¼Œå„æ‰§ä¿ç•™è‡ªå·±çš„private keyã€‚  </p>
<p>è¿™æ ·Cæ‹¿åˆ°ä¸€æ–¹çš„public keyæ²¡æœ‰private keyä¹Ÿæ˜¯æ²¡åŠæ³•ç ´è§£æ¶ˆæ¯ã€‚</p>
<p>æ¥ä¸‹æ¥çš„Aå‘Bé€šä¿¡æ–¹å¼æ˜¯ï¼š</p>
<ul>
<li>1 Aå’ŒBåœ¨ç½‘ä¸Šäº¤æ¢å„è‡ªçš„public keyï¼Œå„è‡ªä¿ç•™è‡ªå·±çš„private key</li>
<li>2 Aå°†è¦å‘é€çš„æ•°æ®è¿›è¡Œhashè®¡ç®—å‡ºä¸€æ®µhashå€¼ï¼Œç”¨è‡ªå·±private keyå¯¹è¿™æ®µhashå€¼è¿›è¡ŒåŠ å¯†ã€‚Aå°†è¦å‘é€çš„æ•°æ®ä½¿ç”¨Bçš„public keyè¿›è¡ŒåŠ å¯†ã€‚æœ€åå°†åŠ å¯†åçš„hashä»¥åŠåŠ å¯†åçš„æ•°æ®åŠ ä¸Šä¸€äº›å…¶ä»–ä¸œè¥¿å‘é€ç»™B</li>
<li>3 Bæ”¶åˆ°åŠ å¯†åçš„hashä»¥åŠåŠ å¯†çš„æ•°æ®ã€‚Bç”¨Açš„public keyå°†åŠ å¯†åhashè§£å¯†å¾—åˆ°åŸå§‹hashã€‚Bç”¨è‡ªå·±çš„private keyè§£å¯†åŠ å¯†åçš„æ•°æ®å¾—åˆ°åŸå§‹æ•°æ®ï¼Œåœ¨å°†åŸå§‹æ•°æ®è¿›è¡Œhashè®¡ç®—å¾—åˆ°hashå€¼ï¼Œä¸å‰é¢è§£å¯†å¾—åˆ°çš„hashå¯¹æ¯”ã€‚å¦‚æœä¸€è‡´é‚£ä¹ˆæ•°æ®å¯ä»¥ä½¿ç”¨ã€‚</li>
</ul>
<p>ä¼˜ç‚¹ï¼š  </p>
<ul>
<li>1 å°±ç®—çŸ¥é“public keyä¹Ÿæ²¡åŠæ³•è§£å¯†æ¶ˆæ¯</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>1 éå¯¹ç§°åŠ å¯†ç”±äºæ•°å­¦åŸå› ç›¸å¯¹äºå¯¹ç§°åŠ å¯†è¦æ¶ˆè€—æ›´å¤šï¼ˆæŒ‡æ•°çº§åˆ«ï¼‰çš„CPUèµ„æº</li>
<li>2 éå¯¹ç§°åŠ å¯†æƒ…å†µä¸‹ï¼Œå¦‚æœCåˆ†åˆ«è·å–äº†Aå’ŒBçš„public keyå¹¶ä¸”ç”¨è‡ªå·±çš„public keyåˆ†åˆ«å‘ç»™Aå’ŒB,å°±å¯èƒ½å‡ºç°ä»¥ä¸‹æƒ…å†µã€‚ <ul>
<li>2.1 Aå°†ç”¨è‡ªå·±çš„private keyåŠ å¯†æ•°æ®çš„hashå€¼ï¼Œç”¨Cçš„public keyåŠ å¯†æ•°æ®</li>
<li>2.2 Cæ‹¦æˆªåˆ°åŠ å¯†åçš„hashå€¼ï¼Œä»¥åŠåŠ å¯†åçš„æ•°æ®ã€‚Cç”¨è‡ªå·±çš„private keyè§£å¯†åŠ å¯†åçš„æ•°æ®ï¼ˆè¿™æ ·å°±å¾—åˆ°åŸå§‹æ•°æ®ï¼‰ï¼Œå¹¶ä¸”Cå°†ç¯¡æ”¹åçš„åŸå§‹æ•°æ®è®¡ç®—hashå€¼ï¼Œå¹¶ä¸”ç”¨Cè‡ªå·±çš„private keyè®¡ç®—å‡ºåŠ å¯†åhashå€¼ï¼Œå†ç”¨å…ˆå‰æ‹¦æˆªåˆ°Bçš„public keyåŠ å¯†ç¯¡æ”¹åçš„æ•°å¾—åˆ°åŠ å¯†åçš„æ•°æ®ã€‚å°†ç¯¡æ”¹åçš„åŠ å¯†hashå€¼ã€åŠ å¯†æ•°æ®å‘é€ç»™B</li>
<li>2.3 Bæ”¶åˆ°ä»¥åä¸¤ä¸ªæ•°æ®åï¼Œå…ˆç”¨è‡ªå·±çš„private keyè§£å¯†æ•°æ®ä¹‹åè®¡ç®—hashå€¼ï¼Œå†ç”¨Cä¼ æ¥çš„å‡public keyè§£å¯†hashå€¼ï¼Œå‘ç°åŒ¹é…ã€‚</li>
</ul>
</li>
</ul>
<h2 id="ç°ä»£åŠ å¯†"><a href="#ç°ä»£åŠ å¯†" class="headerlink" title="ç°ä»£åŠ å¯†"></a>ç°ä»£åŠ å¯†</h2><p>  ä¸Šé¢éå¯¹ç§°åŠ å¯†çš„ç¬¬äºŒä¸ªç¼ºé™·çš„å…³é”®é—®é¢˜ï¼špublic keyæ— æ³•ä¿è¯æ˜¯å¯¹æ–¹çš„ã€‚  </p>
<p>  CAï¼ˆCertificate Authorityï¼‰è¯ä¹¦è®¤è¯å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼ŒCAçš„å·¥ä½œæ–¹å¼å¦‚ä¸‹<br>  1ï¼š Bå…ˆå°†è‡ªå·±çš„public keyå’Œå…¶ä»–ä¸€äº›ä¿¡æ¯äº¤ç»™CA<br>  2ï¼š CAç”¨è‡ªå·±çš„private keyåŠ å¯†è¿™äº›ä¿¡æ¯ç”Ÿäº§Bçš„æ•°å­—è¯ä¹¦ï¼Œè¿”å›ç»™B<br>  3ï¼š å½“Bå‘Aä¼ é€’è‡ªå·±çš„pulic keyæ—¶ï¼ŒBä¼ é€’æ•°å­—è¯ä¹¦ç»™A<br>  4ï¼š Aæ‹¿åˆ°æ•°å­—è¯ä¹¦é€šè¿‡CAè¯ä¹¦ï¼ˆåŒ…å«CAçš„public keyï¼‰è§£å¯†Bçš„æ•°å­—è¯ä¹¦è·å–åˆ°Bçš„public key  </p>
<p>  è¿™é‡Œæœ‰ä¸€ä¸ªå…³é”®çš„åœ°æ–¹æ€ä¹ˆä¿è¯CAä¸è¢«åŠ«æŒï¼ŒåŸå› æ˜¯CAå°†è‡ªå·±çš„è¯ä¹¦é›†æˆåˆ°æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿä¸­ï¼Œåªæœ‰åœ¨æµè§ˆå™¨æˆ–è€…æ“ä½œç³»ç»Ÿè¢«åŠ«æŒçš„æƒ…å†µCAæ‰æœ‰å¯èƒ½è¢«åŠ«æŒã€‚è¿™æ ·åªè¦æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨ä¸è¢«åŠ«æŒå°±èƒ½ä¿è¯äº¤æ¢public key</p>
<p>éå¯¹ç§°åŠ å¯†å¤„ç†ç¼“æ…¢çš„é—®é¢˜åœ¨å®é™…SSL&#x2F;TLSä½¿ç”¨åœºæ™¯ä¸­æ˜¯å¤§ä½“ä¸Šæ˜¯å¦‚ä¸‹è§£å†³çš„ï¼ˆç»†èŠ‚æœ‰å·®åˆ«ï¼‰ï¼š</p>
<ul>
<li>1 å…ˆé€šè¿‡CAä¿è¯äº¤æ¢public key</li>
<li>2 å†é€šè¿‡éå¯¹ç§°ç®—æ³•äº¤æ¢å¯¹ç§°åŠ å¯†å¯†é’¥ï¼ˆä¸€éƒ¨åˆ†ï¼‰</li>
<li>3 æœ€åé€šè¿‡å¯¹ç§°åŠ å¯†ï¼ŒåŠ å¯†é€šä¿¡</li>
</ul>
<h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><p> æœ€å¸¸è§çš„SSL&#x2F;TLSä½¿ç”¨åœºæ™¯ä¸ºHTTPSï¼ˆHTTP over SSLï¼‰, CAä½œä¸ºå…¬è¯æœºæ„ä¸€èˆ¬æ˜¯è¦æ”¶è´¹çš„ï¼Œç”¨æˆ·ï¼ˆæ™®é€šäººï¼‰æ˜¯ä¸ä¼šå»ç”³è¯·çš„ï¼Œè€ŒæœåŠ¡ç«¯ä¸€èˆ¬ä¼šå»ç”³è¯·ï¼Œæ‰€æœ‰å®é™…çš„HTTPSå¦‚ä¸‹ï¼š</p>
<ul>
<li>1 ç”¨æˆ·å‘æœåŠ¡ç«¯å‘èµ·ä¸€ä¸ªå®‰å…¨è¿æ¥è¯·æ±‚  </li>
<li>2 æœåŠ¡ç«¯è¿”å›ä¸€ä¸ªç»è¿‡CAè®¤è¯çš„æ•°å­—è¯ä¹¦ï¼Œå®¢æˆ·é€šè¿‡æµè§ˆå™¨å†…ç½®çš„CAè§£å¯†è¯ä¹¦å¾—åˆ°æœåŠ¡ç«¯public key  </li>
<li>3 ç”¨æˆ·ä½¿ç”¨public keyåŠ å¯†ä¸€ä¸ªå¯¹ç§°åŠ å¯†ç®—æ³•çš„å¯†é’¥ï¼Œå¹¶ä¸”å‘é€ç»™æœåŠ¡ç«¯</li>
<li>4 æœåŠ¡ç«¯ä½¿ç”¨è‡ªå·±çš„private keyè§£å¯†å¾—åˆ°åŸå§‹çš„å¯¹ç§°ç®—æ³•å¯†é’¥</li>
<li>5 åŒæ–¹é€šä¿¡ä½¿ç”¨å¯¹ç§°ç®—æ³•å¯†é’¥åŠ å¯†å’Œè§£å¯†</li>
</ul>
]]></content>
      <tags>
        <tag>https SSL/TLS</tag>
      </tags>
  </entry>
  <entry>
    <title>RFC 7234</title>
    <url>/2017/10/23/RFC/</url>
    <content><![CDATA[<h2 id="1-å¯¼è¨€"><a href="#1-å¯¼è¨€" class="headerlink" title="1 å¯¼è¨€"></a>1 å¯¼è¨€</h2><p>  HTTPé€šå¸¸ç”¨äºåˆ†é…ä¿¡æ¯çš„ç³»ç»Ÿï¼Œåœ¨è¿™é‡Œæ€§èƒ½å¯ä»¥é€šè¿‡åˆ©ç”¨å“åº”å­˜å‚¨å¾—åˆ°æå‡ï¼Œè¿™ä»½æ–‡æ¡£å®šä¹‰ HTTP&#x2F;1.1å…³äºç¼“å­˜å’Œå†åˆ©ç”¨å“åº”æ¶ˆæ¯çš„éƒ¨åˆ†.  </p>
<p>  ä¸€ä¸ªHTTPç¼“å­˜é™¤äº†åŒ…æ‹¬å“åº”æ¶ˆæ¯çš„æœ¬åœ°å­˜å‚¨æ§åˆ¶è¿˜åŒ…æ‹¬æ£€ç´¢ï¼Œåˆ é™¤ï¼Œæ§åˆ¶å­˜å‚¨æ¶ˆæ¯æœ¬èº«.ä¸€ä¸ªç¼“å­˜äº†å¯ç¼“å­˜çš„å“åº”å’Œç­‰æ•ˆçš„æ™®é€šå“åº”ç›¸æ¯”ä½¿ç”¨æ›´å°‘çš„å“åº”æ—¶é—´å’Œå¸¦å®½æ¶ˆè€—.ä»»ä½•çš„ç”¨æˆ·(client)å’ŒæœåŠ¡(server)éƒ½å¯ä»¥ä½¿ç”¨ç¼“å­˜ï¼Œä½†æ˜¯è¢«å½“åšéš§é“(tunnel)çš„æœåŠ¡ä¸èƒ½ä½¿ç”¨.  </p>
<p>  å…±äº«ç¼“å­˜(shared cache)çš„å“åº”å­˜å‚¨å¯ä»¥è¢«å¤šç”¨æˆ·å†æ¬¡åˆ©ç”¨ï¼Œé€šå¸¸å…±äº«ç¼“å­˜è¢«éƒ¨ç½²ä¸ºä¸­ä»‹çš„ä¸€éƒ¨åˆ†.ç›¸åçš„ç§æœ‰ç¼“å­˜(private cache)åªèƒ½è¢«ä¸€ä¸ªç”¨æˆ·æ£€æŸ¥åˆ°ï¼Œé€šå¸¸ç§æœ‰ç¼“å­˜è¢«éƒ¨ç½²ä¸ºç”¨æˆ·ä»£ç†çš„ä¸€éƒ¨åˆ†.  </p>
<p>  åœ¨HTTP&#x2F;1.1ä¸­ç¼“å­˜é€šè¿‡å†åˆ©ç”¨å…ˆå‰çš„å“åº”æ»¡è¶³ç°æœ‰è¯·æ±‚è€Œè¾¾åˆ°æ˜æ˜¾æé«˜æ•ˆç‡çš„ç›®æ ‡.ä¸€ä¸ªå·²å­˜å‚¨çš„ç¼“å­˜è¢«è®¤ä¸ºâ€æ–°é²œâ€(fresh)å¿…é¡»å…ˆæ»¡è¶³4.2å®šä¹‰éƒ¨åˆ†ï¼Œé‚£ä¹ˆè¿™ä¸ªå“åº”å¯ä»¥å†åˆ©ç”¨å¹¶ä¸”ä¸ç”¨â€æ£€éªŒâ€(validationï¼šå‘æºæœåŠ¡å™¨æ£€æŸ¥çœ‹ç¼“å­˜å“åº”æ˜¯å¦å¯¹äºè¿™ä¸ªè¯·æ±‚ä»ç„¶æœ‰æ•ˆ).ä¸€ä¸ªæ–°é²œçš„å“åº”å¯ä»¥æ¯æ¬¡é‡åˆ©ç”¨å› æ­¤å¯ä»¥æœ‰æ•ˆçš„å‡å°‘å»¶è¿Ÿçš„ç½‘ç»œç®¡ç†.å½“ç¼“å­˜å“åº”ä¸å†æ–°é²œæ˜¯ï¼Œå®ƒä¹Ÿè®¸è¿˜å¯ä»¥åˆ©ç”¨æ¯”å¦‚é€šè¿‡æ£€éªŒå†æ›´æ–°æ–°é²œåº¦(4.3)æˆ–è€…æœåŠ¡æºunavailable(4.2.4).<br>  <span id="more"></span></p>
<h3 id="1-1-ä¸€è‡´æ€§å’Œé”™è¯¯å¤„ç†"><a href="#1-1-ä¸€è‡´æ€§å’Œé”™è¯¯å¤„ç†" class="headerlink" title="1.1 ä¸€è‡´æ€§å’Œé”™è¯¯å¤„ç†"></a>1.1 ä¸€è‡´æ€§å’Œé”™è¯¯å¤„ç†</h3><p>  å…³é”®å­—å¦‚â€å¿…é¡»â€ï¼Œâ€å¿…é¡»ä¸â€ï¼Œâ€å¿…è¦çš„â€ï¼Œâ€å°†ä¼šâ€ï¼Œâ€å°†ä¸ä¼šâ€,â€åº”è¯¥â€ï¼Œâ€åº”è¯¥ä¸â€ï¼Œâ€å»ºè®®â€ï¼Œâ€ä¹Ÿè®¸â€ï¼Œâ€é€‰æ‹©æ€§çš„â€è¿™äº›åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„éƒ½å°†åœ¨[RFC2119]å¾—åˆ°è§£é‡Š.    </p>
<p>  ä¸€è‡´æ€§å‡†åˆ™å’Œå¸¸è§„é”™è¯¯å¤„ç†éƒ½åœ¨[RFC7230]ä¸­å¾—åˆ°å®šä¹‰.</p>
<h2 id="2-ç¼“å­˜ç³»ç»Ÿæ¦‚è§ˆ"><a href="#2-ç¼“å­˜ç³»ç»Ÿæ¦‚è§ˆ" class="headerlink" title="2 ç¼“å­˜ç³»ç»Ÿæ¦‚è§ˆ"></a>2 ç¼“å­˜ç³»ç»Ÿæ¦‚è§ˆ</h2><p>  æ­£ç¡®çš„ç¼“å­˜ç³»ç»Ÿåº”è¯¥ä¿æŒHTTPä¼ è¾“ä¸­çš„è¯­æ³•ï¼ŒåŒæ—¶åº”è¯¥æ¶ˆé™¤å·²ç»å­˜åœ¨äºç¼“å­˜ä¸­çš„ä¼ è¾“ä¿¡æ¯.è™½ç„¶ç¼“å­˜è¡Œä¸ºåœ¨HTTPä¸­å®Œå…¨æ˜¯ä¸€ä¸ªå¯é€‰é¡¹.ä½†æ˜¯ä½ å¯ä»¥å°†å†åˆ©ç”¨ç¼“å­˜å“åº”å½“åšå¯å–çš„å¹¶ä¸”è¿™ç§å†åˆ©ç”¨æ˜¯ä¸éœ€è¦è¦æ±‚æˆ–è€…æœ¬åœ°é…ç½®æ¥å¼ºåˆ¶çš„é»˜è®¤è¡Œä¸º.å› æ­¤HTTPçš„ç¼“å­˜é…ç½®æ˜¯ç”¨æ¥å¼ºåˆ¶æ€§è§„å®šç¼“å­˜è¡Œä¸ºæ¥æ»¡è¶³ä¸€äº›æˆ‘ä»¬æƒ³è¦çš„ç‰¹æ€§ï¼Œè€Œä¸æ˜¯åƒæ‰˜ç®¡ä¸€æ ·æ€»æ˜¯ç¼“å­˜å†åˆ©ç”¨ä¸€äº›ç‰¹å®šçš„å“åº”.    </p>
<p>  æ¯ä¸ªç¼“å­˜è®°å½•åŒ…å«ä¸€ä¸ªç¼“å­˜é”®å’Œä¸€ä¸ªæˆ–è€…å¤šä¸ªhttpå“åº”ï¼Œè¿™äº›å“åº”å¯¹åº”ç€å…ˆå‰ä½¿ç”¨åŒä¸€ä¸ªé”®å€¼çš„è¯·æ±‚.ä¸€ä¸ªæœ€å¸¸è§å½¢å¼çš„ç¼“å­˜è®°å½•ä¸ºæˆåŠŸçš„æ£€ç´¢è¯·æ±‚ï¼š ie,200(OK).ç„¶è€Œï¼Œå®ƒä¹Ÿå¯èƒ½ç¼“å­˜ä¸€ä¸ªæ°¸ä¹…æ€§é‡å®šå‘301ï¼Œå¦è®¤ç»“æœ404ï¼Œä¸å®Œå…¨ç»“æœ206ï¼Œæˆ–è€…ç¼“å­˜ä¸€ä¸ªé™¤äº†GETä»¥å¤–çš„æ–¹æ³•.  </p>
<p>  åŸºæœ¬çš„ç¼“å­˜é”®å€¼åŒ…å«è¯·æ±‚æ–¹æ³•å’Œç›®æ ‡URIï¼Œå› ä¸ºHTTPç¼“å­˜é€šå¸¸åªç¼“å­˜GETæ–¹æ³•è¿”å›çš„è¯·æ±‚ï¼Œè®¸å¤šç¼“å­˜ç®€å•çš„å»æ‰å…¶ä»–æ–¹æ³•å¹¶åªç”¨URIå½“åšåŸºæœ¬çš„ç¼“å­˜é”®å€¼.  </p>
<p>  å¦‚æœä¸€ä¸ªè¯·æ±‚çš„ç›®æ ‡ä¸ºå†…å®¹åå•†ï¼Œå®ƒçš„ç¼“å­˜ä½“ä¹Ÿè®¸ä¼šåŒ…å«å¤šç§å“åº”ï¼Œæ¯ç§ä¸åŒå“åº”é€šè¿‡ç¬¬äºŒé”®å€¼åšåŒºåˆ†(4.1)</p>
<h2 id="3-åœ¨ç¼“å­˜ä¸­å­˜å‚¨å“åº”çš„è¿‡ç¨‹"><a href="#3-åœ¨ç¼“å­˜ä¸­å­˜å‚¨å“åº”çš„è¿‡ç¨‹" class="headerlink" title="3 åœ¨ç¼“å­˜ä¸­å­˜å‚¨å“åº”çš„è¿‡ç¨‹"></a>3 åœ¨ç¼“å­˜ä¸­å­˜å‚¨å“åº”çš„è¿‡ç¨‹</h2><p>  ç¼“å­˜å‰ææ¡ä»¶ï¼š</p>
<ul>
<li>è¯·æ±‚æ–¹æ³•å¿…é¡»èƒ½è¢«ç¼“å­˜æ‰€ç†è§£å¹¶ä¸”è¢«å®šä¹‰ä¸ºå¯ç¼“å­˜ç±»å‹</li>
<li>å“åº”çŠ¶æ€ç å¿…é¡»èƒ½è¢«ç¼“å­˜ç†è§£</li>
<li>ç¼“å­˜æŒ‡ä»¤â€no-storeâ€(5.2)ä¸èƒ½å‡ºç°åœ¨è¯·æ±‚æˆ–è€…å“åº”å¤´ä¸­</li>
<li>å…±äº«ç¼“å­˜åœ¨å“åº”ä¸­ç¼“å­˜æŒ‡ä»¤ä¸èƒ½å‡ºç°â€privateâ€(5.2.2.6)å¦åˆ™å…±äº«ç¼“å­˜ä¸ç”Ÿæ•ˆ</li>
<li>å…±äº«ç¼“å­˜ä¸­æƒé™è®¤è¯å¤´ä¿¡æ¯(4.2 of[RFC7235])ä¸èƒ½å‡ºç°å“åº”å¤´ï¼Œé™¤éå“åº”ä¸­æœ‰æ˜ç¡®å…è®¸å…¶å¯ä»¥ç¼“å­˜(3.2)</li>
<li>å…¶ä¸­ä¹‹ä¸€çš„å“åº”ï¼š<ul>
<li>åŒ…å«ä¸€ä¸ªExpireså¤´ä¿¡æ¯(5.3)</li>
<li>åŒ…å«ä¸€ä¸ªmax-age çš„ç¼“å­˜æŒ‡ä»¤(5.2.2.8)</li>
<li>åœ¨å…±äº«ç¼“å­˜ç¼“å­˜ä¸­ï¼ŒåŒ…å«ä¸€ä¸ª s-maxageç¼“å­˜æŒ‡ä»¤(5.2.2.9)</li>
<li>åŒ…å«ä¸€ä¸ªCache Control æ‰©å±•(5.2.3)å…è®¸å…¶å¯ä»¥è¢«ç¼“å­˜</li>
<li>åŒ…å«ä¸€ä¸ªè¢«å®šä¹‰ä¸ºå¯ç¼“å­˜çš„çŠ¶æ€ç (4.2.2)</li>
<li>åŒ…å«ä¸€ä¸ªpublicçš„ç¼“å­˜æŒ‡ä»¤(5.2.2.5)<br>  æ³¨æ„ä»¥ä¸Šçš„æ»¡è¶³æ¡ä»¶éƒ½å¯ä»¥è¢«cache-controlæ‰©å±•æ‰€é‡å†™(5.2.3)</li>
</ul>
</li>
</ul>
<p>  åœ¨è¿™æ®µå†…å®¹ä¸­ï¼Œå¦‚æœè¡¨ç°å‡ºä¸ç¼“å­˜ç›¸å…³çš„è¡Œä¸ºæ—¶ï¼Œè¿™æ—¶ç¼“å­˜å·²ç»â€ç†è§£â€ä¸€ä¸ªè¯·æ±‚æ–¹æ³•æˆ–å“åº”çŠ¶æ€ç .  </p>
<p>  æ³¨æ„ï¼Œé€šå¸¸ç³»ç»Ÿä¸­ï¼Œä¸€äº›ç¼“å­˜å°†ä¸ä¼šå­˜å‚¨ä¸€ä¸ªæ—¢æ²¡æœ‰æ˜ç¡®çš„è¿‡æœŸæ—¶é—´ä¹Ÿæ²¡æœ‰ç¼“å­˜éªŒè¯å™¨çš„å“åº”.ä½†æ˜¯ç¼“å­˜ä¹Ÿæ²¡ç¦æ­¢ç¼“å­˜è¿™æ ·çš„å“åº”.  </p>
<h3 id="3-1-å­˜å‚¨ä¸å®Œå…¨å“åº”"><a href="#3-1-å­˜å‚¨ä¸å®Œå…¨å“åº”" class="headerlink" title="3.1 å­˜å‚¨ä¸å®Œå…¨å“åº”"></a>3.1 å­˜å‚¨ä¸å®Œå…¨å“åº”</h3><h3 id="3-2-å­˜å‚¨æƒé™è®¤è¯è¯·æ±‚çš„å“åº”"><a href="#3-2-å­˜å‚¨æƒé™è®¤è¯è¯·æ±‚çš„å“åº”" class="headerlink" title="3.2 å­˜å‚¨æƒé™è®¤è¯è¯·æ±‚çš„å“åº”"></a>3.2 å­˜å‚¨æƒé™è®¤è¯è¯·æ±‚çš„å“åº”</h3><pre><code>é™¤éç¼“å­˜æŒ‡ä»¤æŒ‡å®šï¼Œå¦åˆ™å…±äº«ç¼“å­˜ä¸èƒ½ç”¨äºç¼“å­˜æ‹¥æœ‰æƒé™è®¤è¯è¯·æ±‚è¿”å›çš„å“åº”.(4.2 of [RFC7235]).
åœ¨è¿™ä»½è§„æ ¼ä¸­ï¼Œä¸‹é¢çš„Cache-Controlçš„å“åº”æŒ‡ä»¤ä¸­æœ‰è¿™äº›æŒ‡ä»¤ï¼š must-revalidateï¼Œ publicï¼Œ s-maxage.  

æ³¨æ„åœ¨ç¼“å­˜å“åº”ä¸­åŒ…å«&quot;must-revalidate&quot; å’Œ/æˆ–&quot;s-maxage&quot;çš„å“åº”æŒ‡ä»¤åˆ™ä¸å…è®¸è¿‡æœŸå­˜å‚¨è¢«å…±äº«å­˜å‚¨(4.2.4). ç‰¹åˆ«æ˜¯åœ¨å“åº”ä¸­è¦ä¹ˆåŒ…å«&quot;max-age=0, must-revalidate&quot;æˆ–è€…&quot;s-maxage=0&quot;åˆ™è¡¨æ˜åç»­è¯·æ±‚éƒ½å¿…é¡»é€šè¿‡æºæœåŠ¡å™¨å¦è®¤éªŒè¯æ‰èƒ½ä½¿ç”¨.
</code></pre>
<h3 id="3-3-æ··åˆéƒ¨åˆ†å†…å®¹"><a href="#3-3-æ··åˆéƒ¨åˆ†å†…å®¹" class="headerlink" title="3.3 æ··åˆéƒ¨åˆ†å†…å®¹"></a>3.3 æ··åˆéƒ¨åˆ†å†…å®¹</h3><h2 id="4-ä»ç¼“å­˜åˆ°å“åº”çš„æ„æˆ"><a href="#4-ä»ç¼“å­˜åˆ°å“åº”çš„æ„æˆ" class="headerlink" title="4 ä»ç¼“å­˜åˆ°å“åº”çš„æ„æˆ"></a>4 ä»ç¼“å­˜åˆ°å“åº”çš„æ„æˆ</h2><p>   å½“å‘èµ·è¯·æ±‚æ—¶ï¼Œåˆ©ç”¨ç¼“å­˜å¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ul>
<li>è¯·æ±‚ä¸ºæœ‰æ•ˆè¯·æ±‚URIï¼Œå¹¶ä¸”åœ¨ç¼“å­˜ä¸­èƒ½åŒ¹é…åˆ°</li>
<li>è¯·æ±‚æ–¹æ³•å’Œæ‰€åŒ¹é…çš„ç¼“å­˜å…è®¸å…¶ç”¨æ¥å±•ç°è¯·æ±‚</li>
<li>æ‰€é€‰æ‹©çš„è¯·æ±‚å¤´è¢«åŒ¹é…çš„ç¼“å­˜æ‰€å‘½ä¸­(nomiatedï¼š4.1)</li>
<li>è¯·æ±‚å¤´ä¸­ä¸èƒ½åŒ…å«pragma &#x3D; no-cacheçš„è¯·æ±‚å¤´(5.4),æˆ–è€…è¯·æ±‚å¤´ä¸­æœ‰ç¼“å­˜æŒ‡ä»¤åŒ…å«no-cache,é™¤éå­˜å‚¨çš„ç¼“å­˜å·²ç»æˆåŠŸçš„éªŒè¯.</li>
<li>å­˜å‚¨çš„å“åº”æ²¡æœ‰åŒ…å«no-cacheç¼“å­˜æŒ‡ä»¤ï¼Œé™¤éå·²ç»éªŒè¯æˆåŠŸ</li>
<li>å­˜å‚¨çš„å“åº”æ—¶ä¸€ä¸‹ä¹‹ä¸€ï¼š <ul>
<li>æ–°é²œ(fresh:4.2)</li>
<li>å…è®¸å…¶è¿‡æœŸå“åº”(4.2.4)</li>
<li>éªŒè¯æˆåŠŸ(4.3)</li>
</ul>
</li>
</ul>
<pre><code>æ³¨æ„ä¸Šé¢çš„æ¡ä»¶éƒ½æœ‰å¯èƒ½è¢«cache-contralæ‰©å±•æ‰€é‡å†™(4.2.3)
å½“ä¸€ä¸ªå­˜å‚¨å¥½çš„å“åº”è¢«ç”¨æ¥æ»¡è¶³ä¸€ä¸ªæ²¡æœ‰éªŒè¯çš„è¯·æ±‚æ—¶ï¼Œè¿™ä¸ªç¼“å­˜å¿…é¡»äº§ç”Ÿä¸€ä¸ªAgeå¤´(5.1),å¹¶ä¸”æ›¿æ¢åœ¨å“åº”ä¸­ä»»ä½•ç­‰ä»·äºcurrent_ageçš„å€¼(4.2.3)
</code></pre>
<h3 id="4-1-ä½¿ç”¨Varyå½“åšç¬¬äºŒå­˜å‚¨é”®å€¼"><a href="#4-1-ä½¿ç”¨Varyå½“åšç¬¬äºŒå­˜å‚¨é”®å€¼" class="headerlink" title="4.1 ä½¿ç”¨Varyå½“åšç¬¬äºŒå­˜å‚¨é”®å€¼"></a>4.1 ä½¿ç”¨Varyå½“åšç¬¬äºŒå­˜å‚¨é”®å€¼</h3><h3 id="4-2-æ–°é²œåº¦"><a href="#4-2-æ–°é²œåº¦" class="headerlink" title="4.2 æ–°é²œåº¦"></a>4.2 æ–°é²œåº¦</h3><p>   ä¸€ä¸ªæ–°é²œå“åº”ä»£è¡¨ç€å®ƒçš„ç”Ÿå‘½å‘¨æœŸè¿˜æ²¡è¿‡æœŸï¼Œç›¸åçš„æ˜¯è¿‡æœŸå“åº”.    </p>
<p>   ä¸€ä¸ªå“åº”çš„æ–°é²œåº¦ç”Ÿå‘½å‘¨æœŸæ˜¯ä»å…¶æºæœåŠ¡å™¨äº§ç”Ÿåˆ°è¿‡æœŸçš„æ—¶é—´ï¼Œæ˜ç¡®è¿‡æœŸæ—¶é—´ï¼šå½“å­˜å‚¨çš„å“åº”è¿‡äº†æœŸæ˜ç¡®çš„è¿‡æœŸæ—¶é—´è¿™å°±æ„å‘³ç€å“åº”å¿…é¡»é€šè¿‡æºæœåŠ¡å™¨éªŒè¯åæ‰èƒ½ä½¿ç”¨ã€‚å½“ä¸€ä¸ªç¼“å­˜æ²¡æœ‰æ˜ç¡®çš„è¿‡æœŸæ—¶é—´æ—¶å¯å‘å¼è¿‡æœŸæ—¶é—´å°±ä¼šè¢«ç¼“å­˜èµ‹äºˆ.  </p>
<p>   ä¸€ä¸ªå“åº”çš„å¹´é¾„(age)è¡¨ç¤ºå…¶ä»æºæœåŠ¡å™¨æ‰€äº§ç”Ÿåˆ°å½“å‰çš„æ—¶é—´å·®ï¼Œæˆ–è€…ä»æºæœåŠ¡å™¨éªŒè¯æˆåŠŸåˆ°ç›®å‰çš„æ—¶é—´å·®.  </p>
<p>   å½“ä¸€ä¸ªå“åº”åœ¨ç¼“å­˜ä¸­æ–°é²œæ—¶ï¼Œå®ƒå¯ä»¥æ»¡è¶³å…¶åçš„ç›¸åŒè¯·æ±‚å¹¶ä¸éœ€è¦è®¿é—®æºæœåŠ¡å™¨ï¼Œå› æ­¤ç›¸å½“é«˜æ•ˆ.  </p>
<p>   å†³å®šæ–°é²œåº¦çš„æœ€ä¸»è¦æœºåˆ¶é€šå¸¸ä¸ºæºæœåŠ¡å™¨æä¾›ä¸€ä¸ªæ˜ç¡®åœ¨æœªæ¥è¿‡æœŸçš„æ—¶é—´(5.3)ï¼Œæˆ–è€…å“åº”æä¾›ä¸€ä¸ªmax-ageæŒ‡ä»¤(5.2.2.8).</p>
<p>   å› ä¸ºæºæœåŠ¡å™¨ä¸æ€»æ˜¯æä¾›ä¸€ä¸ªæ˜ç¡®çš„è¿‡æœŸæ—¶é—´ï¼Œç¼“å­˜ä¹Ÿå¯ä»¥å…è®¸å…¶ä½¿ç”¨å¯å‘å¼è¿‡æœŸæ—¶é—´(4.2.4)  </p>
<p>   å…·ä½“çš„è®¡ç®—è§„åˆ™ï¼š<br>   <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">response_is_fresh = (freshness_lifetime &gt; current_age)</span><br></pre></td></tr></table></figure><br>   freshness_lifetimeå®šä¹‰åœ¨4.2.1;current_ageå®šä¹‰åœ¨4.2.3  </p>
<p>   å®¢æˆ·ç«¯å¯ä»¥åœ¨è¯·æ±‚ä¸­ä½¿ç”¨max-ageæˆ–è€…min-freshçš„å“åº”æŒ‡ä»¤æ¥æ”¾æ¾æˆ–åŠ å›ºä¿¡æ‰€å¯¹åº”å“åº”æ–°é²œåº¦çš„è®¡ç®—<br>(5.2.1)   </p>
<p>  æ³¨æ„æ–°é²œåº¦åªèƒ½åº”ç”¨ä¸ç¼“å­˜ç³»ç»Ÿ;å®ƒä¸èƒ½ç”¨æˆ·å¼ºè¿«å®¢æˆ·ç«¯åˆ·æ–°å…¶å±•ç¤ºæˆ–è€…é‡æ–°åŠ è½½èµ„æºï¼Œç¬¬6éƒ¨åˆ†å°†ä¼šè§£é‡Šç¼“å­˜å’Œå†å²æœºåˆ¶çš„åŒºåˆ«.  </p>
<h4 id="4-2-1-è®¡ç®—æ–°é²œåº¦ç”Ÿå‘½å‘¨æœŸ"><a href="#4-2-1-è®¡ç®—æ–°é²œåº¦ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="4.2.1 è®¡ç®—æ–°é²œåº¦ç”Ÿå‘½å‘¨æœŸ"></a>4.2.1 è®¡ç®—æ–°é²œåº¦ç”Ÿå‘½å‘¨æœŸ</h4><p>  ä¸€ä¸ªç¼“å­˜å¯ä»¥é€šè¿‡å¦‚ä¸‹æœ€å…ˆåŒ¹é…çš„è§„åˆ™æ¥è®¡ç®—å™¨ç”Ÿå‘½å‘¨æœŸ(ç§°:freshness_lifetime):</p>
<ul>
<li>å¦‚æœç¼“å­˜è¢«å…±äº«å¹¶ä¸”å“åº”ä¸­æœ‰s-maxageç¼“å­˜æŒ‡ä»¤</li>
<li>å¦‚æœå“åº”ä¸­æœ‰ç¼“å­˜æŒ‡ä»¤max-age</li>
<li>å¦‚æœå¤´ä¿¡æ¯ä¸­å­˜åœ¨Exoiresï¼Œç”¨å®ƒçš„å€¼å‡å»å“åº”å¤´çš„Dateå€¼</li>
<li>ä½¿ç”¨å¯å‘å¼ç”Ÿå‘½å‘¨æœŸ(4.2.2)  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//ä¸‹é¢æ˜¯ httpæƒå¨æŒ‡å— æœåŠ¡ç«¯æ–°é²œåº¦è®¡ç®—ä¼ªä»£ç æ¯”è¾ƒæ˜“æ‡‚</span><br><span class="line">sub server_freshness_limit</span><br><span class="line">&#123;</span><br><span class="line">  local($heuristic,$server_freshness_limit,$time_since_last_modify);</span><br><span class="line">  $heuristic = 0;</span><br><span class="line">  if ($Max_Age_value_set)</span><br><span class="line">  &#123;</span><br><span class="line">    $server_freshness_limit = $Max_Age_value;</span><br><span class="line">  &#125;</span><br><span class="line">  elseif ($Expires_value_set)</span><br><span class="line">  &#123;</span><br><span class="line">    $server_freshness_limit = $Expires_value - $Date_value;</span><br><span class="line">  &#125;</span><br><span class="line">  elseif ($Last_Modified_value_set)</span><br><span class="line">  &#123;</span><br><span class="line">    $time_since_last_modify = max(0, $Date_value -</span><br><span class="line">  ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ $Last_Modified_value);</span><br><span class="line">    $server_freshness_limit = int($time_since_last_modify *</span><br><span class="line">  ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ $lm_factor);</span><br><span class="line">    $heuristic = 1;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    $server_freshness_limit = $default_cache_min_lifetime;</span><br><span class="line">    $heuristic = 1;</span><br><span class="line">  &#125;</span><br><span class="line">  if ($heuristic)</span><br><span class="line">  &#123;</span><br><span class="line">    if ($server_freshness_limit &gt; $default_cache_max_lifetime)</span><br><span class="line">    &#123; $server_freshness_limit = $default_cache_max_lifetime; &#125;</span><br><span class="line">    if ($server_freshness_limit &lt; $default_cache_min_lifetime)</span><br><span class="line">    &#123; $server_freshness_limit = $default_cache_min_lifetime; &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return($server_freshness_limit);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sub client_modified_freshness_limit</span><br><span class="line">&#123;</span><br><span class="line">  $age_limit = server_freshness_limit( ); ## From Example 7-2</span><br><span class="line">  if ($Max_Stale_value_set)</span><br><span class="line">  &#123;</span><br><span class="line">    if ($Max_Stale_value == $INT_MAX)</span><br><span class="line">    &#123; $age_limit = $INT_MAX; &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123; $age_limit = server_freshness_limit( ) + $Max_Stale_value; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  if ($Min_Fresh_value_set)</span><br><span class="line">  &#123;</span><br><span class="line">    $age_limit = min($age_limit, server_freshness_limit( ) -</span><br><span class="line">  ã€€ã€€ã€€ã€€ã€€ã€€ã€€$Min_Fresh_value_set);</span><br><span class="line">  &#125;</span><br><span class="line">  if ($Max_Age_value_set)</span><br><span class="line">  &#123;</span><br><span class="line">    $age_limit = min($age_limit, $Max_Age_value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>  æ³¨æ„è®¡ç®—è¿‡ç¨‹å¹¶ä¸ä¼šæ—¶é’ŸæŠ–åŠ¨ï¼Œå› ä¸ºæ‰€æœ‰çš„ä¿¡æ¯éƒ½æ¥è‡ªæºæœåŠ¡å™¨.  </p>
<p>  å½“å“åº”å¤´æœ‰å¤šä½™ä¸€ä¸ªå€¼çš„æŒ‡ä»¤ä¿¡æ¯(e.g. ä¸¤ä¸ªè¿‡æœŸå“åº”å¤´ï¼Œå¤šä¸ªCache-Contorl: max-ageæŒ‡ä»¤)ï¼Œè¿™äº›å€¼éƒ½ä¼šè¢«å½“åšæ— æ•ˆå€¼.ç¼“å­˜é¼“åŠ±å…¶å“åº”æ‹¥æœ‰æ— æ•ˆç”Ÿå‘½æ–°é²œåº¦æ¥è®©å®ƒè¿‡æœŸ.  </p>
<h4 id="4-2-2-å¯å‘å¼-Heuristic-æ–°é²œåº¦è®¡ç®—"><a href="#4-2-2-å¯å‘å¼-Heuristic-æ–°é²œåº¦è®¡ç®—" class="headerlink" title="4.2.2 å¯å‘å¼(Heuristic)æ–°é²œåº¦è®¡ç®—"></a>4.2.2 å¯å‘å¼(Heuristic)æ–°é²œåº¦è®¡ç®—</h4><p>   å¦‚æœæºæœåŠ¡å™¨æ²¡æœ‰æä¾›ä¸€ä¸ªæ˜ç¡®çš„è¿‡æœŸæ—¶é—´ï¼Œç¼“å­˜ä¹Ÿè®¸å¯ä»¥ä½¿ç”¨ä¸€å®šç®—æ³•æ¥åˆ©ç”¨å…¶ä»–å¤´ä¿¡æ¯æ¥(å¦‚Last-Modified)æ¥æ¨ç®—ä¸€ä¸ªåˆç†çš„è¿‡æœŸæ—¶é—´ï¼Œè¿™ä»½æ–‡æ¡£å¹¶ä¸ä¼šæä¾›å…·ä½“ç®—æ³•ï¼Œä½†æ˜¯å¯ä»¥ä¸ºä¸€äº›è¾¹ç•Œæƒ…å†µåŠ ä¸€äº›é™åˆ¶ã€‚  </p>
<p>   ç¼“å­˜åªæœ‰åœ¨æ²¡æœ‰ä¸€ä¸ªæ˜ç¡®çš„è¿‡æœŸæ—¶é—´æ—¶æ‰å¯ä»¥ä½¿ç”¨å¯å‘å¼æ–°é²œåº¦æ—¶é—´ï¼Œæ ¹æ®åœ¨ç¬¬3éƒ¨åˆ†çš„ç¼“å­˜çš„å‰ç½®æ¡ä»¶ã€‚åªæœ‰ä¸¤ç§å¯èƒ½ï¼Œä¸€æ˜¯å“åº”çŠ¶æ€ç ä½å¯ç¼“å­˜çš„(6.1 of[RFC7231])ä¸”æ²¡æœ‰æ˜ç¡®è¿‡æœŸæ—¶é—´ï¼ŒäºŒæ˜¯è¢«æ ‡è®°ä¸ºå¯ä»¥ç¼“å­˜(e.g. æœ‰â€publicâ€ç¼“å­˜æŒ‡ä»¤)ä¸”æ²¡æœ‰æ˜ç¡®è¿‡æœŸæ—¶é—´.  </p>
<p>   å¦‚æœå­˜å‚¨å“åº”æœ‰å¤´ä¿¡æ¯Last-Modified(2.2 of [RFC7232]),ç¼“å­˜é¼“åŠ±è¿™ä¸ªå¯å‘å¼è¿‡æœŸæ—¶é—´ä¸ºä»ç°åœ¨åˆ°Last-Modifiedå€¼ä¹‹é—´å·®çš„æŸä¸€æ¯”ä¾‹.é€šå¸¸è¿™ä¸ªæ¯”ä¾‹ä¹Ÿè®¸ä¸º10%.<br>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">freshness_lefetime = (date - Last-Modified)*10% </span><br></pre></td></tr></table></figure></p>
<p>   å½“å¯å‘å¼è¿‡æœŸæ—¶é—´ç”¨äºæ–°é²œåº¦ç”Ÿå‘½å‘¨æœŸï¼Œå…¶ä¸­current_ageçš„å€¼å·²ç»è¶…è¿‡24å°æ—¶æ—¶ç¼“å­˜åº”è¯¥äº§ç”Ÿä¸€ä¸ª113 warn-codeçš„å¤´ä¿¡æ¯(5.5.4).  </p>
<h4 id="4-2-3-è®¡ç®—å¹´é¾„-age"><a href="#4-2-3-è®¡ç®—å¹´é¾„-age" class="headerlink" title="4.2.3 è®¡ç®—å¹´é¾„(age)"></a>4.2.3 è®¡ç®—å¹´é¾„(age)</h4><p>   å¤´ä¿¡æ¯çš„Ageé€šå¸¸ç”¨æ¥è¡¨ç¤ºä»ç¼“å­˜è·å–å“åº”çš„å¹´é¾„æ—¶é—´.ageçš„å€¼é€šå¸¸ç”±å“åº”è¢«äº§ç”Ÿæ—¶æˆ–è¢«é‡æ–°éªŒè¯è¿‡èµ·æ¥ä¼°ç®—.æœ¬è´¨ä¸Šæ¥è¯´Ageçš„å€¼ç”±ä¸¤éƒ¨åˆ†ä¹‹å’Œï¼Œä¸€æ˜¯å“åº”åœ¨ç¼“å­˜ä¸­é©»å­˜æ—¶é—´ï¼ŒäºŒæ˜¯å“åº”åœ¨ç½‘ç»œä¸­è½¬æ¢çš„æ—¶é—´.   </p>
<p>   å¦‚ä¸‹å€¼ç”¨æ¥ageå€¼çš„è®¡ç®—:  </p>
<ul>
<li><p>â€œage_valueâ€è¿™ä¸ªæ¡ç›®æŒ‡çš„æ˜¯å¤´ä¿¡æ¯Ageçš„å€¼(5.1),è¿™ä¸ªå€¼æ˜¯ä»¥ä¸€ç§åˆé€‚çš„ç®—æ³•ç³»ç»Ÿè®¡ç®—è€Œå‡ºï¼Œæˆ–è€…å½“å®ƒä¸å­˜åœ¨çš„æ—¶å€™åˆ™ä¸º0</p>
</li>
<li><p>date_valueè¿™ä¸ªæ¡ç›®çš„å€¼ä¸ºå¤´ä¿¡æ¯Dateçš„å€¼  </p>
</li>
<li><p>nowè¿™ä¸ªæ¡ç›®å€¼æŒ‡çš„æ˜¯æ‰§è¡Œè®¡ç®—æ—¶çš„æ—¶é—´ç‚¹  </p>
</li>
<li><p>request_timeè¿™ä¸ªæ—¶é—´æŒ‡çš„æ˜¯è¯·æ±‚ä»ç¼“å­˜ä¸­è¿”å›çš„æ—¶é—´ç‚¹</p>
</li>
<li><p>response_timeä¸»æœºæ¥å—å“åº”çš„æ—¶é—´ç‚¹</p>
</li>
</ul>
<p>   å“åº”ageå¯ä»¥é€šè¿‡ä¸¤ç§å®Œå…¨ç‹¬ç«‹çš„æ–¹æ³•è®¡ç®—  </p>
<ul>
<li><p>1.â€apprent_ageâ€:å¦‚æœåœ¨æœ¬åœ°æ—¶é’Ÿå’ŒæºæœåŠ¡å™¨æ—¶é’Ÿåˆç†åŒæ­¥æ—¶ ç»“æœ&#x3D;response_time - date_value. å¦‚æœè§£æ„ç­‰äºè´Ÿæ•°ï¼Œç»“æœè¢«é›¶æ›¿æ¢.  </p>
</li>
<li><p>2.â€corrected_age_valueâ€,å¦‚æœæ‰€æœ‰çš„ç¼“å­˜éƒ½éµå¾ªHTTP&#x2F;1.1,ç¼“å­˜å¿…é¡»å°±å¿…é¡»å°†è¿™ä¸ªå€¼ç†ä¸ºä¸è¯·æ±‚åˆå§‹åŒ–æˆåŠŸç›¸å…³ï¼Œè€Œä¸æ˜¯ä¸å“åº”æ¥å—ç›¸å…³  </p>
   <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apparent_age = max(0, response_time - date_value);</span><br><span class="line">response_delay = response_time = request_time;</span><br><span class="line">corrected_age_value = age_value + response_delay</span><br></pre></td></tr></table></figure></li>
</ul>
<p>  è¿™ä¸¤è€…ç›¸ç»“åˆå°±æ˜¯  </p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">corrent_initial_age = max(apparent_age, corrented_age_value);</span><br></pre></td></tr></table></figure>

<p>  current_age çš„å€¼ï¼š<br>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">resident_time = now -response_time;</span><br><span class="line">current_age  = corrented_initial_age + resident_time</span><br></pre></td></tr></table></figure></p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//è¿™ä¸€ç‰ˆæ˜¯httpæƒå¨æŒ‡å—ä¸Šçš„æ„Ÿè§‰æ›´å¥½ç†è§£</span><br><span class="line">$apparent_age = max(0, $time_got_response - $Date_header_value);</span><br><span class="line">$corrected_apparent_age = max($apparent_age, $Age_header_value);</span><br><span class="line">$response_delay_estimate = ($time_got_response - $time_issued_request);</span><br><span class="line">$age_when_document_arrived_at_our_cache =</span><br><span class="line">$corrected_apparent_age + $response_delay_estimate;</span><br><span class="line">$how_long_copy_has_been_in_our_cache = $current_time - $time_got_response;</span><br><span class="line">$age = $age_when_document_arrived_at_our_cache +</span><br><span class="line">$how_long_copy_has_been_in_our_cache;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-4-æä¾›è¿‡æœŸå“åº”"><a href="#4-2-4-æä¾›è¿‡æœŸå“åº”" class="headerlink" title="4.2.4 æä¾›è¿‡æœŸå“åº”"></a>4.2.4 æä¾›è¿‡æœŸå“åº”</h4><p>  ä¸€ä¸ªâ€è¿‡æœŸ(stale)â€å“åº”è¦ä¹ˆæœ‰æ˜ç¡®çš„è¿‡æœŸä¿¡æ¯æˆ–è®¸æ˜¯å·²ç»è¿‡æœŸçš„é€šè¿‡å¯å‘å¼æ–°é²œåº¦è®¡ç®—çš„å€¼.  </p>
<p>  å¦‚æœé€šè¿‡ç¼“å­˜æŒ‡ä»¤è‡´ä½¿æ˜ç¡®è¿‡æœŸçš„å“åº”(e.g, no-store, no-cache,must-revalidate,s-maxage, proxy-revalidate)ï¼Œç¼“å­˜ä¸€å®šä¸èƒ½è¿”å›è¿‡æœŸå“åº”.  </p>
<p>  é™¤éå¤±å»è¿æ¥ä¸€èˆ¬ç¼“å­˜ä¸ä¼šè¿”å›è¿‡æœŸå“åº”(i.e:ä¸èƒ½è¿æ¥åˆ°æºæœåŠ¡å™¨æˆ–è€…å‘ç°ä¸€ä¸ªå‰è¿›è·¯å¾„),å¦å¤–æ˜ç¡®æŒ‡å‡ºå¯ä»¥è¿”å›è¿‡æœŸå“åº”ä¹Ÿå¯ä»¥(e.g: é€šè¿‡max-stale è¯·æ±‚æŒ‡ä»¤)  </p>
<p>  ç¼“å­˜åœ¨è¿”å›è¿‡æœŸå“åº”æ—¶å“åº”å¤´åº”è¯¥æœ‰110 warn-code(5.5.1),åŒæ ·çš„åœ¨å¤±å»è¿æ¥æƒ…å†µä¸‹è¿”å›è¿‡æœŸå“åº”ï¼Œå“åº”å¤´æœ‰112 warn-code  </p>
<p>  åœ¨å‰å¾€ä¸€ä¸ªæ²¡æœ‰Ageå¤´ä¿¡æ¯çš„å“åº”å¦‚æœå“åº”å·²ç»è¿‡æœŸç¼“å­˜ä¸åº”è¯¥äº§ç”Ÿä¸€ä¸ªæ–°çš„warningå¤´ä¿¡æ¯. ç¼“å­˜ä¸éœ€è¦ä¸ºä¸€ä¸ªä»…ä»…å› ä¸ºä¼ è¾“è€Œè¿‡æœŸçš„å“åº”è€ŒéªŒè¯.</p>
<h3 id="4-3"><a href="#4-3" class="headerlink" title="4.3"></a>4.3</h3><p>  å½“ä¸€ä¸ªç¼“å­˜æ‹¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªç¼“å­˜å“åº”å¯¹åº”ä¸€ä¸ªè¯·æ±‚URIä½†æ˜¯å´æ— æ³•æä¾›ç»™è¿™ä¸ªè¯·æ±‚(e.g:å› ä¸ºè¿™äº›ç¼“å­˜ä¸æ–°é²œï¼Œæˆ–è€…æ²¡æœ‰è¢«é€‰æ‹©4.1)ï¼Œè¿™æ ·çš„è¯å¯ä»¥åˆ©ç”¨æ¡ä»¶è¯·æ±‚æœºåˆ¶(conditional request machanism[RFC7232])è½¬å‘è¯·æ±‚ç»™ä¸‹ä¸€ä¸ªåˆ°è¾¾çš„æœåŠ¡å™¨æ¥é€‰æ‹©æ­£ç¡®çš„å“åº”æ¥ä½¿ç”¨ï¼Œä¸€èˆ¬å¯ä»¥é€šè¿‡æ›´æ–°å­˜å‚¨çš„å…ƒæ•°æ®æˆ–è€…æ›´æ–°ä¸€ä¸ªå®Œå…¨æ–°çš„å“åº”.è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºéªŒè¯å­˜å‚¨å“åº”.  </p>
<h4 id="4-3-1-å‘é€ä¸€ä¸ªéªŒè¯è¯·æ±‚"><a href="#4-3-1-å‘é€ä¸€ä¸ªéªŒè¯è¯·æ±‚" class="headerlink" title="4.3.1 å‘é€ä¸€ä¸ªéªŒè¯è¯·æ±‚"></a>4.3.1 å‘é€ä¸€ä¸ªéªŒè¯è¯·æ±‚</h4><h4 id="5-Cache-Control"><a href="#5-Cache-Control" class="headerlink" title="5 Cache-Control"></a>5 Cache-Control</h4>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//è¿™ä»½å›¾è¡¨æ¥è‡ª RFC2616</span><br><span class="line"> Cache-Control   = &quot;Cache-Control&quot; &quot;:&quot; 1#cache-directive</span><br><span class="line">  cache-directive = cache-request-directive</span><br><span class="line">       | cache-response-directive</span><br><span class="line">  cache-request-directive =</span><br><span class="line">         &quot;no-cache&quot;                          ; Section 14.9.1</span><br><span class="line">       | &quot;no-store&quot;                          ; Section 14.9.2</span><br><span class="line">       | &quot;max-age&quot; &quot;=&quot; delta-seconds         ; Section 14.9.3, 14.9.4</span><br><span class="line">       | &quot;max-stale&quot; [ &quot;=&quot; delta-seconds ]   ; Section 14.9.3</span><br><span class="line">       | &quot;min-fresh&quot; &quot;=&quot; delta-seconds       ; Section 14.9.3</span><br><span class="line">       | &quot;no-transform&quot;                      ; Section 14.9.5</span><br><span class="line">       | &quot;only-if-cached&quot;                    ; Section 14.9.4</span><br><span class="line">       | cache-extension                     ; Section 14.9.6</span><br><span class="line">   cache-response-directive =</span><br><span class="line">         &quot;public&quot;                               ; Section 14.9.1</span><br><span class="line">       | &quot;private&quot; [ &quot;=&quot; &lt;&quot;&gt; 1#field-name &lt;&quot;&gt; ] ; Section 14.9.1</span><br><span class="line">       | &quot;no-cache&quot; [ &quot;=&quot; &lt;&quot;&gt; 1#field-name &lt;&quot;&gt; ]; Section 14.9.1</span><br><span class="line">       | &quot;no-store&quot;                             ; Section 14.9.2</span><br><span class="line">       | &quot;no-transform&quot;                         ; Section 14.9.5</span><br><span class="line">       | &quot;must-revalidate&quot;                      ; Section 14.9.4</span><br><span class="line">       | &quot;proxy-revalidate&quot;                     ; Section 14.9.4</span><br><span class="line">       | &quot;max-age&quot; &quot;=&quot; delta-seconds            ; Section 14.9.3</span><br><span class="line">       | &quot;s-maxage&quot; &quot;=&quot; delta-seconds           ; Section 14.9.3</span><br><span class="line">       | cache-extension                        ; Section 14.9.6</span><br><span class="line">  cache-extension = token [ &quot;=&quot; ( token | quoted-string ) ]</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>dockerç½‘ç»œ</title>
    <url>/2020/03/13/docker%E7%BD%91%E7%BB%9C/</url>
    <content><![CDATA[<h2 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h2><p>Dockerçš„ç½‘ç»œç¯å¢ƒéš”ç¦»ä½¿ç”¨çš„æ˜¯Linux NamespaceæŠ€æœ¯è¿›è¡Œç½‘ç»œéš”ç¦»çš„ï¼Œæ¯ä¸€ä¸ª network namespaceéƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç½‘ç»œç¯å¢ƒå…¶ä¸­åŒ…æ‹¬ï¼šç½‘å¡,è·¯ç”±ï¼Œiptableè§„åˆ™ç­‰ã€‚<br> æ•´ä½“æ¶æ„å¦‚ä¸‹å›¾ï¼š<br> <img src="/2020/03/13/docker%E7%BD%91%E7%BB%9C/docker-network-type.png" alt="docker-network-type"><br> <span id="more"></span></p>
<h3 id="1-1-dockerå››ç§ç½‘ç»œæ¨¡å¼"><a href="#1-1-dockerå››ç§ç½‘ç»œæ¨¡å¼" class="headerlink" title="1.1 dockerå››ç§ç½‘ç»œæ¨¡å¼"></a>1.1 dockerå››ç§ç½‘ç»œæ¨¡å¼</h3><p>éš”ç¦»æ€§ç”±å¼ºåˆ°å¼±å¦‚ä¸‹:  </p>
<ul>
<li>noneæ¨¡å¼ æŒ‡å®šæ–¹å¼ï¼šâ€“net&#x3D;none</li>
<li>bridgeæ¨¡å¼ æŒ‡å®šæ–¹å¼ï¼šâ€“net&#x3D;bridge</li>
<li>containeræ¨¡å¼ æŒ‡å®šæ–¹å¼ï¼šâ€“net&#x3D;container:NAME_or_ID</li>
<li>hostæ¨¡å¼ æŒ‡å®šæ–¹å¼ï¼šâ€“net&#x3D;host<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># é»˜è®¤åˆ›å»ºå¥½ä¸‰ç§æ¨¡å¼ï¼Œæ— æ³•åˆ é™¤</span><br><span class="line">docker network ls </span><br><span class="line">NETWORK ID          NAME                DRIVER              SCOPE</span><br><span class="line">99646193e5fd        bridge              bridge              local</span><br><span class="line">213621f7ea56        host                host                local</span><br><span class="line">7bbc7a38b19f        none                null                local</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="1-2-bridge-ç½‘æ¡¥æ¨¡å¼"><a href="#1-2-bridge-ç½‘æ¡¥æ¨¡å¼" class="headerlink" title="1.2 bridge ç½‘æ¡¥æ¨¡å¼"></a>1.2 bridge ç½‘æ¡¥æ¨¡å¼</h3><p>dockerå¼•æ“åœ¨åˆ›å»ºæ—¶ä¼šï¼Œåˆ›å»ºä¸€ä¸ªdocker0çš„è™šæ‹Ÿç½‘æ¡¥ï¼Œåœ¨åŒä¸€å°å®¿ä¸»æœºä¸Šå¯åŠ¨çš„dockerå®¹å™¨çš„ç½‘ç»œè®¾å¤‡ï¼ˆè™šæ‹Ÿç½‘å¡ï¼‰é»˜è®¤ä¼šè¿æ¥åˆ°è¿™ä¸ªç½‘æ¡¥ä¸Šï¼Œå¹¶ä¸”é»˜è®¤åœ°å€ä¸º172.17.0.0&#x2F;16ä¸­çš„åœ°å€ã€‚ç½‘æ¡¥å·¥ä½œçš„æ–¹å¼ç±»ä¼¼ä¸ç‰©ç†äº¤æ¢æœºï¼ˆbridgeæœ‰å¤šä¸ªç«¯å£ï¼Œæ•°æ®å¯ä»¥ä»ä»»ä½•ç«¯å£è¿›æ¥ï¼Œè¿›æ¥ä¹‹åä»å“ªä¸ªå£å‡ºå»å’Œç‰©ç†äº¤æ¢æœºçš„åŸç†å·®ä¸å¤šï¼Œè¦çœ‹macåœ°å€ï¼‰</p>
<p>ä»docker0å­ç½‘ä¸­åˆ†é…ä¸€ä¸ªIPç»™å®¹å™¨ä½¿ç”¨ï¼Œå¹¶è®¾ç½®docker0çš„IPåœ°å€ä¸ºå®¹å™¨çš„é»˜è®¤ç½‘å…³ã€‚åœ¨ä¸»æœºä¸Šåˆ›å»ºä¸€å¯¹è™šæ‹Ÿç½‘å¡veth pairè®¾å¤‡ï¼ŒDockerå°†veth pairè®¾å¤‡çš„ä¸€ç«¯æ”¾åœ¨æ–°åˆ›å»ºçš„å®¹å™¨ä¸­ï¼Œå¹¶å‘½åä¸ºeth0ï¼ˆå®¹å™¨çš„ç½‘å¡ï¼‰ï¼Œå¦ä¸€ç«¯æ”¾åœ¨ä¸»æœºä¸­ï¼Œä»¥vethxxxè¿™æ ·ç±»ä¼¼çš„åå­—å‘½åï¼Œå¹¶å°†è¿™ä¸ªç½‘ç»œè®¾å¤‡åŠ å…¥åˆ°docker0ç½‘æ¡¥ä¸­ã€‚å¯ä»¥é€šè¿‡brctl showå‘½ä»¤æŸ¥çœ‹ã€‚</p>
]]></content>
      <categories>
        <category>docker network</category>
      </categories>
  </entry>
  <entry>
    <title>Aribnb javascript ä»£ç è§„èŒƒ</title>
    <url>/2017/11/10/Airbnb_JavaScript_Style_Guide/</url>
    <content><![CDATA[<h2 id="ç±»å‹-Types"><a href="#ç±»å‹-Types" class="headerlink" title="ç±»å‹(Types)"></a>ç±»å‹(Types)</h2><ul>
<li><p>1.1 åŸå§‹ç±»å‹ï¼šå½“ä½ è·å–ä¸€ä¸ªåŸå§‹ç±»å‹ä½ åº”è¯¥ç›´æ¥åœ¨å…¶å€¼ä¸Šæ“ä½œ</p>
<ul>
<li>string</li>
<li>number</li>
<li>boolean</li>
<li>null</li>
<li>undefined</li>
<li>symbol <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const foo = 1;</span><br><span class="line">let bar = foo;</span><br><span class="line"></span><br><span class="line">bar = 9;</span><br><span class="line"></span><br><span class="line">console.log(foo, bar); // =&gt; 1, 9</span><br></pre></td></tr></table></figure></li>
<li>Symbolsä¸èƒ½å®Œå…¨polyfill,æ‰€ä»¥åœ¨ä½¿ç”¨åº”è¯¥ç¡®å®šå…¶å½“å‰ä½¿ç”¨çš„ç¯å¢ƒåŸç”Ÿæ”¯æŒ <span id="more"></span></li>
</ul>
</li>
<li><p>1.2 å¤æ‚ç±»å‹ï¼šå½“ä½ è·å–ä¸€ä¸ªå¤æ‚ç±»å‹æ—¶ä½ åº”è¯¥é€šè¿‡å…¶å¼•ç”¨æ¥æ“ä½œå…¶å€¼</p>
<ul>
<li>object</li>
<li>array</li>
<li>function <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const foo = [1, 2];</span><br><span class="line">const bar = foo;</span><br><span class="line"></span><br><span class="line">bar[0] = 9;</span><br><span class="line"></span><br><span class="line">console.log(foo[0], bar[0]); // =&gt; 9, 9</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="å‚æ•°-References"><a href="#å‚æ•°-References" class="headerlink" title="å‚æ•°(References)"></a>å‚æ•°(References)</h2><ul>
<li><p>2.1 å¯¹æ‰€æœ‰å‚æ•°ä½¿ç”¨const;é¿å…ä½¿ç”¨var  eslintï¼šprefer-constï¼Œno-const-assign</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? è¿™æ˜¯é¿å…ä½ å¯¹ä½ çš„å‚æ•°èµ‹å€¼ï¼Œå‚æ•°èµ‹å€¼å¯ä»¥å¯¼è‡´è®¸å¤šbugå¹¶ä¸”éš¾äºç†è§£</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad </span><br><span class="line">var a = 1;</span><br><span class="line">var b = 2;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const a = 1;</span><br><span class="line">const b = 2;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>2.2 å¦‚æœä½ ä¸€å®šè¦é‡æ–°å¯¹ä½ çš„å‚æ•°å†æ¬¡èµ‹å€¼ï¼Œå¯ä»¥ä½¿ç”¨letä»£æ›¿var eslit: no-var jscs: disallowVar</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? letæ‹¥æœ‰å—çº§ä½œç”¨è€Œvaræ‹¥æœ‰å‡½æ•°ä½œç”¨åŸŸ</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">var count = 1;</span><br><span class="line">if(true)&#123;</span><br><span class="line">    count += 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good, use the let.</span><br><span class="line">let count = 1;</span><br><span class="line">if(true)&#123;</span><br><span class="line">    count += 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>2.3 å€¼çš„æ³¨æ„çš„æ˜¯letå’Œconstéƒ½æ˜¯å—çº§ä½œç”¨åŸŸ</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// constå’Œletåªå­˜åœ¨äºå®šä¹‰çš„å—</span><br><span class="line">&#123;</span><br><span class="line">    let a = 1;</span><br><span class="line">    const b = 1;</span><br><span class="line">&#125;</span><br><span class="line">console.log(a); // ReferenceError</span><br><span class="line">console.log(b); // ReferenceError</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="å¯¹è±¡-Objects"><a href="#å¯¹è±¡-Objects" class="headerlink" title="å¯¹è±¡(Objects)"></a>å¯¹è±¡(Objects)</h2><ul>
<li>3.1 ä½¿ç”¨å­—é¢é‡è¯­æ³•åˆ›å»ºå¯¹è±¡ eslint: no-new-object  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const item = new Object();</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const item = &#123;&#125;;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>3.2 å½“åˆ›å»ºçš„å¯¹è±¡æ‹¥æœ‰åŠ¨æ€å±æ€§åæ—¶ä½¿ç”¨è®¡ç®—å±æ€§åç§°<br>    &gt; ä¸ºä»€ä¹ˆ? è¿™æ ·å…è®¸ä½ åœ¨ç»Ÿä¸€çš„ä¸€ä¸ªåœ°æ–¹å®šä¹‰å¯¹è±¡å±æ€§<br>    <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function getKey(k)&#123;</span><br><span class="line">    return `a key named $&#123;k&#125;`;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const obj = &#123;</span><br><span class="line">    id: 5,</span><br><span class="line">    name: &#x27;San Francisco&#x27;</span><br><span class="line">&#125;;</span><br><span class="line">obj[getKey(&#x27;endabled&#x27;)] = true;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const obj = &#123;</span><br><span class="line">    id: 5,</span><br><span class="line">    name: &#x27;San Francisco&#x27;,</span><br><span class="line">    [getKey(&#x27;enabled&#x27;)]: true</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>3.3 ä½¿ç”¨å¯¹è±¡æ–¹æ³•ç®€å†™ eslint: object-shorthand </p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const atom = &#123;</span><br><span class="line">    value: 1,</span><br><span class="line"></span><br><span class="line">    addValueï¼š function(value)&#123;</span><br><span class="line">        return atom.value + value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const atom = &#123;</span><br><span class="line">    value: 1,</span><br><span class="line">    addValue(value)&#123;</span><br><span class="line">        return atom.value + value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>3.4 ä½¿ç”¨å±æ€§å€¼ç®€å†™ eslint: object-shorthand</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? å¯¹äºä¹¦å†™å’Œæè¿°æ›´åŠ çŸ­å°</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const lukeSkywalker = &#x27;Luke Skywalker&#x27;;</span><br><span class="line"></span><br><span class="line">// bad </span><br><span class="line">const obj = &#123;</span><br><span class="line">    lukeSkywalker: lukeSkywalker</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const obj = &#123;</span><br><span class="line">    lukeSkywalker</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>3.5 å°†ç®€å†™å±æ€§ç»Ÿä¸€æ”¾åœ¨å¯¹è±¡å£°æ˜çš„å¼€å¤´</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? è¿™æ ·æ›´å®¹æ˜“åŒºåˆ†å“ªäº›å±æ€§æ˜¯ä½¿ç”¨çš„ç®€å†™</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const anakinSkywalker = &#x27;Anakin Skywalker&#x27;;</span><br><span class="line">const lukeSkywalker = &#x27;Luke Skywalker&#x27;;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const obj = &#123;</span><br><span class="line">episodeOne: 1,</span><br><span class="line">twoJediWalkIntoACantina: 2,</span><br><span class="line">lukeSkywalker,</span><br><span class="line">episodeThree: 3,</span><br><span class="line">mayTheFourth: 4,</span><br><span class="line">anakinSkywalker,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const obj = &#123;</span><br><span class="line">lukeSkywalker,</span><br><span class="line">anakinSkywalker,</span><br><span class="line">episodeOne: 1,</span><br><span class="line">twoJediWalkIntoACantina: 2,</span><br><span class="line">episodeThree: 3,</span><br><span class="line">mayTheFourth: 4,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>3.6 åªæœ‰å½“éæ³•æ ‡è¯†ç¬¦åšå±æ€§æ—¶æ‰ä½¿ç”¨å¼•å· eslint: quote-props</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? é€šå¸¸è¿™æ ·ä¸»è§‚ä¸Šæ›´æ˜“é˜…è¯»,å®ƒæ”¹è¿›äº†è¯­æ³•çªæ˜¾,å¹¶ä¸”ä¹Ÿæ›´åŠ å®¹æ˜“è¢«è®¸å¤šjså¼•æ“ä¼˜åŒ–</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const bad = &#123;</span><br><span class="line">&#x27;foo&#x27;: 3,</span><br><span class="line">&#x27;bar&#x27;: 4,</span><br><span class="line">&#x27;data-blah&#x27;: 5,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const good = &#123;</span><br><span class="line">foo: 3,</span><br><span class="line">bar: 4,</span><br><span class="line">&#x27;data-blah&#x27;: 5,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>3.7 ä¸è¦ç›´æ¥ä½¿ç”¨Object.prototypeä¸Šçš„æ–¹æ³•,å¦‚hasOwnProperty,propertyIsEnumerable,isPrototypeOf  </p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? è¿™äº›æ–¹æ³•æœ‰å¯èƒ½è¢«å¯¹è±¡å®ä¾‹ä¸Šçš„å±æ€§ç»™è¦†ç›–æ‰ å¦‚é—®é¢˜ä¸­çš„{hasOwnProperty: false}æˆ–è€…è¿™ä¸ªå¯¹è±¡ä¹Ÿè®¸æ˜¯ä¸ªnullå¯¹è±¡(Object.create(null))</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">console.log(object.hasOwnProperty(key));</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">console.log(Object.prototype.hasOwnProperty.call(object, key));</span><br><span class="line"></span><br><span class="line">// best</span><br><span class="line">const has = Object.prototype.hasOwnProperty; // cache the lookup once, in module scope.</span><br><span class="line">/* or */</span><br><span class="line">import has from &#x27;has&#x27;;</span><br><span class="line">// ...</span><br><span class="line">console.log(has.call(object, key));</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>3.8 åœ¨è¦†ç›–-æ‹·è´å¯¹è±¡æ—¶åº”è¯¥åˆ©ç”¨å±•å¼€è¿ç®—ç¬¦(â€¦)è€Œä¸æ˜¯Object.assign ä¸ºäº†å¾—åˆ°ä¸€ä¸ªå·²åˆ å‡å±æ€§çš„æ–°å¯¹è±¡åº”è¯¥ä½¿ç”¨å¯¹è±¡è§£æ„è¿ç®—ç¬¦</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// very bad</span><br><span class="line">const original = &#123;a:1, b: 2&#125;;</span><br><span class="line">const copy = Object.assign(origin,&#123;c:3&#125;);// è¿™ä¸ªæ”¹å˜äº† `original` à² _à² </span><br><span class="line"></span><br><span class="line">// bad </span><br><span class="line">const original = &#123;a:1, b: 2&#125;;</span><br><span class="line">const copy = Object.assign(&#123;&#125;, original, &#123;c:3&#125;); // copy =&gt;&#123;a:1,b:2,c:3&#125;</span><br><span class="line"></span><br><span class="line">//good</span><br><span class="line">const original = &#123;a:1, b:2&#125;;</span><br><span class="line">const copy = &#123;...original,c:3&#125;; // copy =&gt;&#123;a:1, b:2, c:3&#125;</span><br><span class="line"></span><br><span class="line">const &#123;a,...noA&#125; = copy; // noA =&gt; &#123;b:2, c:3&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="æ•°ç»„-Arrays"><a href="#æ•°ç»„-Arrays" class="headerlink" title="æ•°ç»„(Arrays)"></a>æ•°ç»„(Arrays)</h2><ul>
<li><p>4.1 ä½¿ç”¨å­—é¢é‡è¯­æ³•åˆ›å»ºæ•°ç»„. eslint: no-array-constuctor</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const items = new Array();</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const items = [];</span><br></pre></td></tr></table></figure>
</li>
<li><p>4.2 ä½¿ç”¨æ•°ç»„çš„pushæ–¹æ³•æ·»åŠ é¡¹è€Œä¸æ˜¯ç›´æ¥æ·»åŠ </p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const someStack = [];</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">someStack[someStack.length] = &#x27;abc&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">someStack.push(&#x27;abc&#x27;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>4.3 ä½¿ç”¨æ•°ç»„çš„æ‰©å±•è¿ç®—ç¬¦â€¦æ¥å¤åˆ¶æ•°ç»„</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const len = items.length;</span><br><span class="line">const itemsCopy = [];</span><br><span class="line">let i;</span><br><span class="line"></span><br><span class="line">for (i = 0; i &lt; len; i += 1) &#123;</span><br><span class="line">itemsCopy[i] = items[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const itemsCopy = [...items];</span><br></pre></td></tr></table></figure>
</li>
<li><p>4.4 ä½¿ç”¨â€¦å°†ç±»æ•°ç»„è½¬æ¢ä¸ºæ•°ç»„è€Œä¸æ˜¯Array.form</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const foo = document.querySelectorAll(&#x27;.foo&#x27;);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const nodes = Array.from(foo);</span><br><span class="line"></span><br><span class="line">// best</span><br><span class="line">const nodes = [...foo];</span><br></pre></td></tr></table></figure>
</li>
<li><p>4.5 Array.from è€Œä¸æ˜¯å±•å¼€è¿ç®—ç¬¦â€¦æ¥éå†æ‰§è¡Œæ–¹æ³• ,å› ä¸ºå®ƒé¿å…äº†åˆ›å»ºä¸€ä¸ªä¸­é—´æ•°ç»„(è¿™é‡Œæ˜¯å› ä¸ºä½¿ç”¨mapæ—¶ä»æ¥æ²¡è¢«èµ‹è¿‡å€¼æˆ–è€…ä½¿ç”¨ delete åˆ é™¤çš„ç´¢å¼•åˆ™ä¸ä¼šè°ƒç”¨å‡½æ•°ã€‚)</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad </span><br><span class="line">const baz = [...foo].map(bar);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const baz = Array.form(foo, bar);</span><br><span class="line"></span><br><span class="line">//è¯‘è€…æ·»åŠ </span><br><span class="line">Array.from([1,,2],(i)=&gt;&#123;return i*2;&#125;) // =&gt; [2, NaN, 4]</span><br><span class="line"></span><br><span class="line">[1,,2].map((i)=&gt;&#123;return i*2;&#125;) // =&gt; [2, empty Ã— 1, 4]</span><br></pre></td></tr></table></figure>
</li>
<li><p>4.6 åœ¨æ•°ç»„çš„å›è°ƒå‡½æ•°ä¸­è¿”å›å£°æ˜.å½“å‡½æ•°ä½“åªåŒ…å«ä¸€ä¸ªå£°æ˜è¯­å¥ä¸”æ˜¯æ²¡æœ‰å‰¯ä½œç”¨çš„è¡¨è¾¾å¼æ˜¯å¯ä»¥çœç•¥returnè¯­å¥çš„ã€‚</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// good</span><br><span class="line">[1, 2, 3].map((x) =&gt; &#123;</span><br><span class="line">const y = x + 1;</span><br><span class="line">return x * y;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">[1, 2, 3].map(x =&gt; x + 1);</span><br><span class="line"></span><br><span class="line">// bad - no returned value means `memo` becomes undefined after the first iteration</span><br><span class="line">[[0, 1], [2, 3], [4, 5]].reduce((memo, item, index) =&gt; &#123;</span><br><span class="line">const flatten = memo.concat(item);</span><br><span class="line">memo[index] = flatten;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">[[0, 1], [2, 3], [4, 5]].reduce((memo, item, index) =&gt; &#123;</span><br><span class="line">const flatten = memo.concat(item);</span><br><span class="line">memo[index] = flatten;</span><br><span class="line">return flatten;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">inbox.filter((msg) =&gt; &#123;</span><br><span class="line">const &#123; subject, author &#125; = msg;</span><br><span class="line">if (subject === &#x27;Mockingbird&#x27;) &#123;</span><br><span class="line">    return author === &#x27;Harper Lee&#x27;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">inbox.filter((msg) =&gt; &#123;</span><br><span class="line">const &#123; subject, author &#125; = msg;</span><br><span class="line">if (subject === &#x27;Mockingbird&#x27;) &#123;</span><br><span class="line">    return author === &#x27;Harper Lee&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return false;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>4.7 å¦‚æœä¸€ä¸ªæ•°ç»„æ‹¥æœ‰å¤šè¡Œï¼Œåœ¨æ•°ç»„çš„å¼€å§‹æ‹¬å¼§åå’Œåœ¨ç»“æŸæ‹¬å¼§å‰åŠ æ¢è¡Œç¬¦ã€‚</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad </span><br><span class="line">const arr = [</span><br><span class="line">    [0, 1], [2, 3], [4, 5]</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">const objectInArray = [&#123;</span><br><span class="line">    id: 2,</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    id:2</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">const numberInArray = [</span><br><span class="line">    1,2</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const arr = [[0, 1], [2, 3], [4, 5]];</span><br><span class="line"></span><br><span class="line">const ObjectInArray = [</span><br><span class="line">    &#123;</span><br><span class="line">        id: 1,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        id: 2,</span><br><span class="line">    &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="è§£æ„-Destructuring"><a href="#è§£æ„-Destructuring" class="headerlink" title="è§£æ„(Destructuring)"></a>è§£æ„(Destructuring)</h2><ul>
<li><p>5.1 å½“ä½¿ç”¨å¤šå±æ€§å¯¹è±¡èµ‹å€¼æ—¶åº”è¯¥ä½¿ç”¨å¯¹è±¡è§£æ„</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? è§£æ„å¯ä»¥è®©ä½ èŠ‚çº¦æ‰ä¸ºé‚£äº›å±æ€§åˆ›å»ºä¸´æ—¶å˜é‡</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function getFullName(user)&#123;</span><br><span class="line">    const firstName = user.firstName;</span><br><span class="line">    const lastName = user.lastName;</span><br><span class="line"></span><br><span class="line">    return `$&#123;firstName&#125; $&#123;lastName&#125;`;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function getFullName(user)&#123;</span><br><span class="line">    const &#123; firstName, lastName&#125; = user;</span><br><span class="line">    return `$&#123;firstName&#125; $&#123;lastName&#125;`;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// best</span><br><span class="line">function getFullName(&#123;firstName, lastName&#125;)&#123;</span><br><span class="line">    return `$&#123;firstName&#125; $&#123;lastName&#125;`;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>5.2 ä½¿ç”¨æ•°ç»„è§£æ„. eslint: prefer-destrcuturing</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const arr = [1, 2, 3, 4];</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const first = arr[0];</span><br><span class="line">const second = arr[1];</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const [first, second] = arr;</span><br></pre></td></tr></table></figure>
</li>
<li><p>5.3 å½“å¤šä¸ªå€¼è¿”å›æ—¶ä½¿ç”¨å¯¹è±¡è§£æ„è€Œä¸æ˜¯æ•°ç»„è§£æ„</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? ä½ å¯ä»¥éšç€æ—¶é—´æ·»åŠ ä¸€ä¸ªå±æ€§æˆ–è€…æ”¹å˜å‚æ•°é¡ºåºè€Œä¸ç”¨æ”¹å˜åŸæ¥çš„è°ƒç”¨</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function processInput(input)&#123;</span><br><span class="line">     // then a miracle occurs</span><br><span class="line">    return [left, right, top, bottom];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è°ƒç”¨è€…éœ€è¦çŸ¥é“è¿”å›æ•°æ®çš„é¡ºåº</span><br><span class="line">const [left, __, top] = pocessInput(input);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function precessInput(input)&#123;</span><br><span class="line">    // then a miracle occurs</span><br><span class="line">    return &#123;left, right, top, bottom&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è°ƒç”¨è€…åªéœ€è¦é€‰æ‹©ä»–éœ€è¦çš„æ•°æ®</span><br><span class="line">const &#123; left, top &#125; = processInput(input);</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h2 id="å­—ç¬¦ä¸²-Stirngs"><a href="#å­—ç¬¦ä¸²-Stirngs" class="headerlink" title="å­—ç¬¦ä¸²(Stirngs)"></a>å­—ç¬¦ä¸²(Stirngs)</h2><ul>
<li><p>6.1 ä½¿ç”¨å•å¼•å·â€™â€™ eslint: quotes</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const name = &quot;Capt. Janeway&quot;;</span><br><span class="line"></span><br><span class="line">// bad - template literals should contain interpolation or newlines</span><br><span class="line">const name = `Capt. Janeway`;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const name = &#x27;Capt. Janeway&#x27;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>6.2 å½“å­—ç¬¦è¶…è¿‡100å­—ç¬¦ä¸åº”è¯¥æ¢è¡Œè¿æ¥å­—ç¬¦</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ?æ¢è¡Œå­—ç¬¦å¯¹äºä»£ç æœç´¢æ€§ä¸æœ‰åˆ©</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const errorMessage = &#x27;This is a super long error that was thrown because \</span><br><span class="line">of Batman. When you stop to think about how Batman had anything to do \</span><br><span class="line">with this, you would get nowhere \</span><br><span class="line">fast.&#x27;;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const errorMessage = &#x27;This is a super long error that was thrown because &#x27; +</span><br><span class="line">&#x27;of Batman. When you stop to think about how Batman had anything to do &#x27; +</span><br><span class="line">&#x27;with this, you would get nowhere fast.&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const errorMessage = &#x27;This is a super long error that was thrown because of Batman. When you stop to think about how Batman had anything to do with this, you would get nowhere fast.&#x27;;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>6.3 å½“ç¼–ç¨‹å¼çš„æ„å»ºå­—ç¬¦ä¸²æ—¶ä½¿ç”¨å­—ç¬¦ä¸²æ¨¡æ¿è€Œä¸æ˜¯ä½¿ç”¨è¿æ¥ eslint: prefer-template template-curly-spacing</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? å­—ç¬¦ä¸²æ¨¡æ¿å¯è¯»æ€§é«˜ï¼ŒåŒæ—¶å¯¹äºæ¢è¡Œå­—ç¬¦ä¸²ä»¥åŠæ’å…¥ç‰¹æ€§è¯­æ³•ç®€æ´</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function sayHi(name) &#123;</span><br><span class="line">    return &#x27;How are you, &#x27; + name + &#x27;?&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">function sayHi(name) &#123;</span><br><span class="line">    return [&#x27;How are you, &#x27;, name, &#x27;?&#x27;].join();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">function sayHi(name) &#123;</span><br><span class="line">    return `How are you, $&#123; name &#125;?`;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function sayHi(name) &#123;</span><br><span class="line">    return `How are you, $&#123;name&#125;?`;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>6.4 å¯¹å­—ç¬¦ä¸²æ°¸è¿œä¸è¦ç”¨eval(),è¿™é‡Œé¢å¤ªå¤šä¸ç¨³å®šæ€§ eslint: no-eval</p>
</li>
<li><p>6.5 ä¸è¦æ·»åŠ å¤šä½™çš„å­—ç¬¦ä¸²è½¬ä¹‰ eslint:no-useless-escape</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? åæ–œæ ç ´åå¯è¯»æ€§ï¼Œå› æ­¤ä¸è¦ä½¿ç”¨å¤šä½™çš„è½¬ä¹‰</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const foo = &#x27;\&#x27;this\&#x27; \i\s \&quot;quoted\&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const foo = &#x27;\&#x27;this\&#x27; is &quot;quoted&quot;&#x27;;</span><br><span class="line">const foo = `my name is &#x27;$&#123;name&#125;&#x27;`;</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h2 id="å‡½æ•°-Functions"><a href="#å‡½æ•°-Functions" class="headerlink" title="å‡½æ•°(Functions)"></a>å‡½æ•°(Functions)</h2><ul>
<li><p>7.1 ä½¿ç”¨å‘½åå‡½æ•°è¡¨è¾¾å¼è€Œä¸æ˜¯å‡½æ•°å£°æ˜. eslint: func-style</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? å‡½æ•°å£°æ˜æ˜¯è¦æå‡çš„ï¼Œè¿™å°±æ„å‘³ç€å‡½æ•°ç›¸å½“å®¹æ˜“åœ¨å…¶å®šä¹‰å‰å¼•ç”¨.è¿™å¯¹å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§æ˜¯æœ‰å®³çš„.å¦‚æœä½ å‘ç°å‡½æ•°çš„å®šä¹‰åºå¤§æˆ–å¤æ‚åˆ°ç†è§£å‰©ä½™æ–‡ä»¶å†…å®¹æ—¶,æˆ–è®¸è¿™æ—¶æ˜¯æ—¶å€™å°†å®šä¹‰æå–åˆ°è‡ªå·±çš„æ¨¡å—ä¸­(module).ä¸è¦å¿˜è®°è¿™ä¸ªå‡½æ•°è¡¨è¾¾å¼æ˜ç¡®çš„åå­—ï¼Œä¸ç®¡è¿™ä¸ªåå­—æ˜¯å¦å¯ä»¥ä»è¡¨è¾¾å¼åŒ…å«å˜é‡ä¸­æ¨æ–­.è¿™æ ·ä¼šæ¶ˆé™¤ä»»ä½•å¯¹äºé”™è¯¯è°ƒç”¨æ ˆçš„çŒœæƒ³.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function foo()&#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad </span><br><span class="line">const foo = function()&#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">// è¯æ³•åå­—å’Œå˜é‡å¼•ç”¨ç›¸äº’åŒºåˆ†</span><br><span class="line">const short = function longUniqueMoreDescriptivelLexicalFoo(</span><br><span class="line">    \\ ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>7.2 ç”¨åœ†æ‹¬å·å°†ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼åŒ…å«. eslint: wrap-iife  </p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå•ç‹¬çš„å•å…ƒåŠ ä¸Šæ‰§è¡ŒåŒæ‹¬å·éƒ½ç”¨ç©ºå·åŒ…è£¹èµ·æ¥ï¼Œå¹²å‡€çš„è¡¨è¾¾. å€¼çš„æ³¨æ„çš„æ˜¯åœ¨ä¸€ä¸ªæ‹¥æœ‰moduleçš„ä¸–ç•Œé‡Œï¼Œä½ å‡ ä¹ä¸éœ€è¦ç«‹å³æ‰§è¡Œè¡¨è¾¾å¼</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// immediately-invoked function expression (IIFE)</span><br><span class="line">(function () &#123;</span><br><span class="line">console.log(&#x27;Welcome to the Internet. Please follow me.&#x27;);</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure></blockquote>
</li>
<li><p>7.3 æ°¸è¿œä¸è¦åœ¨éå‡½æ•°å—çº§(if,whileç­‰)å£°æ˜ä¸€ä¸ªå‡½æ•°,è€Œæ˜¯å°†å‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡.æµè§ˆå™¨å…è®¸ä½ è¿™æ ·åš,ä½†æ˜¯å®ƒä»¬è¡¨ç°å¹¶ä¸ä¸€è‡´,è¿™æ˜¯å¾ˆéš¾æ¥å—çš„. eslint: no-loop-func</p>
</li>
<li><p>7.4 æ³¨æ„ï¼šECMA-262å°†å—å®šä¹‰ä¸ºä¸€äº›åˆ—çš„å£°æ˜(satetments).ä¸€ä¸ªå‡½æ•°å£°æ˜(declaration)ä¸æ˜¯è¿™ç§å£°æ˜(statement)</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">if(currentUser)&#123;</span><br><span class="line">    function test()&#123;</span><br><span class="line">        console.log(&#x27;Nope.&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">let test;</span><br><span class="line">if(currentUser)&#123;</span><br><span class="line">    test = ()=&gt;&#123;</span><br><span class="line">        console.log(&#x27;Yup.&#x27;)ï¼›</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>7.5 ä¸è¦å£°æ˜ä¸€ä¸ªargumentså‡½æ•°å‚æ•°,è¿™æ ·ä¼šè¦†ç›–å‡½æ•°ä¸­åŸæœ‰çš„argumentså¯¹è±¡</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function foo(name, options, arguments) &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function foo(name, options, args) &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>7.6 ä¸è¦ä½¿ç”¨arguments,æœ€å¥½ä½¿ç”¨â€¦ eslint:prefer-rest-params</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? â€¦æ˜¯æ˜ç¡®æŒ‡æ˜ä½ æƒ³è¦ä¼ å…¥çš„å‚æ•°.å…¶æ¬¡å‰©ä½™å‚æ•°æ˜¯ä¸€ä¸ªçœŸæ­£æ•°ç»„ï¼Œè€Œä¸åƒargumentsæ˜¯ä¸€ä¸ªç±»æ•°ç»„.</p>
</blockquote>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function concatenateAll()&#123;</span><br><span class="line">    const args = Array.prototype.slice.call(arguments);</span><br><span class="line">    return args.join(&#x27;&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function concatenateAll(...args)&#123;</span><br><span class="line">    return args.join(&#x27;&#x27;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>7.7 ä½¿ç”¨é»˜è®¤å‚æ•°è¯­æ³•è€Œä¸æ˜¯æ”¹å˜å‡½æ•°çš„å‚æ•°</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// çœŸæ­£çš„ç³Ÿç³•</span><br><span class="line">function hanleThings(opts)&#123;</span><br><span class="line">    // ä¸è¦æ”¹å˜å‡½æ•°çš„å‚æ•°</span><br><span class="line">    // æ›´åŠ ç³Ÿç³•: å¦‚æœoptsæ˜¯falsyè¿™é‡Œå°†ä¼šå¼•å…¥ä¸€ä¸ªå¾®å¦™çš„bug</span><br><span class="line">    opts = opts || &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// still bad</span><br><span class="line">function hanldeThings(opts)&#123;</span><br><span class="line">    if(opts === void 0)&#123;</span><br><span class="line">        opts = &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good </span><br><span class="line">function handleThings(opts = &#123;&#125;)&#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>7.8 é¿å…é»˜è®¤å‚æ•°æœ‰å‰¯ä½œç”¨</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? è¿™çœ‹èµ·æ¥å¾ˆç–‘æƒ‘</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var b = 1;</span><br><span class="line">// bad</span><br><span class="line">function count(a = b++) &#123;</span><br><span class="line">console.log(a);</span><br><span class="line">&#125;</span><br><span class="line">count();  // 1</span><br><span class="line">count();  // 2</span><br><span class="line">count(3); // 3</span><br><span class="line">count();  // 3</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>7.9 ä¸€ç›´è®²é»˜è®¤å‚æ•°æ”¾åœ¨æœ€å</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function hanleThings(opts = &#123;&#125;, name)&#123;</span><br><span class="line">    // ....</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function hanleThings(name, opts = &#123;&#125;)&#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>7.10 ä¸è¦ä½¿ç”¨å‡½æ•°æ„é€ å‡½æ•°åˆ›å»ºæ–°å‡½æ•° eslint:no-new-func</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ?ç”¨è¿™ç§æ–¹å¼åˆ›å»ºå‡½æ•°å’Œä½¿ç”¨eval()å¯¹å­—ç¬¦ä¸²æ±‚å€¼ä¸€æ ·ï¼ŒåŒæ ·çš„é£é™©å¾ˆå¤§.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">var add = new Function(&#x27;a&#x27;, &#x27;b&#x27;, &#x27;return a + b&#x27;);</span><br><span class="line"></span><br><span class="line">// still bad</span><br><span class="line">var subtract = Function(&#x27;a&#x27;, &#x27;b&#x27;, &#x27;return a - b&#x27;);</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>7.11 åœ¨å‡½æ•°ç­¾åé—´åŠ ç©ºæ ¼. eslint:sapce-before-function-parent</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? ä¸€è‡´æ€§æ€»æ˜¯å¥½çš„,å¹¶ä¸”åœ¨æ·»åŠ æˆ–è€…å»æ‰å‡½æ•°åæ—¶ä¸åº”è¯¥å»æ‰ç©ºæ ¼</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const f = function()&#123;&#125;;</span><br><span class="line">const g = function ()&#123;&#125;;</span><br><span class="line">const h = function() &#123;&#125;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const x = function () &#123;&#125;;</span><br><span class="line">const y = function a() &#123;&#125;;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>7.13 ä¸è¦æ”¹å˜(mutate)å‚æ•°. eslint:no-param-reassign</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? æ”¹å˜ä¼ å…¥å‚æ•°å¯¹è±¡ä¼šå¯¹åŸè°ƒç”¨è€…é€ æˆæ„æƒ³ä¸åˆ°çš„å˜é‡å‰¯ä½œç”¨</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad </span><br><span class="line">function f1(obj)&#123;</span><br><span class="line">    obj.key = 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good </span><br><span class="line">function f2(obj)&#123;</span><br><span class="line">    const key = Object.prototype.hasOwnProperty.call(obj, &#x27;key&#x27;) ? obj.key : 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>7.13 ä¸è¦å¯¹å‚æ•°å†æ¬¡èµ‹å€¼ eslint: no-param-reassign</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? </p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad </span><br><span class="line">function f1(a)&#123;</span><br><span class="line">    a = 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function f2(a)&#123;</span><br><span class="line">    if(!a) &#123; a = 1; &#125;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good f3(a)&#123;</span><br><span class="line">    const b = a || 1;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function f4(a = 1)&#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>7.14 å¯¹äºå¯å˜å‚æ•°å‡½æ•°ä½¿ç”¨æ‰©å±•æ“ä½œç¬¦â€¦</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? å› ä¸ºç®€æ´,ä½ ä¸éœ€è¦ç»‘å®šå†…å®¹ä¸Šä¸‹æ–‡(context),å¹¶ä¸”ä½ å°†newå’Œapplyç»“åˆä½¿ç”¨ä¹Ÿä¸å®¹æ˜“</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const x = [1, 2, 3, 4, 5];</span><br><span class="line">console.log.apply(console, x);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const x = [1, 2, 3, 4, 5];</span><br><span class="line">console.log(...x);</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">new (Function.prototype.bind.apply(Date, [null, 2016, 8, 5]));</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">new Date(...[2016, 8, 5]);</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>7.15 å¯¹äºå¤šè¡Œå‡½æ•°ç­¾åï¼Œå’Œæœ¬æ–‡æ¡£ä¸­ä¿æŒä¸€è‡´</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function foo(bar,</span><br><span class="line">            baz,</span><br><span class="line">            quux) &#123;</span><br><span class="line">// ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function foo(</span><br><span class="line">    bar,</span><br><span class="line">    baz,</span><br><span class="line">    quux,</span><br><span class="line">) &#123;</span><br><span class="line">// ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">console.log(foo,</span><br><span class="line">    bar,</span><br><span class="line">    baz);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">console.log(</span><br><span class="line">    foo,</span><br><span class="line">    bar,</span><br><span class="line">    baz,</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="ç®­å¤´å‡½æ•°"><a href="#ç®­å¤´å‡½æ•°" class="headerlink" title="ç®­å¤´å‡½æ•°"></a>ç®­å¤´å‡½æ•°</h2><ul>
<li><p>8.1 å½“ä½¿ç”¨åŒ¿åå‡½æ•°æ—¶(åŒæ ·ä¼ å…¥è¡Œå†…å›è°ƒå‡½æ•°æ—¶)ä½¿ç”¨ç®­å¤´å‡½æ•° eslint: prefer-arrow-callback</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? ç®­å¤´å‡½æ•°åˆ›å»ºçš„æ‰§è¡Œä¸Šä¸‹æ–‡(this)é€šå¸¸æ˜¯ä½ æƒ³è¦çš„,å¹¶ä¸”è¯­æ³•æ›´åŠ ç®€æ´</p>
</blockquote>
<blockquote>
<p>ä»€ä¹ˆæ—¶å€™ä¸? å½“ä½ æœ‰ä¸€ä¸ªè¶³å¤Ÿå¤æ‚å‡½æ•°æ—¶,ä½ ä¹Ÿè®¸è¯¥å°†é€»è¾‘ç§»åˆ°ä¸€ä¸ªå…·åå‡½æ•°è¡¨è¾¾å¼ä¸­.<br>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad </span><br><span class="line">[1, 2, 3].map(function(x)&#123;</span><br><span class="line">    const y = x + 1;</span><br><span class="line">    return x * y;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">[1, 2, 3].map((x) =&gt; &#123;</span><br><span class="line">    const y = x + 1;</span><br><span class="line">    return x * y;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
</blockquote>
</li>
<li><p>8.2 å¦‚æœå‡½æ•°ä½“æ˜¯ä¸€ä¸ªå•è¡Œè¡¨è¾¾å¼ä¸”è¿”å›å€¼ä¸ºä¸€ä¸ªæ²¡æœ‰å‰¯ä½œç”¨çš„è¡¨è¾¾å¼,è¿™æ—¶çœç•¥æ‰æ‹¬å·åŒæ—¶ä½¿ç”¨éšå¼è¿”å›</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? è¯­æ³•ç³–.å½“å¤šä¸ªå‡½æ•°é“¾å¼è°ƒç”¨æ—¶å¯è¯»æ€§é«˜.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad </span><br><span class="line">[1, 2, 3].map(number =&gt;&#123;</span><br><span class="line">    const nextNumber = number + 1;</span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// good </span><br><span class="line">[1, 2, 3].map(number =&gt; `A string containing the $&#123;nextNumber&#125;`);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">[1, 2, 3].map((number, index) =&gt; (&#123;</span><br><span class="line">    [index]: number,</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">// No implicit return with side effects</span><br><span class="line">function foo(callback) &#123;</span><br><span class="line">    const val = callback();</span><br><span class="line">    if (val === true) &#123;</span><br><span class="line">        // Do something if callback returns true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let bool = false;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">foo(() =&gt; bool = true);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">foo(() =&gt; &#123;</span><br><span class="line">    bool = true;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>8.3 å½“è¡¨è¾¾å¼ä¸ºå¤šè¡Œæ˜¯,ä½¿ç”¨åœ†æ‹¬å·åŒ…è£¹èµ·æ¥å¯è¯»æ€§æ›´å¥½</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? è¿™æ ·å¯ä»¥æ˜æ˜¾çœ‹å‡ºå‡½æ•°ä»å“ªé‡Œå¼€å§‹å’Œç»“æŸ</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">[&#x27;get&#x27;, &#x27;post&#x27;, &#x27;put&#x27;].map(httpMethod =&gt; Object.prototype.hasOwnProperty.call(</span><br><span class="line">        httpMagicObjectWithAVeryLongName,</span><br><span class="line">        httpMethod,</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">[&#x27;get&#x27;, &#x27;post&#x27;, &#x27;put&#x27;].map(httpMethod =&gt; (</span><br><span class="line">    Object.prototype.hasOwnProperty.call(</span><br><span class="line">        httpMagicObjectWithAVeryLongName,</span><br><span class="line">        httpMethod,</span><br><span class="line">    )</span><br><span class="line">));</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>8.4 å¦‚æœç®­å¤´å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°å¹¶ä¸”æ²¡æœ‰å¤§æ‹¬å·å°±å¯ä»¥ä¸è¦æ˜¯æœ‰åœ†æ‹¬å·ï¼Œå°†æ‹¬å·çœç•¥æ‰,å¦åˆ™ä¸ºäº†æ¸…æ™°å’Œä¸€è‡´æ€§ä¸€ç›´å°†å‚æ•°æ”¾åœ¨æ‹¬å·é‡Œ. æ³¨æ„:ä¹Ÿå¯ä»¥ä¸€ç›´å°†å‚æ•°æ”¾åœ¨æ‹¬å·é‡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">[1, 2, 3].map((x) =&gt; x * x);</span><br><span class="line"></span><br><span class="line">// good </span><br><span class="line">[1, 2, 3].map(x =&gt; x * x);</span><br><span class="line"></span><br><span class="line">// good </span><br><span class="line">[1, 2, 3].map(number =&gt; (</span><br><span class="line">  `A long string with the $&#123;number&#125;. Itâ€™s so long that we donâ€™t want it to take up space on the .map line!`</span><br><span class="line">));</span><br><span class="line"></span><br><span class="line">// bad </span><br><span class="line">[1, 2, 3].map( x =&gt; &#123;</span><br><span class="line">    const y = x + 1;</span><br><span class="line">    return x * y;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// good </span><br><span class="line">[1, 2, 3].map((x) =&gt;&#123;</span><br><span class="line">    const y = x + 1;</span><br><span class="line">    return x * y;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>8.5 é¿å…ç®­å¤´å‡½æ•°(&#x3D;&gt;)å’Œæ¯”è¾ƒç¬¦å·(&lt;&#x3D;,&gt;&#x3D;)çš„æ··æ·†. eslint: no-confusing-arrow</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const itemHeight = item =&gt; item.height &gt; 256 ? item.largeSize : item.smallSize;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const itemHeight = (item) =&gt; item.height &gt; 256 ? item.largeSize : item.smallSize;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const itemHeight = item =&gt; (item.height &gt; 256 ? item.largeSize : item.smallSize);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const itemHeight = (item) =&gt; &#123;</span><br><span class="line">  const &#123; height, largeSize, smallSize &#125; = item;</span><br><span class="line">  return height &gt; 256 ? largeSize : smallSize;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="ç±»å’Œæ„é€ å‡½æ•°-Classes-amp-Constructors"><a href="#ç±»å’Œæ„é€ å‡½æ•°-Classes-amp-Constructors" class="headerlink" title="ç±»å’Œæ„é€ å‡½æ•°(Classes &amp; Constructors)"></a>ç±»å’Œæ„é€ å‡½æ•°(Classes &amp; Constructors)</h2><ul>
<li><p>9.1 é¿å…ç›´æ¥æ“ä½œprototypeè€Œåº”è¯¥ä½¿ç”¨classè¯­æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//bad </span><br><span class="line">function Queue( contents = [] )&#123;</span><br><span class="line">    this.queue = [...contents];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Queue.prototype.pop = function()&#123;</span><br><span class="line">    onst value = this.queue[0];</span><br><span class="line">    this.queue.splice(0, 1);</span><br><span class="line">    return value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">class Queue &#123;</span><br><span class="line">  constructor(contents = []) &#123;</span><br><span class="line">    this.queue = [...contents];</span><br><span class="line">  &#125;</span><br><span class="line">  pop() &#123;</span><br><span class="line">    const value = this.queue[0];</span><br><span class="line">    this.queue.splice(0, 1);</span><br><span class="line">    return value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>9.2 ä½¿ç”¨extendsæ¥ç»§æ‰¿</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? å†…ç½®çš„ç»§æ‰¿æ–¹æ³•åŸå‹é“¾æ²¡æœ‰æ‰“æ–­instanceofä½¿ç”¨</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const inherits = require(&#x27;inherits&#x27;);</span><br><span class="line">function PeekableQueue(contents) &#123;</span><br><span class="line">    Queue.apply(this, contents);</span><br><span class="line">&#125;</span><br><span class="line">inherits(PeekableQueue, Queue);</span><br><span class="line">    PeekableQueue.prototype.peek = function () &#123;</span><br><span class="line">     return this.queue[0];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">class PeekableQueue extends Queue &#123;</span><br><span class="line">    peek() &#123;</span><br><span class="line">        return this.queue[0];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>9.3 æ–¹æ³•è¿”å›thisæ¥å¸®åŠ©æ„é€ æ–¹æ³•è°ƒç”¨é“¾</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">Jedi.prototype.jump = function () &#123;</span><br><span class="line">    this.jumping = true;</span><br><span class="line">    return true;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Jedi.prototype.setHeight = function (height) &#123;</span><br><span class="line">    this.height = height;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const luke = new Jedi();</span><br><span class="line">luke.jump(); // =&gt; true</span><br><span class="line">luke.setHeight(20); // =&gt; undefined</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">class Jedi &#123;</span><br><span class="line">jump() &#123;</span><br><span class="line">    this.jumping = true;</span><br><span class="line">    return this;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setHeight(height) &#123;</span><br><span class="line">    this.height = height;</span><br><span class="line">    return this;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const luke = new Jedi();</span><br><span class="line"></span><br><span class="line">luke.jump()</span><br><span class="line">.setHeight(20);</span><br></pre></td></tr></table></figure></li>
<li><p>9.4 å¯ä»¥å†™è‡ªå®šä¹‰çš„toStringæ–¹æ³•ï¼Œåªè¦ä¿è¯å®ƒèƒ½æ­£å¸¸å·¥ä½œå¹¶ä¸”æ²¡æœ‰å‰¯ä½œç”¨.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class Jedi &#123;</span><br><span class="line">    constructor(options = &#123;&#125;) &#123;</span><br><span class="line">        this.name = options.name || &#x27;no name&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    getName() &#123;</span><br><span class="line">        return this.name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    toString() &#123;</span><br><span class="line">        return `Jedi - $&#123;this.getName()&#125;`;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>9.5 å¦‚æœæ²¡æœ‰æŒ‡å®šæ„é€ å‡½æ•°ç±»éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„æ„é€ å‡½æ•°ï¼Œä¸€ä¸ªç©ºæ„é€ å‡½æ•°æˆ–è€…è¿™ä¸ªæ„é€ å‡½æ•°åªæ˜¯å§”æ‰˜çˆ¶çº§æ„é€ å‡½æ•°ï¼Œè¿™äº›éƒ½æ˜¯ä¸å¿…è¦çš„ã€‚</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">class Jedi&#123;</span><br><span class="line">    constructor() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    getName() &#123;</span><br><span class="line">        return this.name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad </span><br><span class="line">class Reg extends Jedi&#123;</span><br><span class="line">    constructor(...args)&#123;</span><br><span class="line">        super(...args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // good </span><br><span class="line">    class Reg extends Jedi&#123;</span><br><span class="line">        constructor(...args)&#123;</span><br><span class="line">            super(...args);</span><br><span class="line">            this.name = &#x27;Rey&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>9.6 é¿å…ä½¿ç”¨é‡å¤æ–¹æ³•å. eslint: bo-dupe-class-members</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? é‡å¤çš„ç±»æ–¹æ³•åï¼Œä¼šå¯¼è‡´å…ˆå‰å£°æ˜çš„ç±»åå¤±æ•ˆ</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">class Foo &#123;</span><br><span class="line">    bar() &#123; return 1; &#125;</span><br><span class="line">    bar() &#123; return 2; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">class Foo &#123;</span><br><span class="line">    bar() &#123; return 1; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">class Foo &#123;</span><br><span class="line">    bar() &#123; return 2; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h2 id="æ¨¡å—-Modules"><a href="#æ¨¡å—-Modules" class="headerlink" title="æ¨¡å—(Modules)"></a>æ¨¡å—(Modules)</h2><ul>
<li><p>10.1 æ€»æ˜¯ä½¿ç”¨modules(import&#x2F;export)è€Œä¸æ˜¯éæ ‡å‡†æ¨¡å—ç³»ç»Ÿ</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? moduelsæ˜¯æœªæ¥ï¼Œä¸å¦‚ç°åœ¨å°±ä½¿ç”¨</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const AirbnbStyleGuide = require(&#x27;./AirbnbStyleGuide&#x27;);</span><br><span class="line">module.exports = AirbnbStyleGuide.es6;</span><br><span class="line"></span><br><span class="line">// ok</span><br><span class="line">import AirbnbStyleGuide from &#x27;./AirbnbStyleGuide&#x27;;</span><br><span class="line">export default AirbnbStyleGuide.es6;</span><br><span class="line"></span><br><span class="line">// best</span><br><span class="line">import &#123; es6 &#125; from &#x27;./AirbnbStyleGuide&#x27;;</span><br><span class="line">export default es6;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>10.2 ä¸è¦ä½¿ç”¨é€šé…ç¬¦imports</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ?è¿™å¯ä»¥ä¿è¯ä½ åªæœ‰ä¸€ä¸ªdefault exports(ä¸å¤ªç†è§£<del>(â‰§â–½â‰¦)&#x2F;</del>)</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">import * as AirbnbStyleGuide from &#x27;./AirbnbStyleGuide&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">import AirbnbStyleGuide from &#x27;./AirbnbStyleGuide&#x27;;</span><br><span class="line"></span><br><span class="line">10.3 And do not export directly from an import.</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>10.3 ä¸è¦ç›´æ¥ä»ä¸€ä¸ªå¼•å…¥å¯¼å‡º</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? ä¿æŒä¸€è‡´</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">// filename es6.js</span><br><span class="line">export &#123; es6 as default &#125; from &#x27;./AirbnbStyleGuide&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">// filename es6.js</span><br><span class="line">import &#123; es6 &#125; from &#x27;./AirbnbStyleGuide&#x27;;</span><br><span class="line">export default es6;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>10.4 ä»ä¸€ä¸ªåœ°æ–¹å¼•å…¥çš„éƒ½æ”¾åœ¨åŒä¸€ä¸ªåœ°æ–¹. eslintï¼šno-duplicate-imports</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? ä¿å­˜å¯ç»´æŠ¤æ€§</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">import foo from &#x27;foo&#x27;;</span><br><span class="line">// â€¦ some other imports â€¦ //</span><br><span class="line">import &#123; named1, named2 &#125; from &#x27;foo&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">import foo, &#123; named1, named2 &#125; from &#x27;foo&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">import foo, &#123;</span><br><span class="line">named1,</span><br><span class="line">named2,</span><br><span class="line">&#125; from &#x27;foo&#x27;</span><br></pre></td></tr></table></figure></blockquote>
</li>
<li><p>10.5 ä¸è¦å¯¼å‡ºå¯ä»¥æ”¹å˜çš„ç»‘å®š. eslint: import&#x2F;no-mutable-exports</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? å¼‚å˜(mutation)ä¸€èˆ¬éƒ½æ˜¯è¦é¿å…çš„ï¼Œé™¤éåœ¨ç‰¹æ®Šçš„æƒ…å†µéœ€è¦ï¼Œé€šå¸¸åªæœ‰constantå¼•ç”¨æ‰èƒ½è¢«å¯¼å‡º.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// let foo = 3;</span><br><span class="line">export &#123;foo&#125;;</span><br><span class="line"></span><br><span class="line">// good </span><br><span class="line">const foo = 3;</span><br><span class="line">export &#123; foo &#125;;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>10.6 å¦‚æœmodlesé‡Œåªæœ‰ä¸€ä¸ªå¯¼å‡ºï¼Œæ¨èä½¿ç”¨defaultå¯¼å‡ºè€Œä¸æ˜¯å…·åå¯¼å‡º. eslint:import&#x2F;prefer-default-export.</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? ä¸ºäº†é¼“åŠ±æ›´å¤šçš„æ–‡ä»¶å€¼å¯¼å‡ºä¸€ä¸ªæ¨¡å—ï¼Œè¿™æ ·ä¾¿äºé˜…è¯»å’Œç»´æŠ¤.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad </span><br><span class="line">export function foo() &#123;&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">export default function foo() &#123;&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>10.7 å°†æ‰€æœ‰çš„importè¯­å¥æ”¾åœ¨éimportè¯­å¥å‰. eslint: import&#x2F;first</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? æ—¢ç„¶importséƒ½æ˜¯ä¼šæå‡çš„(hosited),å°±éƒ½å°†ä»–ä»¬æ”¾åœ¨é¡¶éƒ¨é¿å…ä¸€äº›æ„å¤–çš„è¡¨ç°è¡Œä¸º.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">import foo from &#x27;foo&#x27;;</span><br><span class="line">foo.init();</span><br><span class="line"></span><br><span class="line">import bar from &#x27;bar&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">import foo from &#x27;foo&#x27;;</span><br><span class="line">import bar from &#x27;bar&#x27;;</span><br><span class="line"></span><br><span class="line">foo.init();</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>10.8 è·¨è¡Œimportsåº”è¯¥ç¼©è¿›ï¼Œè¿™å’Œè·¨è¡Œæ•°ç»„ä¸å¯¹è±¡å­—é¢é‡ä¸€æ ·.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">import &#123;longNameA, longNameB, longNameC, longNameD, longNameE&#125; from &#x27;path&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">import &#123;</span><br><span class="line">longNameA,</span><br><span class="line">longNameB,</span><br><span class="line">longNameC,</span><br><span class="line">longNameD,</span><br><span class="line">longNameE,</span><br><span class="line">&#125; from &#x27;path&#x27;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>10.9 ä¸å…è®¸webpackçš„loaderè¯­æ³•ä¹Ÿåœ¨æ¨¡å—çš„importè¯­å¥é‡Œ. eslint: import&#x2F;no-wabpack-loader-syntax</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ?ä¸ºä»€ä¹ˆä¸è®²è¿™äº›è¯­æ³•å†™åœ¨webpack.config.js.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">import fooSass from &#x27;css!sass!foo.scss&#x27;;</span><br><span class="line">import barCss from &#x27;style!css!bar.css&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">import fooSass from &#x27;foo.scss&#x27;;</span><br><span class="line">import barCss from &#x27;bar.css&#x27;;</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h2 id="è¿­ä»£å™¨å’Œç”Ÿæˆå™¨-Iterators-and-Generators"><a href="#è¿­ä»£å™¨å’Œç”Ÿæˆå™¨-Iterators-and-Generators" class="headerlink" title="è¿­ä»£å™¨å’Œç”Ÿæˆå™¨(Iterators and Generators)"></a>è¿­ä»£å™¨å’Œç”Ÿæˆå™¨(Iterators and Generators)</h2><ul>
<li><p>11.1 ä¸è¦ä½¿ç”¨è¿­ä»£å™¨.åº”è¯¥ä½¿ç”¨é«˜é˜¶å‡½æ•°æ¥ä»£æ›¿å¾ªç¯(for-inæˆ–è€…for-of). eslint:no-iterator no-restricted-stntax</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? è¿™å¯ä»¥å¼ºè¿«æˆ‘ä»¬ä½¿ç”¨ä¸å¼‚å˜åŸåˆ™(immutable).å¤„ç†çº¯å‡½æ•°è¿”å›çš„å€¼ç›¸å¯¹äºæœ‰å‰¯ä½œç”¨çš„æ›´å®¹æ˜“è§£é‡Š.</p>
</blockquote>
<blockquote>
<p>ä½¿ç”¨ map()&#x2F; every()&#x2F; filter()&#x2F; find()&#x2F; findIndex()&#x2F; reduce()&#x2F; some()&#x2F;â€¦ æ¥éå†æ•°ç»„,åŒæ—¶ä½¿ç”¨Object.keys()&#x2F; Object.value()&#x2F; Object.entries()æ¥äº§ç”Ÿæ•°ç»„è®©ä½ å¯ä»¥éå†å¯¹è±¡.<br>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const numbers = [1, 2, 3, 4, 5];</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">let (let num of numbers)&#123;</span><br><span class="line">    sum += num;</span><br><span class="line">&#125;</span><br><span class="line">sum === 15;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">let sum = 0;</span><br><span class="line">numbers.forEach((num) =&gt;&#123;</span><br><span class="line">    sum += num</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">sum === 15;</span><br><span class="line"></span><br><span class="line">// best(ä½¿ç”¨å‡½æ•°å¼å¼ºåˆ¶)</span><br><span class="line">const sum = numbers.reduce((total, num) =&gt; tatal + num, 0);</span><br><span class="line"></span><br><span class="line">sum === 15;</span><br><span class="line"></span><br><span class="line">// bad </span><br><span class="line">const increaseByOne = [];</span><br><span class="line">for(let i = 0; i &lt; numbers.length; i++)&#123;</span><br><span class="line">    increaseByOne.push(numbers[i] + 1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const increasedByOne = [];</span><br><span class="line">numbers.forEach((num) =&gt;&#123;</span><br><span class="line">    increasedByOne.push(num + 1);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// best (ä¿æŒå‡½æ•°å¼)</span><br><span class="line">const increasdByOne = numbers.map(num =&gt; num + 1);</span><br></pre></td></tr></table></figure></p>
</blockquote>
</li>
<li><p>11.2 ç›®å‰ä¸è¦ä½¿ç”¨è¿­ä»£å™¨(generators)</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? å®ƒä»¬ç›®å‰è¿˜ä¸èƒ½å¾ˆå¥½çš„è½¬ä¹‰åˆ°ES5</p>
</blockquote>
</li>
<li><p>11.3 å¦‚æœä½ ä¸€å®šè¦ä½¿ç”¨è¿­ä»£å™¨,æˆ–è€…ä½ ä¸èµæˆæˆ‘ä»¬çš„å»ºè®®ï¼Œè¯·ç¡®å®šå‡½æ•°æ ‡è¯†ç¬¦æ­£ç¡®çš„ç©ºæ ¼åŒ–. eslint: generator-star-spacing</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? functionå’Œ*ä¸¤è€…æ˜¯åŒä¸€ä¸ªæ¦‚å¿µçš„å…³é”®å­—, <em>ä¸æ˜¯æ¥ä¿®é¥°function, function</em>æ˜¯ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ„é€ å™¨ï¼Œè¿™ä¸ªæ„é€ å™¨å’Œæ™®é€šçš„functtionä¸åŒ.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function * foo() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const bar = function * () &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const baz = function *() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const quux = function*() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">function*foo() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">function *foo() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// very bad</span><br><span class="line">function</span><br><span class="line">*</span><br><span class="line">foo() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// very bad</span><br><span class="line">const wat = function</span><br><span class="line">*</span><br><span class="line">() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function* foo() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const foo = function* () &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h2 id="å±æ€§-Properties"><a href="#å±æ€§-Properties" class="headerlink" title="å±æ€§(Properties)"></a>å±æ€§(Properties)</h2><ul>
<li><p>12.1 ä½¿ç”¨ç‚¹æ ‡è®°ç¬¦æ¥è·å–å±æ€§, eslint: dot-notation</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const luke = &#123;</span><br><span class="line">    jedi: true,</span><br><span class="line">    age: 28,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const isJedi = luke[&#x27;jedi&#x27;];</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const isJedi = luke.jedi;</span><br></pre></td></tr></table></figure>
</li>
<li><p>12.2 å½“ä½¿ç”¨ä¸€ä¸ªå˜é‡æ¥è®¿é—®å±æ€§æ—¶ä½¿ç”¨[]</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const luke = &#123;</span><br><span class="line">    jedi: true,</span><br><span class="line">    age: 28,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">function getProp(prop) &#123;</span><br><span class="line">    return luke[prop];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const isJedi = getProp(&#x27;jedi&#x27;);</span><br></pre></td></tr></table></figure></li>
<li><p>12.3 å¹‚è®¡ç®—ä½¿ç”¨**, eslint: no-restricted-properties</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const binary = Math.pow(2, 10);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const binary = 2 ** 10;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="å˜é‡-Variables"><a href="#å˜é‡-Variables" class="headerlink" title="å˜é‡(Variables)"></a>å˜é‡(Variables)</h2><ul>
<li><p>13.1 å£°æ˜å˜é‡æ—¶ä½¿ç”¨constæˆ–letï¼Œå¦‚æœä¸è¿™æ ·åšå°†å¯èƒ½å¯¼è‡´å…¨å±€å˜é‡,ä¸€èˆ¬æˆ‘ä»¬éƒ½é¿å…æ±¡æŸ“å…¨å±€ä½œç”¨åŸŸç©ºé—´, eslint: no-undef prefer-const</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">superPower = new SuperPower();</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const superPower = new SuperPower();</span><br></pre></td></tr></table></figure>
</li>
<li><p>13.2 ä¸ºæ¯ä¸ªå£°æ˜çš„å˜é‡å•ç‹¬ä½¿ç”¨constæˆ–let. eslit: one-var</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? è¿™æ ·æ›´åŠ å®¹æ˜“æ·»åŠ æ–°å£°æ˜å˜é‡,åŒæ—¶ä½ ä¹Ÿä¸ç”¨æ‹…å¿ƒ;å’Œ,çš„ä½ç½®å†™åäº†,åœ¨æ‰“æ–­ç‚¹debuggeræ—¶æ›´æ–¹ä¾¿åˆ†åˆ«æ£€æŸ¥æ¯ä¸ªå˜é‡.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const items = getItems(),</span><br><span class="line">    goSportsTeam = true,</span><br><span class="line">    dragonball = &#x27;z&#x27;;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">// (compare to above, and try to spot the mistake)</span><br><span class="line">const items = getItems(),</span><br><span class="line">    goSportsTeam = true;</span><br><span class="line">    dragonball = &#x27;z&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const items = getItems();</span><br><span class="line">const goSportsTeam = true;</span><br><span class="line">const dragonball = &#x27;z&#x27;;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>13.3 å°†ä½ æ‰€æœ‰çš„constå£°æ˜é›†åˆåœ¨ä¸€èµ·å†™ï¼ŒåŒæ ·letä¹Ÿæ˜¯ä¸€æ ·</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? å½“ä½ æƒ³å†æ¬¡èµ‹å€¼æ—¶å¯èƒ½æ›´åŠ æ–¹ä¾¿</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">let i, len, dragonball,</span><br><span class="line">    items = getItems(),</span><br><span class="line">    goSportsTeam = true;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">let i;</span><br><span class="line">const items = getItems();</span><br><span class="line">let dragonball;</span><br><span class="line">const goSportsTeam = true;</span><br><span class="line">let len;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const goSportsTeam = true;</span><br><span class="line">const items = getItems();</span><br><span class="line">let dragonball;</span><br><span class="line">let i;</span><br><span class="line">let length;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>13.4 å˜é‡åœ¨ä½ éœ€è¦çš„æ—¶å€™å¯¹å®ƒä»¬èµ‹å€¼ï¼Œä½†æ˜¯è¦æŠŠå®ƒä»¬æ”¾åœ¨åˆç†çš„åœ°æ–¹</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad ä¸å¿…è¦çš„å‡½æ•°è°ƒç”¨</span><br><span class="line">function checkName(hasName)&#123;</span><br><span class="line">    const name = getName();</span><br><span class="line"></span><br><span class="line">    if(hasName === &#x27;test&#x27;)&#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(name === &#x27;test&#x27;)&#123;</span><br><span class="line">        this.setName(&#x27;&#x27;);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good </span><br><span class="line">function checkName(hasName) &#123;</span><br><span class="line">    if (hasName === &#x27;test&#x27;)&#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    const name = getName();</span><br><span class="line">    if(name === &#x27;test&#x27;)&#123;</span><br><span class="line">        this.setName(&#x27;&#x27;);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>13.5 ä¸è¦å°†å˜é‡é“¾å¼èµ‹å€¼. eslint: no-multi-assign</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? å˜é‡é“¾å¼èµ‹å€¼ä¼šé€ æˆéšå¼å…¨å±€å˜é‡</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">(function example()&#123;</span><br><span class="line">    //js è¿™æ ·è§£æ</span><br><span class="line">    // let a = ( b = ( c = 1 ) );</span><br><span class="line">    //letå…³é”®å­—åªç”¨åˆ°äº†aä¸Šå…¶ä½™éƒ½æˆä¸ºäº†å…¨å±€å˜é‡</span><br><span class="line">    let a = b = c = 1;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line">console.log(a); // throws ReferenceError</span><br><span class="line">console.log(b); // 1</span><br><span class="line">console.log(c); // 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">(function example() &#123;</span><br><span class="line">    let a = 1;</span><br><span class="line">    let b = a;</span><br><span class="line">    let c = a;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line">console.log(a); // throws ReferenceError</span><br><span class="line">console.log(b); // throws ReferenceError</span><br><span class="line">console.log(c); // throws ReferenceError</span><br><span class="line"></span><br><span class="line">//éƒ½æ˜¯ `const`</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>13.6 é¿å…ä½¿ç”¨ä¸€å…ƒè¿ç®—ç¬¦ eslint: no-plusplus</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line"></span><br><span class="line">const array = [1, 2, 3];</span><br><span class="line">let num = 1;</span><br><span class="line">num++;</span><br><span class="line">--num;</span><br><span class="line"></span><br><span class="line">let sum = 0;</span><br><span class="line">let truthyCount = 0;</span><br><span class="line">for (let i = 0; i &lt; array.length; i++) &#123;</span><br><span class="line">    let value = array[i];</span><br><span class="line">    sum += value;</span><br><span class="line">    if (value) &#123;</span><br><span class="line">        truthyCount++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line"></span><br><span class="line">const array = [1, 2, 3];</span><br><span class="line">let num = 1;</span><br><span class="line">num += 1;</span><br><span class="line">num -= 1;</span><br><span class="line"></span><br><span class="line">const sum = array.reduce((a, b) =&gt; a + b, 0);</span><br><span class="line">const truthyCount = array.filter(Boolean).length;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="æå‡-Hoising"><a href="#æå‡-Hoising" class="headerlink" title="æå‡(Hoising)"></a>æå‡(Hoising)</h2><pre><code>* 14.1 varå£°æ˜å˜é‡æ—¶åœ¨å…¶æœªèµ‹å€¼å°±å·²ç»æå‡åˆ°å½“å‰ä½œç”¨åŸŸé¡¶éƒ¨.ä½†æ˜¯constå’Œletæœ‰ä¸€ä¸ªæ–°çš„æ¦‚å¿µæš‚æ—¶æ€§æ­»åŒº(Temporal Dead Zones).åŒæ ·è¿™å°±æ„å‘³ç€ä½¿ç”¨typeofä¸å†å®‰å…¨.
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// we know this wouldnâ€™t work (assuming there</span><br><span class="line">// is no notDefined global variable)</span><br><span class="line">function example() &#123;</span><br><span class="line">    console.log(notDefined); // =&gt; throws a ReferenceError</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// creating a variable declaration after you</span><br><span class="line">// reference the variable will work due to</span><br><span class="line">// variable hoisting. Note: the assignment</span><br><span class="line">// value of `true` is not hoisted.</span><br><span class="line">function example() &#123;</span><br><span class="line">    console.log(declaredButNotAssigned); // =&gt; undefined</span><br><span class="line">    var declaredButNotAssigned = true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// the interpreter is hoisting the variable</span><br><span class="line">// declaration to the top of the scope,</span><br><span class="line">// which means our example could be rewritten as:</span><br><span class="line">function example() &#123;</span><br><span class="line">    let declaredButNotAssigned;</span><br><span class="line">    console.log(declaredButNotAssigned); // =&gt; undefined</span><br><span class="line">    declaredButNotAssigned = true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// using const and let</span><br><span class="line">function example() &#123;</span><br><span class="line">    console.log(declaredButNotAssigned); // =&gt; throws a ReferenceError</span><br><span class="line">    console.log(typeof declaredButNotAssigned); // =&gt; throws a ReferenceError</span><br><span class="line">    const declaredButNotAssigned = true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre>
<ul>
<li><p>14.2 åŒ¿åå‡½æ•°è¡¨è¾¾å¼åªæ˜¯æå‡äº†å®ƒä»¬çš„å˜é‡åï¼Œä½†æ˜¯å‡½æ•°å¹¶æ²¡æœ‰èµ‹å€¼.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function example() &#123;</span><br><span class="line">    console.log(anonymous); // =&gt; undefined</span><br><span class="line"></span><br><span class="line">    anonymous(); // =&gt; TypeError anonymous is not a function</span><br><span class="line"></span><br><span class="line">    var anonymous = function () &#123;</span><br><span class="line">        console.log(&#x27;anonymous function expression&#x27;);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>14.3 å…·åå‡½æ•°è¡¨è¾¾å¼æå‡äº†å®ƒä»¬çš„å˜é‡åï¼Œç«¥è°£å‡½æ•°åå’Œå‡½æ•°ä¹Ÿæ²¡æœ‰æå‡</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function example() &#123;</span><br><span class="line">    console.log(named); // =&gt; undefined</span><br><span class="line"></span><br><span class="line">    named(); // =&gt; TypeError named is not a function</span><br><span class="line"></span><br><span class="line">    superPower(); // =&gt; ReferenceError superPower is not defined</span><br><span class="line"></span><br><span class="line">    var named = function superPower() &#123;</span><br><span class="line">            console.log(&#x27;Flying&#x27;);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// the same is true when the function name</span><br><span class="line">// is the same as the variable name.</span><br><span class="line">function example() &#123;</span><br><span class="line">    console.log(named); // =&gt; undefined</span><br><span class="line"></span><br><span class="line">    named(); // =&gt; TypeError named is not a function</span><br><span class="line"></span><br><span class="line">    var named = function named() &#123;</span><br><span class="line">        console.log(&#x27;named&#x27;);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>14.4 å‡½æ•°å£°æ˜æå‡å®ƒä»¬åå­—å’Œå‡½æ•°ä½“</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function example() &#123;</span><br><span class="line">    superPower(); // =&gt; Flying</span><br><span class="line"></span><br><span class="line">    function superPower() &#123;</span><br><span class="line">        console.log(&#x27;Flying&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ›´å¤šå…³äºè¿™éƒ¨åˆ†çš„ä¿¡æ¯ <a href="http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting/">javascript Scoping &amp; Hositing</a> by <a href="http://www.adequatelygood.com/">Ben Cherry</a></p>
</li>
</ul>
<h2 id="æ¯”è¾ƒæ“ä½œç¬¦å’Œç›¸ç­‰æ€§-Comparison-Operators-amp-Equality"><a href="#æ¯”è¾ƒæ“ä½œç¬¦å’Œç›¸ç­‰æ€§-Comparison-Operators-amp-Equality" class="headerlink" title="æ¯”è¾ƒæ“ä½œç¬¦å’Œç›¸ç­‰æ€§(Comparison Operators &amp; Equality)"></a>æ¯”è¾ƒæ“ä½œç¬¦å’Œç›¸ç­‰æ€§(Comparison Operators &amp; Equality)</h2><ul>
<li><p>15.1 ä½¿ç”¨&#x3D;&#x3D;&#x3D;å’Œ !&#x3D;&#x3D; æ¥ä»£æ›¿ &#x3D;&#x3D; å’Œ ï¼&#x3D; eslint: eqeqeq</p>
</li>
<li><p>15.2 åœ¨æ¡ä»¶è¯­å¥ä¸­å¦‚ifè¯­å¥å¯¹è¡¨è¾¾å¼æ±‚å€¼æ—¶éƒ½æ˜¯ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè½¬æ¢éƒ½éµå¾ªå¦‚ä¸‹è§„åˆ™:</p>
<ul>
<li>å¯¹è±¡ç±»å‹(Objects)æ±‚å€¼ä¸ºtrue</li>
<li>Undefiendæ±‚å€¼ä¸º false</li>
<li>Nullæ±‚å€¼ä¸º false</li>
<li>å¸ƒå°”ç±»å‹(Booleans)æ±‚å€¼ä¸ºå¸ƒå°”çš„å€¼</li>
<li>æ•°å­—ç±»å‹(Numbers)å½“ä¸º+0ï¼Œ-0æˆ–NaNæ±‚å€¼ä¸ºfalseå…¶ä½™éƒ½ä¸ºtrue</li>
<li>å­—ç¬¦ä¸²ç±»å‹(Strings)åªæœ‰å­—ç¬¦ä¸²ä¸ºç©ºå­—ç¬¦ä¸²â€™â€™ä¸ºfalse,å…¶ä½™éƒ½ä¸ºtrue  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if ([0] &amp;&amp; []) &#123;</span><br><span class="line">    // true</span><br><span class="line">    // an array (even an empty one) is an object, objects will evaluate to true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>15.3 å¸ƒå°”ç±»å‹ä½¿ç”¨ç®€å†™ï¼Œå…¶ä½™å¦‚stringså’Œnumberså¿…é¡»æ˜ç¡®å…¶æ¯”è¾ƒ</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">if(isValid === true)&#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if(isValid)&#123;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad </span><br><span class="line">if(name)&#123;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// if(name !== &#x27;&#x27;)&#123;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">if(collection.length)&#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good </span><br><span class="line">if(collection.length &gt; 0)&#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>15.4 æ›´å¤šä¿¡æ¯çœ‹ <a href="https://javascriptweblog.wordpress.com/2011/02/07/truth-equality-and-javascript/#more-2108">Truth Equality and javascript</a> by Angus Croll</p>
</li>
<li><p>15.5 å¯¹äºcaseå’Œdefaultä»å¥å®ƒä»¬å¦‚æœåŒ…å«è¯æ³•å£°æ˜(eg: let const function calss)ä½¿ç”¨å¤§æ‹¬å·åˆ›å»ºå—</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? è¯æ³•å£°æ˜åœ¨æ•´ä¸ªæ˜¯switchå—å¯è§ä½†æ˜¯åªæœ‰åœ¨èµ‹å€¼çš„æ—¶å€™åˆå§‹åŒ–(åªæœ‰å½“caseåˆ°è¾¾æ—¶).è¿™æ ·å¯èƒ½å¸¦ç€å¤šä¸ªcaseä»å¥éƒ½å°è¯•å®šä¹‰ç›¸å½“çš„ä¸œè¥¿</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">switch (foo) &#123;</span><br><span class="line">    case 1:</span><br><span class="line">        let x = 1;</span><br><span class="line">        break;</span><br><span class="line">    case 2:</span><br><span class="line">        const y = 2;</span><br><span class="line">        break;</span><br><span class="line">    case 3:</span><br><span class="line">        function f() &#123;</span><br><span class="line">        // ...</span><br><span class="line">        &#125;</span><br><span class="line">        break;</span><br><span class="line">    default:</span><br><span class="line">        class C &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">switch (foo) &#123;</span><br><span class="line">    case 1: &#123;</span><br><span class="line">        let x = 1;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    case 2: &#123;</span><br><span class="line">        const y = 2;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    case 3: &#123;</span><br><span class="line">        function f() &#123;</span><br><span class="line">        // ...</span><br><span class="line">        &#125;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    case 4:</span><br><span class="line">        bar();</span><br><span class="line">        break;</span><br><span class="line">    default: &#123;</span><br><span class="line">        class C &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>15.6 ä¸‰å…ƒè¿ç®—ç¬¦åº”è¯¥ä¿æŒåœ¨ä¸€è¡Œï¼Œä¸åº”æœ‰ä½¿ç”¨å¾ˆæ··ä¹± eslint: no-nested-ternary</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const foo = maybe1 &gt; maybe2</span><br><span class="line">    ? &quot;bar&quot;</span><br><span class="line">    : value1 &gt; value2 ? &quot;baz&quot; : null;</span><br><span class="line"></span><br><span class="line">// split into 2 separated ternary expressions</span><br><span class="line">const maybeNull = value1 &gt; value2 ? &#x27;baz&#x27; : null;</span><br><span class="line"></span><br><span class="line">// better</span><br><span class="line">const foo = maybe1 &gt; maybe2</span><br><span class="line">    ? &#x27;bar&#x27;</span><br><span class="line">    : maybeNull;</span><br><span class="line"></span><br><span class="line">// best</span><br><span class="line">const foo = maybe1 &gt; maybe2 ? &#x27;bar&#x27; : maybeNull;</span><br></pre></td></tr></table></figure>
</li>
<li><p>15.7 é¿å…ä¸å¿…è¦çš„ä¸‰å…ƒè¯­å¥. eslint: no-unneeded-ternary</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const foo = a ? a : b;</span><br><span class="line">const bar = c ? true : false;</span><br><span class="line">const baz = c ? false : true;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const foo = a || b;</span><br><span class="line">const bar = !!c;</span><br><span class="line">const baz = !c</span><br></pre></td></tr></table></figure>
</li>
<li><p>15.8 å½“å¤šä¸ªæ“ä½œç¬¦æ··åˆåœ¨ä¸€ä¸ªè¯­å¥ä¸­ä½¿ç”¨åœ†æ‹¬å·å°†åŒ…è£¹èµ·æ¥ï¼Œå½“æœ‰æ··åˆæ•°å­¦æ“ä½œç¬¦ä¸è¦å°†*<em>ä¸%æˆ–è€…+-</em>&amp;&#x2F;ä¹‹é—´æ··åˆ eslint: no-mixed-operators</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ?è¿™æ ·æ”¹å–„äº†å¯è¯»æ€§å¹¶ä¸”æ¾„æ¸…äº†å¼€å‘è€…çš„æ„å›¾</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const foo = a &amp;&amp; b &lt; 0 || c &gt; 0 || d + 1 === 0;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const bar = a ** b - 5 % d;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">if (a || b &amp;&amp; c) &#123;</span><br><span class="line">    return d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const foo = (a &amp;&amp; b &lt; 0) || c &gt; 0 || (d + 1 === 0);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const bar = (a ** b) - (5 % d);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if ((a || b) &amp;&amp; c) &#123;</span><br><span class="line">    return d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const bar = a + b / c * d;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>å—(Blocks)</p>
</li>
<li><p>16.1 å¯¹æ‰€ç”¨çš„å¤šè¡Œå—ä½¿ç”¨å¤§æ‹¬å· eslint: nonblock-statement-body-position</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">if (test)</span><br><span class="line">    return false;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if (test) return false;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if (test) &#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">function foo() &#123; return false; &#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function bar() &#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>16.2 åœ¨å¤šè¡Œif-elseä¸­elseæ”¾åœ¨ifç»“æŸæ‹¬å·å eslint:brace-style</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">if (test) &#123;</span><br><span class="line">    thing1();</span><br><span class="line">    thing2();</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">    thing3();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if (test) &#123;</span><br><span class="line">    thing1();</span><br><span class="line">    thing2();</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    thing3();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>16.3 å¦‚æœifè¯­å¥é‡Œæœ‰returnè¯­å¥,æ¥ä¸‹æ¥çš„elseå—æ˜¯ä¸å¿…è¦çš„. eslint: no-else-return</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function foo() &#123;</span><br><span class="line">    if (x) &#123;</span><br><span class="line">        return x;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">function cats() &#123;</span><br><span class="line">    if (x) &#123;</span><br><span class="line">        return x;</span><br><span class="line">    &#125; else if (y) &#123;</span><br><span class="line">        return y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">function dogs() &#123;</span><br><span class="line">    if (x) &#123;</span><br><span class="line">        return x;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        if (y) &#123;</span><br><span class="line">        return y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function foo() &#123;</span><br><span class="line">    if (x) &#123;</span><br><span class="line">        return x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function cats() &#123;</span><br><span class="line">    if (x) &#123;</span><br><span class="line">        return x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (y) &#123;</span><br><span class="line">        return y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//good</span><br><span class="line">function dogs(x) &#123;</span><br><span class="line">    if (x) &#123;</span><br><span class="line">        if (z) &#123;</span><br><span class="line">        return y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return z;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="æ§åˆ¶è¯­å¥-Control-Statements"><a href="#æ§åˆ¶è¯­å¥-Control-Statements" class="headerlink" title="æ§åˆ¶è¯­å¥(Control Statements)"></a>æ§åˆ¶è¯­å¥(Control Statements)</h2><ul>
<li>17.1 åœ¨æ§åˆ¶è¯­å¥ä¸­å¦‚æœå¤ªé•¿æˆ–è€…è¶…è¿‡äº†ä¸€è¡Œçš„æœ€å¤§é•¿åº¦ï¼Œå°†æ¯ä¸ªï¼ˆæ±‡åˆï¼‰æ¡ä»¶æ”¾åœ¨ä¸€ä¸ªæ–°è¡Œ.é€»è¾‘è¿ç®—ç¬¦åº”è¯¥åœ¨è¡Œçš„å¼€å¤´(è¯‘è€…æ³¨ï¼šè¿™ä¸ªæˆ‘è‡ªå·±æ”¾åœ¨è¡Œå°¾)<blockquote>
<p>ä¸ºä»€ä¹ˆ?è¦æ±‚æ“ä½œç¬¦æ”¾åœ¨æ¯è¡Œçš„å¼€å§‹ï¼Œè¿™æ˜¯ä¸ºäº†å’Œæ–¹æ³•é“¾è°ƒç”¨æ–¹å¼ä¿æŒä¸€è‡´å’Œå¯¹é½.åŒæ ·è¿™ä¹Ÿæé«˜äº†å¯è¯»æ€§</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">if ((foo === 123 || bar === &#x27;abc&#x27;) &amp;&amp; doesItLookGoodWhenItBecomesThatLong() &amp;&amp; isThisReallyHappening()) &#123;</span><br><span class="line">    thing1();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">if (foo === 123 &amp;&amp;</span><br><span class="line">bar === &#x27;abc&#x27;) &#123;</span><br><span class="line">    thing1();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">if (foo === 123</span><br><span class="line">&amp;&amp; bar === &#x27;abc&#x27;) &#123;</span><br><span class="line">    thing1();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">if (</span><br><span class="line">foo === 123 &amp;&amp;</span><br><span class="line">bar === &#x27;abc&#x27;</span><br><span class="line">) &#123;</span><br><span class="line">    thing1();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if (</span><br><span class="line">foo === 123</span><br><span class="line">&amp;&amp; bar === &#x27;abc&#x27;</span><br><span class="line">) &#123;</span><br><span class="line">    thing1();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if (</span><br><span class="line">(foo === 123 || bar === &quot;abc&quot;)</span><br><span class="line">&amp;&amp; doesItLookGoodWhenItBecomesThatLong()</span><br><span class="line">&amp;&amp; isThisReallyHappening()</span><br><span class="line">) &#123;</span><br><span class="line">    thing1();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if (foo === 123 &amp;&amp; bar === &#x27;abc&#x27;) &#123;</span><br><span class="line">    thing1();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h2 id="æ³¨é‡Š-Comments"><a href="#æ³¨é‡Š-Comments" class="headerlink" title="æ³¨é‡Š(Comments)"></a>æ³¨é‡Š(Comments)</h2><ul>
<li><p>18.1 å¯¹äºå¤šè¡Œæ³¨é‡Šä½¿ç”¨ &#x2F;** â€¦ *&#x2F;</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">// make() returns a new element</span><br><span class="line">// based on the passed in tag name</span><br><span class="line">//</span><br><span class="line">// @param &#123;String&#125; tag</span><br><span class="line">// @return &#123;Element&#125; element</span><br><span class="line">function make(tag) &#123;</span><br><span class="line"></span><br><span class="line">    // ...</span><br><span class="line"></span><br><span class="line">    return element;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">/**</span><br><span class="line">* make() returns a new element</span><br><span class="line">* based on the passed-in tag name</span><br><span class="line">*/</span><br><span class="line">function make(tag) &#123;</span><br><span class="line"></span><br><span class="line">    // ...</span><br><span class="line"></span><br><span class="line">    return element;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>18.2 å¯¹äºå•è¡Œæ³¨é‡Šä½¿ç”¨&#x2F;&#x2F;,å°†å•è¡Œæ³¨é‡Šæ”¾åœ¨æ–°ä¸€è¡Œçš„ä¸Šé¢ï¼Œå¹¶ä¸”åœ¨å•è¡Œæ³¨é‡Šå‰åŠ ä¸€ä¸ªç©ºè¡Œé™¤éè¿™ä¸ªæ³¨é‡Šåœ¨å—çº§çš„å¤´éƒ¨</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const active = true; // is current tab</span><br><span class="line"></span><br><span class="line">// good </span><br><span class="line">// is current tab</span><br><span class="line">const active = true</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">function getType() &#123;</span><br><span class="line">    console.log(&#x27;fetching type...&#x27;);</span><br><span class="line">    // set the default type to &#x27;no type&#x27;</span><br><span class="line">    const type = this.type || &#x27;no type&#x27;;</span><br><span class="line"></span><br><span class="line">    return type;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function getType() &#123;</span><br><span class="line">    console.log(&#x27;fetching type...&#x27;);</span><br><span class="line"></span><br><span class="line">    // set the default type to &#x27;no type&#x27;</span><br><span class="line">    const type = this.type || &#x27;no type&#x27;;</span><br><span class="line"></span><br><span class="line">    return type;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// also good</span><br><span class="line">function getType() &#123;</span><br><span class="line">    // set the default type to &#x27;no type&#x27;</span><br><span class="line">    const type = this.type || &#x27;no type&#x27;;</span><br><span class="line"></span><br><span class="line">    return type;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>18.3 åœ¨æ‰€æœ‰çš„æ³¨é‡Šå‰éƒ½åŠ ä¸€ä¸ªç©ºæ ¼è¿™æ ·æ›´æ˜“é˜…è¯». eslint: spaced-comment</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">//is current tab</span><br><span class="line">const active = true;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">// is current tab</span><br><span class="line">const active = true;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">/**</span><br><span class="line">*make() returns a new element</span><br><span class="line">*based on the passed-in tag name</span><br><span class="line">*/</span><br><span class="line">function make(tag) &#123;</span><br><span class="line"></span><br><span class="line">    // ...</span><br><span class="line"></span><br><span class="line">    return element;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">/**</span><br><span class="line">* make() returns a new element</span><br><span class="line">* based on the passed-in tag name</span><br><span class="line">*/</span><br><span class="line">function make(tag) &#123;</span><br><span class="line"></span><br><span class="line">    // ...</span><br><span class="line"></span><br><span class="line">    return element;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>18.4 åœ¨æ³¨é‡Šå‰åŠ ä¸€ä¸ªFIXME æˆ–è€… TODO æ¥å¸®åŠ©å…¶ä»–å¼€å‘è€…è¿…é€Ÿçš„å®šä½é—®é¢˜ï¼Œæˆ–è€…ä½ å»ºè®®ä¸€ä¸ªè§£å†³æ–¹æ¡ˆå°†è¦å®æ–½. å®ƒä»¬éƒ½ä¸åŒäºæ™®é€šçš„æ³¨é‡Šå› ä¸ºå®ƒä»¬æ˜¯å¯å®æ–½çš„. FIXMEï¼šè¿™ä¸ªåŠ¨ä½œéœ€è¦ç†æ¸…ï¼ŒTODOLï¼šéœ€è¦å®æ–½</p>
</li>
<li><p>18.5 ç”¨ &#x2F;&#x2F; FIXME: æ¥æ ‡æ˜é—®é¢˜</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class Calculator extends Abacus &#123;</span><br><span class="line">    constructor() &#123;</span><br><span class="line">        super();</span><br><span class="line"></span><br><span class="line">        // FIXME: è¿™é‡Œä¸åº”è¯¥æœ‰å…¨å±€å˜é‡</span><br><span class="line">        total = 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>18.6 ä½¿ç”¨&#x2F;&#x2F; TODO: æ¥æ ‡æ˜è§£å†³é—®çš„æ–¹æ¡ˆ</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class Calculator extends Abacus &#123;</span><br><span class="line">    constructor() &#123;</span><br><span class="line">        super();</span><br><span class="line"></span><br><span class="line">        // TODO: totalåº”è¯¥é€šè¿‡ä¸€ä¸ªé€‰é¡¹å‚æ•°é…ç½®</span><br><span class="line">        this.total = 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="ç©ºç™½ç¬¦"><a href="#ç©ºç™½ç¬¦" class="headerlink" title="ç©ºç™½ç¬¦"></a>ç©ºç™½ç¬¦</h2><ul>
<li><p>19.1 ä½¿ç”¨è½¯tabs(ç©ºæ ¼é”®)æ¥è®¾ç½®2ä¸ªç©ºæ ¼ eslint: indent</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function foo() &#123;</span><br><span class="line">....let name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">function foo() &#123;</span><br><span class="line">.let name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good </span><br><span class="line">function baz() &#123;</span><br><span class="line">..let name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>19.2 åœ¨å¤§æ‹¬å·ä¹‹å‰ä½¿ç”¨ä¸€ä¸ªç©ºæ ¼ eslint: space-before-blocks</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function test()&#123;</span><br><span class="line">    console.log(&#x27;test&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">funtcion test() &#123;</span><br><span class="line">    console.log(&#x27;test&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad </span><br><span class="line">dog.set(&#x27;attr&#x27;,&#123;</span><br><span class="line">    age: &#x27;1 year&#x27;,</span><br><span class="line">    breed: &#x27;Bernese Mountain Dog&#x27;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">dog.set(&#x27;attr&#x27;, &#123;</span><br><span class="line">    age: &#x27;1 year&#x27;,</span><br><span class="line">    breed: &#x27;Bernese Mountain Dog&#x27;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>19.3 åœ¨æ§åˆ¶è¯­å¥ä¸­(if,while)çš„å¼€å§‹åœ†æ‹¬å·å‰åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œè€Œåœ¨å‚æ•°åˆ—å’Œå‡½æ•°å£°æ˜ä¸è°ƒç”¨ä¸åŠ ç©ºæ ¼. eslint: keyword-spaceing</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">if(isJedi) &#123;</span><br><span class="line">    fight ();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if (isJedi) &#123;</span><br><span class="line">    fight();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">function fight () &#123;</span><br><span class="line">    console.log (&#x27;Swoosh!&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function fight() &#123;</span><br><span class="line">    console.log(&#x27;Swoosh!&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>19.4 åœ¨æ“ä½œç¬¦å‰åŠ ç©ºæ ¼. eslint: space-infix-ops</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const x=y+4;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const x = x + 5;</span><br></pre></td></tr></table></figure>
</li>
<li><p>19.5 åœ¨æ–‡ä»¶ç»“æŸå¤„åŠ ä¸€ä¸ªæ¢è¡Œç¬¦. eslint:eol-last</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">import &#123; es6 &#125; from &#x27;./AirbnbStyleGuide&#x27;;</span><br><span class="line">// ...</span><br><span class="line">export default es6;</span><br></pre></td></tr></table></figure>

  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">import &#123; es6 &#125; from &#x27;./AirbnbStyleGuide&#x27;;</span><br><span class="line">// ...</span><br><span class="line">export default es6;â†µ</span><br><span class="line">â†µ</span><br></pre></td></tr></table></figure>

  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// good</span><br><span class="line">import &#123; es6 &#125; from &#x27;./AirbnbStyleGuide&#x27;;</span><br><span class="line">// ...</span><br><span class="line">export default es6;â†µ</span><br></pre></td></tr></table></figure>
</li>
<li><p>19.6 å½“æ–¹æ³•è°ƒç”¨å¾ˆé•¿æ—¶(è¶…è¿‡ä¸¤ä¸ªæ–¹æ³•è°ƒç”¨é“¾)ä½¿ç”¨ç¼©å‡.å¼€å¤´å‡ºä½¿ç”¨ç‚¹è°ƒç”¨ï¼Œè¿™æ„å‘³ç€è¿™è¡Œæ˜¯æ–¹æ³•è°ƒç”¨ï¼Œç›¸åçš„æ˜¯æ–°çš„è¯­å¥ä¸ç”¨ eslint: newline-per-chained-call no-whitespace-before-property</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">$(&#x27;#items&#x27;).find(&#x27;.selected&#x27;).highlight().end().find(&#x27;.open&#x27;).updateCount();</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">$(&#x27;#items&#x27;).</span><br><span class="line">    find(&#x27;.selected&#x27;).</span><br><span class="line">        highlight().</span><br><span class="line">        end().</span><br><span class="line">    find(&#x27;.open&#x27;).</span><br><span class="line">        updateCount();</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">$(&#x27;#items&#x27;)</span><br><span class="line">    .find(&#x27;.selected&#x27;)</span><br><span class="line">        .heighLight()</span><br><span class="line">        .end()</span><br><span class="line">    .find(&#x27;.open&#x27;)</span><br><span class="line">        .undateCount();</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const leds = stage.selectAll(&#x27;.led&#x27;).data(data).enter().append(&#x27;svg:svg&#x27;).classed(&#x27;led&#x27;, true)</span><br><span class="line">    .attr(&#x27;width&#x27;, (radius + margin) * 2).append(&#x27;svg:g&#x27;)</span><br><span class="line">    .attr(&#x27;transform&#x27;, `translate($&#123;radius + margin&#125;,$&#123;radius + margin&#125;)`)</span><br><span class="line">    .call(tron.led);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const leds = stage.selectAll(&#x27;.led&#x27;)</span><br><span class="line">    .data(data)</span><br><span class="line">.enter().append(&#x27;svg:svg&#x27;)</span><br><span class="line">    .classed(&#x27;led&#x27;, true)</span><br><span class="line">    .attr(&#x27;width&#x27;, (radius + margin) * 2)</span><br><span class="line">.append(&#x27;svg:g&#x27;)</span><br><span class="line">    .attr(&#x27;transform&#x27;, `translate($&#123;radius + margin&#125;,$&#123;radius + margin&#125;)`)</span><br><span class="line">    .call(tron.led);    </span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const leds = stage.selectAll(&#x27;.led&#x27;).data(data);    </span><br><span class="line">    </span><br></pre></td></tr></table></figure>
</li>
<li><p>19.7 åœ¨æ¯ä¸ªå—çº§ç»“æŸä¹‹åæ–°è¯­å¥å¼€å§‹ä¹‹å‰ç•™ä¸€ä¸ªç©ºåŒ…è¡Œ</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">if (foo) &#123;</span><br><span class="line">    return bar;</span><br><span class="line">&#125;</span><br><span class="line">return baz;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if (foo) &#123;</span><br><span class="line">    return bar;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return baz;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const obj = &#123;</span><br><span class="line">    foo() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    bar() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">return obj;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const obj = &#123;</span><br><span class="line">    foo() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    bar() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">return obj;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const arr = [</span><br><span class="line">    function foo() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    function foo() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">];</span><br><span class="line">return arr;</span><br><span class="line"></span><br><span class="line">// good </span><br><span class="line">const arr = [</span><br><span class="line">    function foo() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    function bar() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">return arr;</span><br></pre></td></tr></table></figure>
</li>
<li><p>19.8 ä¸è¦åœ¨æ–°çš„å—å¤´éƒ¨åŠ ç©ºç™½è¡Œ</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function bar() &#123;</span><br><span class="line"></span><br><span class="line">    console.log(foo);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">if (baz) &#123;</span><br><span class="line"></span><br><span class="line">    console.log(qux);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    console.log(foo);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">class Foo &#123;</span><br><span class="line"></span><br><span class="line">    constructor(bar) &#123;</span><br><span class="line">        this.bar = bar;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function bar() &#123;</span><br><span class="line">    console.log(foo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if (baz) &#123;</span><br><span class="line">    console.log(qux);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    console.log(foo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>19.9 ä¸è¦åœ¨åœ†æ‹¬å·é‡ŒåŠ é¢å¤–çš„ç©ºæ ¼ eslint: space-in-parens</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function bar( foo ) &#123;</span><br><span class="line">    return foo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function bar(foo) &#123;</span><br><span class="line">    return foo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">if ( foo ) &#123;</span><br><span class="line">    console.log(foo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if (foo) &#123;</span><br><span class="line">    console.log(foo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>19.10 ä¸è¦åœ¨æ–¹æ‹¬å·é‡ŒåŠ ç©ºæ ¼ eslint:array-bracket-spacing</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const foo = [ 1, 2, 3 ];</span><br><span class="line">console.log(foo[ 0 ]);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const foo = [1, 2, 3];</span><br><span class="line">console.log(foo[0]);</span><br></pre></td></tr></table></figure></li>
<li><p>19.11 åœ¨å¤§æ‹¬å·é‡ŒåŠ ç©ºæ ¼ eslint: object-curly-spacing</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const foo = &#123;clark: &#x27;kent&#x27;&#125;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const foo = &#123; clark: &#x27;kent&#x27; &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>19.12 é¿å…æ¯ä¸€è¡Œçš„ä»£ç è¶…è¿‡100ä¸ªå­—ç¬¦(åŒ…æ‹¬ç©ºæ ¼). æ³¨æ„: ä¸Šé¢çš„é•¿å­—ç¬¦ä¸²(6.2)æ˜¯è¿™ä¸ªè§„åˆ™çš„ä¾‹å¤–,å…¶ä½™çš„éƒ½ä¸åº”è¯¥ç ´åè¿™æ¡è§„åˆ™. eslintï¼š max-len</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? è¿™æ ·ç¡®ä¿å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const foo = jsonData &amp;&amp; jsonData.foo &amp;&amp; jsonData.foo.bar &amp;&amp; jsonData.foo.bar.baz &amp;&amp; jsonData.foo.bar.baz.quux &amp;&amp; jsonData.foo.bar.baz.quux.xyzzy;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">$.ajax(&#123; method: &#x27;POST&#x27;, url: &#x27;https://airbnb.com/&#x27;, data: &#123; name: &#x27;John&#x27; &#125; &#125;).done(() =&gt; console.log(&#x27;Congratulations!&#x27;)).fail(() =&gt; console.log(&#x27;You have failed this city.&#x27;));</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const foo = jsonData</span><br><span class="line">    &amp;&amp; jsonData.foo</span><br><span class="line">    &amp;&amp; jsonData.foo.bar</span><br><span class="line">    &amp;&amp; jsonData.foo.bar.baz</span><br><span class="line">    &amp;&amp; jsonData.foo.bar.baz.quux</span><br><span class="line">    &amp;&amp; jsonData.foo.bar.baz.quux.xyzzy;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    method: &#x27;POST&#x27;,</span><br><span class="line">    url: &#x27;https://airbnb.com/&#x27;,</span><br><span class="line">    data: &#123; name: &#x27;John&#x27; &#125;,</span><br><span class="line">&#125;)</span><br><span class="line">    .done(() =&gt; console.log(&#x27;Congratulations!&#x27;))</span><br><span class="line">    .fail(() =&gt; console.log(&#x27;You have failed this city.&#x27;));</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h2 id="é€—å·-Commas"><a href="#é€—å·-Commas" class="headerlink" title="é€—å·(Commas)"></a>é€—å·(Commas)</h2><ul>
<li><p>20.1 ä¸å¯ä»¥ä»¥é€—å·å¼€å¤´. eslint: comma-style</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const story = [</span><br><span class="line">    once</span><br><span class="line">    , upon</span><br><span class="line">    , aTime</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const story = [</span><br><span class="line">    once,</span><br><span class="line">    upon,</span><br><span class="line">    aTime,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const hero = &#123;</span><br><span class="line">    firstName: &#x27;Ada&#x27;</span><br><span class="line">    , lastName: &#x27;Lovelace&#x27;</span><br><span class="line">    , birthYear: 1815</span><br><span class="line">    , superPower: &#x27;computers&#x27;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const hero = &#123;</span><br><span class="line">    firstName: &#x27;Ada&#x27;,</span><br><span class="line">    lastName: &#x27;Lovelace&#x27;,</span><br><span class="line">    birthYear: 1815,</span><br><span class="line">    superPower: &#x27;computers&#x27;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>20.2 æ·»åŠ å°¾é€—å·. eslint: comma-dangle</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ?(è¯‘è€…ï¼šä¸ªäººä¸å¤ªç¨€é¥­) è¿™å¯¹äºgit diffsæ›´åŠ æ•´æ´,åŒæ—¶å‘Babelè¿™ä¸ªæ ·çš„ç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘çš„æ—¶å€™å»æ‰å°¾é€—å·ï¼Œè¿™å°±æ„å‘³ç€åœ¨åˆæ³•çš„æµè§ˆå™¨ä¸­ä½ ä¸ç”¨æ‹…å¿ƒ<a href="https://github.com/airbnb/javascript/blob/es5-deprecated/es5/README.md#commas">å°¾é€—å·é—®é¢˜</a></p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad - git diff without trailing comma</span><br><span class="line">const hero = &#123;</span><br><span class="line">    firstName: &#x27;Florence&#x27;,</span><br><span class="line">-    lastName: &#x27;Nightingale&#x27;</span><br><span class="line">+    lastName: &#x27;Nightingale&#x27;,</span><br><span class="line">+    inventorOf: [&#x27;coxcomb chart&#x27;, &#x27;modern nursing&#x27;]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// good - git diff with trailing comma</span><br><span class="line">const hero = &#123;</span><br><span class="line">    firstName: &#x27;Florence&#x27;,</span><br><span class="line">    lastName: &#x27;Nightingale&#x27;,</span><br><span class="line">+    inventorOf: [&#x27;coxcomb chart&#x27;, &#x27;modern nursing&#x27;],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</blockquote>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const hero = &#123;</span><br><span class="line">    firstName: &#x27;Dana&#x27;,</span><br><span class="line">    lastName: &#x27;Scully&#x27;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const heroes = [</span><br><span class="line">    &#x27;Batman&#x27;,</span><br><span class="line">    &#x27;Superman&#x27;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const hero = &#123;</span><br><span class="line">    firstName: &#x27;Dana&#x27;,</span><br><span class="line">    lastName: &#x27;Scully&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const heroes = [</span><br><span class="line">    &#x27;Batman&#x27;,</span><br><span class="line">    &#x27;Superman&#x27;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">function createHero(</span><br><span class="line">    firstName,</span><br><span class="line">    lastName,</span><br><span class="line">    inventorOf</span><br><span class="line">) &#123;</span><br><span class="line">// does nothing</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function createHero(</span><br><span class="line">    firstName,</span><br><span class="line">    lastName,</span><br><span class="line">    inventorOf,</span><br><span class="line">) &#123;</span><br><span class="line">    // does nothing</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good (æ³¨æ„é€—å·ä¸èƒ½åœ¨&quot;rest&quot;å…ƒç´ å)</span><br><span class="line">function createHear(</span><br><span class="line">    frstName,</span><br><span class="line">    lastName.</span><br><span class="line">    inventorOf,</span><br><span class="line">    ...heroArs</span><br><span class="line">) &#123;</span><br><span class="line">    // does nothing</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">createHero(</span><br><span class="line">    firstName,</span><br><span class="line">    lastName,</span><br><span class="line">    inventorOf</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">createHero(</span><br><span class="line">    firstName,</span><br><span class="line">    lastName,</span><br><span class="line">    inventorOf,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">// good (note that a comma must not appear after a &quot;rest&quot; element)</span><br><span class="line">createHero(</span><br><span class="line">    firstName,</span><br><span class="line">    lastName,</span><br><span class="line">    inventorOf,</span><br><span class="line">    ...heroArgs</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="åˆ†å·-Semicolons"><a href="#åˆ†å·-Semicolons" class="headerlink" title="åˆ†å·(Semicolons)"></a>åˆ†å·(Semicolons)</h2><ul>
<li>21.1 æ˜¯æ»´ eslint: semi  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">(function () &#123;</span><br><span class="line">    const name = &#x27;Skywalker&#x27;</span><br><span class="line">    return name</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">(function () &#123;</span><br><span class="line">    const name = &#x27;Skywalker&#x27;;</span><br><span class="line">    return name;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line">// good, but legacy (guards against the function becoming an argument when two files with IIFEs are concatenated)</span><br><span class="line">;((() =&gt; &#123;</span><br><span class="line">    const name = &#x27;Skywalker&#x27;;</span><br><span class="line">    return name;</span><br><span class="line">&#125;)());</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="ç±»å‹è½¬æ¢å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢-Type-Casting-amp-Coercion"><a href="#ç±»å‹è½¬æ¢å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢-Type-Casting-amp-Coercion" class="headerlink" title="ç±»å‹è½¬æ¢å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢(Type Casting &amp; Coercion)"></a>ç±»å‹è½¬æ¢å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢(Type Casting &amp; Coercion)</h2><ul>
<li><p>22.1 åœ¨è¯­å¥çš„å¼€å¤´æ‰§è¡Œå¼ºåˆ¶ç±»å‹è½¬åŒ–</p>
</li>
<li><p>22.2 å­—ç¬¦ä¸²ï¼šeslint: no-new-wrappers</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// =&gt; this.reviewScore = 9;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const totalScore = new String(this.reviewScore); // typeof totalScore æ˜¯&quot;object&quot;è€Œä¸æ˜¯&quot;string&quot;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const totalScore = this.reviewSore + &#x27;&#x27;; // ä¼šè§¦å‘this.reviewScore.valueOf()</span><br><span class="line"></span><br><span class="line">// bad </span><br><span class="line">const totalScore = this.reviewScore.toStirng();// ä¸èƒ½ä¿è¯æ˜¯è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²,è¿™ä¸ªæ–¹æ³•æœ‰å¯èƒ½è¢«è¦†ç›–æ‰</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const totalScore = String(this.reviewScore)</span><br></pre></td></tr></table></figure>
</li>
<li><p>22.3 æ•°å­—ï¼šä½¿ç”¨Numberæ¥ç±»å‹è½¬æ¢ï¼Œä½¿ç”¨parseIntæ€»æ˜¯éœ€è¦ä¸€ä¸ªåŸºæ•°(radix) eslint: redix no-new-wrappers</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const inputValue = &#x27;4&#x27;;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const val = new Number(inputValue);</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const val = inputValue &gt;&gt; 0;</span><br><span class="line"></span><br><span class="line">// bad </span><br><span class="line">const val = parseInt(inputValue);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const val = Number(inputValue);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const val = parseInt(inputValue, 10);</span><br></pre></td></tr></table></figure>
</li>
<li><p>22.4 å¦‚æœä½ å› ä¸ºæŸç§åŸå› è€Œåšä¸€äº›ç–¯ç‹‚äº‹parseIntä¸èƒ½æ»¡è¶³ä½ çš„æ€§èƒ½è¦æ±‚ä½ éœ€è¦ä½¿ç”¨ä½è¿ç®—ï¼Œå†™ä¸€äº›æ³¨é‡Šæ¥è§£é‡Šä¸ºä»€ä¹ˆä½ è¿™æ ·åš.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// good</span><br><span class="line">/**</span><br><span class="line">* parseIntæ˜¯æˆ‘è¿™æ®µä»£ç æ…¢çš„åŸå› </span><br><span class="line">* ä½è¿ç®—å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">const val = inputValue &gt;&gt; 0;</span><br></pre></td></tr></table></figure>
</li>
<li><p>22.5 æ³¨æ„ï¼šä½¿ç”¨ä½è¿ç®—æ“ä½œç¬¦æ—¶ï¼Œè¿ç®—å‰æ•°å­—ä»£è¡¨çš„æ˜¯64ä½çš„å€¼ï¼Œä½†æ˜¯ä½è¿ç®—åè¿”å›çš„æ˜¯ä¸€ä¸ª32ä½çš„æ•´æ•°(<a href="https://es5.github.io/#x11.7">source</a>),ä½è¿ç®—å¯¹äºè¶…è¿‡32ä½çš„æ•´æ•°å¯ä»¥å¼•èµ·ä¸å¯é¢„æ–™çš„è¡¨ç°è¡Œä¸º.æœ€å¤§çš„32ä½æ•´æ•°2,147,483,647:</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2147483647 &gt;&gt; 0; // =&gt; 2147483647</span><br><span class="line">2147483648 &gt;&gt; 0; // =&gt; -2147483648</span><br><span class="line">2147483649 &gt;&gt; 0; // =&gt; -2147483647</span><br></pre></td></tr></table></figure>
</li>
<li><p>22.6 å¸ƒå°”ï¼š eslint: no-new-wrappers</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const age = 0;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const hasAge = new Boolean(age);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const hasAge = Boolean(age);</span><br><span class="line"></span><br><span class="line">// best</span><br><span class="line">const hasAge = !!age;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="å‘½åä¹ ä¿—-Naming-Conventions"><a href="#å‘½åä¹ ä¿—-Naming-Conventions" class="headerlink" title="å‘½åä¹ ä¿— (Naming Conventions)"></a>å‘½åä¹ ä¿— (Naming Conventions)</h2><ul>
<li><p>23.1 é¿å…å•ä¸ªå­—æ¯å‘½åï¼Œä½¿ç”¨æè¿°æ€§å‘½å. eslint: id-length</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function q() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function query() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
</li>
<li><p>23.2 ä½¿ç”¨é©¼å³°å‘½åï¼šå¯¹è±¡,å‡½æ•°,å®ä¾‹. eslint: camelcase</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const OBJEcttsssss = &#123;&#125;;</span><br><span class="line">const this_is_my_object = &#123;&#125;;</span><br><span class="line">function c() &#123;&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const thisIsMyObject = &#123;&#125;;</span><br><span class="line">function thisIsMyFunction() &#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>23.3 åœ¨å‘½åæ„é€ å‡½æ•°æˆ–è€…ç±»æ—¶ä½¿ç”¨ é¦–å­—æ¯å¤§å†™  eslint: new-cap</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function user(options) &#123;</span><br><span class="line">    this.name = options.name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const bad = new user(&#123;</span><br><span class="line">    name: &#x27;nope&#x27;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">class User &#123;</span><br><span class="line">    constructor(options) &#123;</span><br><span class="line">        this.name = options.name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const good = new User(&#123;</span><br><span class="line">    name: &#x27;yup&#x27;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>23.4 ä¸è¦åœ¨å¤´å°¾ä½¿ç”¨ä¸‹åˆ’çº¿. eslint: no-underscore-dangle</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ? jså¯¹äºå±æ€§æˆ–è€…æ–¹æ³•éƒ½æ²¡æœ‰ç§æœ‰çš„æ¦‚å¿µï¼Œè™½ç„¶å‰ç½®ä¸‹åˆ’çº¿æŒ‰ä¹ ä¿—æ¥è®²æ˜¯ä¸€ä¸ªç§æœ‰çš„(private).äº‹å®ä¸Š,è¿™äº›å¸¦ä¸‹åˆ’çº¿çš„å±æ€§æ˜¯å®Œå…¨å…¬å¼€çš„,å¹¶ä¸”å­˜åœ¨äºä½ çš„å…¬å…±APIæ¥å£ä¸­ï¼Œè¿™ä¸ªä¹ ä¿—è®©å¼€å‘è€…é”™è¯¯çš„è®¤ä¸ºä¸€ç‚¹æ”¹å˜ä¸ä¼šæ˜¯ç ´åï¼Œæˆ–è€…ä¸éœ€è¦æµ‹è¯•ï¼Œå¦‚æœä½ æƒ³è¦æŸäº›ä¸œè¥¿çœŸçš„ç§æœ‰(â€œprivateâ€),ä½ å¿…é¡»è®©ä»–ä¸å¯ä»¥è§‚å¯Ÿçš„å‘ˆç°.</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">this.__firstName__ = &#x27;Panda&#x27;;</span><br><span class="line">this.firstName_ = &#x27;Panda&#x27;;</span><br><span class="line">this._firstName = &#x27;Panda&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">this.firstName = &#x27;Panda&#x27;;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>23.5 å¸Œæœ›ä¸è¦ä¿å­˜thiså¼•ç”¨.ä¸ä¹‹ä»£æ›¿çš„æ˜¯ä½¿ç”¨ç®­å¤´å‡½æ•°æˆ–è€…å‡½æ•°ç»‘å®š</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function foo() &#123;</span><br><span class="line">    const self = this;</span><br><span class="line">    return function () &#123;</span><br><span class="line">        console.log(self);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">function foo() &#123;</span><br><span class="line">    const that = this;</span><br><span class="line">    return function () &#123;</span><br><span class="line">        console.log(that);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function foo() &#123;</span><br><span class="line">    return () =&gt; &#123;</span><br><span class="line">        console.log(this);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>23.6 ä¸€ä¸ªåŸºæœ¬æ–‡ä»¶ååº”è¯¥å’Œé»˜è®¤å¯¼å‡º(default export)ç›¸åŒ¹é…</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> // file 1 contents</span><br><span class="line">class CheckBox &#123;</span><br><span class="line">// ...</span><br><span class="line">&#125;</span><br><span class="line">export default CheckBox;</span><br><span class="line"></span><br><span class="line">// file 2 contents</span><br><span class="line">export default function fortyTwo() &#123; return 42; &#125;</span><br><span class="line"></span><br><span class="line">// file 3 contents</span><br><span class="line">export default function insideDirectory() &#123;&#125;</span><br><span class="line"></span><br><span class="line">// in some other file</span><br><span class="line">// bad</span><br><span class="line">import CheckBox from &#x27;./checkBox&#x27;; // PascalCase import/export, camelCase filename</span><br><span class="line">import FortyTwo from &#x27;./FortyTwo&#x27;; // PascalCase import/filename, camelCase export</span><br><span class="line">import InsideDirectory from &#x27;./InsideDirectory&#x27;; // PascalCase import/filename, camelCase export</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">import CheckBox from &#x27;./check_box&#x27;; // PascalCase import/export, snake_case filename</span><br><span class="line">import forty_two from &#x27;./forty_two&#x27;; // snake_case import/filename, camelCase export</span><br><span class="line">import inside_directory from &#x27;./inside_directory&#x27;; // snake_case import, camelCase export</span><br><span class="line">import index from &#x27;./inside_directory/index&#x27;; // requiring the index file explicitly</span><br><span class="line">import insideDirectory from &#x27;./insideDirectory/index&#x27;; // requiring the index file explicitly</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">import CheckBox from &#x27;./CheckBox&#x27;; // PascalCase export/import/filename</span><br><span class="line">import fortyTwo from &#x27;./fortyTwo&#x27;; // camelCase export/import/filename</span><br><span class="line">import insideDirectory from &#x27;./insideDirectory&#x27;; // camelCase export/import/directory name/implicit &quot;index&quot;</span><br><span class="line">// ^ supports both insideDirectory.js and insideDirectory/index.js   </span><br></pre></td></tr></table></figure>
</li>
<li><p>23.7 å½“é»˜è®¤å¯¼å‡ºä¸€ä¸ªå‡½æ•°ä½¿ç”¨é©¼å³°æ³•å‘½å,ä½ æ–‡ä»¶åç§°åº”è¯¥å’Œä½ å‡½æ•°åä¿å­˜ä¸€è‡´</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function makeStyleGuide() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default makeStyleGuide;</span><br></pre></td></tr></table></figure>
</li>
<li><p>23.8 å½“ä½ å¯¼å‡ºä¸€ä¸ªcontructor&#x2F; class&#x2F;å‡½æ•°åº“&#x2F;å•ç‹¬çš„å¯¹è±¡ ä½¿ç”¨é¦–PascalCase</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const AirbnbStyleGuide = &#123;</span><br><span class="line">    es6: &#123;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default AirbnbStyleGuide;</span><br></pre></td></tr></table></figure></li>
<li><p>23.9 ç¼©å†™æ˜¯ä¹Ÿåº”è¯¥é¦–å­—æ¯å¤§å†™ï¼Œå…¶ä½™å…¨ä¸ºå°å†™</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">import SmsContainer from &#x27;./containers/SmsContainer&#x27;;</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">const HttpRequests = [</span><br><span class="line">    // ...</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">import SMSContainer from &#x27;./containers/SMSContainer&#x27;;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const HTTPRequests = [</span><br><span class="line">    // ...</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">// also good</span><br><span class="line">const httpRequests = [</span><br><span class="line">// ...</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">// best</span><br><span class="line">import TextMessageContainer from &#x27;./containers/TextMessageContainer&#x27;;</span><br><span class="line"></span><br><span class="line">// best</span><br><span class="line">const requests = [</span><br><span class="line">    // ...</span><br><span class="line">];</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="å­˜å–å™¨-å­˜å–å™¨"><a href="#å­˜å–å™¨-å­˜å–å™¨" class="headerlink" title="å­˜å–å™¨(å­˜å–å™¨)"></a>å­˜å–å™¨(å­˜å–å™¨)</h2><ul>
<li><p>24.1 å¯¹äºå±æ€§å­˜å–å™¨å‡½æ•°ä¸æ˜¯å¿…è¦çš„</p>
</li>
<li><p>24.2 ä¸è¦ä½¿ç”¨jsçš„getters&#x2F;setterså› ä¸ºå®ƒä»¬ä¼šå¼•èµ·ä¸å¯é¢„æœŸçš„å‰¯ä½œç”¨å¹¶ä¸”éš¾äºæµ‹è¯•å’Œç»´æŠ¤ï¼Œå’Œæ¨ç†. å¦‚æœä½ ä¸€å®šè¦ä½¿ç”¨å­˜å–å‡½æ•°ä½¿ç”¨getVal()å’ŒsetVal(â€˜helloâ€™)</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">class Dragon &#123;</span><br><span class="line">    get age() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    set age(value) &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">class Dragon &#123;</span><br><span class="line">    getAge() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    setAge(value)&#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>24.3 å¦‚æœå±æ€§æˆ–æ–¹æ³•æ˜¯boolean,ä½¿ç”¨isVal()æˆ–è€…hasVal()</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">if(!dragon.age()) &#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">if(!dragon.hasAge())&#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>24.4 å¯ä»¥åˆ›å»ºget()å’Œset()å‡½æ•°ï¼Œä½†æ˜¯å¾—ä¿æŒä¸€è‡´</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class Jedi &#123;</span><br><span class="line">    constructor(options = &#123;&#125;) &#123;</span><br><span class="line">        const lightsaber = options.lightsaber || &#x27;blue&#x27;;</span><br><span class="line">        this.set(&#x27;lightsaber&#x27;, lightsaber);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    set(key, val) &#123;</span><br><span class="line">        this[key] = val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    get(key) &#123;</span><br><span class="line">        return this[key];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="äº‹ä»¶-Events"><a href="#äº‹ä»¶-Events" class="headerlink" title="äº‹ä»¶(Events)"></a>äº‹ä»¶(Events)</h2><ul>
<li>25.1 å½“æ·»åŠ æ•°æ®åŠ è½½åˆ°äº‹ä»¶ä¸­(åŸç”Ÿæˆ–è€…è‡ªå®šä¹‰),ä¼ å…¥ä¸€ä¸ªå“ˆå¸Œå€¼è€Œä¸æ˜¯åŸå§‹æ•°æ®,è¿™æ ·å¯ä»¥è®©åæ¥çš„å¼€å‘è€…æ·»åŠ æ›´å¤šæ•°æ®åˆ°äº‹ä»¶ä¸­æ—¶ä¸è¦å…ˆæ‰¾åˆ°æˆ–æ›´æ–°æ¯ä¸ªhandler,ä¹Ÿå°±æ˜¯è®©ä¼ å…¥å‚æ•°æ›´åŠ çµæ´».å¦‚ä¸‹ï¼š  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">$(this).trigger(&#x27;listingUpdated&#x27;, listing.id);</span><br><span class="line"></span><br><span class="line">// ...</span><br><span class="line"></span><br><span class="line">$(this).on(&#x27;listingUpdated&#x27;, (e, listingId) =&gt; &#123;</span><br><span class="line">    // do something with listingId</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">$(this).trigger(&#x27;listingUpdated&#x27;, &#123; listingId: listing.id &#125;);</span><br><span class="line"></span><br><span class="line">// ...</span><br><span class="line"></span><br><span class="line">$(this).on(&#x27;listingUpdated&#x27;, (e, data) =&gt; &#123;</span><br><span class="line">    // do something with data.listingId</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="jQuery"><a href="#jQuery" class="headerlink" title="jQuery"></a>jQuery</h2><ul>
<li><p>26.1 å¯¹æ¯ä¸ªjQueryå¯¹è±¡å˜é‡éƒ½åŠ ä¸ªå‰ç¼€$  jscs: requireDollarBeforejQueryAssignment</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">const sidebar = $(&#x27;.sidebar&#x27;);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const $sidebar = $(&#x27;.sidebar&#x27;);</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">const $sidebarBtn = $(&#x27;.sidebar-btn&#x27;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>26.2 ç¼“å­˜jqueryå¯¹è±¡</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">function setSidebar() &#123;</span><br><span class="line">    $(&#x27;.sidebar&#x27;).hide();</span><br><span class="line"></span><br><span class="line">    // ...</span><br><span class="line"></span><br><span class="line">    $(&#x27;.sidebar&#x27;).css(&#123;</span><br><span class="line">        &#x27;background-color&#x27;: &#x27;pink&#x27;,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">function setSidebar() &#123;</span><br><span class="line">    const $sidebar = $(&#x27;.sidebar&#x27;);</span><br><span class="line">    $sidebar.hide();</span><br><span class="line"></span><br><span class="line">    // ...</span><br><span class="line"></span><br><span class="line">    $sidebar.css(&#123;</span><br><span class="line">        &#x27;background-color&#x27;: &#x27;pink&#x27;,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>26.3 å¯¹äºDOMæŸ¥è¯¢ä½¿ç”¨å‚ç›´æŸ¥è¯¢$(â€˜.sidebar ulâ€™) æˆ–è€…&gt;  $(â€˜.sidebar &gt; ulâ€™)</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// bad</span><br><span class="line">$(&#x27;ul&#x27;, &#x27;.sidebar&#x27;).hide();</span><br><span class="line"></span><br><span class="line">// bad</span><br><span class="line">$(&#x27;.sidebar&#x27;).find(&#x27;ul&#x27;).hide();</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">$(&#x27;.sidebar ul&#x27;).hide();</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">$(&#x27;.sidebar &gt; ul&#x27;).hide();</span><br><span class="line"></span><br><span class="line">// good</span><br><span class="line">$sidebar.find(&#x27;ul&#x27;).hide();</span><br></pre></td></tr></table></figure>
</li>
<li><p>åŸæ–‡<img src="https://github.com/airbnb/javascript#arrow-functions" alt="Airbnb JavaScript Style Guide"></p>
</li>
</ul>
]]></content>
      <categories>
        <category>javscriptä»£ç è§„èŒƒ</category>
      </categories>
  </entry>
  <entry>
    <title>es6ç±»ä¸ç»§æ‰¿è¯­æ³•è¦ç‚¹</title>
    <url>/2017/11/08/es6%E7%B1%BB%E4%B8%8E%E7%BB%A7%E6%89%BF%E8%AF%AD%E6%B3%95%E8%A6%81%E7%82%B9/</url>
    <content><![CDATA[<h2 id="es6ç±»"><a href="#es6ç±»" class="headerlink" title="es6ç±»"></a>es6ç±»</h2><h3 id="es6ç±»ä¸es5ç±»å¯¹æ¯”"><a href="#es6ç±»ä¸es5ç±»å¯¹æ¯”" class="headerlink" title="es6ç±»ä¸es5ç±»å¯¹æ¯”"></a>es6ç±»ä¸es5ç±»å¯¹æ¯”</h3><p>es6å’Œes5çš„ç±»å£°æ˜å¾ˆç›¸ä¼¼ä½†æ˜¯ä¹Ÿæœ‰å¾ˆå¤šåŒºåˆ«ï¼š</p>
<ul>
<li>1 es6ç±»å£°æ˜æ˜¯æ²¡æœ‰å˜é‡æå‡å’Œä¸èƒ½é‡å¤å£°æ˜å’Œletä¸€æ ·ï¼Œä¹Ÿæ˜¯å°±è¯´åœ¨æ‰§è¡Œæ²¡åˆ°è¾¾å£°æ˜å‰ä¸å¯ä»¥ä½¿ç”¨</li>
<li>2 es6ç±»å£°æ˜ä¸­æ‰€æœ‰ä»£ç è‡ªåŠ¨åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹æ‰§è¡Œ</li>
<li>3 es6ç±»å£°æ˜ä¸­çš„æ‰€ç”¨çš„æ–¹æ³•éƒ½æ˜¯ä¸å¯æšä¸¾çš„ï¼Œåœ¨es5ä¸­å¯ä»¥ä½¿ç”¨Object.definePropertyå®ç°</li>
<li>4 es6ç±»å£°æ˜ä¸­çš„æ‰€æœ‰çš„æ–¹æ³•éƒ½ç¼ºå¤±å†…éƒ¨[[Construct]]å±æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸èƒ½å½“åšæ„é€ å‡½æ•°ä½¿ç”¨</li>
<li>5 es6ç±»å¿…é¡»ä½¿ç”¨newè°ƒç”¨ï¼Œå¦åˆ™æŠ¥é”™</li>
<li>6 ä¸èƒ½åœ¨es6ç±»å£°æ˜ä¸­ä¿®æ”¹ç±»å</li>
<li>7 es6æ˜ç¡®å£°æ˜classå†…éƒ¨åªèƒ½æœ‰é™æ€æ–¹æ³•ï¼Œæ²¡æœ‰é™æ€å±æ€§<span id="more"></span>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//es6 class</span><br><span class="line">class PersonType &#123;</span><br><span class="line">    constructor(name)&#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    static sayClassName()&#123;</span><br><span class="line">        console.log(this.name);// PersonType</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sayName()&#123;</span><br><span class="line">        console.log(this.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">PersonType.family = &quot;chen&quot;;</span><br><span class="line"></span><br><span class="line">// es5 calss(å¤§éƒ¨åˆ†æ˜¯es5)</span><br><span class="line">let personType = (function()&#123;</span><br><span class="line">    &quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">    // ç¡®ä¿å‡½æ•°æ˜¯ä½¿ç”¨newè°ƒç”¨çš„</span><br><span class="line">    const PersonType = function(name)&#123;</span><br><span class="line">        if(typeof new.target === &quot;undefined&quot;)&#123;</span><br><span class="line">            throw new Error(&quot;æ„é€ å‡½æ•°å¿…é¡»ä½¿ç”¨newè°ƒç”¨&quot;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    Object.defineProperty(PersonType,&quot;sayClassName&quot;,&#123;</span><br><span class="line">        value: function()&#123;</span><br><span class="line">            // ç¡®ä¿åŸå‹ä¸Šçš„æ–¹æ³•ä¸æ˜¯è¢«newè°ƒç”¨</span><br><span class="line">            if(typeof new.target !== &quot;undefined&quot;)&#123;</span><br><span class="line">                throw new Error(&quot;Method cannot be called with new.&quot;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            console.log(this.name)</span><br><span class="line">        &#125;,</span><br><span class="line">        enumerable: false,</span><br><span class="line">        writable: true,</span><br><span class="line">        configurable: true</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    PersonType.family = &quot;chen&quot;;</span><br><span class="line"></span><br><span class="line">    Object.defineProperty(PersonType.prototype,&quot;sayName&quot;,&#123;</span><br><span class="line">        value: function()&#123;</span><br><span class="line">            // ç¡®ä¿åŸå‹ä¸Šçš„æ–¹æ³•ä¸æ˜¯è¢«newè°ƒç”¨</span><br><span class="line">            if(typeof new.target !== &quot;undefined&quot;)&#123;</span><br><span class="line">                throw new Error(&quot;Method cannot be called with new.&quot;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            console.log(this.name)</span><br><span class="line">        &#125;,</span><br><span class="line">        enumerable: false,</span><br><span class="line">        writable: true,</span><br><span class="line">        configurable: true</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    return PersonType</span><br><span class="line">&#125;())</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="es6çš„ä¸€äº›æ–°åº”ç”¨"><a href="#es6çš„ä¸€äº›æ–°åº”ç”¨" class="headerlink" title="es6çš„ä¸€äº›æ–°åº”ç”¨"></a>es6çš„ä¸€äº›æ–°åº”ç”¨</h3><p>ç§æœ‰æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const sayName = Symbol(&#x27;sayName&#x27;);</span><br><span class="line"></span><br><span class="line">export default class personType&#123;</span><br><span class="line">    // å…±æœ‰æ–¹æ³•</span><br><span class="line">    sayAge()&#123;</span><br><span class="line">        console.log(&#x27;18å²&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // ç§æœ‰æ–¹æ³•</span><br><span class="line">    [sayName]()&#123;</span><br><span class="line">        console.log(&#x27;tianyu&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å­˜å–å‡½æ•°ï¼šå®ç°æ‹¦æˆªè¯¥å±æ€§çš„å­˜å–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// es5</span><br><span class="line">let CustomHTMLElement = (function() &#123;</span><br><span class="line"></span><br><span class="line">    &quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">    const CustomHTMLElement = function(element) &#123;</span><br><span class="line"></span><br><span class="line">        // ç¡®ä¿å‡½æ•°æ˜¯è¢«newè°ƒç”¨</span><br><span class="line">        if (typeof new.target === &quot;undefined&quot;) &#123;</span><br><span class="line">            throw new Error(&quot;Constructor must be called with new.&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        this.element = element;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Object.defineProperty(CustomHTMLElement.prototype, &quot;html&quot;, &#123;</span><br><span class="line">        enumerable: false,</span><br><span class="line">        configurable: true,</span><br><span class="line">        get: function() &#123;</span><br><span class="line">            return this.element.innerHTML;</span><br><span class="line">        &#125;,</span><br><span class="line">        set: function(value) &#123;</span><br><span class="line">            this.element.innerHTML = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    return CustomHTMLElement;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line">// es6</span><br><span class="line">class CustomHTMLElement &#123;</span><br><span class="line"></span><br><span class="line">    constructor(element) &#123;</span><br><span class="line">        this.element = element;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    get html() &#123;</span><br><span class="line">        return this.element.innerHTML;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    set html(value) &#123;</span><br><span class="line">        this.element.innerHTML = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var descriptor = Object.getOwnPropertyDescriptor(CustomHTMLElement.prototype, &quot;html&quot;);</span><br><span class="line">console.log(&quot;get&quot; in descriptor);   // true</span><br><span class="line">console.log(&quot;set&quot; in descriptor);   // true</span><br><span class="line">console.log(descriptor.enumerable); // false</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå®ç°äº†å¯¹åŸå‹ä¸Šhtmlå±æ€§çš„æ‹¦æˆªï¼Œä¸”è¿™ä¸ªå±æ€§ä¸å¯æšä¸¾,getå’Œseté‡Œå¼ºåˆ¶æ‰§è¡Œä¸¥æ ¼æ¨¡å¼ </p>
<h2 id="es6ç»§æ‰¿"><a href="#es6ç»§æ‰¿" class="headerlink" title="es6ç»§æ‰¿"></a>es6ç»§æ‰¿</h2><h3 id="es5å’Œes6ç»§æ‰¿å¯¹æ¯”"><a href="#es5å’Œes6ç»§æ‰¿å¯¹æ¯”" class="headerlink" title="es5å’Œes6ç»§æ‰¿å¯¹æ¯”"></a>es5å’Œes6ç»§æ‰¿å¯¹æ¯”</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//ES5</span><br><span class="line">function Rectanle(length, width)&#123;</span><br><span class="line">    this.length = length;</span><br><span class="line">    this.width = width;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Rectangle.prototype.getArea = function()&#123;</span><br><span class="line">    return this.length*this.width;</span><br><span class="line">&#125;</span><br><span class="line">function Square(length)&#123;</span><br><span class="line">    Rectangle.call(this,length,length);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Square.prototype = Object.create(Rectangle.prototype,&#123;</span><br><span class="line">    constructor: &#123;</span><br><span class="line">        value: Square,</span><br><span class="line">        enumerable: true,</span><br><span class="line">        writable: true,</span><br><span class="line">        configurable: true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">var sqare = new Square(3);</span><br><span class="line"></span><br><span class="line">console.log(square.getArea());            // 9</span><br><span class="line">console.log(square instanceof Square);    // true</span><br><span class="line">console.log(square instanceof Rectangle); // true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ES6</span><br><span class="line">class Rectangle&#123;</span><br><span class="line">    constructor(length, width)&#123;</span><br><span class="line">        this.length = length;</span><br><span class="line">        this.width = width;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    getArea()&#123;</span><br><span class="line">        return this.length * this.width;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Square extends Rectangle&#123;</span><br><span class="line">    constructor(lenth)&#123;</span><br><span class="line">        //å’Œè°ƒç”¨ Ractangle.call(this, length, length)ç›¸ä¼¼</span><br><span class="line">        super(length, length);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">var square = new Square(3);</span><br><span class="line">console.log(square.getArea());              // 9</span><br><span class="line">console.log(square instanceof Square);      // true</span><br><span class="line">console.log(square instanceof Rectangle);   // true</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„es6é€šè¿‡å…³é”®å­—extendsæ¥å®ç°ç»§æ‰¿ï¼Œé€šè¿‡åœ¨contructoré‡Œçš„super()æ¥è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚<br>è¡¨åä¸Šes5å’Œes6ç»§æ‰¿å¾ˆç›¸ä¼¼ä½†å®é™…ä¸Šå¤§æœ‰ä¸åŒï¼š</p>
<ul>
<li>es5ä¸­çš„thisæ˜¯å…ˆåˆ›é€ å­ç±»çš„å®ä¾‹å¯¹è±¡thisï¼Œç„¶åå†å°†çˆ¶ç±»çš„æ–¹æ³•å’Œå±æ€§æ·»åŠ åˆ°thisä¸Šã€‚è€Œes6åˆ™åˆšå¥½ç›¸åã€‚</li>
<li>es5ä¸­ä¸€èˆ¬åªå®ç°äº†å­ç±»åŸå‹å¯¹çˆ¶ç±»æ„é€ å‡½æ•°åŸå‹çš„ç»§æ‰¿ä¹Ÿå°±æ˜¯å•é“¾ç»§æ‰¿ï¼Œes6ä¸­ä¸ä½†å®ç°äº†es5ä¸­ç»§æ‰¿è¿˜å®ç°äº†å­ç±»æ„é€ å‡½æ•°å¯¹çˆ¶ç±»æ„é€ å‡½æ•°çš„ç»§æ‰¿ï¼Œè¿™å°±æ˜¯è¯´å­ç±»æ„é€ å‡½æ•°å¯ä»¥ä½¿ç”¨çˆ¶ç±»æ„é€ å‡½æ•°ä¸Šçš„é™æ€æ–¹æ³•ï¼Œç»“æœä¸Šæ¥è¯´æ˜¯åŒé“¾ç»§æ‰¿ã€‚<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">console.log( Square.__proto__ === Rectangle); // true</span><br><span class="line">console.log( Square.prototype.__proto__ === Rectangle.prototype ); // true</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="es6ç»§æ‰¿æ³¨æ„é¡¹"><a href="#es6ç»§æ‰¿æ³¨æ„é¡¹" class="headerlink" title="es6ç»§æ‰¿æ³¨æ„é¡¹"></a>es6ç»§æ‰¿æ³¨æ„é¡¹</h3><h4 id="constuctor"><a href="#constuctor" class="headerlink" title="constuctor"></a>constuctor</h4><p>constructorå¯ä»¥çœç•¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class Square extends Rectangle&#123;</span><br><span class="line">    // no contructor</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Square extends Rectangle&#123;</span><br><span class="line">    constructor(...agrs)&#123;</span><br><span class="line">        super(...args)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>constructorä¸çœç•¥æ—¶ï¼š</p>
<ul>
<li>super()åªèƒ½åœ¨ç»§æ‰¿å­ç±»constructoré‡Œä½¿ç”¨</li>
<li>super()å¿…é¡»è°ƒç”¨æ¥åˆ›é€ thisï¼Œé™¤éç›´æ¥ä»constructorä¸­è¿”å›ä¸€ä¸ªå¯¹è±¡</li>
<li>å› ä¸ºsuper()æ˜¯ç”¨æ¥åˆå§‹åŒ–thisçš„ï¼Œåœ¨super()è°ƒç”¨ä¹‹å‰ä¸èƒ½ä½¿ç”¨this</li>
</ul>
<h4 id="superå…³é”®å­—"><a href="#superå…³é”®å­—" class="headerlink" title="superå…³é”®å­—"></a>superå…³é”®å­—</h4><p>superå…³é”®å­—æ—¢å¯ä»¥å½“åšå‡½æ•°ä½¿ç”¨ä¹Ÿå¯ä»¥å½“åšå¯¹è±¡ä½¿ç”¨ï¼Œè¿™ä¸¤ç§æƒ…å†µå®Œå…¨ä¸ä¸€æ ·ï¼Œä¸”åœ¨å‡ºç°å…³é”®å­—superæ—¶å¿…é¡»æ˜ç¡®superæ˜¯å¯¹è±¡æˆ–è€…å‡½æ•°å¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<p>superå‡½æ•°ï¼š</p>
<ul>
<li>ä½œä¸ºçˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå­ç±»æ„é€ å‡½æ•°ä¸­ä¸€èˆ¬å¿…é¡»æ‰§è¡Œä¸€æ¬¡superå‡½æ•°ï¼Œå…·ä½“ä½¿ç”¨å¦‚ä¸Š</li>
<li>åœ¨super()æ‰§è¡Œæ—¶å†…éƒ¨çš„thisé»˜è®¤æŒ‡å‘å­ç±»<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class A&#123;</span><br><span class="line">	constructor()&#123;</span><br><span class="line">		console.log(new.target.name);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class B extends A&#123;</span><br><span class="line">	constructor()&#123;</span><br><span class="line">		super();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">new A(); // A</span><br><span class="line">new B(); // B</span><br></pre></td></tr></table></figure></li>
</ul>
<p>superå¯¹è±¡ï¼š</p>
<ul>
<li>åœ¨æ™®é€šæ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»åŸå‹å¯¹è±¡ï¼›åœ¨é™æ€æ–¹æ³•ä¸­æŒ‡å‘çˆ¶ç±»<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class A &#123;</span><br><span class="line">  p() &#123;</span><br><span class="line">    return 2;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">class B extends A &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    console.log(super.p()); // 2</span><br><span class="line">  &#125;</span><br><span class="line">â€‹</span><br><span class="line">  p()&#123;</span><br><span class="line">    return 1;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">let b = new B();</span><br></pre></td></tr></table></figure></li>
<li>åŒæ ·superå½“åšå¯¹è±¡æ—¶thisé»˜è®¤æŒ‡å‘å­ç±»</li>
<li>super.x &#x3D; 3 ç›¸å½“äºthis.x &#x3D; 3</li>
</ul>
<h4 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h4><ul>
<li><a href="https://github.com/nzakas/understandinges6/tree/master/manuscript">understanding es6</a></li>
<li><a href="http://es6.ruanyifeng.com/">ECMAScript 6 å…¥é—¨</a></li>
</ul>
]]></content>
      <categories>
        <category>javscript</category>
      </categories>
  </entry>
  <entry>
    <title>æµè§ˆå™¨å¼‚æ­¥ä¹‹macrotaskä¸microtask</title>
    <url>/2017/08/09/event-loop/</url>
    <content><![CDATA[<p>æœ¬æ–‡ä¸»è¦æ˜¯åŸºäºæµè§ˆå™¨æ ‡å‡†(html5)ä»‹ç»macrotaskå’Œmicrotask. ç”±äºäº‹ä»¶å¾ªç¯å’Œæ‰§è¡Œç¯å¢ƒç›¸å…³æ‰€ä»¥åœ¨nodeä¸­æ‰§è¡Œç»“æœç¨æœ‰ä¸åŒã€‚  </p>
<p><code>é¦–å…ˆäº†è§£æˆ‘ä»¬çŸ¥é“jsçš„ç‰¹æ€§æ˜¯å•çº¿ç¨‹ã€éé˜»å¡I/Oï¼Œä¸ç”¨è€ƒè™‘å¹¶å‘,æ­»é”ç­‰é—®é¢˜ã€‚ä½†æ˜¯jsçš„æ‰§è¡Œä¼šå¯¼è‡´å¤šä¸ªçº¿ç¨‹åŒæ—¶åœ¨è·‘ï¼Œå¦‚æˆ‘ä»¬åŒæ—¶è§¦å‘äº†å¼‚æ­¥httpè¯·æ±‚çº¿ç¨‹,ä»¥åŠå®šæ—¶å™¨çº¿ç¨‹ï¼Œå¦‚ä½•ç®¡ç†ä»–ä»¬ä¹‹é—´çš„å…³ç³»å°±éœ€è¦even-loopã€‚</code></p>
<p>1ï¼šé¦–å…ˆæˆ‘ä»¬çš„jsçº¿ç¨‹åœ¨è°ƒç”¨æ ˆä¸­è§¦å‘äº†å„ç§å¼‚æ­¥çº¿ç¨‹<br>2ï¼šå¼‚æ­¥çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åæ”¾åˆ°å¼‚æ­¥ä»»åŠ¡å¯¹åº”æºçš„é˜Ÿåˆ—ä¸­ï¼ˆQueueï¼‰<br>3ï¼šæœ€åç”±event-loopå°†é˜Ÿåˆ—ä¸­ï¼ˆQueueï¼‰éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡æŒ‰ç…§ä¸€å®šç­–ç•¥å–åˆ°jsè°ƒç”¨æ ˆä¸­æ‰§è¡Œ</p>
<p><img src="/2017/08/09/event-loop/event-loop.jpg" alt="event-loop"></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯<a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop-processing-model">event-loopçš„æ‰§è¡Œçš„ä¸€äº›ç»†èŠ‚(htmlæ ‡å‡†)</a>ï¼Œå¤§æ¦‚åˆ†ä¸‰æ­¥</p>
<p>1: æ‰§è¡Œæœ€æ—§çš„taskï¼ˆä¸€æ¬¡ï¼‰<br>2ï¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨microtaskï¼Œç„¶åä¸åœæ‰§è¡Œï¼Œç›´åˆ°æ¸…ç©ºé˜Ÿåˆ—ï¼ˆæœ‰å¯èƒ½å¤šæ¬¡ï¼‰<br>3ï¼šæ£€æµ‹æ˜¯å¦æ‰§è¡Œrenderï¼Œå¦‚æœå¯ä»¥å°±æ‰§è¡Œ<br><img src="/2017/08/09/event-loop/flow" alt="flow"></p>
<ul>
<li><p>ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œäº‹ä»¶å¾ªç¯(event-loop)æ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯æ ¹æ®ä»»åŠ¡æº(tasks source)åšåŒºåˆ†çš„ä»»åŠ¡é˜Ÿåˆ—(tasks queued)å¯ä»¥æ‹¥æœ‰å¤šä¸ªã€‚</p>
</li>
<li><p>ä»»åŠ¡é˜Ÿåˆ—åˆåˆ†ä¸ºmacrostask(å®ä»»åŠ¡)ä¸microtask(å¾®ä»»åŠ¡)ï¼Œåœ¨æœ€æ–°æ ‡å‡†ä¸­ï¼Œå®ƒä»¬è¢«åˆ†åˆ«ç§°ä¸ºtaskä¸jobsã€‚</p>
</li>
<li><p>macrotaskå¤§æ¦‚åŒ…æ‹¬ï¼šscript(æ•´ä½“ä»£ç ), setTimeout, setInterval, setImmediate, I&#x2F;O, UI rendering, networking(å¦‚ajaxï¼Œfetch)ã€‚</p>
</li>
<li><p>microtaskså¤§æ¦‚åŒ…æ‹¬: process.nextTick, Promise, Object.observe(å·²åºŸå¼ƒ), MutationObserver(html5æ–°ç‰¹æ€§)</p>
</li>
<li><p>åœ¨æ¯ä¸ªmacrotask(å®ä»»åŠ¡)ä¹Ÿå°±æ˜¯taskæ‰§è¡Œä¹‹é—´æµè§ˆå™¨ä¹Ÿè®¸ä¼šæ›´æ–°æ¸²æŸ“ï¼šåŸå› æ˜¯60fpsï¼ˆ60 frame per secondï¼‰ï¼Œè¿™æ„å‘³ç€çº¦16.7msè¿›è¡Œä¸€æ¬¡render,å¦‚æœtaské—´éš”æ²¡è¶…è¿‡è¿™ä¸ªæ—¶é—´ä¹Ÿå°±ä¸ä¼šæ›´æ–°ã€‚</p>
</li>
<li><p>åœ¨æ‰§è¡Œmacrotask(å®ä»»åŠ¡)çš„æ—¶å€™é‡åˆ°ä¸€ä¸ªæ–°çš„macrotasks(å®ä»»åŠ¡)ä¼šå°†ä»»åŠ¡åˆ†å‘åˆ°å¯¹åº”é˜Ÿåˆ—ä¸­ç­‰å¾…ä¸‹ä¸€æ¬¡äº‹ä»¶å¾ªç¯æ‰§è¡Œ</p>
</li>
<li><p>mircrotaskåœ¨ä¸¤ç§æƒ…å†µä¼šæ‰§è¡Œ<br> 1åœ¨å›è°ƒå‡½æ•°ä¸­å‡½æ•°æ ˆæ²¡æœ‰æ­£åœ¨æ‰§è¡Œä¸­çš„å…¶ä»–js<br> 2åœ¨æ¯ä¸ªtaskçš„åé¢</p>
</li>
<li><p>å¤„ç† microtask é˜Ÿåˆ—æœŸé—´ï¼Œæ–°æ·»åŠ çš„ microtask æ·»åŠ åˆ°é˜Ÿåˆ—çš„æœ«å°¾å¹¶ä¸”ä¹Ÿè¢«æ‰§è¡Œ</p>
</li>
<li><p>æ¥è‡ªä¸åŒä»»åŠ¡æºçš„ä»»åŠ¡ä¼šè¿›å…¥åˆ°ä¸åŒçš„ä»»åŠ¡é˜Ÿåˆ—ã€‚å…¶ä¸­setTimeoutä¸setIntervalæ˜¯åŒæºçš„ã€‚</p>
</li>
<li><p>åœ¨æ¯ä¸€æ¬¡äº‹ä»¶å¾ªç¯(event-loop)ä¸­ï¼Œmacrotask åªä¼šæå–ä¸€ä¸ªæ‰§è¡Œï¼Œè€Œ microtask ä¼šä¸€ç›´æå–ï¼Œç›´åˆ° microtask é˜Ÿåˆ—æ¸…ç©ºã€‚</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">console.log(&#x27;glob1&#x27;);</span><br><span class="line">setTimeout(function() &#123;</span><br><span class="line">      setTimeout(function()&#123;</span><br><span class="line">		console.log(&#x27;test1&#x27;);</span><br><span class="line">		Promise.resolve().then(function()&#123;</span><br><span class="line">            console.log(&#x27;test1_promise&#x27;)</span><br><span class="line">        &#125;);</span><br><span class="line">	&#125;);</span><br><span class="line">    console.log(&#x27;timeout1&#x27;);</span><br><span class="line">    new Promise(function(resolve) &#123;</span><br><span class="line">        console.log(&#x27;timeout1_promise&#x27;);</span><br><span class="line">        resolve();</span><br><span class="line">    &#125;).then(function() &#123;</span><br><span class="line">        console.log(&#x27;timeout1_then&#x27;)</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">new Promise(function(resolve) &#123;</span><br><span class="line">    console.log(&#x27;glob1_promise&#x27;);</span><br><span class="line">    resolve();</span><br><span class="line">    console.log(&#x27;glob2_promise&#x27;);</span><br><span class="line">&#125;).then(function() &#123;</span><br><span class="line">    console.log(&#x27;glob1_then&#x27;)</span><br><span class="line">&#125;).then(function()&#123;</span><br><span class="line">	Promise.resolve().then(function()&#123;</span><br><span class="line">		console.log(&#x27;glob1_then_test&#x27;)</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// glob1</span><br><span class="line">// glob1_promise</span><br><span class="line">// glob2_promise</span><br><span class="line">// glob1_then</span><br><span class="line">// glob1_then_test</span><br><span class="line">// timeout1</span><br><span class="line">// timeout1_promise</span><br><span class="line">// timeout1_then</span><br><span class="line">// test1</span><br><span class="line">// test1_promise</span><br></pre></td></tr></table></figure>
<p>åˆ†æä¸‹ä¸Šé¢æ‰§è¡Œçš„ç»“æœï¼š<br>1ï¼š golb1 ç¬¬ä¸€ä¸ªtaskï¼ˆjs scriptï¼‰ä¸­æ‰§è¡Œçš„åŒæ­¥console<br>2ï¼š glob1_promise ç¬¬ä¸€ä¸ªtaskï¼ˆjs scriptï¼‰ä¸­æ‰§è¡Œpromiseæ„é€ å‡½æ•°çš„åŒæ­¥console<br>3ï¼š glob2_promise ç¬¬ä¸€ä¸ªtaskï¼ˆjs scriptï¼‰ä¸­æ‰§è¡Œpromiseæ„é€ å‡½æ•°çš„åŒæ­¥console<br>4:  glob1_then ç¬¬ä¸€ä¸ªtaskæ‰§è¡Œå®Œæ¯•åæ£€æµ‹å…ˆmicrotaské˜Ÿåˆ—ä¸­æœ‰ä¸€ä¸ªPromise<br>5ï¼š glob1_then_test ç¬¬4æ­¥Promiseæ‰§è¡Œè¿‡ç¨‹ä¸­æ’å…¥çš„microtaskï¼Œä¹Ÿä¼šç»§ç»­æ‰§è¡Œ<br>6ï¼š timeout1 æ‰§è¡Œç¬¬äºŒä¸ªtaskï¼ˆsetTimeoutï¼‰é‡Œé¢çš„åŒæ­¥console<br>7ï¼š timeout1_promise ç¬¬äºŒä¸ªtaskä¸­æ‰§è¡ŒPromoseæ„é€ å‡½æ•°çš„console<br>8ï¼š timeout1_then ç¬¬äºŒä¸ªtaskæ‰§è¡Œå®Œæ¯•åæ£€æµ‹microtaské˜Ÿåˆ—ä¸­æœ‰ä¸€ä¸ªPromise<br>9ï¼š test1 ç¬¬ä¸‰ä¸ªtaskï¼ˆsetTimeoutï¼‰ä¸­åŒæ­¥æ‰§è¡Œçš„console<br>10ï¼š test1_promise ç¬¬ä¸‰ä¸ªtaskæ‰§è¡Œå®Œæ¯•åæ£€æµ‹microtaské˜Ÿåˆ—ä¸­çš„Promise</p>
]]></content>
  </entry>
  <entry>
    <title>font-size with line-height</title>
    <url>/2017/10/09/font-size%20with%20line-height/</url>
    <content><![CDATA[<h2 id="1-å­—å·ä¸è¡Œé«˜"><a href="#1-å­—å·ä¸è¡Œé«˜" class="headerlink" title="1.å­—å·ä¸è¡Œé«˜"></a>1.å­—å·ä¸è¡Œé«˜</h2><p>  å­—å·å¤§å°å°±æ˜¯å­—ä½“çš„é«˜åº¦ï¼Œå¦‚å­—å·ä¸º50px,é‚£ä¹ˆä»–çš„é«˜åº¦å¦‚ä¸‹å›¾ï¼š<br><img src="/2017/10/09/font-size%20with%20line-height/1.png" alt="font-size">  </p>
<p>  è¡Œè·ä¸ºè¡Œé«˜å‡å»å­—å·å¤§å°ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="/2017/10/09/font-size%20with%20line-height/2.png" alt="fontSizeAndLineHeight"><br>æ‰€ä»¥ åŠè¡Œè· &#x3D; (lineHeight-fontSize) &#x2F; 2; </p>
<span id="more"></span>

<h2 id="2-å­—ä½“è®¾è®¡"><a href="#2-å­—ä½“è®¾è®¡" class="headerlink" title="2.å­—ä½“è®¾è®¡"></a>2.å­—ä½“è®¾è®¡</h2><p>  æ­£å¸¸çš„å­—ä½“éƒ½è¦å¦‚ä¸‹å›¾çš„åˆ»åº¦å’Œåº¦é‡çº¿ï¼š<br><img src="/2017/10/09/font-size%20with%20line-height/3.png" alt="font-size"><br>  è¿™å…¶ä¸­çš„å€¼ä¸€èˆ¬å¦‚ä¸‹ï¼Œä¹Ÿå¯ä»¥è‡ªå·±è®¾ç½®<br><img src="/2017/10/09/font-size%20with%20line-height/4.png" alt="length"><br>  Units Per Emè¡¨ç¤ºä¸€ä¸ªå­—çš„é«˜åº¦æœ‰1000ä¸ªå•ä½ï¼Œbaselineçš„åæ ‡ä¸º0ï¼Œå…¶å®ƒçº¿çš„åæ ‡ç›¸å¯¹äºbaselineï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/2017/10/09/font-size%20with%20line-height/5.png" alt="length"></p>
<h2 id="3-å›¾ç‰‡åº•éƒ¨çš„ç©ºç™½"><a href="#3-å›¾ç‰‡åº•éƒ¨çš„ç©ºç™½" class="headerlink" title="3.å›¾ç‰‡åº•éƒ¨çš„ç©ºç™½"></a>3.å›¾ç‰‡åº•éƒ¨çš„ç©ºç™½</h2><p>  è®¾ç½®divçš„font-sizeä¸º40pxï¼Œline-heightä¸º60pxï¼Œåº•éƒ¨æœ‰ä¸€ç‚¹ç©ºç™½ï¼š<br><img src="/2017/10/09/font-size%20with%20line-height/6.png" alt="img"><br>  åœ¨ç”»ä¸Šè¾…åŠ©çº¿åå°±æ¸…æ¥šè®¸å¤šäº†ï¼š<br><img src="/2017/10/09/font-size%20with%20line-height/7.png" alt="length"><br>  åº•éƒ¨çš„ç©ºç™½é«˜åº¦ &#x3D; (baseline - descender) + åŠè¡Œè·ï¼›<br>  åŸºçº¿åˆ°åº•çº¿çš„è·ç¦»ä¸ºï¼š<br>  250 &#x2F; 1000 * 40 &#x3D; 10px<br>  åŠè¡Œè·ä¸ºï¼š<br>  (60 - 40) &#x2F; 2 &#x3D; 10px<br>  ç©ºç™½è·ç¦»ï¼š<br>  10px + 10px &#x3D; 20px<br>  å¦‚ä½•å°†è¿™ä¸ªç©ºç™½å»æ‰ï¼Œå¯ä»¥å°†divçš„è¡Œé«˜è®¾ç½®ä¸º0å°±å¯ä»¥ã€‚</p>
]]></content>
      <categories>
        <category>css</category>
      </categories>
  </entry>
  <entry>
    <title>http</title>
    <url>/2017/10/19/http/</url>
    <content><![CDATA[<h2 id="ç¬¬3ç« -HTTPæŠ¥æ–‡å†…çš„HTTPä¿¡æ¯"><a href="#ç¬¬3ç« -HTTPæŠ¥æ–‡å†…çš„HTTPä¿¡æ¯" class="headerlink" title="ç¬¬3ç«  HTTPæŠ¥æ–‡å†…çš„HTTPä¿¡æ¯"></a>ç¬¬3ç«  HTTPæŠ¥æ–‡å†…çš„HTTPä¿¡æ¯</h2><p>ä¸€èˆ¬æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡çš„è§£æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  </p>
<p><img src="/2017/10/19/http/message.png" alt="message"></p>
<span id="more"></span>


<h4 id="æŠ¥æ–‡å’Œå®ä½“çš„å·®å¼‚"><a href="#æŠ¥æ–‡å’Œå®ä½“çš„å·®å¼‚" class="headerlink" title="æŠ¥æ–‡å’Œå®ä½“çš„å·®å¼‚"></a>æŠ¥æ–‡å’Œå®ä½“çš„å·®å¼‚</h4><ul>
<li>æŠ¥æ–‡(message): HTTPé€šä¿¡çš„åŸºæœ¬å•ä½ï¼Œç”±8ä½ç»„å­—èŠ‚æµç»„æˆï¼Œé€šè¿‡HTTPé€šä¿¡ä¼ è¾“  </li>
<li>å®ä½“(entity):ä½œä¸ºæŠ¥æ–‡çš„ä¸€éƒ¨åˆ†ï¼Œè¢«å½“åšè¯·æ±‚å’Œå“åº”çš„æœ‰æ•ˆè½½è·æ•°æ®è¢«ä¼ è¾“ï¼Œå…¶å†…å®¹ç”±å®ä½“é¦–éƒ¨å’Œå®ä½“ä¸»ä½“ç»„æˆã€‚</li>
</ul>
<h2 id="ç¬¬4ç« -è¿”å›ç»“æ„çš„HTTPçŠ¶æ€ç "><a href="#ç¬¬4ç« -è¿”å›ç»“æ„çš„HTTPçŠ¶æ€ç " class="headerlink" title="ç¬¬4ç«  è¿”å›ç»“æ„çš„HTTPçŠ¶æ€ç "></a>ç¬¬4ç«  è¿”å›ç»“æ„çš„HTTPçŠ¶æ€ç </h2><p>çŠ¶æ€ç ç±»åˆ«ï¼š  </p>
<table>
<thead>
<tr>
<th>çŠ¶æ€</th>
<th>ç±»åˆ«</th>
<th>åŸå› </th>
</tr>
</thead>
<tbody><tr>
<td>1XX Informatinal</td>
<td>ä¿¡æ¯æ€§çŠ¶æ€ç </td>
<td>æ¥æ”¶çš„è¯·æ±‚å¤„ç†ä¸­</td>
</tr>
<tr>
<td>2XX Success</td>
<td>æˆåŠŸçŠ¶æ€ç </td>
<td>è¯·æ±‚æ­£å¸¸å¤„ç†å®Œæ¯•</td>
</tr>
<tr>
<td>3XX Redirection</td>
<td>é‡å®šå‘çŠ¶æ€ç </td>
<td>éœ€è¦è¿›è¡Œé™„åŠ æ“ä½œä»¥å®Œæˆè¯·æ±‚</td>
</tr>
<tr>
<td>4XX Client Error</td>
<td>å®¢æœç«¯é”™è¯¯çŠ¶æ€ç </td>
<td>æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚</td>
</tr>
<tr>
<td>5XX Server Error</td>
<td>æœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç </td>
<td>æœåŠ¡å™¨å¤„ç†è¯·æ±‚é”™è¯¯</td>
</tr>
</tbody></table>
<p>å¸¸ç”¨çŠ¶æ€ç ï¼š</p>
<ul>
<li>200 OK    è¡¨ç¤ºä»å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚åœ¨æœåŠ¡å™¨ç«¯æ­£å¸¸å¤„ç†äº†</li>
<li>204 No Content   è¡¨ç¤ºæœåŠ¡å™¨æ¥å—è¯·æ±‚å·²æˆåŠŸå¤„ç†ï¼Œä½†æ˜¯è¿”å›çš„å“åº”ä¿æ¸©ä¸­ä¸å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ†ã€‚</li>
<li>206 Partail Content è¡¨ç¤ºå®¢æˆ·ç‚¹è¿›è¡ŒèŒƒå›´è¯·æ±‚ï¼ŒæœåŠ¡å™¨æˆåŠŸæ‰§è¡Œè¿™éƒ¨åˆ†çš„GETè¯·æ±‚ã€‚å“åº”æŠ¥æ–‡ä¸­çš„Content-Range æŒ‡å®šå®ä½“å†…å®¹çš„èŒƒå›´ã€‚</li>
<li>301 Moved Permanently   è¡¨ç¤ºèµ„æºå·²ç»æ°¸ä¹…æ€§é‡æ–°åˆ†é…URIï¼Œè¿™æ˜¯åº”è¯¥æŒ‰ç…§å“åº”å¤´çš„Locationé¦–éƒ¨å­—æ®µçš„URIé‡å®šå‘ã€‚</li>
<li>302 Found è¡¨ç¤ºèµ„æºæš‚æ—¶é‡æ–°åˆ†é…URI</li>
<li>303 See Other è¡¨ç¤ºèµ„æºå­˜åœ¨å¦ä¸€ä¸ªURIï¼Œåº”è¯¥ä½¿ç”¨GETæ–¹æ³•å®šå‘è·å–è¯·æ±‚çš„èµ„æºã€‚</li>
<li>304 Not Modified è¡¨ç¤ºå®¢æˆ·ç«¯å‘é€é™„å¸¦æ¡ä»¶(If-Match,If-Modified-Since,If-None-Match,If-Range,If-Unmodified-Since)è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯å…è®¸è¯·æ±‚è®¿é—®èµ„æºï¼Œä½†æ˜¯ä¸ºæ»¡è¶³æ¡ä»¶ï¼Œè¿”å›ä¸åŒ…å«ä»»ä½•ç›¸åº”ä¸»ä½“éƒ¨åˆ†ã€‚</li>
<li>400 Bad Request è¡¨ç¤ºæŠ¥æ–‡ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯ã€‚</li>
<li>401 Unauthorized è¡¨ç¤ºæœªæˆæƒï¼Œæˆ–æˆæƒéªŒè¯å¤±è´¥</li>
<li>403 Forbidden æ‹’ç»è®¿é—®</li>
<li>404 Not Found æ— æ³•é€šè¿‡æŒ‡å®šçš„URIæ‰¾åˆ°å¯¹åº”çš„èµ„æº</li>
<li>500 Internal Server Error æœåŠ¡å™¨æ‰§è¡Œæ—¶å‘ç”Ÿé”™è¯¯ã€‚</li>
<li>503 Service Unavailable æœåŠ¡å™¨æš‚æ—¶è¶…è´Ÿè·æˆ–åœæœºç»´æŠ¤ä¸­ï¼Œæœ€å¥½å†™å…¥åœ¨å“åº”å¤´ä¸­å†™å…¥RetryAfteré¦–éƒ¨å­—æ®µç»™å®¢æˆ·ç«¯</li>
</ul>
<h2 id="ç¬¬5ç« -ä¸HTTPåä½œçš„webæœåŠ¡å™¨"><a href="#ç¬¬5ç« -ä¸HTTPåä½œçš„webæœåŠ¡å™¨" class="headerlink" title="ç¬¬5ç«  ä¸HTTPåä½œçš„webæœåŠ¡å™¨"></a>ç¬¬5ç«  ä¸HTTPåä½œçš„webæœåŠ¡å™¨</h2><h4 id="5-2-1-ä»£ç†"><a href="#5-2-1-ä»£ç†" class="headerlink" title="5.2.1 ä»£ç†"></a>5.2.1 ä»£ç†</h4><p>ä»£ç†ï¼šæ¥å—å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚å¹¶è½¬å‘ç»™æœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹Ÿæ¥æ”¶æœåŠ¡å™¨è¿”å›çš„å“åº”å¹¶è½¬å‘ç»™å®¢æˆ·ç«¯ã€‚<br>ä¸€èˆ¬å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š  </p>
<p><img src="/2017/10/19/http/proxy.png" alt="proxy"></p>
<p>æŒ‰ç…§ä½¿ç”¨åˆ†ç±»ã€‚ä¸€ç§æ˜¯å¦ä½¿ç”¨ç¼“å­˜ï¼Œå¦ä¸€ç§æ˜¯å¦ä¿®æ”¹æŠ¥æ–‡ã€‚</p>
<ul>
<li>ç¼“å­˜ä»£ç†ï¼š ä»£ç†è½¬å‘å“åº”æ—¶ï¼Œç¼“å­˜ä»£ç†(Caching Proxy)ä¼šé¢„å…ˆå°†èµ„æºå‰¯æœ¬ä¿å­˜åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šï¼Œå½“ä»£ç†å†æ¬¡æ¥æ”¶åˆ°ç›¸åŒèµ„æºè¯·æ±‚æ—¶ï¼Œå°±ä¸å¯ä»¥ä»æºæœåŠ¡å™¨è·å–èµ„æºï¼Œè€Œæ˜¯å°†ä¹‹å‰ç¼“å­˜ä½œä¸ºå“åº”è¿”å›ã€‚</li>
<li>é€æ˜ä»£ç†ï¼š è½¬å‘è¯·æ±‚æˆ–å“åº”æ—¶ï¼Œä¸å¯¹æŠ¥æ–‡åšä»»ä½•åŠ å·¥ç§°ä¸ºé€æ˜ä»£ç†ã€‚</li>
</ul>
<h4 id="5-2-2-ç½‘å…³"><a href="#5-2-2-ç½‘å…³" class="headerlink" title="5.2.2 ç½‘å…³"></a>5.2.2 ç½‘å…³</h4><p>ç½‘å…³ï¼šåˆ©ç”¨ç½‘å…³å¯ä»¥ç”±HTTPè¯·æ±‚è½¬åŒ–ä¸ºå…¶ä»–åè®®é€šä¿¡ã€‚  </p>
<p><img src="/2017/10/19/http/gateway.png" alt="gateway"></p>
<h4 id="5-2-3-éš§é“"><a href="#5-2-3-éš§é“" class="headerlink" title="5.2.3 éš§é“"></a>5.2.3 éš§é“</h4><p>éš§é“ï¼š æŒ‰ç…§è¦æ±‚å»ºç«‹å™¨ä¸å…¶ä»–æœåŠ¡å™¨é€šä¿¡çš„è·¯çº¿ï¼Œå¦‚åˆ©ç”¨SSLç­‰åŠ å¯†æ‰‹æ®µã€‚éš§é“çš„ç›®çš„åœ¨ä¿éšœå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨è¿›è¡Œå®‰å…¨é€šä¿¡ã€‚</p>
<h3 id="5-3-ç¼“å­˜"><a href="#5-3-ç¼“å­˜" class="headerlink" title="5.3 ç¼“å­˜"></a>5.3 ç¼“å­˜</h3><p>ç¼“å­˜åˆ†ä¸ºå®¢æˆ·ç«¯ç¼“å­˜å’Œä»£ç†ç¼“å­˜ã€‚</p>
<p><img src="/2017/10/19/http/tunnel.png" alt="tunnel"></p>
<h2 id="ç¬¬6ç« -HTTPé¦–éƒ¨"><a href="#ç¬¬6ç« -HTTPé¦–éƒ¨" class="headerlink" title="ç¬¬6ç«  HTTPé¦–éƒ¨"></a>ç¬¬6ç«  HTTPé¦–éƒ¨</h2><p>æ ¹æ®é¦–éƒ¨å­—æ®µå®é™…ç”¨é€”è¢«åˆ†ä¸ºä»¥ä¸‹4ä¸­ç±»å‹</p>
<ul>
<li>é€šç”¨é¦–éƒ¨å­—æ®µ(General Header Fileds): è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡éƒ½ä¼šä½¿ç”¨çš„é¦–éƒ¨ã€‚</li>
<li>è¯·æ±‚é¦–éƒ¨å­—æ®µ(Request Header Fileds): å®¢æˆ·ç«¯é¡¹æœåŠ¡å™¨ç«¯è¯·æ±‚ä½¿ç”¨çš„é¦–éƒ¨ã€‚ è¡¥å……äº†è¯·æ±‚é™„åŠ å†…å®¹ï¼Œå®¢æˆ·ç«¯ä¿¡æ¯ï¼Œå“åº”å†…å®¹ç›¸å…³ä¼˜å…ˆçº§ç­‰ä¿¡æ¯ã€‚</li>
<li>å“åº”é¦–éƒ¨å­—æ®µ(Response Header Fields): æœåŠ¡å™¨å‘å®¢æˆ·ç¦å®‰å“åº”æ—¶ä½¿ç”¨çš„é¦–éƒ¨ã€‚è¡¥å……äº†å“åº”é™„åŠ å†…å®¹ï¼Œä¹Ÿä¼šè¦æ±‚å®¢æˆ·ç«¯é™„åŠ é¢å¤–å†…å®¹ä¿¡æ¯ã€‚</li>
<li>å®ä½“é¦–éƒ¨å­—æ®µ(Entity Header Fields): è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡å®ä½“éƒ¨åˆ†ä½¿ç”¨çš„é¦–éƒ¨ã€‚è¡¥å……èµ„æºå†…å®¹æ›´æ–°æ—¶é—´ç­‰ä¸å®ä½“æœ‰å…³çš„ä¿¡æ¯ã€‚</li>
</ul>
<p>HTTP&#x2F;1.1 è§„èŒƒå®šä¹‰å¦‚ä¸‹47ä¸­é¦–éƒ¨å­—æ®µ<br>é€šç”¨é¦–éƒ¨å­æ®µï¼š<br><img src="/2017/10/19/http/GeneralHeader.png" alt="å­æ®µ1">  </p>
<p>è¯·æ±‚é¦–éƒ¨å­æ®µï¼š<br><img src="/2017/10/19/http/RequestHeader.png" alt="å­æ®µ2">  </p>
<p>å“åº”é¦–éƒ¨å­æ®µï¼š<br><img src="/2017/10/19/http/ResponseHeader.png" alt="å­æ®µ3">  </p>
<p>å®ä½“é¦–éƒ¨å­æ®µï¼š<br><img src="/2017/10/19/http/EntityHeader.png" alt="å­æ®µ4">  </p>
<p>é™¤äº†RFC2616ä¸­å®šä¹‰çš„47ç§é¦–éƒ¨å­æ®µã€‚è¿˜æœ‰Cookie, Set-Cookieå’ŒContent-Dispositionç­‰ã€‚</p>
<h4 id="6-3-2-Connection"><a href="#6-3-2-Connection" class="headerlink" title="6.3.2 Connection"></a>6.3.2 Connection</h4><ul>
<li>æ§åˆ¶ä»£ç†ä¸å†è½¬å‘ç»™æºæœåŠ¡å™¨çš„é¦–éƒ¨å­—æ®µ  Connection: ä¸å†è½¬å‘çš„é¦–éƒ¨å­—æ®µå</li>
</ul>
<h4 id="6-3-3-Date"><a href="#6-3-3-Date" class="headerlink" title="6.3.3 Date"></a>6.3.3 Date</h4><ul>
<li>åˆ›å»ºHTTPæŠ¥æ–‡çš„æ—¥æœŸå’Œæ—¶é—´ Date:Fri, 20 Oct 2017 06:33:42 GMT</li>
</ul>
<h4 id="6-3-4-Pragma"><a href="#6-3-4-Pragma" class="headerlink" title="6.3.4 Pragma"></a>6.3.4 Pragma</h4><ul>
<li>HTTP&#x2F;1.1 é—ç•™å­—æ®µï¼Œè™½ç„¶ä¸ºé€šç”¨é¦–éƒ¨å­—æ®µï¼Œä½†æ˜¯åªåœ¨å®¢æˆ·ç«¯å‘é€è¯·æ±‚æ—¶ä½¿ç”¨ã€‚ ä¸ºäº†ä¿è¯å…¨éƒ¨ä¸­é—´æœåŠ¡å™¨è¡Œä¸ºä¿å­˜ä¸€èˆ¬éƒ½ä¼šå«ä»¥ä¸‹ä¸¤ä¸ªå­—æ®µ<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Cache-Control: no-catch</span><br><span class="line">Paragma: no-cache</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Tralier"><a href="#Tralier" class="headerlink" title="Tralier"></a>Tralier</h4><ul>
<li>å…è®¸å‘ç”Ÿæ–¹åœ¨åˆ†å—å‘é€æ¶ˆæ¯åé¢æ·»åŠ é¢å¤–çš„å…ƒä¿¡æ¯ Trailer: header-names</li>
</ul>
<h4 id="Transfer-Encoding"><a href="#Transfer-Encoding" class="headerlink" title="Transfer-Encoding"></a>Transfer-Encoding</h4><ul>
<li>Transfer-Encoding æ˜¯ä¸€ä¸ªé€è·³ä¼ è¾“æ¶ˆæ¯é¦–éƒ¨ï¼Œå³ä»…åº”ç”¨äºä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„æ¶ˆæ¯ä¼ é€’ï¼Œè€Œä¸æ˜¯æ‰€è¯·æ±‚çš„èµ„æºæœ¬èº«ã€‚</li>
</ul>
<h2 id="6-4-è¯·æ±‚é¦–éƒ¨"><a href="#6-4-è¯·æ±‚é¦–éƒ¨" class="headerlink" title="6.4 è¯·æ±‚é¦–éƒ¨"></a>6.4 è¯·æ±‚é¦–éƒ¨</h2><h4 id="Accept"><a href="#Accept" class="headerlink" title="Accept"></a>Accept</h4><ul>
<li>Accept é¦–éƒ¨å­—æ®µå¯é€šçŸ¥æœåŠ¡å™¨ï¼Œç”¨æˆ·ä»£ç†èƒ½å¤Ÿå¤„ç†çš„åª’ä½“ç±»å‹åŠåª’ä½“ç±»å‹çš„ç›¸å¯¹ä¼˜å…ˆçº§ï¼Œä½¿ç”¨qæ¥è¡¨ç¤ºæƒé‡(0-1)é»˜è®¤ä¸º1.<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8</span><br></pre></td></tr></table></figure>
<h4 id="Accept-Charset"><a href="#Accept-Charset" class="headerlink" title="Accept-Charset"></a>Accept-Charset</h4></li>
<li>Accept-Charset é¦–éƒ¨å­—æ®µå¯ç”¨æ¥é€šçŸ¥æœåŠ¡å™¨ç”¨æˆ·ä»£ç†æ”¯æŒçš„å­—ç¬¦é›†åŠå­—ç¬¦é›†çš„ç›¸å¯¹ä¼˜å…ˆé¡ºåº.<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Accept-Charset: iso-8859-5, unicode-1-1;q=0.8</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Accept-Encoding"><a href="#Accept-Encoding" class="headerlink" title="Accept-Encoding"></a>Accept-Encoding</h4><ul>
<li>Accept-Encoding é¦–éƒ¨å­—æ®µç”¨æ¥å‘ŠçŸ¥æœåŠ¡å™¨ç”¨æˆ·ä»£ç†æ”¯æŒçš„å†…å®¹ç¼–ç åŠå†…å®¹ç¼–ç çš„ä¼˜å…ˆçº§é¡ºåº<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Accept-Encoding:gzip, deflate, br</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Accept-Languag"><a href="#Accept-Languag" class="headerlink" title="Accept-Languag"></a>Accept-Languag</h4><ul>
<li>Accept-Language ç”¨æ¥å‘ŠçŸ¥æœåŠ¡å™¨ç”¨æˆ·ä»£ç†èƒ½å¤Ÿå¤„ç†çš„è‡ªç„¶è¯­è¨€é›†ï¼ˆæŒ‡ä¸­æ–‡æˆ–è‹±æ–‡ç­‰ï¼‰ï¼Œä»¥åŠè‡ªç„¶è¯­è¨€é›†çš„ç›¸å¯¹ä¼˜å…ˆçº§ã€‚<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Accept-Language:zh-CN,zh;q=0.8</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Authorization"><a href="#Authorization" class="headerlink" title="Authorization"></a>Authorization</h4><p><img src="/2017/10/19/http/Authorization.png" alt="Authorization">;</p>
<h4 id="Host"><a href="#Host" class="headerlink" title="Host"></a>Host</h4><ul>
<li>é¦–éƒ¨å­—æ®µ Host ä¼šå‘ŠçŸ¥æœåŠ¡å™¨ï¼Œè¯·æ±‚çš„èµ„æºæ‰€å¤„çš„äº’è”ç½‘ä¸»æœºåå’Œç«¯å£å·Host é¦–éƒ¨å­—æ®µåœ¨ HTTP&#x2F;1.1 è§„èŒƒå†…æ˜¯å”¯ä¸€ä¸€ä¸ªå¿…é¡»è¢«åŒ…å«åœ¨è¯·æ±‚å†…çš„é¦–éƒ¨å­—æ®µ<br><img src="/2017/10/19/http/Host.png" alt="Host"></li>
</ul>
<h4 id="If-Match"><a href="#If-Match" class="headerlink" title="If-Match"></a>If-Match</h4><ul>
<li>å¦‚If-xxxè¿™ç§é¦–éƒ¨å­—æ®µç§°ä¸ºæ¡ä»¶è¯·æ±‚ï¼Œåªæœ‰æœåŠ¡å™¨æ¥å—é™„åŠ æ¡ä»¶ååˆ¤å®šä¸ºçœŸæ‰ä¼šæ‰§è¡Œè¯·æ±‚ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯æ‰€æœ‰çš„æ¡ä»¶éƒ½åŒæ—¶æ»¡è¶³æ—¶æ‰ä¼šå¤„ç†è¯·æ±‚ã€‚If-Matchå­—æ®µå¿…é¡»å’ŒETagåŒ¹é…æ—¶ï¼ŒæœåŠ¡å™¨æ‰ä¼šæ¥å—è¯·æ±‚ã€‚<br><img src="/2017/10/19/http/If-Match.png" alt="If-Match"></li>
</ul>
<h4 id="If-Modified-Since"><a href="#If-Modified-Since" class="headerlink" title="If-Modified-Since"></a>If-Modified-Since</h4><p><img src="/2017/10/19/http/If-Modified-Since.png" alt="If-Modified-Since"></p>
<h4 id="If-None-Match"><a href="#If-None-Match" class="headerlink" title="If-None-Match"></a>If-None-Match</h4><ul>
<li>åœ¨ GET æˆ– HEAD æ–¹æ³•ä¸­ä½¿ç”¨é¦–éƒ¨å­—æ®µ If-None-Match å¯è·å–æœ€æ–°çš„èµ„æºã€‚å› æ­¤ï¼Œè¿™ä¸ä½¿ç”¨é¦–éƒ¨å­—æ®µ If-Modified-Since æ—¶æœ‰äº›ç±»ä¼¼ã€‚<br><img src="/2017/10/19/http/If-None-Match.png" alt="If-None-Match"></li>
</ul>
<h4 id="If-Range"><a href="#If-Range" class="headerlink" title="If-Range"></a>If-Range</h4><ul>
<li><p>å®ƒå‘ŠçŸ¥æœåŠ¡å™¨è‹¥æŒ‡å®šçš„ If-Range å­—æ®µå€¼ï¼ˆETag å€¼æˆ–è€…æ—¶é—´ä½†æ˜¯äºŒè€…ä¸èƒ½åŒæ—¶ä½¿ç”¨ï¼‰å’Œè¯·æ±‚èµ„æºçš„ ETag å€¼æˆ–æ—¶é—´ç›¸ä¸€è‡´æ—¶ï¼Œåˆ™ä½œä¸ºèŒƒå›´è¯·æ±‚å¤„ç†ã€‚åä¹‹ï¼Œåˆ™è¿”å›å…¨ä½“èµ„æºã€‚<br><img src="/2017/10/19/http/If-Range.png" alt="If-Range"></p>
</li>
<li><p>è‹¥ä¸ä½¿ç”¨If-Rangeè¯·æ±‚å¤±è´¥åˆ™éœ€è¦ä¸¤æ¬¡è¯·æ±‚<br><img src="/2017/10/19/http/If-Range-without.png" alt="If-Range-without"></p>
</li>
</ul>
<h4 id="If-Unmodified-Since"><a href="#If-Unmodified-Since" class="headerlink" title="If-Unmodified-Since"></a>If-Unmodified-Since</h4><ul>
<li>çš„ä½œç”¨çš„æ˜¯å‘ŠçŸ¥æœåŠ¡å™¨ï¼ŒæŒ‡å®šçš„è¯·æ±‚èµ„æºåªæœ‰åœ¨å­—æ®µå€¼å†…æŒ‡å®šçš„æ—¥æœŸæ—¶é—´ä¹‹åï¼Œæœªå‘ç”Ÿæ›´æ–°çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½å¤„ç†è¯·æ±‚ã€‚</li>
</ul>
<h4 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a>Referer</h4><ul>
<li>é¦–éƒ¨å­—æ®µ Referer ä¼šå‘ŠçŸ¥æœåŠ¡å™¨è¯·æ±‚çš„åŸå§‹èµ„æºçš„ URIã€‚åŸå§‹èµ„æºçš„ URI ä¸­çš„æŸ¥è¯¢å­—ç¬¦ä¸²å¯èƒ½æœ‰ ID å’Œå¯†ç ç­‰ä¿å¯†ä¿¡æ¯ï¼Œè¦æ˜¯å†™è¿› Referer è½¬å‘ç»™å…¶ä»–æœåŠ¡å™¨ï¼Œåˆ™æœ‰å¯èƒ½å¯¼è‡´ä¿å¯†ä¿¡æ¯çš„æ³„éœ²ã€‚</li>
</ul>
<h2 id="6-5-å“åº”é¦–éƒ¨å­—æ®µ"><a href="#6-5-å“åº”é¦–éƒ¨å­—æ®µ" class="headerlink" title="6.5 å“åº”é¦–éƒ¨å­—æ®µ"></a>6.5 å“åº”é¦–éƒ¨å­—æ®µ</h2><h4 id="Accept-Ranges"><a href="#Accept-Ranges" class="headerlink" title="Accept-Ranges"></a>Accept-Ranges</h4><ul>
<li>Accept-Ranges æ˜¯ç”¨æ¥å‘ŠçŸ¥å®¢æˆ·ç«¯æœåŠ¡å™¨æ˜¯å¦èƒ½å¤„ç†èŒƒå›´è¯·æ±‚ï¼Œä»¥æŒ‡å®šè·å–æœåŠ¡å™¨ç«¯æŸä¸ªéƒ¨åˆ†çš„èµ„æºã€‚ä¸€ç§æ—¶bytesèƒ½å¤„ç†ä¸€ç§ä¸ºnoneä¸èƒ½å¤„ç†</li>
</ul>
<h4 id="age"><a href="#age" class="headerlink" title="age"></a>age</h4><ul>
<li>é¦–éƒ¨å­—æ®µ Age èƒ½å‘ŠçŸ¥å®¢æˆ·ç«¯ï¼ŒæºæœåŠ¡å™¨åœ¨å¤šä¹…å‰åˆ›å»ºäº†å“åº”ã€‚å­—æ®µå€¼çš„å•ä½ä¸ºç§’ã€‚</li>
</ul>
<h4 id="ETag"><a href="#ETag" class="headerlink" title="ETag"></a>ETag</h4><ul>
<li>é¦–éƒ¨å­—æ®µ ETag èƒ½å‘ŠçŸ¥å®¢æˆ·ç«¯å®ä½“æ ‡è¯†ã€‚å®ƒæ˜¯ä¸€ç§å¯å°†èµ„æºä»¥å­—ç¬¦ä¸²å½¢å¼åšå”¯ä¸€æ€§æ ‡è¯†çš„æ–¹å¼ã€‚<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å¼º ETag å€¼ ä¸è®ºå®ä½“å‘ç”Ÿå¤šä¹ˆç»†å¾®çš„å˜åŒ–éƒ½ä¼šæ”¹å˜å…¶å€¼</span><br><span class="line">ETag: &quot;usagi-1234&quot;</span><br><span class="line"></span><br><span class="line">//å¼± ETag å€¼ å¼± ETag å€¼åªç”¨äºæç¤ºèµ„æºæ˜¯å¦ç›¸åŒä¼šåœ¨å­—æ®µå€¼æœ€å¼€å§‹å¤„é™„åŠ  W/ã€‚</span><br><span class="line">ETag: W/&quot;usagi-1234&quot;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Location"><a href="#Location" class="headerlink" title="Location"></a>Location</h4><ul>
<li>è¯¥å­—æ®µä¼šé…åˆ 3xx ï¼šRedirection çš„å“åº”ï¼Œæä¾›é‡å®šå‘çš„<br>URIã€‚</li>
</ul>
<h4 id="Proxy-Authenticate"><a href="#Proxy-Authenticate" class="headerlink" title="Proxy-Authenticate"></a>Proxy-Authenticate</h4><ul>
<li>é¦–éƒ¨å­—æ®µ Proxy-Authenticate ä¼šæŠŠç”±ä»£ç†æœåŠ¡å™¨æ‰€è¦æ±‚çš„è®¤è¯ä¿¡æ¯å‘é€ç»™å®¢æˆ·ç«¯</li>
</ul>
<h4 id="Retry-After"><a href="#Retry-After" class="headerlink" title="Retry-After"></a>Retry-After</h4><ul>
<li>é¦–éƒ¨å­—æ®µ Retry-After å‘ŠçŸ¥å®¢æˆ·ç«¯åº”è¯¥åœ¨å¤šä¹…ä¹‹åå†æ¬¡å‘é€è¯·æ±‚ã€‚ä¸»è¦é…åˆçŠ¶æ€ç  503 Service Unavailable å“åº”ï¼Œæˆ– 3xx Redirect å“åº”ä¸€èµ·ä½¿ç”¨ã€‚</li>
</ul>
<h4 id="Vary"><a href="#Vary" class="headerlink" title="Vary"></a>Vary</h4><ul>
<li>ä»ä»£ç†æœåŠ¡å™¨æ¥æ”¶åˆ°æºæœåŠ¡å™¨è¿”å›åŒ…å« Vary æŒ‡å®šé¡¹çš„å“åº”ä¹‹åï¼Œè‹¥å†è¦è¿›è¡Œç¼“å­˜ï¼Œä»…å¯¹è¯·æ±‚ä¸­å«æœ‰ç›¸åŒ Vary æŒ‡å®šé¦–éƒ¨å­—æ®µçš„è¯·æ±‚è¿”å›ç¼“å­˜ã€‚å³ä½¿å¯¹ç›¸åŒèµ„æºå‘èµ·è¯·æ±‚ï¼Œä½†ç”±äº Vary æŒ‡å®šçš„é¦–éƒ¨å­—æ®µä¸ç›¸åŒï¼Œå› æ­¤å¿…é¡»è¦ä»æºæœåŠ¡å™¨é‡æ–°è·å–èµ„æºã€‚<br><img src="/2017/10/19/http/Vary.png" alt="Vary"></li>
</ul>
<h2 id="6-6-å®ä½“é¦–éƒ¨å­—æ®µ"><a href="#6-6-å®ä½“é¦–éƒ¨å­—æ®µ" class="headerlink" title="6.6 å®ä½“é¦–éƒ¨å­—æ®µ"></a>6.6 å®ä½“é¦–éƒ¨å­—æ®µ</h2>]]></content>
  </entry>
  <entry>
    <title>Javscript.The Coreï¼š2nd Edition</title>
    <url>/2017/12/04/javascript%E6%A0%B8%E5%BF%83/</url>
    <content><![CDATA[<p>è¿™æ˜¯â€™javascriptæ ¸å¿ƒâ€™æ¦‚è§ˆç¬¬äºŒç‰ˆï¼Œæ–‡ç« å†…å®¹ä¸»è¦æ˜¯ECMAScriptç¨‹åºè¯­è¨€ä»¥åŠè¿è¡Œæ—¶ç³»ç»Ÿæ ¸å¿ƒéƒ¨åˆ†.</p>
<p>é¢å‘é˜…è¯»å¯¹è±¡ï¼šä¸“ä¸šå¼€å‘è€…</p>
<ol>
<li><a href="#object">å¯¹è±¡(Object)</a></li>
<li><a href="#prototype">åŸå‹(Prototype)</a></li>
<li><a href="#class">ç±»(Class)</a></li>
<li><a href="#executionContext">æ‰§è¡Œä¸Šä¸‹æ–‡(Execution context)</a></li>
<li><a href="#environment">ç¯å¢ƒ(Environment)</a></li>
<li><a href="#closure">é—­åŒ…(Closure)</a></li>
<li><a href="#this">This</a></li>
<li><a href="#realm">èŒƒå›´(Realm)</a></li>
<li><a href="#Job">Job</a></li>
<li><a href="#agent">ä»£ç†(Agent)</a></li>
</ol>
<span id="more"></span>
<p>ç¬¬ä¸€ç‰ˆçš„æ–‡ç« ä¸»è¦è¦†ç›–äº†jsè¯­è¨€ä»¥ä¸‹è¿™äº›æ–¹é¢ï¼Œä»es3ä¸­æŠ½è±¡çš„æ¦‚å¿µï¼Œä»¥åŠä¸€äº›åœ¨es5æˆ–es6ä¸­åˆé€‚çš„æ”¹å˜ã€‚</p>
<p>è‡ªä»es2015å¼€å§‹ï¼Œè¿™äº›æ ¸å¿ƒçš„æ¦‚å¿µå·²ç»å‘ç”Ÿäº†æ”¹å˜å¹¶ä¸”å¼•å…¥äº†æ–°çš„æ¨¡å—ï¼Œåœ¨è¿™ä¸€ç‰ˆçš„æ–‡ç« ä¸­æˆ‘ä»¬å°†èšç„¦ä¸€äº›æ–°æ¦‚å¿µå’Œæ–°æŠ€æœ¯ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿä¼šå…¼é¡¾é‚£äº›ä¸åŒæ–‡æ¡£é—´ä¿æŒä¸å˜çš„jsåŸºç¡€ç»“æ„ã€‚  </p>
<p>è¿™ç¯‡æ–‡ç« å°†è¦†ç›– ES2017+è¿è¡Œæ—¶ç³»ç»Ÿ</p>
<ul>
<li>æ³¨æ„ï¼š æœ€æ–°ç‰ˆçš„ECMAScriptæ–‡æ¡£å¯ä»¥åœ¨TC-39ç½‘ç«™æ‰¾åˆ°</li>
</ul>
<p>æˆ‘ä»¬ä»è®¨è®ºå¯¹è±¡æ¦‚å¿µå¼€å§‹ï¼Œå®ƒæ˜¯æ•´ä¸ªECMAScriptçš„æ ¹åŸº.</p>
<h2 id="Object"><a href="#Object" class="headerlink" title="Object"></a><span id="object">Object</span></h2><p>ECMAScript æ˜¯ä¸€é—¨åŸºäºåŸå‹çš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ï¼Œå¯¹è±¡æ˜¯å®ƒçš„æ ¸å¿ƒæ¦‚å¿µã€‚</p>
<ul>
<li>Def.1 :å¯¹è±¡ï¼šå¯¹è±¡æ˜¯å±æ€§çš„é›†åˆï¼Œä¸”æ‹¥æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œè¿™ä¸ªåŸå‹è¦ä¹ˆæ˜¯ä¸ªobjectè¦ä¹ˆæ˜¯nullå€¼.</li>
</ul>
<p>è®©æˆ‘ä»¬åˆ›é€ ä¸€ä¸ªåŸºæœ¬çš„å¯¹è±¡ï¼Œå¯¹è±¡çš„åŸå‹æ˜¯é€šè¿‡ä¸€ä¸ªå†…éƒ¨å±æ€§[[Prototype]]å¼•ç”¨,åœ¨ç”¨æˆ·å±‚é¢è¿™ä¸ªå±æ€§åŒè¿‡__proto__æ¥å¼•ç”¨.  </p>
<p>çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let point = &#123;</span><br><span class="line">    x: 10,</span><br><span class="line">    y: 20</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªç»“æ„ä¸­æœ‰ä¸¤ä¸ªæˆ‘ä»¬çš„æ˜¾æ€§å±æ€§å¾ˆä¸€ä¸ªéšå¼å±æ€§__proto__,è¿™ä¸ªå±æ€§å®ƒæŒ‡å‘pointçš„åŸå‹:  </p>
<p><img src="/2017/12/04/javascript%E6%A0%B8%E5%BF%83/js-object.png" alt="js-object"></p>
<p>æ³¨æ„ï¼šå¯¹è±¡ä¹Ÿå¯ä»¥å­˜å‚¨symbols,ä½ å¯ä»¥ä»<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol">è¿™ä»½æ–‡æ¡£</a>å¾—åˆ°æ›´å¤šçš„ä¿¡æ¯.  </p>
<p>åŸå‹å¯¹è±¡é€šå¸¸ç”¨äºå®ç°ç»§æ‰¿æ¥åŠ¨æ€åˆ†å‘,è®©æˆ‘ä»¬æ¥çœ‹çœ‹åŸå‹é“¾ç»†èŠ‚.  </p>
<h2 id="åŸå‹-Prototype"><a href="#åŸå‹-Prototype" class="headerlink" title="åŸå‹(Prototype)"></a><span id="prototype">åŸå‹(Prototype)</span></h2><p>æ¯ä¸ªå¯¹è±¡åœ¨å…¶åˆ›å»ºçš„æ—¶å€™æ¥å—ä¸€ä¸ªåŸå‹.å¦‚æœè¿™ä¸ªåŸå‹æ²¡æœ‰æ˜¾å¼è®¾ç½®,é‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ä¼šæ¥å—ä¸€ä¸ªé»˜è®¤åŸå‹å½“åšå®ƒçš„ç»§æ‰¿å¯¹è±¡.  </p>
<ul>
<li>Def.2:åŸå‹:prototypeæ˜¯ä¸€ä¸ªå§”æ‰˜å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡é€šå¸¸ç”¨äºå®ç°åŸºäºåŸå‹çš„ç»§æ‰¿.</li>
</ul>
<p>åŸå‹å¯ä»¥é€šè¿‡__prot__å±æ€§æˆ–è€…Object.createæ–¹æ³•è¿›è¡Œæ˜¾å¼è®¾ç½®:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Base object.</span><br><span class="line">let point = &#123;</span><br><span class="line">  x: 10,</span><br><span class="line">  y: 20,</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">// Inherit from `point` object.</span><br><span class="line">let point3D = &#123;</span><br><span class="line">  z: 30,</span><br><span class="line">  __proto__: point,</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">console.log(</span><br><span class="line">  point3D.x, // 10, inherited</span><br><span class="line">  point3D.y, // 20, inherited</span><br><span class="line">  point3D.z  // 30, own</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼š é»˜è®¤çš„åŸå‹ç»§æ‰¿è‡ªObject.prototype.  </p>
<p>ä»»ä½•ä¸€ä¸ªå¯¹è±¡å¯ä»¥è¢«å½“åšå¦ä¸€ä¸ªå¯¹è±¡çš„åŸå‹,å¹¶ä¸”åŸå‹æœ¬èº«ä¹Ÿå¯ä»¥æœ‰è‡ªå·±çš„åŸå‹.å¦‚æœåŸå‹çš„åŸå‹æŒ‡å‘ä¸€ä¸ªéç©º(no-null)å¼•ç”¨,ä»¥æ­¤ç±»æ¨ï¼Œè¿™æ ·å°±å½¢å‚äº†åŸå‹é“¾.  </p>
<ul>
<li>Def.3: åŸå‹é“¾ï¼š åŸå‹é“¾æ˜¯ä¸€ä¸ªæœ‰é™çš„å¯¹è±¡é“¾ï¼Œè¿™ä¸ªå¯¹è±¡é“¾é€šå¸¸ç”¨äºå®ç°ç»§æ‰¿çš„å±æ€§å…±äº«.</li>
</ul>
<p><img src="/2017/12/04/javascript%E6%A0%B8%E5%BF%83/prototype-chain.png" alt="prototype-chain"></p>
<p>åŸå‹é“¾çš„è§„åˆ™ä¹Ÿæ˜¯ç›¸å½“ç®€å•: å¦‚æœä¸€ä¸ªå±æ€§åœ¨å¯¹è±¡ä¸Šæ²¡æœ‰æ‰¾åˆ°,é‚£ä¹ˆå°±ä»å®ƒçš„åŸå‹ä¸Šæ‰¾,ç„¶åå†åŸå‹çš„åŸå‹ä¸Šæ‰¾,ä»¥æ­¤ç±»æ¨ç›´åˆ°åŸå‹é“¾éƒ½è¢«éå†ä¸ºæ­¢.  </p>
<p>æŠ€æœ¯ä¸Šæ¥è¯´è¿™ä¸ªæœºåˆ¶é€šå¸¸ä»¥åŠ¨æ€åˆ†å‘(dynamic dispatch)æˆ–è€…å§”æ‰˜(delegation)è€Œè‘—ç§°.  </p>
<p>Def.4: å§”æ‰˜ï¼šä¸€ä¸ªç”¨æ¥åœ¨ç»§æ‰¿é“¾ä¸Šæ‰¾å¯»å±æ€§çš„æœºåˆ¶,å®ƒé€šå¸¸å‘ç”Ÿåœ¨è¿è¡Œæ—¶,å› æ­¤ä¹Ÿè¢«ç§°ä½œåŠ¨æ€åˆ†å‘(dynamic dispatch)</p>
<ul>
<li>æ³¨æ„ï¼šä¸åŠ¨æ€åˆ†å‘åœ¨è¿è¡Œæ—¶æ±‚å€¼ç›¸åçš„æ˜¯,é™æ€åˆ†å‘(static dispatch)åœ¨ç¼–è¯‘æ—¶ç¡®å®šå¼•ç”¨å€¼.</li>
</ul>
<p>å¦‚æœå±æ€§åœ¨åŸå‹é“¾ä¸Šå¹¶æ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£ä¹ˆundefinedå°†ä½œä¸ºå€¼è¿”å›.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// An &quot;empty&quot; object.</span><br><span class="line">let empty = &#123;&#125;;</span><br><span class="line"> </span><br><span class="line">console.log(</span><br><span class="line"> </span><br><span class="line">  // function, from default prototype</span><br><span class="line">  empty.toString,</span><br><span class="line">   </span><br><span class="line">  // undefined</span><br><span class="line">  empty.x,</span><br><span class="line"> </span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>æ­£å¦‚æˆ‘æ‰€çœ‹åˆ°çš„ï¼Œä¸€ä¸ªé»˜è®¤å¯¹è±¡å®é™…ä¸Šæ°¸è¿œéƒ½ä¸æ˜¯ç©ºçš„,å®ƒæ€»æ˜¯ä»Object.prototypeç»§æ‰¿ä¸€äº›ä¸œè¥¿.å¦‚æœæƒ³ç»§æ‰¿ä¸€ä¸ªç©ºå¯¹è±¡,æˆ‘ä»¬å¯ä»¥æ˜¾å¼çš„è®¾ç½®å®ƒçš„åŸå‹ä¸ºnullï¼š   </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Doesn&#x27;t inherit from anything.</span><br><span class="line">let dict = Object.create(null);</span><br><span class="line"> </span><br><span class="line">console.log(dict.toString); // undefined</span><br></pre></td></tr></table></figure>

<p>åŠ¨æ€åˆ†å‘æœºåˆ¶å…è®¸å…¶ä¿®æ”¹åŸå‹é“¾ä¸Šå§”æ‰˜å¯¹è±¡:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let protoA = &#123;x: 10&#125;;</span><br><span class="line">let protoB = &#123;x: 20&#125;;</span><br><span class="line"></span><br><span class="line">// Same as &#x27;let objectC = &#123;__proto__: protoA&#125;;&#x27;</span><br><span class="line">let objectC = Object,create(protoA);</span><br><span class="line">console.log(objectC.x); // 10</span><br><span class="line"></span><br><span class="line">// change the delegate</span><br><span class="line">Object.setPrototypeOf(objctC, protoB);</span><br><span class="line">console.log(objectC.X); // 20</span><br></pre></td></tr></table></figure>

<ul>
<li>æ³¨æ„ï¼š ç»è¿‡åœ¨ä»Šå¤©__proto__å±æ€§å·²ç»æ ‡å‡†åŒ–äº†,ä½†æ˜¯å®è·µå’Œä¸¾ä¾‹ä¸­äººä»¬æ›´åŠ æ„¿æ„ä½¿ç”¨å¦‚Object.create,Object.getPrototypeOf,Object.setPrototypeOf è¿™æ ·çš„APIæ–¹æ³•æ¥æ“ä½œåŸå‹.</li>
</ul>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬çœ‹åˆ°Obejct.prototyep,è¢«ä¸åŒçš„å¯¹è±¡å…±äº«ä¸ºåŸå‹,è¿™æ˜¯ECMAScriptä»¥åŸºäºç±»ç»§æ‰¿çš„å®ç°æ–¹å¼.è®©æˆ‘ä»¬åœ¨çœ‹çœ‹JSä¸­çš„ç±»çš„æ¦‚å¿µ.  </p>
<h2 id="ç±»-Class"><a href="#ç±»-Class" class="headerlink" title="ç±»(Class)"></a><span id="class">ç±»(Class)</span></h2><p>å½“ä¸åŒçš„å¯¹è±¡æ‹¥æœ‰ç›¸åŒçš„åˆå§‹çŠ¶æ€å’Œè¡Œä¸º,è¿™æ—¶å®ƒä»¬å…±åŒçš„å½¢æˆäº†ä¸€ä¸ªç±».  </p>
<ul>
<li>Def.5: ç±»ï¼š ç±»æ˜¯ä¸€ç»„æ‹¥æœ‰ç‰¹å®šåˆå§‹çŠ¶æ€å’Œè¡Œä¸ºçš„å¯¹è±¡.</li>
</ul>
<p>å½“æˆ‘ä»¬éœ€è¦å¯¹å¤šä¸ªå¯¹è±¡ç»§æ‰¿è‡ªç›¸åŒåŸå‹æ—¶,æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªåŸå‹ï¼Œç„¶åæ˜¾å¼çš„ä»è¿™ä¸ªåˆ›å»ºçš„åŸå‹ç»§æ‰¿.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Generic prototype for all letters.</span><br><span class="line">let letter = &#123;</span><br><span class="line">  getNumber() &#123;</span><br><span class="line">    return this.number;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">let a = &#123;number: 1, __proto__: letter&#125;;</span><br><span class="line">let b = &#123;number: 2, __proto__: letter&#125;;</span><br><span class="line">// ...</span><br><span class="line">let z = &#123;number: 26, __proto__: letter&#125;;</span><br><span class="line"> </span><br><span class="line">console.log(</span><br><span class="line">  a.getNumber(), // 1</span><br><span class="line">  b.getNumber(), // 2</span><br><span class="line">  z.getNumber(), // 26</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥ä»ä¸‹å›¾ä¸­çœ‹ä»–ä»¬ä¹‹é—´çš„å…³ç³»:  </p>
<p><img src="/2017/12/04/javascript%E6%A0%B8%E5%BF%83/shared-prototype.png" alt="shared-prototype"></p>
<p>ç„¶è€Œè¿™çœ‹èµ·æ¥ç›¸å½“ç¬¨é‡.å¹¶ä¸”ç±»æŠ½è±¡åˆšå¥½å……å½“äº†å¥æ³•ç³–çš„ä½œç”¨(i.eè¿™ä¸ªç»“æ„åœ¨è¯­ä¹‰ä¸Šæ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯æ˜¯ä»¥ä¸€ç§æ›´åŠ è¯æ³•åŒ–çš„å½¢å¼),å®ƒè®©æˆ‘ä»¬ä»¥ä¸€ç§æ–¹ä¾¿çš„æ¨¡å¼åˆ›å»ºè¿™æ ·çš„å¯¹è±¡.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class Letter &#123;</span><br><span class="line">  constructor(number) &#123;</span><br><span class="line">    this.number = number;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  getNumber() &#123;</span><br><span class="line">    return this.number;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">let a = new Letter(1);</span><br><span class="line">let b = new Letter(2);</span><br><span class="line">// ...</span><br><span class="line">let z = new Letter(26);</span><br><span class="line"> </span><br><span class="line">console.log(</span><br><span class="line">  a.getNumber(), // 1</span><br><span class="line">  b.getNumber(), // 2</span><br><span class="line">  z.getNumber(), // 26</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>æ³¨æ„ï¼šåŸºäºç±»çš„ç»§æ‰¿åœ¨ESä¸­æ˜¯é€šè¿‡åŸå‹å§”æ‰˜æ¥å®ç°çš„.  </p>
</li>
<li><p>æ³¨æ„ï¼šç±»åªæ˜¯ä¸€ç§ç†è®ºä¸Šçš„æŠ½è±¡.ç†è®ºä¸Šæ¥è¯´å®ƒæ—¢å¯ä»¥é€šè¿‡é™æ€åˆ†å‘æ¥å®ç°,å¦‚åœ¨javaæˆ–è€…c++,ä¹Ÿå¯ä»¥é€šè¿‡åŠ¨æ€åˆ†å‘(å§”æ‰˜)æ¥å®ç°,å¦‚javascript,Python,Ruby.ç­‰ç­‰.</p>
</li>
</ul>
<p>ç†è®ºä¸Šç±»å¯ä»¥ç”±â€æ„é€ å‡½æ•°+åŸå‹â€æ¥è¡¨ç¤º.æ„é€ å‡½æ•°åœ¨åˆ›å»ºå¯¹è±¡çš„åŒæ—¶è‡ªåŠ¨çš„å°†ä¸ºæ–°åˆ›å»ºçš„å®ä¾‹è®¾ç½®åŸå‹.å®ƒçš„åŸå‹è¢«å­˜å‚¨åœ¨ConstructorFunction.prototype(æ„é€ å‡½æ•°çš„åŸå‹)ä¸Š.  </p>
<ul>
<li>Def.6: æ„é€ å™¨: æ„é€ å™¨æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºå®ä¾‹å¹¶ä¸”è‡ªåŠ¨ä¸ºå®ä¾‹è®¾ç½®åŸå‹çš„å‡½æ•°.</li>
</ul>
<p> å¯ä»¥æ˜¾ç¤ºçš„ä½¿ç”¨ä¸€ä¸ªæ„é€ å™¨å‡½æ•°ï¼Œè€Œä¸”åœ¨ç±»æŠ½è±¡è¢«å¼•è¿›ä¹‹å‰,JSå¼€å‘è€…å¹¶æ²¡æœ‰æ›´å¥½çš„é€‰æ‹©(æˆ‘ä»¬å¯ä»¥åœ¨å› ç‰¹ç½‘ä¸Šçœ‹åˆ°è®¸å¤šè¿™æ ·é—ç•™ä»£ç ):</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> function Letter(number) &#123;</span><br><span class="line">  this.number = number;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Letter.prototype.getNumber = function() &#123;</span><br><span class="line">  return this.number;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">let a = new Letter(1);</span><br><span class="line">let b = new Letter(2);</span><br><span class="line">// ...</span><br><span class="line">let z = new Letter(26);</span><br><span class="line"> </span><br><span class="line">console.log(</span><br><span class="line">  a.getNumber(), // 1</span><br><span class="line">  b.getNumber(), // 2</span><br><span class="line">  z.getNumber(), // 26</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>å½“åˆ›å»ºä¸€ä¸ªå•ä¸€å±‚çº§çš„æ„é€ å™¨æ˜¯ä¸€ä»¶ç›¸å½“å®¹æ˜“çš„äº‹,ä»çˆ¶ç±»ç»§æ‰¿çš„æ¨¡å‹éœ€è¦æ›´å¤šçš„æ¨¡æ¿.å½“å‰è¿™ç§æ¨¡æ¿çš„å®ç°ç»†èŠ‚åœ¨æˆ‘ä»¬åˆ›å»ºJSç±»æ—¶å·²ç»è¢«éšè—èµ·æ¥äº†.  </p>
<ul>
<li>æ³¨æ„ï¼šæ„é€ å™¨å‡½æ•°åªæ˜¯åŸºäºç±»ç»§æ‰¿çš„å®ç°ç»†èŠ‚.</li>
</ul>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¯¹è±¡å’Œç±»çš„å…³ç³»:  </p>
<p><img src="/2017/12/04/javascript%E6%A0%B8%E5%BF%83/js-constructor.png" alt="jsConstructor"></p>
<p>è¿™å¼ å›¾å±•ç¤ºäº†æ¯ä¸ªå¯¹è±¡éƒ½å’Œä¸€ä¸ªåŸå‹ç›¸å…³è”,ç”šè‡³æ„é€ å™¨å‡½æ•°(class)Letterä¹Ÿæœ‰è‡ªå·±çš„åŸå‹,è¿™ä¸ªå‡½æ•°çš„åŸå‹æŒ‡å‘Function.prototype. æ³¨æ„Letter.prototypeæ˜¯Letterå®ä¾‹çš„åŸå‹ä¹Ÿå°±æ˜¯a,b,z.  </p>
<ul>
<li>æ³¨æ„:å¯¹äºä»»ä½•å¯¹è±¡çš„å®é™…åŸå‹éƒ½æ˜¯æŒ‡__proto__.åŒæ—¶åœ¨æ„é€ å‡½æ•°çš„æ˜¾ç¤ºå±æ€§prototypeåªæ˜¯æŒ‡å‘å®ä¾‹çš„åŸå‹çš„å¼•ç”¨.å…¶å®å®ä¾‹çš„åŸå‹ä»ç„¶æ˜¯__proto__.å¯ä»¥ä»<a href="http://dmitrysoshnikov.com/ecmascript/chapter-7-2-oop-ecmascript-implementation/#explicit-codeprototypecode-and-implicit-codeprototypecode-properties">è¿™é‡Œ</a>æŸ¥çœ‹æ›´å¤šç»†èŠ‚.</li>
</ul>
<p>ä½ å¯ä»¥ä»<a href="http://dmitrysoshnikov.com/ecmascript/chapter-7-1-oop-general-theory/">ES3. 7.1 OOP: The general theory</a>æ–‡ç« ä¸­æ‰¾åˆ°æ›´å¤šå…³äºä¸€èˆ¬é¢å‘å¯¹è±¡ç¼–ç¨‹(OPP)çš„æ¦‚å¿µ(åŒ…æ‹¬åŸºäºç±»,åŸºäºåŸå‹çš„æè¿°,ç­‰ç­‰)  </p>
<p>ç°åœ¨æˆ‘ä»¬å¯¹ECMAScriptå¯¹è±¡æœ‰äº†åŸºæœ¬çš„äº†è§£,è®©æˆ‘ä»¬å†çœ‹ä¸€ä¸‹JSçš„è¿è¡Œç³»ç»Ÿ,æˆ‘ä»¬å°†çœ‹åˆ°,åœ¨é‚£å„¿ä»»ä½•ä¸œè¥¿éƒ½å°†ä»¥å¯¹è±¡å‘ˆç°.  </p>
<h2 id="æ‰§è¡Œä¸Šä¸‹æ–‡-Execution-context"><a href="#æ‰§è¡Œä¸Šä¸‹æ–‡-Execution-context" class="headerlink" title="æ‰§è¡Œä¸Šä¸‹æ–‡(Execution context)"></a><span id="executionContext">æ‰§è¡Œä¸Šä¸‹æ–‡(Execution context)</span></h2><p>ä¸ºäº†æ‰§è¡ŒJSä»£ç çš„åŒæ—¶è·Ÿè¸ªä»£ç è¿è¡Œæ—¶çš„æ±‚å€¼,ECMAScript è§„èŒƒå®šä¹‰äº†æ‰§è¡Œä¸Šä¸‹æ–‡çš„æ¦‚å¿µ.é€»è¾‘ä¸Šæ¥è¯´æ‰§è¡Œä¸Šä¸‹æ–‡åšæŒä½¿ç”¨æ ˆ(stack:æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆæˆ‘ä»¬å°†å¾ˆå¿«çœ‹åˆ°),å®ƒå¯¹åº”çš„æ›´å¹¿ä¸ºäººçŸ¥çš„æ¦‚å¿µä¸ºè°ƒç”¨æ ˆ.  </p>
<ul>
<li>Def.7: æ‰§è¡Œä¸Šä¸‹æ–‡ï¼šæ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªç”¨äºè·Ÿè¸ªè¿è¡Œæ—¶å¯¹ä»£ç æ±‚å€¼çš„ä¸œè¥¿</li>
</ul>
<p>åœ¨ESCMScriptä¸­æœ‰å‡ ç§ç±»å‹çš„ä»£ç ï¼šå…¨å±€ä»£ç , å‡½æ•°ä»£ç ,evalä»£ç ,æ¨¡å—ä»£ç .æ¯ä¸€ç§ä»£ç éƒ½æ˜¯åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ±‚å€¼.ä¸åŒçš„ä»£ç ï¼Œåœ¨ä¸€å®šç±»å‹å¯¹è±¡ä¸‹ä¼šå½±å“æ‰§è¡Œä¸Šä¸‹æ–‡çš„ç»“æ„ï¼šå¦‚generator functionåœ¨ä¸Šä¸‹æ–‡ä¸­ä¿å­˜å®ƒä»¬çš„genaratorå¯¹è±¡æ—¶.  </p>
<p>è®©æˆ‘ä»¬çœ‹ä¸€çœ‹ä¸‹é¢çš„å‡½æ•°é€’å½’è°ƒç”¨:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function recursive(flag) &#123;</span><br><span class="line"> </span><br><span class="line">  // Exit condition.</span><br><span class="line">  if (flag === 2) &#123;</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  // Call recursively.</span><br><span class="line">  recursive(++flag);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// Go.</span><br><span class="line">recursive(0);</span><br></pre></td></tr></table></figure>

<p>ä¸€æ—¦ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶,ä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡å°†è¢«åˆ›å»º,åŒæ—¶å°†å®ƒæ¨è¿›æ ˆä¸­â€“è¿™æ—¶å°±å˜æˆä¸€ä¸ªæ´»åŠ¨æ‰§è¡Œä¸Šä¸‹æ–‡(active execution context),å½“ä¸€ä¸ªå‡½æ•°è¿”å›æ—¶,è¿™ä¸ªä¸Šä¸‹æ–‡å°±ä»æ ˆä¸­å(poped)å‡ºæ¥.  </p>
<p>ä¸€ä¸ªä¸Šä¸‹æ–‡è°ƒç”¨å¦ä¸€ä¸ªä¸Šä¸‹æ–‡æ—¶ï¼Œå‰ä¸€ä¸ªä¸Šä¸‹æ–‡è¢«ç§°åšè°ƒç”¨è€…(caller),å½“ä¸€ä¸ªä¸Šä¸‹æ–‡è¢«è°ƒç”¨å¯¹åº”çš„è¢«ç§°ä½œè¢«è°ƒç”¨è€…(callee).åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­recursiveå‡½æ•°æ‰®æ¼”ç€ä¸¤ä¸ªè§’è‰²ï¼šè°ƒç”¨è€…å’Œè¢«è°ƒç”¨è€….  </p>
<ul>
<li>Def.8: æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆï¼šæ‰§è¡Œä¸Šä¸‹æ–‡æ ˆæ˜¯ä¸€ä¸ªåè¿›å…ˆå‡º(LIFO)çš„ç»“æ„,è¿™ç§ç»“æ„è¢«ç”¨æ¥æ§åˆ¶æ‰§è¡Œé¡ºåºå’Œæµ.</li>
</ul>
<p>å¯¹äºä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬éµå¾ªæ ˆçš„â€push-popâ€é™åˆ¶ï¼š  </p>
<p><img src="/2017/12/04/javascript%E6%A0%B8%E5%BF%83/execution-stack.png" alt="executionStack"> </p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°,å…¨å±€ä¸Šä¸‹æ–‡æ€»æ˜¯æ ˆåº•éƒ¨,å®ƒåœ¨æ‰§è¡Œæ‰€æœ‰å…¶ä»–ä¸Šä¸‹æ–‡å‰å°±å·²ç»åˆ›å»º.  </p>
<p>ä½ å¯ä»¥åœ¨<a href="http://dmitrysoshnikov.com/ecmascript/chapter-1-execution-contexts/">åˆé€‚çš„ç« èŠ‚</a>æ‰¾åˆ°æ›´å¤šçš„ç»†èŠ‚.   </p>
<p>é€šå¸¸,ä¸Šä¸‹æ–‡ä¸­ä»£ç å°†ä¼šè¿è¡Œå®Œæˆï¼Œä½†æ˜¯æ­£å¦‚æˆ‘æ‰€ä¸Šé¢æåˆ°çš„â€“å¦‚generatorsä¹Ÿè®¸ä¼šç ´ååæ ˆçš„è¿›å…ˆå‡ºé¡ºåº.ä¸€ä¸ªgeneratorå‡½æ•°ä¹Ÿè®¸ä¼šæš‚åœå®ƒçš„è¿è¡Œä¸Šä¸‹æ–‡,åŒæ—¶åœ¨å®ƒæ‰§è¡Œå®Œä¹‹å‰å°†å®ƒä»æ ˆä¸­ç§»é™¤.ä¸€æ—¦generatorè¢«å†æ¬¡æ¿€æ´»,å®ƒçš„ä¸Šä¸‹æ–‡ä¼šå†æ¬¡å›å¤å¹¶ä¸”å°†å†æ¬¡è¢«æ¨è¿›æ ˆä¸­:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function *gen() &#123;</span><br><span class="line">  yield 1;</span><br><span class="line">  return 2;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">let g = gen();</span><br><span class="line"> </span><br><span class="line">console.log(</span><br><span class="line">  g.next().value, // 1</span><br><span class="line">  g.next().value, // 2</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„yieldè¯­å¥å°†å¯¹è°ƒç”¨è€…è¿”å›valueå€¼,åŒæ—¶ä¸Šä¸‹æ–‡å°†è¢«åå‡º.å½“ç¬¬äºŒä¸ªnextè°ƒç”¨æ—¶,ç›¸åŒçš„ä¸Šä¸‹æ–‡å°†è¢«æ¨è¿›æ ˆä¸­æ¢å¤.è¿™æ ·ä¸Šä¸‹æ–‡å°†ä¼šåœ¨åˆ›å»ºå®ƒçš„è°ƒç”¨è€…ä¹‹å¤–å­˜æ´»,å› æ­¤å®ƒç ´åäº†åè¿›å…ˆå‡ºçš„ç»“æ„.  </p>
<ul>
<li>æ³¨æ„ï¼šä½ å¯ä»¥ä»è¿™ä¸ª<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators">æ–‡æ¡£</a>é˜…è¯»æ›´å¤šå…³äºgeneratorså’Œiteratorsçš„ç»†èŠ‚.</li>
</ul>
<p>æˆ‘ä»¬å°†ç°åœ¨è®¨è®ºä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡çš„é‡è¦ç»„æˆéƒ¨åˆ†,ç‰¹åˆ«æ˜¯ECMACriptè¿è¡Œä¸­åœ¨åµŒå¥—ä»£ç å—ä¸­å¦‚ä½•ç®¡ç†å˜é‡å­˜å‚¨å’Œä½œç”¨åŸŸ.ä¸€èˆ¬å®ƒä»¬è¢«ç§°åšè¯æ³•ç¯å¢ƒï¼šå®ƒä»¬åœ¨JSä¸­ç”¨æ¥å­˜å‚¨æ•°æ®ä»¥åŠè§£å†³â€å‡½æ•°ä½œä¸ºå‚æ•°é—®é¢˜(Funarg problem)â€â€“å’Œé—­åŒ…æœºåˆ¶.  </p>
<h2 id="ç¯å¢ƒ-Environment"><a href="#ç¯å¢ƒ-Environment" class="headerlink" title="ç¯å¢ƒ(Environment)"></a><span id="environment">ç¯å¢ƒ(Environment)</span></h2><p>æ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹ç›¸å…³è”çš„è¯æ³•ç¯å¢ƒ.  </p>
<ul>
<li>Def.9: è¯æ³•ç¯å¢ƒï¼š è¯æ³•ç¯å¢ƒæ˜¯ä¸€ä¸ªç”¨äºå®šä¹‰å‡ºç°åœ¨ä¸Šä¸‹æ–‡æ ‡è¯†ç¬¦å’Œå€¼ä¹‹é—´å…³ç³».æ¯ä¸ªç¯å¢ƒéƒ½ä¸€ä¸ªæŒ‡å‘å¯é€‰çˆ¶çº§ç¯å¢ƒçš„å¼•ç”¨.</li>
</ul>
<p>æ‰€ä»¥ä¸€ä¸ªç¯å¢ƒå°±æ˜¯å­˜å‚¨åœ¨ä¸€ä¸ªä½œç”¨åŸŸå®šä¹‰çš„å˜é‡,å‡½æ•°,ç±».  </p>
<p>ç†è®ºä¸Šæ¥è¯´,ç¯å¢ƒæ˜¯ç”±ç¯å¢ƒè®°å½•(ä¸€ä¸ªå®é™…ä¸Šå­˜å‚¨è¡¨,è¡¨çš„å†…å®¹ä¸ºæ ‡è¯†ç¬¦å’Œå€¼ä¹‹é—´çš„æ˜ å°„),ä¸å¯ä»¥æŒ‡å‘çˆ¶çº§ç¯å¢ƒ(å¯èƒ½ä¸ºnull)çš„å¼•ç”¨ç»„æˆ.  </p>
<p>ä»£ç å¦‚ä¸‹:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let x = 10;</span><br><span class="line">let y = 20;</span><br><span class="line"> </span><br><span class="line">function foo(z) &#123;</span><br><span class="line">  let x = 100;</span><br><span class="line">  return x + y + z;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">foo(30); // 150</span><br></pre></td></tr></table></figure>

<p>å…¨å±€ä¸Šä¸‹æ–‡å’Œfooå‡½æ•°ä¸Šä¸‹æ–‡çš„ç¯å¢ƒè§£æ„å…³ç³»å¦‚ä¸‹ï¼š  </p>
<p><img src="/2017/12/04/javascript%E6%A0%B8%E5%BF%83/environment-chain.png" alt="environmentChain">  </p>
<p>è¿™è®©æˆ‘ä»¬æƒ³èµ·å…ˆå‰æåˆ°åŸå‹é“¾.å¹¶ä¸”æ ‡è¯†ç¬¦æ±‚å€¼è§„åˆ™ä¸ä¹‹ç›¸å½“ç›¸ä¼¼: å¦‚æœä¸€ä¸ªå˜é‡åœ¨å½“å‰ç¯ç›‘å±€æ²¡æœ‰æ‰¾åˆ°,é‚£ä¹ˆå°±å‘çˆ¶çº§ç¯å¢ƒå¯»æ‰¾,ç„¶åçˆ¶çº§çš„çˆ¶çº§,ä»¥æ­¤ç±»æ¨,ç›´åˆ°æ•´ä¸ªç¯å¢ƒé“¾è¢«éå†å®Œäº†.  </p>
<ul>
<li>Def.10:æ ‡è¯†ç¬¦æ±‚å€¼ï¼šå®ƒæ˜¯ä¸€ä¸ªåœ¨ç¯å¢ƒé“¾æ±‚å€¼çš„è¿‡ç¨‹,å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç›¸åº”çš„ç»‘å®šå°±ä¼šæŠ›å‡ºä¸€ä¸ªReferenceErroré”™è¯¯.</li>
</ul>
<p>è¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆå˜é‡xæ±‚å€¼ä¸º100,è€Œä¸æ˜¯10â€“å®ƒè¢«åœ¨è‡ªå·±çš„ç¯å¢ƒfooä¸­æ‰¾åˆ°;ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥è®¿é—®å‚æ•°zâ€“å®ƒä¹Ÿæ˜¯æ—¶è¢«å­˜å‚¨åœ¨æ¿€æ´»ç¯å¢ƒä¸­;åŒæ—¶ä¹Ÿèƒ½è§£é‡Šæˆ‘ä»¬å¯ä»¥è·å–yçš„å€¼â€“è¿™æ˜¯å› ä¸ºå®ƒåœ¨çˆ¶çº§ç¯å¢ƒä¸­å¯ä»¥æ‰¾åˆ°.  </p>
<p>ä¸åŸå‹ç›¸ä¼¼çš„æ˜¯,ç›¸åŒçš„çˆ¶çº§ç¯å¢ƒå¯ä»¥è¢«å¤šä¸ªå­çº§ç¯å¢ƒå…±äº«ï¼šå¦‚è¿ä¸ªå…¨å±€å‡½æ•°å…±äº«ä¸€ä¸ªå…¨å±€ç¯å¢ƒ.  </p>
<ul>
<li>æ³¨æ„ï¼šä½ å¯ä»¥ä»<a href="http://dmitrysoshnikov.com/ecmascript/es5-chapter-3-2-lexical-environments-ecmascript-implementation/">è¿™ç¯‡æ–‡ç« </a>å¾—åˆ°å…³äºè¯æ³•ç¯å¢ƒå®ç°çš„ç»†èŠ‚.</li>
</ul>
<p>ç¯å¢ƒè®°å½•æ ¹æ®ç±»å‹è¢«åˆ†ä¸ºä¸¤ç§.ä¸€ç§æ˜¯å¯¹è±¡ç¯å¢ƒè®°å½•å¦ä¸€ç§æ˜¯å£°æ˜ç¯å¢ƒè®°å½•,åœ¨å£°æ˜è®°å½•çš„ä¸Šé¢ä¹Ÿæœ‰å‡½æ•°ç¯å¢ƒè®°å½•ï¼Œmoduleç¯å¢ƒè®°å½•.æ¯ä¸€ç§è®°å½•éƒ½æœ‰å¯¹äºè‡ªå·±å±æ€§çš„ç‰¹å¾.ä½†æ˜¯å¯¹äºæ ‡è¯†ç¬¦æ±‚å€¼çš„ä¸€èˆ¬æœºåˆ¶å®ƒä»¬æ˜¯ä¸åˆ†ç¯å¢ƒçš„,å¹¶ä¸”ä¹Ÿä¸ä¾èµ–è®°å½•çš„ç±»å‹.  </p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…³äºå¯¹è±¡ç¯å¢ƒè®°å½•å¯ä»¥æ˜¯å…¨å±€ç¯å¢ƒ.è¿™ä¸ªè®°å½•ä¸ä¸€ä¸ªç»‘å®šå¯¹è±¡ç›¸å…³è”.ç»‘å®šå¯¹è±¡å¯ä»¥ä»è¿™ä¸ªè®°å½•å­˜å‚¨ä¸€äº›å±æ€§,ä½†æ˜¯ä¸å¯ä»¥ä»å…¶ä»–åœ°æ–¹,åä¹‹äº¦ç„¶.è¿™ä¸ªç»‘å®šå¯¹è±¡å¯ä»¥ä»thiså€¼ä¸­è·å–.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Legacy variables using `var`.</span><br><span class="line">var x = 10;</span><br><span class="line"> </span><br><span class="line">// Modern variables using `let`.</span><br><span class="line">let y = 20;</span><br><span class="line"> </span><br><span class="line">// Both are added to the environment record:</span><br><span class="line">console.log(</span><br><span class="line">  x, // 10</span><br><span class="line">  y, // 20</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line">// But only `x` is added to the &quot;binding object&quot;.</span><br><span class="line">// The binding object of the global environment</span><br><span class="line">// is the global object, and equals to `this`:</span><br><span class="line"> </span><br><span class="line">console.log(</span><br><span class="line">  this.x, // 10</span><br><span class="line">  this.y, // undefined!</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line">// Binding object can store a name which is not</span><br><span class="line">// added to the environment record, since it&#x27;s</span><br><span class="line">// not a valid identifier:</span><br><span class="line"> </span><br><span class="line">this[&#x27;not valid ID&#x27;] = 30;</span><br><span class="line"> </span><br><span class="line">console.log(</span><br><span class="line">  this[&#x27;not valid ID&#x27;], // 30</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å¯ä»¥æç»˜æˆä¸‹é¢å›¾: </p>
<p><img src="/2017/12/04/javascript%E6%A0%B8%E5%BF%83/env-binding-object.png" alt="envBindingObject"></p>
<p>æ³¨æ„ï¼šç»‘å®šå¯¹è±¡çš„å­˜åœ¨æ˜¯ä¸ºå¯ä»¥è¦†ç›–ä¸€äº›é—ç•™çš„è§£æ„,å¦‚varå£°æ˜,withè¯­å¥ï¼Œå®ƒä»¬è¢«å½“åšç»‘å®šå¯¹è±¡.å½“ç¯å¢ƒä»¥ç®€å•å¯¹è±¡æ¥å‘ˆç°æ˜¯æœ‰å†å²åŸå› çš„.å½“å‰çš„ç¯å¢ƒæ¨¡å‹æ˜¯ä¼˜åŒ–è¿‡åçš„ï¼Œä½†æ˜¯ä½œä¸ºç»“æœæ˜¯æˆ‘ä»¬ä¸èƒ½é€šè¿‡å±æ€§æ¥è®¿é—®è¿™äº›ç»‘å®šäº†.  </p>
<p>æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ç¯å¢ƒå¦‚ä½•é€šè¿‡çˆ¶çº§è¿æ¥ç›¸å…³è”.ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç¯å¢ƒæ€æ ·å¯ä»¥è„±ç¦»åˆ›å»ºå®ƒçš„ä¸Šçº¿æ–‡ç»§ç»­å­˜æ´».è¿™å°±å°±æ˜¯æˆ‘ä»¬å°†è¦è®¨è®ºçš„é—­åŒ…åŸç†.  </p>
<h2 id="é—­åŒ…-Closure"><a href="#é—­åŒ…-Closure" class="headerlink" title="é—­åŒ…(Closure)"></a><span id="closure">é—­åŒ…(Closure)</span></h2><p>å‡½æ•°åœ¨ECMAScriptä¸­æ˜¯ç¬¬ä¸€å…¬æ°‘.è¿™æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„é‡è¦çš„æ ¹åŸºæ¦‚å¿µ.è¿™å°±æ„å‘³ç€å‡½æ•°å¼ç¼–ç¨‹åœ¨jsä¸­å¾—åˆ°éƒ¨åˆ†çš„å®ç°.  </p>
<ul>
<li>Def. 11: ç¬¬ä¸€å…¬æ°‘å‡½æ•°:ä¸€ä¸ªå‡½æ•°å¯ä»¥å……å½“æ™®é€šçš„æ•°æ®:å¯ä»¥è¢«å­˜å‚¨ä¸ºå˜é‡,ä¼ åšå‚æ•°,ä»å¦ä¸€ä¸ªå‡½æ•°ä¸­å½“åšå€¼è¿”å›.</li>
</ul>
<p>ç¬¬ä¸€å…¬æ°‘å‡½æ•°çš„æ¦‚å¿µå’Œè¢«å«åšâ€Funcarg problemâ€(å‡½æ•°ä½œä¸ºå‚æ•°çš„é—®é¢˜)ç›¸å…³.è¿™ä¸ªé—®é¢˜å¼•èµ·å‡½æ•°å¦‚ä½•å¤„ç†è‡ªç”±å˜é‡.  </p>
<ul>
<li>Def.12 : è‡ªç”±å˜é‡ï¼šä¸€ä¸ªæ—¢ä¸æ˜¯å½“å‰å‡½æ•°å‚æ•°ä¹Ÿä¸æ˜¯å½“å‰å‡½æ•°æœ¬åœ°å˜é‡çš„å˜é‡.</li>
</ul>
<p>è®©æˆ‘ä»¬çœ‹çœ‹â€Funcarg problemâ€,ç„¶åçœ‹ECMAScriptæ˜¯å¦‚ä½•è§£å†³çš„.  </p>
<p>çœ‹å¦‚ä¸‹ä»£ç : </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let x = 10;</span><br><span class="line"> </span><br><span class="line">function foo() &#123;</span><br><span class="line">  console.log(x);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">function bar(funArg) &#123;</span><br><span class="line">  let x = 20;</span><br><span class="line">  funArg(); // 10, not 20!</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// Pass `foo` as an argument to `bar`.</span><br><span class="line">bar(foo);</span><br></pre></td></tr></table></figure>

<p>å˜é‡xå¯¹äºå‡½æ•°fooæ˜¯è‡ªç”±å˜é‡. å½“fooå‡½æ•°è°ƒç”¨æ—¶(é€šè¿‡å‡½æ•°å‚æ•°ä¼ é€’)â€“xçš„å€¼æ˜¯é‚£é‡Œç»‘å®šçš„?æ˜¯å‡½æ•°åˆ›å»ºçš„åœ°æ–¹,æˆ–è€…æ˜¯è°ƒç”¨è€…ä½œç”¨åŸŸ,ä¹Ÿå°±æ˜¯å‡½æ•°è°ƒç”¨çš„åœ°æ–¹?æ­£å¦‚æˆ‘ä»¬æ‰€è§xçš„å€¼ä¸º20.  </p>
<p>ä¸Šé¢ç”¨ä¾‹æè¿°äº†å¹¿ä¸ºäººçŸ¥çš„â€ä¸‹æ”¾å‡½æ•°å‚æ•°é—®é¢˜(downward funarg problem)â€,i.e ä¸€ä¸ªå…³äºå¦‚ä½•å†³å®šç¯å¢ƒç»‘å®šçš„é—®é¢˜ï¼šæ˜¯åº”è¯¥ç»‘å®šåˆ›å»ºæ—¶çš„ç¯å¢ƒ,æˆ–è€…æ˜¯è°ƒç”¨æ—¶çš„ç¯å¢ƒ.  </p>
<p>å®ƒè¢«ä¸€ä¸ªä¸€ä¸ªä½¿ç”¨é™æ€ä½œç”¨åŸŸçš„å…±è¯†è§£å†³äº†,ä¹Ÿå°±æ˜¯åˆ›å»ºæ—¶çš„ä½œç”¨åŸŸ.  </p>
<p>Def.13:é™æ€ä½œç”¨åŸŸ:ä¸€ä¸ªå®ç°é™æ€ä½œç”¨åŸŸçš„è¯­è¨€,æ˜¯é€šè¿‡å…¶æºç ä½ç½®å†³å®šç¯å¢ƒç»‘å®š.  </p>
<p>é™æ€ä½œç”¨ä¹Ÿå«è¯æ³•ç¯å¢ƒ,å› æ­¤ä»¥è¯æ³•ç¯å¢ƒå‘½å.  </p>
<ul>
<li>æ³¨æ„ï¼šä½ å¯ä»¥é€šè¿‡<a href="https://codeburst.io/js-scope-static-dynamic-and-runtime-augmented-5abfee6223fe">è¿™ç¯‡æ–‡ç« </a>äº†è§£é™æ€å’ŒåŠ¨æ€ä½œç”¨åŸŸ.</li>
</ul>
<p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­,fooå‡½æ•°æ•è·çš„ç¯å¢ƒå°±æ˜¯å…¨å±€ç¯å¢ƒ.  </p>
<p><img src="/2017/12/04/javascript%E6%A0%B8%E5%BF%83/closure.png" alt="closure"></p>
<p>Def. 14: closure: é—­åŒ…å°±æ˜¯å‡½æ•°å¯¹å®šä¹‰æ—¶ç¯å¢ƒçš„æ•è·,è¿™ä¸ªç¯å¢ƒé€šå¸¸ç”¨æ¥å¯¹æ ‡è¯†ç¬¦çš„æ±‚å€¼.  </p>
<p>å¯¹äºå‡½æ•°å‚æ•°çš„å¦ä¸€ç§é—®é¢˜è¢«ç§°ä¸ºâ€ä¸Šå‡å‡½æ•°å‚æ•°é—®é¢˜(upward funarg problem)â€.å®ƒä»¬å”¯ä¸€ä¸åŒçš„æ˜¯æ•è·ç¯å¢ƒåœ¨è„±ç¦»åˆ›å»ºç¯å¢ƒæ—¶ä»»ç„¶å­˜æ´».  </p>
<p>è®©æˆ‘ä»¬çœ‹ä¸‹è¿™ä¸ªä¾‹å­ï¼š  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">  let x = 10;</span><br><span class="line">   </span><br><span class="line">  // Closure, capturing environment of `foo`.</span><br><span class="line">  function bar() &#123;</span><br><span class="line">    return x;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  // Upward funarg.</span><br><span class="line">  return bar;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">let x = 20;</span><br><span class="line"> </span><br><span class="line">// Call to `foo` returns `bar` closure.</span><br><span class="line">let bar = foo();</span><br><span class="line"> </span><br><span class="line">bar(); // 10, not 20!</span><br></pre></td></tr></table></figure>

<p>ç†è®ºä¸Šå®ƒçš„æ•è·ç¯å¢ƒæœºåˆ¶å¹¶æ²¡æœ‰å˜.åªæ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹,æˆ‘ä»¬æ²¡é—­åŒ…äº†å—?fooçš„æ¿€æ´»ç¯å¢ƒå°†è¢«é”€æ¯.ä½†æ˜¯æˆ‘ä»¬æ•è·äº†å®ƒ,æ‰€ä»¥å®ƒè¢«ä¿å­˜èµ·æ¥â€“æ¥æ”¯æŒé™æ€ä½œç”¨åŸŸè¯­ä¹‰.  </p>
<p>è¿™é‡Œå¸¸å¸¸å­˜åœ¨å¯¹é—­åŒ…ä¸å®Œæ•´çš„ç†è§£. â€“é€šå¸¸å¼€å‘è€…è®¤ä¸ºçš„é—­åŒ…åªæ˜¯â€ä¸Šå‡å‡½æ•°å‚æ•°é—®é¢˜â€.ä½†æ˜¯,æ­£å¦‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°,ç†è®ºä¸Šæ¥è¯´ä¸Šå‡å’Œä¸‹é’»å‚æ•°é—®é¢˜éƒ½æ˜¯ä¸€æ ·çš„â€“é™æ€ä½œç”¨åŸŸæœºåˆ¶.  </p>
<p>å¦‚ä¸Šæ‰€è¿°,å’ŒåŸå‹ç›¸ä¼¼çš„æ˜¯â€“ç›¸åŒçš„çˆ¶ç¯å¢ƒå¯ä»¥è¢«å¤šä¸ªé—­åŒ…æ‰€å…±äº«,è¿™è®©æˆ‘ä»¬è·å–å’Œæ”¹å˜å…±äº«æ•°æ®:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function createCounter() &#123;</span><br><span class="line">  let count = 0;</span><br><span class="line"> </span><br><span class="line">  return &#123;</span><br><span class="line">    increment() &#123; count++; return count; &#125;,</span><br><span class="line">    decrement() &#123; count--; return count; &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">let counter = createCounter();</span><br><span class="line"> </span><br><span class="line">console.log(</span><br><span class="line">  counter.increment(), // 1</span><br><span class="line">  counter.decrement(), // 0</span><br><span class="line">  counter.increment(), // 1</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºä¸¤ä¸ªé—­åŒ…ï¼Œincrementå’Œdecrementéƒ½åœ¨åŒä¸€ä¸ªåŒ…å«å˜é‡countçš„ç¯å¢ƒåˆ›å»º,æ‰€ä»¥å®ƒä»¬å…±äº«åŒä¸€ä¸ªçˆ¶çº§ä½œç”¨åŸŸ,æ€»æ˜¯é€šè¿‡å¼•ç”¨â€“æ„å‘³ç€å¼•ç”¨å¯¹å…¨éƒ¨çš„çˆ¶çº§ç¯å¢ƒä¿æŒå­˜å‚¨.</p>
<p><img src="/2017/12/04/javascript%E6%A0%B8%E5%BF%83/shared-environment.png" alt="sharedEnvironment">  </p>
<p>ä¸€äº›è¯­è¨€ä¹Ÿè®¸åªæ˜¯æ•è·å€¼,ä¹Ÿå°±æ˜¯åˆ¶ä½œä¸€ä»½æ•è·å˜é‡çš„å‰¯æœ¬,å¹¶ä¸”ä¸å…è®¸å…¶å¯¹çˆ¶çº§ä½œç”¨åŸŸçš„æ”¹å˜.ä½†æ˜¯åœ¨jsä¸­,æ€»æ˜¯çˆ¶çº§ä½œç”¨åŸŸæ€»æ˜¯é€šè¿‡å¼•ç”¨.</p>
<p>æ³¨æ„ï¼šåœ¨å®ç°ä¸Šä¹Ÿè®¸ä¼šå¯¹è¿™ä¸ªæ­¥éª¤è¿›è¡Œä¼˜åŒ–.å¹¶ä¸”ä¸ä¼šæ•è·æ•´ä¸ªç¯å¢ƒ.åªä¼šæ•è·â€™è‡ªç”±å˜é‡â€™,ä½†æ˜¯å®ƒä»¬ä»ä¼šä¿æŒå¯¹çˆ¶çº§ä½œç”¨åŸŸæ•°æ®æ”¹å˜çš„èƒ½åŠ›.  </p>
<p>ä½ å¯ä»¥ä»<a href="http://dmitrysoshnikov.com/ecmascript/chapter-6-closures/">åˆé€‚çš„æ–‡ç« </a>æ‰¾åˆ°é—­åŒ…å’Œå‡½æ•°å‚æ•°é—®é¢˜ç›¸å…³ç»†èŠ‚.  </p>
<p>å¯ä»¥è¯´æ‰€æœ‰çš„æ ‡è¯†ç¬¦éƒ½æ˜¯é™æ€ç»‘å®šçš„.ä½†æ˜¯åœ¨ECMAScriptä¸­ä»»ç„¶æœ‰ä¸€ä¸ªæ˜¯åŠ¨æ€ç»‘å®šçš„å€¼this. </p>
<h2 id="this"><a href="#this" class="headerlink" title="this"></a><span id="this">this</span></h2><p> thisçš„å€¼æ˜¯ä¸€ä¸ªåŠ¨æ€çš„å¹¶ä¸”æ˜¯éšå¼ä¼ å…¥ä»£ç ä¸Šä¸‹æ–‡çš„.æˆ‘ä»¬å¯ä»¥å°†å®ƒå½“åšä¸€ä¸ªéšå¼é¢å¤–å‚æ•°ï¼Œå®ƒå¯ä»¥è¢«è®¿é—®ä½†æ˜¯ä¸èƒ½è¢«æ”¹å˜.  </p>
<p> thiså€¼çš„ç›®çš„åœ¨äºç›¸åŒä»£ç ç»™å¤šä¸ªå¯¹è±¡ä½¿ç”¨.  </p>
<ul>
<li>Def. 15: This: ä¸€ä¸ªç”¨äºè®¿é—®æ‰§è¡Œä¸Šä¸‹æ–‡çš„éšå¼ä¸Šä¸‹æ–‡å¯¹è±¡â€“å®ƒçš„ç›®çš„åœ¨äºè®©ç›¸åŒä»£ç å¯ä»¥è¢«å¤šä¸ªå¯¹è±¡ä½¿ç”¨.</li>
</ul>
<p> å®ƒçš„ä¸»è¦ç”¨ä¾‹ä¸ºåŸºäºç±»çš„é¢å‘å¯¹è±¡ç¼–ç¨‹(OOP).ä¸€ä¸ªå­˜äºå®ä¾‹ä¸Šçš„æ–¹æ³•(å®šä¹‰åœ¨åŸå‹ä¸Š),å®é™…ä¸Šè¦è¢«æ‰€æœ‰åŸºäºè¿™ä¸ªç±»çš„å®ä¾‹ä½¿ç”¨.  </p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> class Point &#123;</span><br><span class="line">  constructor(x, y) &#123;</span><br><span class="line">    this._x = x;</span><br><span class="line">    this._y = y;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  getX() &#123;</span><br><span class="line">    return this._x;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  getY() &#123;</span><br><span class="line">    return this._y;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">let p1 = new Point(1, 2);</span><br><span class="line">let p2 = new Point(3, 4);</span><br><span class="line"> </span><br><span class="line">// Can access `getX`, and `getY` from</span><br><span class="line">// both instances (they are passed as `this`).</span><br><span class="line"> </span><br><span class="line">console.log(</span><br><span class="line">  p1.getX(), // 1</span><br><span class="line">  p2.getX(), // 3</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p> å½“å¼€å§‹æ¿€æ´»getXæ–¹æ³•æ—¶,ä¸€ä¸ªç”¨äºåˆ›å»ºæœ¬åœ°å˜é‡å’Œå‚æ•°çš„ç¯å¢ƒè¢«åˆ›å»º.æ­¤å¤–ï¼Œä¸€ä¸ª[[ThisValue]]è¢«ä¼ é€’åˆ°å‡½æ•°ç¯å¢ƒè®°å½•,è¿™ä¸ªå€¼åŠ¨æ€çš„ç»‘å®šå‡½æ•°è°ƒç”¨è€….å½“è°ƒç”¨è€…ä¸ºp1æ—¶,thisçš„å€¼å°±æ˜¯p1,ç¬¬äºŒç§æƒ…å†µå°±æ˜¯p2.  </p>
<p> thisçš„å¦ä¸€åº”ç”¨,æ˜¯é€šç”¨æ¥å£å‡½æ•°çš„æ··åˆä¸è¦†ç›–.</p>
<p>åœ¨ä¸‹é¢ä¾‹å­ä¸­,MovableåŒ…å«ä¸€ä¸ªé€šç”¨æ¥å£å‡½æ•°move,è¿™ä¸ªå‡½æ•°æœŸæœ›ä½¿ç”¨è€…å¯¹_xå’Œ_yçš„æ··åˆ(mixin).  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Generic Movable interface (mixin).</span><br><span class="line">let Movable = &#123;</span><br><span class="line"> </span><br><span class="line">  /**</span><br><span class="line">   * This function is generic, and works with any</span><br><span class="line">   * object, which provides `_x`, and `_y` properties,</span><br><span class="line">   * regardless of the class of this object.</span><br><span class="line">   */</span><br><span class="line">  move(x, y) &#123;</span><br><span class="line">    this._x = x;</span><br><span class="line">    this._y = y;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">let p1 = new Point(1, 2);</span><br><span class="line"> </span><br><span class="line">// Make `p1` movable.</span><br><span class="line">Object.assign(p1, Movable);</span><br><span class="line"> </span><br><span class="line">// Can access `move` method.</span><br><span class="line">p1.move(100, 200);</span><br><span class="line"> </span><br><span class="line">console.log(p1.getX()); // 100</span><br></pre></td></tr></table></figure>

<p>å¦ä¸€æ–¹é¢.æ··åˆä¹Ÿå¯ä»¥åº”ç”¨äºåŸå‹çº§åˆ«è€Œä¸åªæ˜¯å®ä¾‹.  </p>
<p>ä¸ºäº†å±•ç¤ºthiså€¼çš„åŠ¨æ€å±æ€§,çœ‹ä¸‹é¢çš„è¿™ä¸ªä¾‹å­.æˆ‘ä»¬å°†ç•™ç»™è¯»è€…å½“åšä¸€ä¸ªç»ƒä¹ è§£å†³:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">  return this;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">let bar = &#123;</span><br><span class="line">  foo,</span><br><span class="line"> </span><br><span class="line">  baz() &#123;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">// `foo`</span><br><span class="line">console.log(</span><br><span class="line">  foo(),       // global or undefined</span><br><span class="line"> </span><br><span class="line">  bar.foo(),   // bar</span><br><span class="line">  (bar.foo)(), // bar</span><br><span class="line"> </span><br><span class="line">  (bar.foo = bar.foo)(), // global</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line">// `bar.baz`</span><br><span class="line">console.log(bar.baz()); // bar</span><br><span class="line"> </span><br><span class="line">let savedBaz = bar.baz;</span><br><span class="line">console.log(savedBaz()); // global</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºåªæ˜¯çœ‹fooå‡½æ•°çš„æºç æ˜¯æ— æ³•åŒºåˆ†thisçš„å€¼çš„.æ‰€ä»¥æˆ‘ä»¬è¯´thiså€¼åŠ¨æ€çš„.  </p>
<ul>
<li>ä½ å¯ä»¥åœ¨ç›¸åº”çš„<a href="http://dmitrysoshnikov.com/ecmascript/chapter-3-this/">ç« èŠ‚</a>æ‰¾åˆ°ç­”æ¡ˆ.</li>
</ul>
<p>åœ¨ç®­å¤´å‡½æ•°é‡Œthisçš„å€¼å¾ˆç‰¹æ®Š:thiså€¼æ˜¯è¯æ³•çš„(é™æ€çš„),è€Œä¸æ˜¯åŠ¨æ€çš„.I.e.å®ƒä»¬å‡½æ•°ç¯å¢ƒè®°å½•ä¸æä¾›thisçš„å€¼,è€Œä¸”å®ƒä»¬æ˜¯ä»çˆ¶çº§ç¯å¢ƒè·å–.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var x = 10;</span><br><span class="line"> </span><br><span class="line">let foo = &#123;</span><br><span class="line">  x: 20,</span><br><span class="line"> </span><br><span class="line">  // Dynamic `this`.</span><br><span class="line">  bar() &#123;</span><br><span class="line">    return this.x;</span><br><span class="line">  &#125;,</span><br><span class="line"> </span><br><span class="line">  // Lexical `this`.</span><br><span class="line">  baz: () =&gt; this.x,</span><br><span class="line"> </span><br><span class="line">  qux() &#123;</span><br><span class="line">    // Lexical this within the invocation.</span><br><span class="line">    let arrow = () =&gt; this.x;</span><br><span class="line"> </span><br><span class="line">    return arrow();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">console.log(</span><br><span class="line">  foo.bar(), // 20, from `foo`</span><br><span class="line">  foo.baz(), // 10, from global</span><br><span class="line">  foo.qux(), // 20, from `foo` and arrow</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>æ­£å¦‚æˆ‘ä»¬æ‰€è¯´,åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­thisçš„å€¼æ˜¯å…¨å±€å¯¹è±¡(å®ƒç»‘å®šç€å…¨å±€ç¯å¢ƒè®°å½•çš„å¯¹è±¡),å…ˆå‰å…¨å±€å¯¹è±¡åªæœ‰ä¸€ä¸ª.ä½†æ˜¯ç°åœ¨ç‰ˆæœ¬çš„è§„èŒƒé‡Œä¹Ÿè®¸æœ‰å¤šä¸ªå…¨å±€å¯¹è±¡.è¿™äº›å…¨å±€å¯¹è±¡åªé’ˆå¯¹éƒ¨åˆ†ä»£ç èŒƒå›´.è®©æˆ‘ä»¬çœ‹çœ‹è¿™ç§ç»“æ„.  </p>
<h2 id="èŒƒå›´"><a href="#èŒƒå›´" class="headerlink" title="èŒƒå›´"></a><span id="realm">èŒƒå›´</span></h2><p>åœ¨æ±‚å€¼ä¹‹å‰,æ‰€æœ‰çš„ECMAScriptä»£ç éƒ½å’Œä¸€ä¸ªèŒƒå›´ç›¸å…³è”.ç†è®ºä¸ŠèŒƒå›´åªæ˜¯ä¸ºä¸€ä¸ªä¸Šä¸‹æ–‡æä¾›ä¸€ä¸ªå…¨å±€ç¯å¢ƒ.  </p>
<p>å½“ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡è¢«åˆ›å»ºæ—¶å®ƒå°±å’Œä¸€ä¸ªç‰¹åˆ«ä»£ç èŒƒå›´ç›¸å…³è”.è¿™ä¸ªä»£ç èŒƒå›´åªæ˜¯ä¸ºè¿™ä¸ªä¸Šä¸‹æ–‡æä¾›ä¸€ä¸ªå…¨å±€ç¯å¢ƒ.è¿™ä¸ªå…³è”æ˜¯ä¸å¯å˜çš„.  </p>
<ul>
<li>æ³¨æ„ï¼š åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ä¸€ä¸ªæœ€ç›´æ¥çš„è¿”å›ä¸ºiframe,å¥¹æ°å¥½ä½“åŒä¸€ä¸ªå…¨å±€ç¯å¢ƒ,åœ¨Node.jsä¸­æœ€æ¥è¿‘çš„æ˜¯æ²™ç®±çš„<a href="https://nodejs.org/api/vm.html">vm module</a></li>
</ul>
<p>å½“å‰ç‰ˆæœ¬çš„è§„èŒƒå¹¶æ²¡æœ‰æä¾›ä¸€ä¸ªrealmsåˆ›å»ºçš„å…·ä½“æ–¹æ³•,ä½†æ˜¯å®ƒä»¬å¯ä»¥ç”±å®ç°ç¯å¢ƒéšå¼å®ç°. è¿™é‡Œæœ‰ä¸€ä¸ªå…³äºæš´éœ²ç»™ç”¨æˆ·ä½¿ç”¨APIçš„<a href="https://github.com/tc39/proposal-realms/">æè®®</a>  </p>
<p>ç†è®ºä¸Šæ¯ä¸ªåœ¨æ ˆä¸­ä¸Šä¸‹æ–‡éƒ½å’Œè‡ªå·±çš„èŒƒå›´ç›¸å…³è”.  </p>
<p><img src="/2017/12/04/javascript%E6%A0%B8%E5%BF%83/context-realm.png" alt="contextRealm"></p>
<p>ç°åœ¨æˆ‘ä»¬å¯¹è¿è¡Œæ—¶ECMAScriptçš„å¤§åœ°å›¾æ›´é è¿‘äº†. ä½†æ˜¯æˆ‘ä»¬ä»»ç„¶éœ€è¦çœ‹ä¸€çœ‹å…¥å£ä»£ç å’Œåˆå§‹åŒ–è¿‡ç¨‹.å®ƒä»¬éƒ½ç”±ä¸€ä¸ªå«jobså’Œjobåºåˆ—çš„æœºåˆ¶ç®¡ç†.  </p>
<h2 id="job"><a href="#job" class="headerlink" title="job"></a><span id="job">job</span></h2><p>ä¸€äº›æ“ä½œå¯ä»¥è¢«æ¨è¿Ÿ,å¹¶ä¸”åªæœ‰åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆæœ‰ç©ºçš„æ—¶å€™å°±å¯ä»¥æ‰§è¡Œ.  </p>
<ul>
<li>Def.17:Job:jobæ˜¯ä¸€ç§æŠ½è±¡çš„æ“ä½œ,å®ƒåœ¨å½“å‰è¿›ç¨‹ä¸­æ²¡æœ‰å…¶ä»–ECMAScriptè®¡ç®—æ—¶å‘èµ·ä¸€ä¸ªECMAScriptè®¡ç®—.</li>
</ul>
<p>jobsåœ¨jobåºåˆ—ä¸­æ’åº,åœ¨å½“å‰è§„èŒƒç‰ˆæœ¬ä¸­æœ‰ä¸¤ç§jobåºåˆ—:ScriptJobs,å’ŒPromiseJobs.  </p>
<p>åœ¨ScriptJobsä¸Šçš„åˆå§‹åŒ–jobæ˜¯æˆ‘ä»¬ç¨‹åºçš„ä¸»å…¥å£â€“å°±æ˜¯å¯¹æˆ‘ä»¬çš„åˆå§‹åŒ–è„šæœ¬åŠ è½½å’Œæ±‚å€¼ï¼šèŒƒå›´(realm)åˆ›å»ºï¼Œå…¨å±€ä¸Šä¸‹æ–‡ä¸èŒƒå›´ç›¸å…³è”,æ¨å…¥è°ƒç”¨æ ˆï¼Œå…¨å±€ä»£ç æ‰§è¡Œ.  </p>
<ul>
<li>æ³¨æ„ï¼ŒScriptJobsåºåˆ—åŒæ—¶ç®¡ç†è„šæœ¬å’Œmodules.</li>
</ul>
<p>æ¥ç€è¿™ä¸ªä¸Šä¸‹æ–‡å¯ä»¥æ‰§è¡Œå…¶ä»–ä¸Šä¸‹æ–‡ï¼Œæˆ–è€…å…¶ä»–æ’é˜Ÿçš„jobs. </p>
<p>å½“ä¹ˆæœ‰è¿è¡Œçš„æ‰§è¡Œä¸Šä¸‹æ–‡åŒæ—¶æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆä¸ºç©ºæ—¶ï¼ŒECMAScriptå°†åœ¨jobç³»åˆ—çš„ç¬¬ä¸€ä¸ªç­‰å¾…jobç§»é™¤,åŒæ—¶åˆ›å»ºä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹å¼€å§‹æ‰§è¡Œè¿™ä¸ªjob.  </p>
<ul>
<li>æ³¨æ„ï¼šjobåºåˆ—é€šå¸¸è¢«ç§°ä¸ºâ€event loopâ€çš„ç®¡ç†.ECMAScriptæ ‡å‡†å¹¶æ²¡æœ‰æ˜ç¡®è§„å®šè¿™ä¸ªâ€event loopâ€,å®ƒçš„å®ç°éƒ½ç•™ç»™äº†å®ç°ç¯å¢ƒäº†.ä½†æ˜¯ä½ å¯ä»¥å‘ç°ä¸€ä¸ªå¯å‘å¼çš„ä¾‹å­åœ¨è¿™å„¿.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Enqueue a new promise on the PromiseJobs queue.</span><br><span class="line">new Promise(resolve =&gt; setTimeout(() =&gt; resolve(10), 0))</span><br><span class="line">  .then(value =&gt; console.log(value));</span><br><span class="line"> </span><br><span class="line">// This log is executed earlier, since it&#x27;s still a</span><br><span class="line">// running context, and job cannot start executing first</span><br><span class="line">console.log(20);</span><br><span class="line"> </span><br><span class="line">// Output: 20, 10</span><br></pre></td></tr></table></figure>

<p>async å‡½æ•°å¯ä»¥å¯¹promiseè¿›è¡Œawait,æ‰€ä»¥å®ƒä»¬ä¹Ÿæ˜¯æ’é˜Ÿåºåˆ—: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">async function later() &#123;</span><br><span class="line">  return await Promise.resolve(10);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">(async () =&gt; &#123;</span><br><span class="line">  let data = await later();</span><br><span class="line">  console.log(data); // 10</span><br><span class="line">&#125;)();</span><br><span class="line"> </span><br><span class="line">// Also happens earlier, since async execution</span><br><span class="line">// is queued on the PromiseJobs queue.</span><br><span class="line">console.log(20);</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨æˆ‘ä»¬ç›¸å½“æ¥è¿‘JSçš„å…¨è²Œäº†,ç°åœ¨æˆ‘ä»¬å°†çœ‹è¿™äº›ç»„ä»¶çš„ä¸»è¦æ‹¥æœ‰è€…,ä»£ç†.  </p>
<h2 id="ä»£ç†-agent"><a href="#ä»£ç†-agent" class="headerlink" title="ä»£ç†(agent)"></a><span id="agent">ä»£ç†(agent)</span></h2><p>åœ¨ECMAScriptä¸­å¹¶å‘å’Œå¹¶è¡Œæ˜¯é€šè¿‡ä»£ç†æ¨¡å¼å®ç°. ä»£ç†æ¨¡å¼ä¸<a href="https://en.wikipedia.org/wiki/Actor_model">æ¼”å‘˜æ¨¡å¼</a>ç›¸å½“æ¥è¿‘â€“ä¸€ç§è½»é‡çš„å¤„ç†æ¶ˆæ¯ä¼ é€’æ–¹å¼çš„è¿‡ç¨‹.  </p>
<ul>
<li>Def.18: Agent: ä»£ç†æ˜¯ä¸€ç§å¯¹æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ,ä¸€ç³»åˆ—jobé˜Ÿåˆ—,ä»£ç èŒƒå›´çš„æŠ½è±¡.</li>
</ul>
<p>å®ç°è€…ä¾èµ–ä»£ç†ç©¶ç«Ÿæ˜¯å¯ä»¥å…è®¸åœ¨å•ä¸€çº¿ç¨‹,è¿˜æ˜¯å¤šçº¿ç¨‹.å¦‚åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­worker agentå°±æ˜¯ä»£ç†æ¦‚å¿µçš„ä¾‹å­.  </p>
<p>ä»£ç†ä»¬çš„çŠ¶æ€æ˜¯ç›¸äº’ç‹¬ç«‹çš„,å®ƒä»¬å¯ä»¥é€šè¿‡å‘é€æ¶ˆæ¯æ¥æ²Ÿé€š.ä¸€äº›æ•°æ®å¯ä»¥åœ¨ä¸åŒä»£ç†ä¹‹é—´å…±äº«,å¦‚sharedArrayBuffer.ä»£ç†ä»¬å¯ä»¥ç»„æˆé›†ç¾¤.  </p>
<p>æ‰€ä»¥ä¸‹é¢æ˜¯ECMAScriptè¿è¡Œæ—¶çš„å…¨è²Œ:  </p>
<p><img src="/2017/12/04/javascript%E6%A0%B8%E5%BF%83/agents-1.png" alt="agents"></p>
<p>è¿™å°±æ˜¯å‘ç”Ÿåœ¨ECMAScriptå¼•æ“ä¸‹å…¨å›¾.  </p>
<p>ç°åœ¨æˆ‘ä»¬æ¥åˆ°äº†æ–‡ç« ç»“å°¾å¤„.è¿™æ˜¯ç¯‡æ–‡ç« æœ‰å¾ˆå¤šå…³äºjsæ ¸å¿ƒçš„ä¿¡æ¯.å¦‚æˆ‘ä»¬æåˆ°çš„JSä»£ç å¯ä»¥å°†å®ƒåˆ†ä¸ºmodulesï¼Œå¯¹è±¡å±æ€§é€šè¿‡proxyè·Ÿè¸ªç­‰ç­‰åˆ†ç±»â€“è¿™å„¿æœ‰å¾ˆå¤šç”¨æˆ·çº§åˆ«çš„ç»†èŠ‚ä½ å¯ä»¥ä»ä¸åŒæ–‡æ¡£è¯»åˆ°.  </p>
<p>ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å°½åŠ›å±•ç°ECMAScriptç¨‹åºæœ¬èº«çš„é€»è¾‘ç»“æ„,åŒæ—¶å¸Œæœ›æ¾„æ¸…å®ƒä»¬ä¸€äº›çš„ç»†èŠ‚.å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜,å»ºè®®æˆ–è€…åé¦ˆâ€“æˆ‘å°†å¾ˆä¹æ„åœ¨è¯„è®ºä¸­è®¨è®º.  </p>
]]></content>
      <categories>
        <category>javscript</category>
      </categories>
  </entry>
  <entry>
    <title>ä»£ç æ•´æ´ä¹‹é“</title>
    <url>/2017/10/10/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93--%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h2 id="ç¬¬2ç« -æœ‰æ„ä¹‰çš„åç§°"><a href="#ç¬¬2ç« -æœ‰æ„ä¹‰çš„åç§°" class="headerlink" title="ç¬¬2ç«   æœ‰æ„ä¹‰çš„åç§°"></a>ç¬¬2ç«   æœ‰æ„ä¹‰çš„åç§°</h2><h3 id="2-2-åå‰¯å…¶å®"><a href="#2-2-åå‰¯å…¶å®" class="headerlink" title="2.2 åå‰¯å…¶å®"></a>2.2 åå‰¯å…¶å®</h3><ul>
<li>å˜é‡ å‡½æ•°æˆ–ç±»çš„åç§°éƒ½åº”è¯¥å·²ç»å›å¤äº†æ‰€æœ‰çš„å¤§é—®é¢˜ã€‚å®ƒåº”è¯¥å‘Šè¯‰ä½ ï¼Œå®ƒä¸ºä»€ä¹ˆä¼šå­˜åœ¨ï¼Œå®ƒåšä»€ä¹ˆäº‹ï¼Œåº”è¯¥æ€ä¹ˆç”¨ã€‚å¦‚æœåç§°éœ€è¦æ³¨é‡Šæ¥è¡¥å……ï¼Œé‚£å°±ä¸ç®—æ˜¯åå‰¯å…¶å®ã€‚<span id="more"></span></li>
</ul>
<h3 id="2-3-é¿å…è¯¯å¯¼"><a href="#2-3-é¿å…è¯¯å¯¼" class="headerlink" title="2.3 é¿å…è¯¯å¯¼"></a>2.3 é¿å…è¯¯å¯¼</h3><h4 id="ç¨‹åºå‘˜å¿…é¡»é¿å…ç•™ä¸‹æ©è—ä»£ç æœ¬æ„çš„é”™è¯¯çº¿ç´¢ã€‚"><a href="#ç¨‹åºå‘˜å¿…é¡»é¿å…ç•™ä¸‹æ©è—ä»£ç æœ¬æ„çš„é”™è¯¯çº¿ç´¢ã€‚" class="headerlink" title="ç¨‹åºå‘˜å¿…é¡»é¿å…ç•™ä¸‹æ©è—ä»£ç æœ¬æ„çš„é”™è¯¯çº¿ç´¢ã€‚"></a>ç¨‹åºå‘˜å¿…é¡»é¿å…ç•™ä¸‹æ©è—ä»£ç æœ¬æ„çš„é”™è¯¯çº¿ç´¢ã€‚</h4><ul>
<li>1.é¿å…ä½¿ç”¨ä¸æœ¬æ„ç›¸æ‚–çš„çš„è¯ï¼š åˆ«ç”¨accountArrayæ¥æŒ‡ç§°ä¸€ç»„è´¦å·ï¼Œé™¤éå®ƒçœŸçš„æ˜¯Arrayç±»å‹ã€‚</li>
<li>2.æé˜²ä½¿ç”¨å·®åˆ«è¾ƒå°çš„åç§°ã€‚</li>
<li>3.åˆ«ç”¨äººçœ¼è¯¯å¯¼æ€§åç§°ï¼šå°å†™iå’Œå¤§å†™Oå’Œå¸¸é‡â€œ1â€ä¸â€œ0â€å¾ˆç›¸ä¼¼ã€‚</li>
</ul>
<h3 id="2-4-åšæœ‰æ„ä¹‰çš„åŒºåˆ†"><a href="#2-4-åšæœ‰æ„ä¹‰çš„åŒºåˆ†" class="headerlink" title="2.4 åšæœ‰æ„ä¹‰çš„åŒºåˆ†"></a>2.4 åšæœ‰æ„ä¹‰çš„åŒºåˆ†</h3><ul>
<li>åºŸè¯æ˜¯å¦ä¸€ç§æ²¡æ„ä¹‰çš„åŒºåˆ†ã€‚å¦‚æœæœ‰ä¸€ä¸ªProductç±»ã€‚å¦‚æœè¿˜æœ‰ä¸€ä¸ªProductInfoæˆ–ProductDateç±»ï¼Œé‚£å®ƒä»¬çš„åç§°è™½ç„¶ä¸åŒï¼Œæ„æ€å´æ— åŒºåˆ«</li>
</ul>
<h3 id="2-5-ä½¿ç”¨è¯»å¾—å‡ºæ¥çš„åç§°"><a href="#2-5-ä½¿ç”¨è¯»å¾—å‡ºæ¥çš„åç§°" class="headerlink" title="2.5 ä½¿ç”¨è¯»å¾—å‡ºæ¥çš„åç§°"></a>2.5 ä½¿ç”¨è¯»å¾—å‡ºæ¥çš„åç§°</h3><h3 id="2-6-ä½¿ç”¨å¯æœç´¢çš„åç§°"><a href="#2-6-ä½¿ç”¨å¯æœç´¢çš„åç§°" class="headerlink" title="2.6 ä½¿ç”¨å¯æœç´¢çš„åç§°"></a>2.6 ä½¿ç”¨å¯æœç´¢çš„åç§°</h3><ul>
<li>å•å­—æ¯åç§°å’Œæ•°å­—å¸¸é‡æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¾ˆéš¾åœ¨å¤§ç¯‡æ–‡å­—ä¸­æ‰¾å‡ºæ¥ã€‚å•å­—æ¯çš„åç§°ä»…ç”¨äºçŸ­æ–¹æ³•ä¸­çš„æœ¬åœ°å˜é‡ï¼Œåç§°é•¿çŸ­åº”ä¸å…¶ä½œç”¨åŸŸå¤§å°ç›¸å¯¹åº”ã€‚</li>
</ul>
<h3 id="2-9-ç±»å"><a href="#2-9-ç±»å" class="headerlink" title="2.9 ç±»å"></a>2.9 ç±»å</h3><ul>
<li>ç±»åå’Œå¯¹è±¡ååº”è¯¥æ˜¯å…·ä½“çš„åç§°æˆ–åè¯çŸ­è¯­ï¼Œå¦‚Customerï¼ŒWikiPageï¼ŒAccountï¼ŒAddressParserã€‚é¿å…ä½¿ç”¨ä¸å…·ä½“çš„Manager,Processor,Data,Infoè¿™æ ·çš„ç±»åã€‚ç±»åä¸åº”è¯¥æ˜¯åŠ¨è¯ã€‚</li>
</ul>
<h3 id="2-10-æ–¹æ³•å"><a href="#2-10-æ–¹æ³•å" class="headerlink" title="2.10 æ–¹æ³•å"></a>2.10 æ–¹æ³•å</h3><ul>
<li>æ–¹æ³•ååº”å½“æ˜¯åŠ¨è¯æˆ–è€…åŠ¨è¯çŸ­è¯­ï¼Œå¦‚postPayment,deletePage,æˆ–save</li>
</ul>
<h3 id="2-12-ä¿æŒå‘½åé£æ ¼ç»Ÿä¸€"><a href="#2-12-ä¿æŒå‘½åé£æ ¼ç»Ÿä¸€" class="headerlink" title="2.12 ä¿æŒå‘½åé£æ ¼ç»Ÿä¸€"></a>2.12 ä¿æŒå‘½åé£æ ¼ç»Ÿä¸€</h3><ul>
<li>fetch,retrieve,getæ„æ€ä¸Šç›¸å½“ç›¸è¿‘ï¼Œå¦‚åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­åªä½¿ç”¨ä¸€ä¸ªåˆ™é˜…è¯»èµ·æ¥ç›¸å½“æ˜äº†ã€‚</li>
</ul>
<h3 id="2-16-æ·»åŠ æœ‰æ„ä¹‰çš„è¯­å¢ƒ"><a href="#2-16-æ·»åŠ æœ‰æ„ä¹‰çš„è¯­å¢ƒ" class="headerlink" title="2.16 æ·»åŠ æœ‰æ„ä¹‰çš„è¯­å¢ƒ"></a>2.16 æ·»åŠ æœ‰æ„ä¹‰çš„è¯­å¢ƒ</h3><ul>
<li>é€šå¸¸æ·»åŠ å‰ç¼€ä¸ºè¯»è€…æä¾›è¯­å¢ƒï¼Œä¼šè®©è¯»è€…æ˜ç™½è¿™äº›å˜é‡æ˜¯æŸä¸€ä¸ªæ›´å¤§ç»“æ„çš„ä¸€éƒ¨åˆ†ã€‚</li>
</ul>
<h3 id="2-17-ä¸è¦æ·»åŠ æ²¡ç”¨çš„è¯­å¢ƒ"><a href="#2-17-ä¸è¦æ·»åŠ æ²¡ç”¨çš„è¯­å¢ƒ" class="headerlink" title="2.17 ä¸è¦æ·»åŠ æ²¡ç”¨çš„è¯­å¢ƒ"></a>2.17 ä¸è¦æ·»åŠ æ²¡ç”¨çš„è¯­å¢ƒ</h3><ul>
<li>å¦‚æœçŸ­åç§°è¶³å¤Ÿæ¸…æ¥šï¼Œå°±è¦æ¯”é•¿åç§°å¥½ã€‚åˆ«ç»™åç§°æ·»åŠ ä¸å¿…è¦çš„è¯­å¢ƒã€‚</li>
</ul>
<h2 id="ç¬¬3ç« -å‡½æ•°"><a href="#ç¬¬3ç« -å‡½æ•°" class="headerlink" title="ç¬¬3ç«  å‡½æ•°"></a>ç¬¬3ç«  å‡½æ•°</h2><h3 id="3-1-çŸ­å°"><a href="#3-1-çŸ­å°" class="headerlink" title="3.1 çŸ­å°"></a>3.1 çŸ­å°</h3><ul>
<li>å‡½æ•°ç¬¬ä¸€è§„åˆ™å°±æ˜¯è¦çŸ­å°ï¼Œæ¯è¡Œéƒ½ä¸åº”è¯¥æœ‰150ä¸ªå­—ç¬¦é‚£ä¹ˆé•¿ã€‚å‡½æ•°ä¹Ÿä¸åº”è¯¥æœ‰100è¡Œé‚£ä¹ˆé•¿ï¼Œ20è¡Œå°é¡¶æœ€ä½³ã€‚</li>
</ul>
<h3 id="3-2-åªåšä¸€ä»¶äº‹"><a href="#3-2-åªåšä¸€ä»¶äº‹" class="headerlink" title="3.2 åªåšä¸€ä»¶äº‹"></a>3.2 åªåšä¸€ä»¶äº‹</h3><ul>
<li>1.å¦‚æœå‡½æ•°åªæ˜¯åšäº†è¯¥å‡½æ•°åä¸‹åŒä¸€æŠ½è±¡å±‚çš„æ­¥éª¤ï¼Œåˆ™å‡½æ•°è¿˜æ˜¯åšäº†ä¸€ä»¶äº‹</li>
<li>2.è¦åˆ¤æ–­å‡½æ•°æ˜¯å¦ä¸æ­¢åšäº†ä¸€ä»¶äº‹ï¼Œè¿˜æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯çœ‹æ˜¯å¦èƒ½å†æ‹†å‡ºä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°ä¸ä»…æ˜¯å•çº¯çš„é‡æ–°è¯ é‡Šå…¶å®ç°ã€‚</li>
</ul>
<h3 id="3-3-æ¯ä¸ªå‡½æ•°ä¸€ä¸ªæŠ½è±¡å±‚çº§"><a href="#3-3-æ¯ä¸ªå‡½æ•°ä¸€ä¸ªæŠ½è±¡å±‚çº§" class="headerlink" title="3.3 æ¯ä¸ªå‡½æ•°ä¸€ä¸ªæŠ½è±¡å±‚çº§"></a>3.3 æ¯ä¸ªå‡½æ•°ä¸€ä¸ªæŠ½è±¡å±‚çº§</h3><ul>
<li>æˆ‘ä»¬æƒ³è®©ä»£ç æ‹¥æœ‰è‡ªé¡¶å‘ä¸‹çš„é˜…è¯»é¡ºåºã€‚æˆ‘ä»¬æƒ³è¦æ¯ä¸ªå‡½æ•°åé¢éƒ½è·Ÿç€ä½äºä¸‹ä¸€æŠ½è±¡å±‚çº§çš„å‡½æ•°ï¼Œè¿™ä¸ªæ ·å­æˆ‘ä»¬æŸ¥çœ‹å‡½æ•°åˆ—è¡¨æ—¶ï¼Œå°±èƒ½ä¾å¾ªæŠ½è±¡å±‚çº§å‘ä¸‹é˜…è¯»äº†ã€‚</li>
</ul>
<h3 id="3-4-switchè¯­å¥"><a href="#3-4-switchè¯­å¥" class="headerlink" title="3.4 switchè¯­å¥"></a>3.4 switchè¯­å¥</h3><ul>
<li>æˆ‘ä»¬æ— æ³•é¿å¼€switchè¯­å¥ï¼Œä¸è¿‡è¿˜æ˜¯èƒ½ç¡®ä¿æ¯ä¸ªswitchéƒ½åŸ‹åœ¨è¾ƒä½çš„æŠ½è±¡å±‚çº§ï¼Œè€Œä¸”æ°¸è¿œä¸é‡å¤</li>
</ul>
<h3 id="3-5-ä½¿ç”¨æè¿°æ€§çš„åç§°"><a href="#3-5-ä½¿ç”¨æè¿°æ€§çš„åç§°" class="headerlink" title="3.5 ä½¿ç”¨æè¿°æ€§çš„åç§°"></a>3.5 ä½¿ç”¨æè¿°æ€§çš„åç§°</h3><ul>
<li>åˆ«å®³æ€•é•¿åç§°ã€‚é•¿è€Œå…·æœ‰æè¿°æ€§çš„åç§°ï¼Œè¦æ¯”çŸ­è€Œè´¹è§£çš„åç§°å¥½ã€‚</li>
</ul>
<h3 id="3-6-å‡½æ•°å‚æ•°"><a href="#3-6-å‡½æ•°å‚æ•°" class="headerlink" title="3.6 å‡½æ•°å‚æ•°"></a>3.6 å‡½æ•°å‚æ•°</h3><ul>
<li>1.å¯¹äºè¾“å…¥å‚æ•°æœ€ç†æƒ³çš„å‚æ•°æ•°é‡æ˜¯é›¶ï¼Œå…¶æ¬¡æ˜¯ä¸€ï¼Œå†æ¬¡æ˜¯äºŒï¼Œåº”å½“å°½åŠ›é¿å…ä¸‰</li>
<li>2.ä¸è¦é€šè¿‡å‚æ•°è¾“å‡ºï¼ˆä¹Ÿæ˜¯å°±é€šå¸¸çš„å¯¹è±¡æ”¹å˜å½±å“å¤–éƒ¨å¯¹è±¡ï¼‰ï¼Œæˆ‘ä»¬æƒ¯äºé€šè¿‡å‚æ•°è¾“å…¥å‡½æ•°ï¼Œé€šè¿‡è¿”å›å€¼ä»å‡½æ•°ä¸­è¾“å‡ºã€‚æˆ‘ä»¬ä¸å¤ªæœŸæœ›ä¿¡æ¯é€šè¿‡å‚æ•°è¾“å‡ºã€‚</li>
<li>3.æ ‡ç¤ºå‚æ•°ä¸‘é™‹ä¸å ªã€‚å‘å‡½æ•°ä¼ å…¥å¸ƒå°”å€¼ç®€ç›´å°±æ˜¯éª‡äººå¬é—»çš„åšæ³•ï¼Œç€æ„å‘³ç€å¤§å£°å®£å¸ƒæœ¬å‡½æ•°ä¸æ­¢åšä¸€ä»¶äº‹ã€‚</li>
</ul>
<h3 id="3-7-æ— å‰¯ä½œç”¨"><a href="#3-7-æ— å‰¯ä½œç”¨" class="headerlink" title="3.7 æ— å‰¯ä½œç”¨"></a>3.7 æ— å‰¯ä½œç”¨</h3><ul>
<li>æœ‰å‰¯ä½œç”¨çš„å‡½æ•°ï¼Œéƒ½æ˜¯å…·æœ‰ç ´åæ€§çš„ï¼Œä¼šå¯¼è‡´å¤æ€ªçš„æ—¶åºè€¦åˆåŠé¡ºåº</li>
</ul>
<h3 id="3-8-åˆ†å‰²æŒ‡ä»¤ä¸è¯¢é—®"><a href="#3-8-åˆ†å‰²æŒ‡ä»¤ä¸è¯¢é—®" class="headerlink" title="3.8 åˆ†å‰²æŒ‡ä»¤ä¸è¯¢é—®"></a>3.8 åˆ†å‰²æŒ‡ä»¤ä¸è¯¢é—®</h3><ul>
<li>å‡½æ•°è¦ä¹ˆåšä»€ä¹ˆäº‹ï¼Œè¦ä¹ˆå›ç­”ä»€ä¹ˆäº‹ï¼Œä½†äºŒè€…ä¸å¯å…¼å¾—ã€‚å‡½æ•°åº”è¯¥ä¿®æ”¹æŸä¸ªå¯¹è±¡çš„çŠ¶æ€ï¼Œæˆ–è€…è¿”å›è¯¥å¯¹è±¡çš„æœ‰å…³ä¿¡æ¯ã€‚</li>
</ul>
<h3 id="3-9-ä½¿ç”¨å¼‚å¸¸ä»£æ›¿è¿”å›é”™è¯¯ç "><a href="#3-9-ä½¿ç”¨å¼‚å¸¸ä»£æ›¿è¿”å›é”™è¯¯ç " class="headerlink" title="3.9 ä½¿ç”¨å¼‚å¸¸ä»£æ›¿è¿”å›é”™è¯¯ç "></a>3.9 ä½¿ç”¨å¼‚å¸¸ä»£æ›¿è¿”å›é”™è¯¯ç </h3><ul>
<li>å°†æŒ‡ä»¤å¼å‡½æ•°é”™è¯¯ä»£ç è¿”å›ä¸€åé¢è¿åäº†åˆ†å‰²æŒ‡ä»¤ä¸è¯¢é—®ï¼Œå¦ä¸€æ–¹é¢æœ‰å¯èƒ½å¯¼è‡´æ›´æ·±å±‚çš„åµŒå¥—è§£æ„ã€‚ä½¿ç”¨try&#x2F;catchå°†é”™è¯¯å¤„ç†ä»£ç ä»ä¸»è·¯å¾„ä¸­åˆ†ç¦»å‡ºã€‚<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(delatePage(page)  == E_OK) &#123;</span><br><span class="line">    if(registry.deleteReference(page.name) == E_OK) &#123;</span><br><span class="line">        if(configKeys.deleteKey(page.name.makeKey()) == E_OK )&#123;</span><br><span class="line">            console.log(&quot;page deleted&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            console.log(&quot;configKey not deleted&quot;);</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        console.log(&quot;deletReference from regitry failed&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    console.log(&quot;delete failed&quot;);</span><br><span class="line">    return E_ERROR;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">try&#123;</span><br><span class="line">    deletePage(page);</span><br><span class="line">    registry.deleteReerence(page.name);</span><br><span class="line">    configKegs.deleteKey(page.name.makeKey());</span><br><span class="line">&#125; catch(e)&#123;</span><br><span class="line">    console.log(e.message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-9-1-æŠ½ç¦»try-x2F-catchä»£ç å—"><a href="#3-9-1-æŠ½ç¦»try-x2F-catchä»£ç å—" class="headerlink" title="3.9.1 æŠ½ç¦»try&#x2F;catchä»£ç å—"></a>3.9.1 æŠ½ç¦»try&#x2F;catchä»£ç å—</h4><ul>
<li>å°†try&#x2F;catchä»£ç å—ä»ä¸»ä½“ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œå½¢æˆå•ç‹¬çš„å‡½æ•°ã€‚ä»£ç æ›´æ•´æ´</li>
</ul>
<h3 id="3-10-åˆ«é‡å¤è‡ªå·±"><a href="#3-10-åˆ«é‡å¤è‡ªå·±" class="headerlink" title="3.10 åˆ«é‡å¤è‡ªå·±"></a>3.10 åˆ«é‡å¤è‡ªå·±</h3><ul>
<li>é‡å¤å¯èƒ½æ˜¯è½¯ä»¶ä¸­ä¸€åˆ‡çš„é‚ªæ¶æ ¹æº</li>
</ul>
<h3 id="3-12-å¦‚ä½•å†™å‡ºè¿™æ ·çš„å‡½æ•°"><a href="#3-12-å¦‚ä½•å†™å‡ºè¿™æ ·çš„å‡½æ•°" class="headerlink" title="3.12 å¦‚ä½•å†™å‡ºè¿™æ ·çš„å‡½æ•°"></a>3.12 å¦‚ä½•å†™å‡ºè¿™æ ·çš„å‡½æ•°</h3><ul>
<li>å†™ä»£ç å’Œå†™æ–‡ç« ä¸€æ ·éƒ½æ˜¯éœ€è¦æ‰“ç£¨çš„ï¼Œä¸€å¼€å§‹çš„æ··ä¹±éœ€è¦ä¸€ç‚¹ç‚¹çš„æ”¹å˜</li>
</ul>
<h2 id="ç¬¬äº”ç« -æ ¼å¼"><a href="#ç¬¬äº”ç« -æ ¼å¼" class="headerlink" title="ç¬¬äº”ç«  æ ¼å¼"></a>ç¬¬äº”ç«  æ ¼å¼</h2><h3 id="5-2-å‚ç›´æ ¼å¼"><a href="#5-2-å‚ç›´æ ¼å¼" class="headerlink" title="5.2 å‚ç›´æ ¼å¼"></a>5.2 å‚ç›´æ ¼å¼</h3><ul>
<li>å•ä¸ªæ–‡ä»¶ä»£ç è¡Œæ•°åœ¨500è¡Œä»¥ä¸‹å¹³å‡åœ¨100å·¦å³æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å»ºè®®ã€‚</li>
</ul>
<h4 id="5-2-2-æ¦‚å¿µé—´å‚ç›´æ–¹å‘ä¸Šçš„åŒºéš”"><a href="#5-2-2-æ¦‚å¿µé—´å‚ç›´æ–¹å‘ä¸Šçš„åŒºéš”" class="headerlink" title="5.2.2 æ¦‚å¿µé—´å‚ç›´æ–¹å‘ä¸Šçš„åŒºéš”"></a>5.2.2 æ¦‚å¿µé—´å‚ç›´æ–¹å‘ä¸Šçš„åŒºéš”</h4><ul>
<li>å‡ ä¹è¯´æœ‰ä»£ç éƒ½æ˜¯ä»ä¸Šå¾€ä¸‹è¯»ï¼Œä»å·¦å¾€å³è¯»ã€‚æ¯è¡Œå±•ç¤ºä¸€ä¸ªè¡¨è¾¾å¼æˆ–ä¸€ä¸ªå­å¥ï¼Œæ¯ç»„ä»£ç è¡Œå±•ç¤ºä¸€æ¡å®Œæ•´çš„æ€è·¯ã€‚è¿™äº›æ€è·¯ç”¨ç©ºç™½è¡ŒåŒºéš”å¼€æ¥ã€‚</li>
</ul>
<h4 id="5-2-3-å‚ç›´æ–¹å‘ä¸Šçš„é è¿‘"><a href="#5-2-3-å‚ç›´æ–¹å‘ä¸Šçš„é è¿‘" class="headerlink" title="5.2.3 å‚ç›´æ–¹å‘ä¸Šçš„é è¿‘"></a>5.2.3 å‚ç›´æ–¹å‘ä¸Šçš„é è¿‘</h4><ul>
<li>å¦‚æœè¯´ç©ºç™½è¡Œéš”ç¦»æ¦‚å¿µã€‚é è¿‘çš„ä»£ç è¡Œåˆ™æš—ç¤ºå®ƒä»¬ä¹‹é—´ç´§å¯†å…³ç³»ã€‚æ‰€ä»¥ï¼Œç´§å¯†ç›¸å…³çš„ä»£ç åº”è¯¥ç›¸äº’é è¿‘ã€‚</li>
</ul>
<h4 id="5-2-4-å‚ç›´è·ç¦»"><a href="#5-2-4-å‚ç›´è·ç¦»" class="headerlink" title="5.2.4 å‚ç›´è·ç¦»"></a>5.2.4 å‚ç›´è·ç¦»</h4><p>å…³ç³»å¯†åˆ‡çš„æ¦‚å¿µåº”è¯¥ç›¸äº’é è¿‘ã€‚  </p>
<ul>
<li>å¦‚å˜é‡å£°æ˜åº”å°½å¯èƒ½é è¿‘å…¶ä½¿ç”¨ä½ç½®</li>
<li>ç›¸å…³å‡½æ•°ï¼šè‹¥æŸä¸ªå‡½æ•°è°ƒç”¨äº†å¦ä¸€ä¸ªï¼Œå°±åº”è¯¥æŠŠå®ƒä»¬æ”¾åœ¨ä¸€èµ·ï¼Œè€Œä¸”è°ƒç”¨è€…åº”è¯¥å°½å¯èƒ½æ”¾åœ¨è¢«è°ƒç”¨è€…ä¸Šé¢.<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let request = null;</span><br><span class="line">let crawler = null;</span><br><span class="line"></span><br><span class="line">function makeResponse(context, request)&#123;</span><br><span class="line">    let pageName = getPageName(request, &quot;FrontPage&quot;);</span><br><span class="line">    loadPage(pageName, context);</span><br><span class="line">    if(page == null)&#123;</span><br><span class="line">        return notFoundResponse(context, request);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return makePageResponse(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function getPageName()&#123;&#125;</span><br><span class="line">    function loadPage()&#123;&#125;</span><br><span class="line">    function notFoundResponse()&#123;&#125;</span><br><span class="line">    function makePageResponse()&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>æ¦‚å¿µç›¸å…³ï¼šæ¦‚å¿µç›¸å…³çš„ä»£ç åº”è¯¥æ”¾åœ¨ä¸€èµ·ã€‚ç›¸å…³æ€§è¶Šå¼ºï¼Œå½¼æ­¤ä¹‹é—´çš„è·ç¦»å°±è¯¥è¶ŠçŸ­ï¼Œç›¸å…³æ€§èµ–åœ¨å¦‚å‡½æ•°é—´è°ƒç”¨ï¼Œæˆ–è€…ä½¿ç”¨æŸä¸ªå˜é‡ï¼Œä¹Ÿå¯èƒ½æ¥è‡ªæ‰§è¡Œç›¸ä¼¼æ“ä½œçš„ä¸€ç»„å‡½æ•°ã€‚</li>
</ul>
<h4 id="5-2-5å‚ç›´é¡ºåº"><a href="#5-2-5å‚ç›´é¡ºåº" class="headerlink" title="5.2.5å‚ç›´é¡ºåº"></a>5.2.5å‚ç›´é¡ºåº</h4><ul>
<li>ä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬æƒ³è‡ªä¸Šå‘ä¸‹å±•ç¤ºå‡½æ•°è°ƒç”¨é¡ºåºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¢«è°ƒç”¨çš„å‡½æ•°åº”è¯¥æ”¾åœ¨æ‰§è¡Œè°ƒç”¨çš„é¢å‡½æ•°ä¸‹é¢ã€‚ æˆ‘ä»¬å¸Œæœ›æœ€é‡è¦çš„æ¦‚å¿µå…ˆå‡ºæ¥ï¼ŒæŒ‡æœ›ä»¥åŒ…æ‹¬æœ€å°‘ç»†èŠ‚çš„æ–¹å¼è¡¨è¿°å®ƒä»¬ï¼Œæˆ‘ä»¬å¸Œæœ›åº•å±‚ç»†èŠ‚æœ€åå‡ºæ¥ï¼Œè€Œä¸æ˜¯ä¸€å¼€å§‹å°±æ²‰è¿·äºç»†èŠ‚ã€‚</li>
</ul>
<h4 id="5-3-1-æ°´å¹³æ–¹å‘ä¸Šçš„é—´éš”ä¸é è¿‘"><a href="#5-3-1-æ°´å¹³æ–¹å‘ä¸Šçš„é—´éš”ä¸é è¿‘" class="headerlink" title="5.3.1 æ°´å¹³æ–¹å‘ä¸Šçš„é—´éš”ä¸é è¿‘"></a>5.3.1 æ°´å¹³æ–¹å‘ä¸Šçš„é—´éš”ä¸é è¿‘</h4><ul>
<li>æˆ‘ä»¬ä½¿ç”¨ç©ºæ ¼å­—ç¬¦å°†å½¼æ­¤ç´§å¯†çš„è¿æ¥åˆ°ä¸€èµ·ï¼Œä¹Ÿç”¨ç©ºæ ¼å­—ç¬¦å°†ç›¸å…³æ€§è¾ƒå¼±çš„äº‹ç‰©éš”å¼€ã€‚</li>
</ul>
<h2 id="ç¬¬6ç« -å¯¹è±¡å’Œæ•°æ®ç»“æ„"><a href="#ç¬¬6ç« -å¯¹è±¡å’Œæ•°æ®ç»“æ„" class="headerlink" title="ç¬¬6ç«  å¯¹è±¡å’Œæ•°æ®ç»“æ„"></a>ç¬¬6ç«  å¯¹è±¡å’Œæ•°æ®ç»“æ„</h2><ul>
<li>ç±»å¹¶ä¸æ˜¯é—´æ–­çš„å–èµ‹å€¼ï¼Œæ›´å¤šæ˜¯æŠ½è±¡æ¥å£ï¼Œä»¥ä¾¿ç”¨æˆ·æ— éœ€äº†è§£æ•°æ®çš„å®é™…å°±èƒ½æ“ä½œæ•°æ®æœ¬ä½“<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function Point()&#123;</span><br><span class="line">    let x;</span><br><span class="line">    let y;</span><br><span class="line"></span><br><span class="line">    function getX()&#123;</span><br><span class="line">        return x;</span><br><span class="line">    &#125;</span><br><span class="line">    function getY()&#123;</span><br><span class="line">        return Y;</span><br><span class="line">    &#125;</span><br><span class="line">    function getArea()&#123;</span><br><span class="line">        return x*y*2;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return &#123;</span><br><span class="line">        x:getXï¼Œ</span><br><span class="line">        y:getY,</span><br><span class="line">        area:getArea</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>å¦‚ä½•å†™ä»£ç </category>
      </categories>
  </entry>
  <entry>
    <title>å…³é”®è·¯å¾„æ¸²æŸ“</title>
    <url>/2017/08/14/%E5%85%B3%E9%94%AE%E8%B7%AF%E5%BE%84%E6%B8%B2%E6%9F%93/</url>
    <content><![CDATA[<h2 id="æ€»çš„æ¥è¯´æµè§ˆå™¨è¦ç»è¿‡ä¸€ä¸‹å‡ ä¸ªæ­¥éª¤æ‰èƒ½å°†ä¸‹è½½å¥½çš„æ•°æ®æ¸²æŸ“åˆ°æµè§ˆå™¨ç•Œé¢ä¸Š"><a href="#æ€»çš„æ¥è¯´æµè§ˆå™¨è¦ç»è¿‡ä¸€ä¸‹å‡ ä¸ªæ­¥éª¤æ‰èƒ½å°†ä¸‹è½½å¥½çš„æ•°æ®æ¸²æŸ“åˆ°æµè§ˆå™¨ç•Œé¢ä¸Š" class="headerlink" title="æ€»çš„æ¥è¯´æµè§ˆå™¨è¦ç»è¿‡ä¸€ä¸‹å‡ ä¸ªæ­¥éª¤æ‰èƒ½å°†ä¸‹è½½å¥½çš„æ•°æ®æ¸²æŸ“åˆ°æµè§ˆå™¨ç•Œé¢ä¸Š"></a>æ€»çš„æ¥è¯´æµè§ˆå™¨è¦ç»è¿‡ä¸€ä¸‹å‡ ä¸ªæ­¥éª¤æ‰èƒ½å°†ä¸‹è½½å¥½çš„æ•°æ®æ¸²æŸ“åˆ°æµè§ˆå™¨ç•Œé¢ä¸Š</h2><h3 id="DOM-CSSOM-x3D-Render-Tree"><a href="#DOM-CSSOM-x3D-Render-Tree" class="headerlink" title="DOM + CSSOM &#x3D; Render Tree"></a>DOM + CSSOM &#x3D; Render Tree</h3><ul>
<li>å¤„ç† HTML æ ‡è®°å¹¶è§£æä¸º DOM æ ‘ã€‚(Parse HTNL)</li>
<li>å¤„ç† CSS æ ‡è®°å¹¶è§£æä¸º CSSOM æ ‘ã€‚(Recalculate style)</li>
<li>å°† DOM ä¸ CSSOM åˆå¹¶æˆä¸€ä¸ªæ¸²æŸ“æ ‘ã€‚</li>
<li>æ ¹æ®æ¸²æŸ“æ ‘æ¥å¸ƒå±€ï¼Œä»¥è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„å‡ ä½•ä¿¡æ¯ã€‚(layout)</li>
<li>å°†å„ä¸ªèŠ‚ç‚¹ç»˜åˆ¶åˆ°å±å¹•ä¸Šã€‚(panit &amp; Composite Layers )<br><img src="/2017/08/14/%E5%85%B3%E9%94%AE%E8%B7%AF%E5%BE%84%E6%B8%B2%E6%9F%93/dom-css.png" alt="dom-css">  <span id="more"></span></li>
</ul>
<p>è¿™å…¶ä¸­å°†HTMLæ–‡æ¡£è§£æä¸ºDOMä¸å°†ç‰¹å®šæ ·å¼è¡¨(stylesheet)çš„è§„åˆ™å’Œèµ„æºè§£æä¸ºCSSOMæ˜¯åŒæ­¥è¿›è¡Œçš„ã€‚æœ€ç»ˆå°†ä¸¤è€…(DOM CSSOM)åˆå¹¶ä¸ºæ¸²æŸ“æ ‘(è¿™ä¹Ÿæ„å‘³ç€ä¸€èˆ¬çš„csså’Œhtmléƒ½æ˜¯é˜»å¡ç•Œé¢æ¸²æŸ“çš„èµ„æº)æ­¤æ—¶æµè§ˆå™¨å°±æœ‰äº†è¶³å¤Ÿçš„ä¿¡æ¯åœ¨æµè§ˆå™¨ä¸Šæ‰§è¡Œå¸ƒå±€(Layout)å’Œç»˜åˆ¶(Paint)ã€‚  </p>
<p>ä¸å¹¸çš„æ˜¯è¿™åªæ˜¯æ²¡æœ‰å¼•å…¥jsçš„æƒ…å†µ</p>
<ul>
<li>å› ä¸ºåŒæ­¥jsè„šæœ¬å¯ä»¥åœ¨ä»»ä½•æ—¶é—´ä½¿ç”¨document.write,å› æ­¤DOMæ ‘æ„é€ å°†åœ¨ä»»ä½•æ—¶å€™é‡åˆ°ä¸€ä¸ªåŒæ­¥jsæ ‡ç­¾æ—¶é˜»å¡ã€‚</li>
<li>å¦ä¸€æ–¹é¢jså¯ä»¥è·å–ä»»æ„èŠ‚ç‚¹å¯¹è±¡è®¡ç®—æ ·å¼ï¼Œè¿™å°±æ„å‘³ç€jsè„šæœ¬ä¹Ÿä¼šè¢«CSSOMæ„é€ é˜»å¡ã€‚<br><img src="/2017/08/14/%E5%85%B3%E9%94%AE%E8%B7%AF%E5%BE%84%E6%B8%B2%E6%9F%93/dom-css-js.png" alt="dom-css-js"><br><img src="/2017/08/14/%E5%85%B3%E9%94%AE%E8%B7%AF%E5%BE%84%E6%B8%B2%E6%9F%93/analysis-dom-css-js.png" alt="analysis-dom-css-js"></li>
</ul>
<p>æ·»åŠ åŒæ­¥jsåï¼Œåœ¨jsæ²¡æ‰§è¡Œå®Œä¹‹å‰DOMæ„é€ è¢«é˜»å¡ï¼Œåœ¨æ‰§è¡Œjsä¹‹å‰CSSOMå¿…é¡»æ„é€ å®Œæˆ</p>
<h3 id="æ–‡æ¡£-Interactive-amp-DOMContentLoaded"><a href="#æ–‡æ¡£-Interactive-amp-DOMContentLoaded" class="headerlink" title="æ–‡æ¡£ Interactive &amp; DOMContentLoaded"></a>æ–‡æ¡£ Interactive &amp; DOMContentLoaded</h3><ul>
<li>å½“æµè§ˆå™¨å®Œæˆå¯¹æ‰€æœ‰ HTML çš„è§£æå¹¶ä¸” DOM æ„å»ºå®Œæˆæ–‡æ¡£æ ‡è®°ä¸ºInteractiveã€‚</li>
<li>å½“ DOM å‡†å¤‡å°±ç»ªå¹¶ä¸”æ²¡æœ‰æ ·å¼è¡¨é˜»æ­¢ JavaScript æ‰§è¡Œã€‚æ–‡æ¡£æ ‡è®°ä¸ºDOMContentLoadedã€‚æ­¤æ—¶DOMå’ŒCSSOMå‡å‡†å¤‡å°±ç»ªå¼€å§‹åˆæˆrender treeã€‚  (è¿™æ˜¯æœ‰æœ‰é˜»å¡è§£é‡Šå™¨jsçš„æƒ…å†µï¼ŒåŒ…æ‹¬åŒæ­¥å’Œå«æœ‰deferå±æ€§js)<br><strong>note</strong>:å¦‚æœæ²¡æœ‰é˜»å¡è§£æå™¨çš„ JavaScriptï¼Œåˆ™ DOMContentLoaded å°†åœ¨ domInteractive åç«‹å³è§¦å‘ã€‚åŒæ—¶ä¹Ÿæ„å‘³ç€æ— éœ€ç­‰å¾…æ ·å¼è¡¨å®ŒæˆåŠ è½½å’Œè§£æã€‚</li>
</ul>
<h3 id="å…³äºcssçš„æ¸²æŸ“é˜»å¡"><a href="#å…³äºcssçš„æ¸²æŸ“é˜»å¡" class="headerlink" title="å…³äºcssçš„æ¸²æŸ“é˜»å¡"></a>å…³äºcssçš„æ¸²æŸ“é˜»å¡</h3><ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒCSS è¢«è§†ä¸ºé˜»å¡æ¸²æŸ“çš„èµ„æº</li>
<li>æˆ‘ä»¬å¯ä»¥é€šè¿‡åª’ä½“ç±»å‹å’Œåª’ä½“æŸ¥è¯¢å°†ä¸€äº› CSS èµ„æºæ ‡è®°ä¸ºä¸é˜»å¡æ¸²æŸ“ã€‚<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;link href=&quot;style.css&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">&lt;link href=&quot;print.css&quot; rel=&quot;stylesheet&quot; media=&quot;print&quot;&gt;</span><br><span class="line">&lt;link href=&quot;other.css&quot; rel=&quot;stylesheet&quot; media=&quot;(min-width: 40em)&quot;&gt;</span><br></pre></td></tr></table></figure></li>
<li>æµè§ˆå™¨ä¼šä¸‹è½½æ‰€æœ‰ CSS èµ„æºï¼Œæ— è®ºé˜»å¡è¿˜æ˜¯ä¸é˜»å¡ã€‚</li>
</ul>
<h3 id="å…³äºjsçš„DOMé˜»å¡"><a href="#å…³äºjsçš„DOMé˜»å¡" class="headerlink" title="å…³äºjsçš„DOMé˜»å¡"></a>å…³äºjsçš„DOMé˜»å¡</h3><ul>
<li>JavaScript å¯ä»¥æŸ¥è¯¢å’Œä¿®æ”¹ DOM ä¸ CSSOMã€‚</li>
<li>JavaScript æ‰§è¡Œä¼šè¢« CSSOM çš„æ„é€ é˜»å¡</li>
<li>é™¤éå°† JavaScript æ˜¾å¼å£°æ˜ä¸ºå¼‚æ­¥ï¼Œå¦åˆ™å®ƒä¼šé˜»æ­¢æ„å»º DOMã€‚<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1&quot;&gt;</span><br><span class="line">    &lt;link href=&quot;style.css&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">    &lt;title&gt;Critical Path: Script Async&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;p&gt;Hello &lt;span&gt;web performance&lt;/span&gt; students!&lt;/p&gt;</span><br><span class="line">    &lt;div&gt;&lt;img src=&quot;awesome-photo.jpg&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;script src=&quot;app.js&quot; async&gt;&lt;/script&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li>
<li>æ‰§è¡Œæˆ‘ä»¬çš„å†…è”è„šæœ¬ä¼šé˜»æ­¢ DOM æ„å»ºï¼Œä¹Ÿå°±å»¶ç¼“äº†é¦–æ¬¡æ¸²æŸ“ã€‚</li>
<li>æµè§ˆå™¨å°†å»¶è¿Ÿè„šæœ¬æ‰§è¡Œå’Œ DOM æ„å»ºï¼Œç›´è‡³å…¶å®Œæˆ CSSOM çš„ä¸‹è½½å’Œæ„å»ºã€‚</li>
</ul>
<h3 id="ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„"><a href="#ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„" class="headerlink" title="ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„"></a>ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„</h3><ul>
<li>å¯¹å…³é”®è·¯å¾„è¿›è¡Œåˆ†æå’Œç‰¹æ€§æè¿°ï¼šèµ„æºæ•°ã€å­—èŠ‚æ•°ã€é•¿åº¦ã€‚</li>
<li>æœ€å¤§é™åº¦å‡å°‘å…³é”®èµ„æºçš„æ•°é‡ï¼šåˆ é™¤å®ƒä»¬ï¼Œå»¶è¿Ÿå®ƒä»¬çš„ä¸‹è½½ï¼Œå°†å®ƒä»¬æ ‡è®°ä¸ºå¼‚æ­¥ç­‰ã€‚</li>
<li>ä¼˜åŒ–å…³é”®å­—èŠ‚æ•°ä»¥ç¼©çŸ­ä¸‹è½½æ—¶é—´ï¼ˆå¾€è¿”æ¬¡æ•°ï¼‰ã€‚</li>
<li>ä¼˜åŒ–å…¶ä½™å…³é”®èµ„æºçš„åŠ è½½é¡ºåºï¼šæ‚¨éœ€è¦å°½æ—©ä¸‹è½½æ‰€æœ‰å…³é”®èµ„äº§ï¼Œä»¥ç¼©çŸ­å…³é”®è·¯å¾„é•¿åº¦ã€‚</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>åˆè¯†RESTful</title>
    <url>/2017/10/29/%E5%88%9D%E8%AF%86REST/</url>
    <content><![CDATA[<p>RESTful API æ˜¯ç›®å‰æ¯”è¾ƒæˆç†Ÿå’Œæµè¡Œçš„äº’è”ç½‘åº”ç”¨ç¨‹åºAPIè®¾è®¡ç†è®ºï¼ŒRESTæ˜¯è¡¨è¿°æ€§çŠ¶æ€è½¬ç§»(REpresentational State Transfer)çš„ç®€ç§°ã€‚å®ƒæ˜¯ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ï¼Œè®¾è®¡é£æ ¼è€Œä¸æ˜¯æ ‡å‡†ï¼Œåªæ˜¯æä¾›äº†ä¸€ç»„è®¾è®¡åŸåˆ™å’Œçº¦æŸæ¡ä»¶ã€‚</p>
<span id="more"></span>

<p>REST å…³é”®åŸåˆ™</p>
<ul>
<li>ä¸ºæ‰€æœ‰â€œäº‹ç‰©â€(èµ„æº)å®šä¹‰ID</li>
<li>å°†æ‰€æœ‰äº‹ç‰©é“¾æ¥åœ¨ä¸€èµ·</li>
<li>ä½¿ç”¨æ ‡å‡†æ–¹æ³•</li>
<li>èµ„æºå¤šé‡è¡¨è¿°</li>
<li>æ— çŠ¶æ€é€šä¿¡</li>
</ul>
<h3 id="ä¸ºæ‰€æœ‰â€œäº‹ç‰©â€-èµ„æº-å®šä¹‰ID"><a href="#ä¸ºæ‰€æœ‰â€œäº‹ç‰©â€-èµ„æº-å®šä¹‰ID" class="headerlink" title="ä¸ºæ‰€æœ‰â€œäº‹ç‰©â€(èµ„æº)å®šä¹‰ID"></a>ä¸ºæ‰€æœ‰â€œäº‹ç‰©â€(èµ„æº)å®šä¹‰ID</h3><p>å¯¹äº‹ç‰©ä½¿ç”¨ä¸€è‡´çš„å‘½åè§„åˆ™ï¼Œå°†æ¯ä¸ªå¯æ ‡è®°çš„èµ„æºä½¿ç”¨ä¸€ä¸ªå”¯ä¸€çš„æ ‡å¿—æ¥æ ‡è¯†(URI)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://example.com/customers/1234</span><br><span class="line">http://example.com/orders/2007/10/776654</span><br><span class="line">http://example.com/products/4554</span><br><span class="line">http://example.com/processes/salary-increase-234 </span><br><span class="line"></span><br><span class="line">http://example.com/orders/2007/11</span><br><span class="line">http://example.com/products?color=green </span><br></pre></td></tr></table></figure>

<h3 id="å°†æ‰€æœ‰äº‹ç‰©é“¾æ¥åœ¨ä¸€èµ·"><a href="#å°†æ‰€æœ‰äº‹ç‰©é“¾æ¥åœ¨ä¸€èµ·" class="headerlink" title="å°†æ‰€æœ‰äº‹ç‰©é“¾æ¥åœ¨ä¸€èµ·"></a>å°†æ‰€æœ‰äº‹ç‰©é“¾æ¥åœ¨ä¸€èµ·</h3><p>ä»»ä½•å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨é“¾æ¥æŒ‡å¼•å¯ä»¥è¢«æ ‡è¯†çš„äº‹ç‰©ï¼ˆèµ„æºï¼‰ã€‚ä¹Ÿæ­£æ˜¯è¶…é“¾æ¥é€ å°±äº†ç°åœ¨çš„Webã€‚<br>æ¢å¥è¯è¯´ï¼šæ˜¯é“¾æ¥çš„æ€æƒ³ã€‚é“¾æ¥æ˜¯æˆ‘ä»¬åœ¨HTMLä¸­å¸¸è§çš„æ¦‚å¿µï¼Œä½†æ˜¯å®ƒçš„ç”¨å¤„ç»ä¸å±€é™äºæ­¤ï¼ˆç”¨äºäººä»¬ç½‘ç»œæµè§ˆï¼‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;order self=&quot;http://example.com/customers/1234&quot;&gt; </span><br><span class="line">   &lt;amount&gt;23&lt;/amount&gt; </span><br><span class="line">   &lt;product ref=&quot;http://example.com/products/4554&quot;&gt; </span><br><span class="line">   &lt;customer ref=&quot;http://example.com/customers/1234&quot;&gt; </span><br><span class="line">&lt;/customer&gt; &lt;/product&gt;&lt;/order&gt;</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨æ ‡å‡†æ–¹æ³•"><a href="#ä½¿ç”¨æ ‡å‡†æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ ‡å‡†æ–¹æ³•"></a>ä½¿ç”¨æ ‡å‡†æ–¹æ³•</h3><p>ä¸ºä½¿å®¢æˆ·ç«¯ç¨‹åºèƒ½ä¸ä½ çš„èµ„æºç›¸äº’åä½œï¼Œèµ„æºåº”è¯¥æ­£ç¡®åœ°å®ç°é»˜è®¤çš„åº”ç”¨åè®®ï¼ˆHTTPï¼‰ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨æ ‡å‡†çš„GETã€PUTã€POSTå’ŒDELETEæ–¹æ³•ã€‚</p>
<h3 id="èµ„æºå¤šé‡è¡¨è¿°"><a href="#èµ„æºå¤šé‡è¡¨è¿°" class="headerlink" title="èµ„æºå¤šé‡è¡¨è¿°"></a>èµ„æºå¤šé‡è¡¨è¿°</h3><p>é’ˆå¯¹ä¸åŒçš„éœ€æ±‚æä¾›èµ„æºå¤šé‡è¡¨è¿°ã€‚</p>
<h3 id="æ— çŠ¶æ€é€šä¿¡"><a href="#æ— çŠ¶æ€é€šä¿¡" class="headerlink" title="æ— çŠ¶æ€é€šä¿¡"></a>æ— çŠ¶æ€é€šä¿¡</h3><p>ä¸€ä¸ªå®¢æˆ·ç«¯ä»æŸå°æœåŠ¡å™¨ä¸Šæ”¶åˆ°ä¸€ä»½åŒ…å«é“¾æ¥çš„æ–‡æ¡£ï¼Œå½“å®ƒè¦åšä¸€äº›å¤„ç†æ—¶ï¼Œè¿™å°æœåŠ¡å™¨å®•æ‰äº†ï¼Œå¯èƒ½æ˜¯ç¡¬ç›˜åæ‰è€Œè¢«æ‹¿å»ä¿®ç†ï¼Œå¯èƒ½æ˜¯è½¯ä»¶éœ€è¦å‡çº§é‡å¯â€”â€”å¦‚æœè¿™ä¸ªå®¢æˆ·ç«¯è®¿é—®äº†ä»è¿™å°æœåŠ¡å™¨æ¥æ”¶çš„é“¾æ¥ï¼Œå®ƒä¸ä¼šå¯Ÿè§‰åˆ°åå°çš„æœåŠ¡å™¨å·²ç»æ”¹å˜äº†ã€‚</p>
<p>å…·ä½“å®æ–½å¯ä»¥å‚è€ƒ <a href="http://www.ruanyifeng.com/blog/2014/05/restful_api.html">RESTful API è®¾è®¡æŒ‡å—</a></p>
]]></content>
      <tags>
        <tag>æ„æ¶</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¨¡å—åŒ–</title>
    <url>/2017/10/12/%E5%89%8D%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96%E5%8C%BA%E5%88%AB/</url>
    <content><![CDATA[<ul>
<li><p>1.AMD&#x2F;CMD&#x2F;CommonJsæ˜¯JSæ¨¡å—åŒ–å¼€å‘çš„æ ‡å‡†ï¼Œç›®å‰å¯¹åº”çš„å®ç°æ˜¯RequireJs&#x2F;SeaJs&#x2F;nodeJs.</p>
</li>
<li><p>2.CommonJsä¸»è¦é’ˆå¯¹æœåŠ¡ç«¯ï¼ŒAMD&#x2F;CMDä¸»è¦é’ˆå¯¹æµè§ˆå™¨ç«¯ï¼Œæ‰€ä»¥æœ€å®¹æ˜“æ··æ·†çš„æ˜¯AMD&#x2F;CMD:æœåŠ¡å™¨ç«¯ä¸€èˆ¬é‡‡ç”¨åŒæ­¥åŠ è½½æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦æŸä¸ªæ¨¡å—ï¼ŒæœåŠ¡å™¨ç«¯ä¾¿åœä¸‹æ¥ï¼Œç­‰å¾…å®ƒåŠ è½½å†æ‰§è¡Œ.æµè§ˆå™¨ç«¯è¦ä¿è¯æ•ˆç‡ï¼Œéœ€è¦é‡‡ç”¨å¼‚æ­¥åŠ è½½.</p>
</li>
<li><p>3.AMD&#x2F;CMDåŒºåˆ«ï¼Œè™½ç„¶éƒ½æ˜¯å¹¶è¡ŒåŠ è½½jsæ–‡ä»¶ï¼Œä½†è¿˜æ˜¯æœ‰æ‰€åŒºåˆ«ï¼ŒAMDæ˜¯é¢„åŠ è½½ï¼Œåœ¨å¹¶è¡ŒåŠ è½½jsæ–‡ä»¶åŒæ—¶ï¼Œè¿˜ä¼šè§£ææ‰§è¡Œè¯¥æ¨¡å—ï¼ˆå› ä¸ºè¿˜éœ€è¦æ‰§è¡Œï¼Œæ‰€ä»¥åœ¨åŠ è½½æŸä¸ªæ¨¡å—å‰ï¼Œè¿™ä¸ªæ¨¡å—çš„ä¾èµ–æ¨¡å—éœ€è¦å…ˆåŠ è½½å®Œæˆï¼‰ï¼›è€ŒCMDæ˜¯æ‡’åŠ è½½ï¼Œè™½ç„¶ä¼šä¸€å¼€å§‹å°±å¹¶è¡ŒåŠ è½½jsæ–‡ä»¶ï¼Œä½†æ˜¯ä¸ä¼šæ‰§è¡Œï¼Œè€Œæ˜¯åœ¨éœ€è¦çš„æ—¶å€™æ‰æ‰§è¡Œã€‚</p>
</li>
<li><p>4.AMD&#x2F;CMDçš„ä¼˜ç¼ºç‚¹.ä¸€ä¸ªçš„ä¼˜ç‚¹å°±æ˜¯å¦ä¸€ä¸ªçš„ç¼ºç‚¹ï¼Œ å¯ä»¥å¯¹ç…§æµè§ˆã€‚   </p>
<pre><code>   AMDä¼˜ç‚¹ï¼šåŠ è½½å¿«é€Ÿï¼Œå°¤å…¶é‡åˆ°å¤šä¸ªå¤§æ–‡ä»¶ï¼Œå› ä¸ºå¹¶è¡Œè§£æï¼Œæ‰€ä»¥åŒä¸€æ—¶é—´å¯ä»¥è§£æå¤šä¸ªæ–‡ä»¶ã€‚
   AMDç¼ºç‚¹ï¼šå¹¶è¡ŒåŠ è½½ï¼Œå¼‚æ­¥å¤„ç†ï¼ŒåŠ è½½é¡ºåºä¸ä¸€å®šï¼Œå¯èƒ½ä¼šé€ æˆä¸€äº›å›°æ‰°ï¼Œç”šè‡³ä¸ºç¨‹åºåŸ‹ä¸‹å¤§å‘ã€‚

  CMDä¼˜ç‚¹ï¼šå› ä¸ºåªæœ‰åœ¨ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šè§£ææ‰§è¡Œjsæ–‡ä»¶ï¼Œå› æ­¤ï¼Œæ¯ä¸ªJSæ–‡ä»¶çš„æ‰§è¡Œé¡ºåºåœ¨ä»£ç ä¸­æ˜¯æœ‰ä½“ç°çš„ï¼Œæ˜¯å¯æ§çš„ã€‚
  CMDç¼ºç‚¹ï¼šæ‰§è¡Œç­‰å¾…æ—¶é—´ä¼šå åŠ ã€‚å› ä¸ºæ¯ä¸ªæ–‡ä»¶æ‰§è¡Œæ—¶æ˜¯åŒæ­¥æ‰§è¡Œï¼ˆä¸²è¡Œæ‰§è¡Œï¼‰ï¼Œå› æ­¤æ—¶é—´æ˜¯æ‰€æœ‰æ–‡ä»¶è§£ææ‰§è¡Œæ—¶é—´ä¹‹å’Œï¼Œå°¤å…¶åœ¨æ–‡ä»¶è¾ƒå¤šè¾ƒå¤§æ—¶ï¼Œè¿™ç§ç¼ºç‚¹å°¤ä¸ºæ˜æ˜¾ã€‚
</code></pre>
</li>
<li><p>5.å¦‚ä½•ä½¿ç”¨ï¼ŸCommonJsçš„è¯ï¼Œå› ä¸ºnodeJså°±æ˜¯å®ƒçš„å®ç°ï¼Œæ‰€ä»¥ä½¿ç”¨nodeå°±è¡Œï¼Œä¹Ÿä¸ç”¨å¼•å…¥å…¶ä»–åŒ…ã€‚AMDåˆ™æ˜¯é€šè¿‡&lt;script&gt;æ ‡ç­¾å¼•å…¥RequireJsï¼Œå…·ä½“è¯­æ³•è¿˜æ˜¯å»çœ‹å®˜æ–¹æ–‡æ¡£æˆ–è€…ç™¾åº¦ä¸€ä¸‹å§ã€‚CMDåˆ™æ˜¯å¼•å…¥SeaJsã€‚</p>
</li>
<li><p>6.commonJS&#x2F;AMD&#x2F;CMD&#x2F;moudleéƒ½æ˜¯åŠ¨æ€åŠ è½½çš„ä¹Ÿæ˜¯å°±åœ¨ä»£ç æ‰§è¡Œå‰ä¸çŸ¥é“ä¾èµ–çš„ï¼Œmoudleåˆ™æ˜¯é™æ€çš„ï¼Œåœ¨ä»£ç æ‰§è¡Œä¹‹å‰å·²ç»ç¡®å®šäº†ä¾èµ–å…³ç³»ã€‚</p>
</li>
</ul>
]]></content>
      <tags>
        <tag>commonJS/AMD/CMD/moudle</tag>
      </tags>
  </entry>
  <entry>
    <title>æ·±å…¥æµ…å‡ºNode.js</title>
    <url>/2017/10/11/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BANode.js--%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h2 id="ç¬¬1ç« -Nodeç®€ä»‹"><a href="#ç¬¬1ç« -Nodeç®€ä»‹" class="headerlink" title="ç¬¬1ç«  Nodeç®€ä»‹"></a>ç¬¬1ç«  Nodeç®€ä»‹</h2><p>  nodeçš„ä¸»è¦æ„æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  </p>
<p>  <img src="/2017/10/11/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BANode.js--%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/node1.png" alt="nodeStrcture"><br>  <span id="more"></span></p>
<h2 id="ç¬¬2ç« -æ¨¡å—æœºåˆ¶"><a href="#ç¬¬2ç« -æ¨¡å—æœºåˆ¶" class="headerlink" title="ç¬¬2ç«  æ¨¡å—æœºåˆ¶"></a>ç¬¬2ç«  æ¨¡å—æœºåˆ¶</h2><p>  Nodeæ¨¡å—åˆ†ä¸¤ç±»ï¼šä¸€ç±»Nodeæä¾›çš„æ ¸å¿ƒæ¨¡å—ï¼Œå¦ä¸€ç±»æ–‡ä»¶æ¨¡å—  </p>
<p>  Nodeæ¨¡å—å®ç°ä¸»è¦éµå¾ªçš„æ˜¯commonJSï¼Œè¦å¼•å…¥æ¨¡å—è¦ç»å†ä¸‰ä¸ªæ­¥éª¤ï¼šå‰ä¸¤æ­¥äº¤æ›¿æ‰§è¡Œï¼Œç¬¬ä¸‰æ­¥æœ€åæ‰§è¡Œ</p>
<ul>
<li><p>ï¼ˆ1ï¼‰è·¯å¾„åˆ†æ</p>
<pre><code>æ ¸å¿ƒæ¨¡å—ï¼šä¼˜å…ˆçº§ä»…æ¬¡äºç¼“å­˜åŠ è½½çš„ï¼Œå› ä¸ºå·²ç»ç¼–è¯‘ä¸ºäºŒè¿›åˆ¶ä»£ç ã€‚    
ç›¸å¯¹ç»å¯¹è·¯å¾„æ¨¡å—ï¼šè¢«å½“åšæ–‡ä»¶æ¨¡å—å¤„ç†ï¼Œè½¬åŒ–å°†è·¯å¾„è½¬æ¢ä¸ºçœŸå®è·¯å¾„ï¼Œæ£€ç´¢ï¼ŒåŠ è½½ï¼Œç¼–è¯‘ï¼Œç¼“å­˜ã€‚   
è‡ªå®šä¹‰ï¼šåœ¨åŠ è½½è¿‡ç¨‹ä¸­ï¼Œnodeä¼šé€ä¸ªå°è¯•çˆ¶çº§æ¨¡å—è·¯å¾„ä¸­è·¯å¾„ï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶ä¸ºæ­¢
</code></pre>
</li>
<li><p>ï¼ˆ2ï¼‰æ–‡ä»¶å®šä½</p>
<p>  æœ‰æ‰©å±•åï¼š ç›´æ¥å®šä½<br>  æ— æ‰©å±•åï¼š Nodeä¼šæŒ‰.js .json .nodeè¡¥å……æ‰©å±•åï¼Œä¾æ¬¡å°è¯•ã€‚è‹¥æœªæ‰¾åˆ°ç›¸åº”æ–‡ä»¶ï¼Œä½†å¾—åˆ°ä¸€ä¸ªç›®å½•Nodeä¼šå°†ç›®å½•å½“æˆåŒ…æ¥å¤„ç†ï¼Œé¦–å…ˆåœ¨å½“å‰ç›®å½•package.jsonè§£æmainå±æ€§çœ‹æœ‰æ— æŒ‡å®šå…¥å£æ–‡ä»¶ï¼ˆè‹¥æ— æ‰©å±•åä¹Ÿä¼šè¡¥å……æ‰©å±•åï¼‰ï¼Œè‹¥å¤±è´¥åˆ™ä¾æ¬¡æŸ¥æ‰¾index.js index.json index.nodeã€‚<br>  è‹¥æ–‡ä»¶å®šä½å¤±è´¥åˆ™ç»§ç»­å‘çˆ¶çº§è¿›è¡Œåç»­çš„è·¯å¾„åˆ†æ</p>
</li>
<li><p>ï¼ˆ3ï¼‰ç¼–è¯‘æ‰§è¡Œï¼š<br> .jsæ–‡ä»¶ï¼š é€šè¿‡fsæ¨¡å—åŒæ­¥è¯»å–æ–‡ä»¶åç¼–è¯‘æ‰§è¡Œ<br> .nodeæ–‡ä»¶ï¼š è¿™æ˜¯ç”¨C&#x2F;C++ç¼–å†™çš„æ‰©å±•æ–‡ä»¶ï¼Œé€šè¿‡dlopen()æ–¹æ³•åŠ è½½æœ€åç¼–è¯‘ç”Ÿæˆæ–‡ä»¶<br> .jsonæ–‡ä»¶ï¼š é€šè¿‡fsæ¨¡å—åŒæ­¥è¯»å–æ–‡ä»¶åï¼Œç”¨JSON.parse()è§£æè¿”å›ç»“æœ<br> å…¶ä»–æ‰©å±•åæ–‡ä»¶ï¼š éƒ½ä¼šå½“åš.jsæ–‡ä»¶è½½å…¥</p>
<p>Nodeä¹Ÿä¼šç¼“å­˜ä¸è¿‡æ˜¯ç¼“å­˜çš„æ˜¯ç¼–è¯‘å’Œæ‰§è¡Œåçš„å¯¹è±¡ï¼Œrequire()æ–¹æ³•å¯¹ç›¸åŒæ¨¡å—çš„äºŒæ¬¡åŠ è½½éƒ½æ˜¯ä¼˜å…ˆé‡‡ç”¨ç¼“å­˜ã€‚</p>
</li>
</ul>
<h2 id="ç¬¬5ç« -å†…å­˜æ§åˆ¶"><a href="#ç¬¬5ç« -å†…å­˜æ§åˆ¶" class="headerlink" title="ç¬¬5ç«  å†…å­˜æ§åˆ¶"></a>ç¬¬5ç«  å†…å­˜æ§åˆ¶</h2>]]></content>
      <categories>
        <category>node</category>
      </categories>
  </entry>
  <entry>
    <title>ç¬¬ä¸€ç«  å—çº§ç»‘å®š</title>
    <url>/2017/06/20/%E7%AC%AC1%E7%AB%A0%20%E5%9D%97%E7%BA%A7%E7%BB%91%E5%AE%9A/</url>
    <content><![CDATA[<h2 id="å—ç»‘å®šï¼ˆBlock-Bindingsï¼‰"><a href="#å—ç»‘å®šï¼ˆBlock-Bindingsï¼‰" class="headerlink" title="å—ç»‘å®šï¼ˆBlock Bindingsï¼‰"></a>å—ç»‘å®šï¼ˆBlock Bindingsï¼‰</h2><p>ä»¥å‰åœ¨javascriptä¸­å˜é‡å£°æ˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ä¸€éƒ¨åˆ†ï¼Œå¤§å¤šæ•°åŸºäºcçš„è¯­è¨€ä¸­å˜é‡ï¼ˆæˆ–ç»‘å®šï¼‰è¢«åˆ›å»ºäºå˜é‡å£°æ˜çš„åœ°æ–¹ï¼Œç„¶è€Œjavascriptä¸­å¹¶ä¸æ˜¯è¿™æ ·ï¼Œå˜é‡åˆ›å»ºçš„æ–¹å¼å–å†³äºä½ å¦‚ä½•å£°æ˜å®ƒä»¬ï¼Œå¹¶ä¸”ECMAScript 6 æä¾›çš„äº†è®©æ§åˆ¶ä½œç”¨åŸŸ(scope)æ›´å®¹æ˜“çš„æ–¹æ³•ï¼Œåœ¨è¿™ç« é‡Œå°†ä¼šå±•ç¤ºä¸ºä»€ä¹ˆè€å¼ var å£°æ˜è®©äººå›°æƒ‘ï¼ŒåŒæ—¶ä»‹ç»SCMAScript 6ä¸­çš„å—ç»‘å®šï¼Œå¹¶æä¾›æœ€ä½³å®è·µã€‚</p>
<span id="more"></span>


<h3 id="å˜é‡å£°æ˜å’Œæå‡"><a href="#å˜é‡å£°æ˜å’Œæå‡" class="headerlink" title="å˜é‡å£°æ˜å’Œæå‡"></a>å˜é‡å£°æ˜å’Œæå‡</h3><p>ç”¨varå£°æ˜çš„å˜é‡ä¸€å¾‹è¢«å½“åšåœ¨å‡½æ•°ï¼ˆå¦‚æœåœ¨å‡½æ•°å¤–éƒ¨å£°æ˜ï¼Œåˆ™ä¸ºå…¨å±€å˜é‡ï¼‰é¡¶éƒ¨å£°æ˜çš„å˜é‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function getValue(condition) &#123;</span><br><span class="line"></span><br><span class="line">    if (condition) &#123;</span><br><span class="line">        var value = &quot;blue&quot;;</span><br><span class="line"></span><br><span class="line">        // other code</span><br><span class="line"></span><br><span class="line">        return value;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line"></span><br><span class="line">        // value exists here with a value of undefined</span><br><span class="line"></span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // value exists here with a value of undefined</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ å¯¹javscriptä¸ç†Ÿæ‚‰ï¼Œä½ ä¹Ÿè®¸ä¼šé¢„æƒ³valueè¿™ä¸ªå˜é‡åªæœ‰å½“conditionè¢«æ±‚å€¼ä¸ºtrueæ˜¯æ‰è¢«åˆ›å»ºï¼Œä½†æ— è®ºæ±‚conditionå€¼æ˜¯ä»€ä¹ˆå˜é‡valueéƒ½è¢«åˆ›å»ºäº†ï¼Œä¸‹é¢ä»£ç æ˜¯javascriptå¼•æ“æ”¹å˜getValueè¿™ä¸ªå‡½æ•°æˆè¿™ä¸ªæ ·å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function getValue(condition) &#123;</span><br><span class="line"></span><br><span class="line">    var value;</span><br><span class="line"></span><br><span class="line">    if (condition) &#123;</span><br><span class="line">        value = &quot;blue&quot;;</span><br><span class="line"></span><br><span class="line">        // other code</span><br><span class="line"></span><br><span class="line">        return value;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line"></span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>value å˜é‡çš„å£°æ˜è¢«æå‡åˆ°é¡¶éƒ¨ï¼ŒåŒæ—¶å®ƒçš„åˆå§‹åŒ–è¿˜åœ¨åŸæ¥é‚£ä¸ªåœ°æ–¹ã€‚è¿™æ„å‘³ç€valueå˜é‡å¯ä»¥åœ¨elseæ‹¬å·åé¢è®¿é—®åˆ°ï¼Œå¦‚æœä»é‚£å„¿è®¿é—®ï¼Œè¿™ä¸ªå˜é‡å°†åªæ˜¯undefinedï¼Œå› ä¸ºå®ƒè¿˜æ²¡è¢«åˆå§‹åŒ–ã€‚</p>
<h3 id="å—çº§å£°æ˜"><a href="#å—çº§å£°æ˜" class="headerlink" title="å—çº§å£°æ˜"></a>å—çº§å£°æ˜</h3><p>å—çº§å£°æ˜æ„å‘³ç€é‚£äº›å£°æ˜çš„å˜é‡ä¸èƒ½åœ¨ç»™å®šå—çº§ä½œç”¨å¤–è®¿é—®ï¼Œå—çº§ä½œç”¨åŸŸä¹Ÿç§°åšè¯æ³•ä½œç”¨åŸŸè¢«åˆ›å»ºäºï¼š</p>
<ul>
<li>1 å‡½æ•°é‡Œé¢</li>
<li>2 åŒå¤§æ‹¬å·é‡Œé¢ï¼ˆ{}ï¼‰<br>å—çº§ä½œç”¨åŸŸæ˜¯è®¸å¤šåŸºäºcè¯­è¨€çš„å·¥ä½œæ–¹å¼ï¼ŒåŒæ—¶åœ¨ECAMScript 6 ä¸­å¼•å…¥å—çº§å£°æ˜æ„åœ¨å¼•è¿›ç›¸åŒçš„çµæ´»æ€§ï¼ˆå¹¶ç»Ÿä¸€æ€§ï¼‰åˆ°javascriptä¸­</li>
</ul>
<h4 id="Let-å£°æ˜"><a href="#Let-å£°æ˜" class="headerlink" title="Let å£°æ˜"></a>Let å£°æ˜</h4><p>let å£°æ˜è¯­æ³•å’Œvarå£°æ˜è¯­æ³•ä¸€æ ·ï¼Œä½ åŸºæœ¬ä¸Šå¯ä»¥ç”¨letæ›¿æ¢varå£°æ˜å˜é‡ï¼Œä½†æ˜¯leçš„å˜é‡ä½œç”¨åŸŸé™åˆ¶åœ¨å½“å‰ä»£ç å—ï¼ˆè¿™é‡Œæœ‰å°‘é‡ç»†å¾®å·®åˆ«åœ¨åé¢è®¨è®ºï¼‰ã€‚å› ä¸ºletå£°æ˜ä¸ä¼šæå‡åˆ°ä»£ç å—é¡¶éƒ¨ï¼Œä½ ä¹Ÿè®¸æ€»æƒ³å°†letå£°æ˜æ”¾åœ¨ä»£ç å—é¡¶éƒ¨ï¼Œè¿™æ ·åœ¨æ•´ä¸ªä»£ç éƒ½å¯ä»¥è·å–åˆ°ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function getValue(condition) &#123;</span><br><span class="line"></span><br><span class="line">    if (condition) &#123;</span><br><span class="line">        let value = &quot;blue&quot;;</span><br><span class="line"></span><br><span class="line">        // other code</span><br><span class="line"></span><br><span class="line">        return value;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line"></span><br><span class="line">        // value doesn&#x27;t exist here</span><br><span class="line"></span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // value doesn&#x27;t exist here</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€ç‰ˆçš„getValueå‡½æ•°è¡¨ç°çš„æ›´åƒä½ æœŸå¾…ä¸­çš„å…¶ä»–åŸºäºcçš„è¯­è¨€äº†ï¼Œå› ä¸ºå˜é‡valueæ˜¯ç”¨letå£°æ˜å–ä»£äº†varï¼Œè¿™ç§å£°æ˜å¹¶ä¸ä¼šå˜é‡æå‡åˆ°å‡½æ•°å£°æ˜é¡¶éƒ¨ï¼Œå¹¶ä¸”å˜é‡valueåœ¨æ‰§è¡Œå®Œifå—åä¸å†èƒ½è®¿é—®åˆ°ï¼Œä¸€æ—¦ifæ¡ä»¶æ±‚å€¼ä¸ºfalseåvalueå°†æ°¸è¿œä¸ä¼šå£°æ˜æˆ–åˆå§‹åŒ–ã€‚</p>
<h4 id="ç¦æ­¢é‡å£°æ˜"><a href="#ç¦æ­¢é‡å£°æ˜" class="headerlink" title="ç¦æ­¢é‡å£°æ˜"></a>ç¦æ­¢é‡å£°æ˜</h4><p>å¦‚æœä¸€ä¸ªæ ‡è¯†ç¬¦å·²ç»åœ¨ä¸€ä¸ªä½œç”¨åŸŸå®šä¹‰è¿‡ï¼Œç„¶åå†ç”¨letåœ¨è¿™ä¸ªä½œç”¨åŸŸå®šä¹‰è¿™ä¸ªæ ‡è¯†ç¬¦å°†åé€ æˆä¸€ä¸ªé”™è¯¯æŠ›å‡ºï¼Œå¦‚ä¸‹ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var count = 30;</span><br><span class="line"></span><br><span class="line">//Syntax error</span><br><span class="line">let count = 40;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œcountè¢«å£°æ˜äº†ä¸¤æ¬¡ï¼šä¸€æ¬¡ç”¨varå£°æ˜ç„¶åå†ç”¨ä¸€æ¬¡letå£°æ˜ã€‚å› ä¸ºletä¸ä¼šåœ¨ä¸€ä¸ªå·²ç»å£°æ˜è¿‡çš„ä½œç”¨åŸŸé‡å£°æ˜ï¼Œå¦‚æœé‡å£°æ˜å°†æŠ›å‡ºä¸€ä¸ªerrorã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœletå£°æ˜åœ¨ä¸€ä¸ªåŒ…å«ä½œç”¨åŸŸä¸­åˆ›å»ºåŒåçš„å˜é‡æ˜¯ä¸ä¼šæŠ›å‡ºé”™è¯¯çš„ï¼Œå¦‚ä¸‹é¢ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var count = 30;</span><br><span class="line"></span><br><span class="line">// Does not throw an error</span><br><span class="line">if (condition) &#123;</span><br><span class="line"></span><br><span class="line">    let count = 40;</span><br><span class="line"></span><br><span class="line">    // more code</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>letå£°æ˜æ²¡æœ‰æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸æ˜¯å› ä¸ºå®ƒåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å·²ç»å£°æ˜è¿‡çš„å˜é‡countåœ¨ifè¯­å¥é‡Œï¼Œè€Œä¸æ˜¯åœ¨ä¸€ä¸ªç›¸é‚»çš„å—ã€‚åœ¨è¿™ä¸ªifå—é‡Œï¼Œè¿™ä¸ªæ–°çš„å˜é‡é®ç›–äº†è¿™ä¸ªå…¨å±€countï¼Œé˜²æ­¢è·å–åˆ°å…¨å±€countç›´åˆ°æ‰§è¡Œè¿‡è¿™ä¸ªifå—ã€‚</p>
<h4 id="å¸¸é‡å£°æ˜"><a href="#å¸¸é‡å£°æ˜" class="headerlink" title="å¸¸é‡å£°æ˜"></a>å¸¸é‡å£°æ˜</h4><p>åœ¨ECMAScript6ä¸­ä½ ä¹Ÿå¯ä»¥ç”¨constå£°æ˜è¯­æ³•å®šä¹‰å˜é‡ã€‚ç”¨constå£°æ˜çš„å˜é‡è¢«å½“åšå¸¸é‡ï¼Œè¿™æ„å‘³ç€å®ƒä»¬çš„å€¼ä¸€æ—¦ç»™åˆå§‹åŒ–åä¸èƒ½æ”¹å˜ã€‚å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæ¯ä¸ªcountå˜é‡å¿…é¡»åœ¨å£°æ˜çš„åŒæ—¶åˆå§‹åŒ–ï¼Œå¦‚ä¸‹ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Valid constant</span><br><span class="line">const maxItems = 30;</span><br><span class="line"></span><br><span class="line">// Syntax error: missing initialization</span><br><span class="line">const name;</span><br></pre></td></tr></table></figure>
<p>maxItems å˜é‡å·²ç»åˆå§‹åŒ–äº†ï¼Œæ‰€ä»¥contå£°æ˜å°†ä¼šèµ·æ•ˆæ²¡é—®é¢˜ã€‚å¦‚æœè¯•ç€è¿è¡ŒåŒ…å«nameå˜é‡è¿™æ®µä»£ç å°†ä¼šé€ æˆä¸€ä¸ªè¯­æ³•é”™æˆ‘ï¼Œå› ä¸ºnameæ²¡æœ‰åˆå§‹åŒ–ã€‚</p>
<h5 id="constå£°æ˜å’Œletå£°æ˜å¯¹æ¯”"><a href="#constå£°æ˜å’Œletå£°æ˜å¯¹æ¯”" class="headerlink" title="constå£°æ˜å’Œletå£°æ˜å¯¹æ¯”"></a>constå£°æ˜å’Œletå£°æ˜å¯¹æ¯”</h5><p>constå£°æ˜å’Œletå£°æ˜ä¸€æ ·æ˜¯å—çº§å£°æ˜ã€‚è¿™æ„å‘³ç€å¸¸é‡ä¸€æ—¦æ‰§è¡Œå®Œæ‰€åœ¨å—åå°†ä¸å†èƒ½è®¿é—®ï¼Œå¹¶ä¸”å£°æ˜ä¹Ÿä¸ä¼šæå‡ï¼Œå¦‚ä¸‹é¢ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (condition) &#123;</span><br><span class="line">    const maxItems = 5;</span><br><span class="line"></span><br><span class="line">    // more code</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// maxItems isn&#x27;t accessible here</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä»£ç ä¸­ï¼Œå¸¸é‡maxItemså£°æ˜åœ¨ifè¯­å¥é‡Œï¼Œä¸€æ—¦è¿™ä¸ªè¯­å¥æ‰§è¡Œå®Œæˆåï¼ŒmaxItemså°†åœ¨è¿™ä¸ªå—å¤–ä¸å†èƒ½è®¿é—®åˆ°ã€‚  </p>
<p>constä¸letå¦ä¸€ä¸ªç›¸ä¼¼çš„åœ°æ–¹ï¼Œå¦‚æœä¸€ä¸ªæ ‡è¯†ç¬¦åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸä¸­å·²ç»å®šä¹‰è¿‡ç”¨constå†æ¬¡å®šä¹‰å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ç”¨varï¼ˆå…¨å±€æˆ–å‡½æ•°ä½œç”¨åŸŸï¼‰æˆ–è€…letï¼ˆå—çº§ä½œç”¨åŸŸï¼‰ä»€ä¹ˆéƒ½æ²¡å…³ç³»ï¼Œå¦‚ä¸‹ä¾‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var message = &quot;Hello!&quot;;</span><br><span class="line">let age = 25;</span><br><span class="line"></span><br><span class="line">// Each of these would throw an error.</span><br><span class="line">const message = &quot;Goodbye!&quot;;</span><br><span class="line">const age = 30;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸¤ä¸ªconstå£°æ˜å•ç‹¬å£°æ˜éƒ½ä¼šæœ‰æ•ˆï¼Œä½†æ˜¯ä»‹äºå‰é¢çš„varå’Œletå£°æ˜æ²¡æœ‰ä¸€ä¸ªcontså£°æ˜å°†ä¼šæœ‰æ•ˆã€‚<br>letå’Œconstå°½ç®¡è¿™ä¹ˆå¤šç›¸ä¼¼çš„åœ°æ–¹ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸ªå·¨å¤§çš„åŒºåˆ«ç‚¹å€¼å¾—è®°ä½ï¼Œæ— è®ºåœ¨ä¸¥æ ¼æˆ–è€…éä¸¥æ ¼æ¨¡å¼å¦‚æœå°è¯•èµ‹å€¼ä¸€ä¸ªåŸå…ˆå®šä¹‰è¿‡çš„constå˜é‡å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const maxItems = 5;</span><br><span class="line"></span><br><span class="line">maxItems = 6;      // throws error</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„å¸¸é‡å’Œå…¶ä»–è¯­è¨€å¾ˆç›¸ä¼¼çš„æ˜¯è¿™ä¸ªmaxItemså˜é‡å°†ä¸èƒ½é‡æ–°èµ‹å€¼ï¼Œç„¶è€Œä¸åƒå…¶ä»–è¯­è¨€çš„å¸¸é‡ï¼Œå¦‚æœè¿™ä¸ªå¸¸é‡æ˜¯ä¸€ä¸ªå¯¹è±¡å°†æœ‰å¯èƒ½è¢«ä¿®æ”¹ã€‚</p>
<h5 id="ç”¨constå£°æ˜å¯¹è±¡"><a href="#ç”¨constå£°æ˜å¯¹è±¡" class="headerlink" title="ç”¨constå£°æ˜å¯¹è±¡"></a>ç”¨constå£°æ˜å¯¹è±¡</h5><p>ä¸€ä¸ªconstå£°æ˜é˜²æ­¢å…¶ä¿®æ”¹å…¶ç»‘å®šè€Œéå€¼æœ¬èº«ã€‚è¿™æ„å‘³ç€constå£°æ˜ä¸€ä¸ªå¯¹è±¡å°†ä¸ä¼šé˜²æ­¢å…¶ä¿®æ”¹è¿™ä¸ªå˜é‡çš„å€¼ï¼ˆè¯‘è€…æ³¨é‡Šï¼šå±æ€§å€¼ï¼‰ã€‚å¦‚ä¸‹ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const person = &#123;</span><br><span class="line">    name: &quot;Nicholas&quot;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// works</span><br><span class="line">person.name = &quot;Greg&quot;;</span><br><span class="line"></span><br><span class="line">// throws an error</span><br><span class="line">person = &#123;</span><br><span class="line">    name: &quot;Greg&quot;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œï¼Œè¢«ç»‘å®šçš„personä»¥ä¸€ä¸ªå±æ€§å€¼çš„å¯¹è±¡åˆ›å»ºï¼Œå®ƒæ˜¯å¯èƒ½æ”¹å˜person.nameè€Œä¸å¼•èµ·ä¸€ä¸ªé”™è¯¯çš„å› ä¸ºå®ƒæ˜¯æ”¹å˜çš„personåŒ…å«çš„å±æ€§å€¼è€Œå¹¶æ²¡æ”¹å˜personç»‘å®šåˆ°ä¸€ä¸ªå¯¹è±¡æœ¬èº«ã€‚å½“è¿™é‡Œçš„ä»£ç å°è¯•èµ‹å€¼personï¼ˆå› æ­¤å°è¯•æ”¹å˜ç»‘å®šæœ¬èº«ï¼‰å°†ä¼šæœ‰ä¸€ä¸ªé”™è¯¯æŠ›å‡ºï¼Œè¿™ä¸ªåœ¨constä¸­ç»†å¾®çš„å·®åˆ«å®¹æ˜“å¼•èµ·è¯¯è§£ã€‚åªè¦è®°ä½ï¼šconsté˜²æ­¢å…¶æ”¹å˜ç»‘å®šï¼Œè€Œä¸æ˜¯ç»‘å®šçš„å€¼ã€‚</p>
<h4 id="ä¸´æ—¶æ€§æ­»åŒºï¼ˆTDZï¼‰"><a href="#ä¸´æ—¶æ€§æ­»åŒºï¼ˆTDZï¼‰" class="headerlink" title="ä¸´æ—¶æ€§æ­»åŒºï¼ˆTDZï¼‰"></a>ä¸´æ—¶æ€§æ­»åŒºï¼ˆTDZï¼‰</h4><p>ä¸€ä¸ªç”¨letæˆ–è€…constå£°æ˜çš„å˜é‡ä¸èƒ½è¢«è®¿é—®ç›´åˆ°å£°æ˜è¿‡åã€‚å°è¯•ç€è¿™æ ·åšå°†ä¼šå¯¼è‡´ä¸€ä¸ªå¼•ç”¨ç±»å‹é”™è¯¯ï¼ˆreference errorï¼‰,å³ä¾¿ç”¨æ­£å¸¸æƒ…å†µä¸‹å®‰å…¨æ“ä½œç¬¦ typeofã€‚å¦‚ä¸‹ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (condition) &#123;</span><br><span class="line">    console.log(typeof value);  // ReferenceError!</span><br><span class="line">    let value = &quot;blue&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œï¼Œå˜é‡valueç”¨letå®šä¹‰å’Œåˆå§‹åŒ–ï¼Œä½†æ˜¯è¯­å¥å°†æ°¸è¿œä¸ä¼šæ‰§è¡Œå› ä¸ºå‰é¢å¥æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚è¿™ä¸ªå…³äºvalueçš„è¯é¢˜å­˜åœ¨äºjavascriptç¤¾åŒºè¢«ç§°ä½œä¸´æ—¶æ€§æ­»åŒºï¼ˆTDZï¼‰ã€‚TDZåœ¨ECNAScriptæ²¡æœ‰æ˜ç¡®çš„å®šä¹‰ï¼Œä½†æ˜¯TDZè¿™ä¸ªæ¡ç›®å¸¸è¢«ç”¨æ¥å½¢å®¹letæˆ–constå£°æ˜æ—¶ä¸èƒ½åœ¨å…¶å£°æ˜å‰è®¿é—®ã€‚è¿™ä¸ªéƒ¨åˆ†å°†è®²è¿°ä¸€äº›å…³äºTDZå¼•èµ·çš„ç»†å¾®å·®åˆ«ï¼ŒåŒæ—¶è¿™é‡Œçš„ä¾‹å­å…¨éƒ¨ç”¨letï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯è¿™äº›ä¾‹å­åŒæ ·é€‚ç”¨äºconstã€‚  </p>
<p>å½“javascriptå¼•æ“éå†ä¸€ä¸ªå³å°†æ‰§è¡Œçš„ä»£ç å—å¹¶æ‰¾åˆ°ä¸€ä¸ªå˜é‡å£°æ˜æ˜¯ï¼Œå®ƒè¦ä¹ˆæ˜¯varåœ¨å…¨å±€æˆ–è€…å‡½æ•°å†…é€šè¿‡å˜é‡æå‡ï¼ŒæŠ‘æˆ–letæˆ–è€…conståœ¨TDZçš„å£°æ˜ï¼Œä»»ä½•å°è¯•è·å–åœ¨TDZçš„å˜é‡éƒ½å°†åœ¨æ‰§è¡Œæ—¶å¼•èµ·ä¸€ä¸ªé”™è¯¯ã€‚åªæœ‰å°†è¿™ä¸ªå˜é‡ä»TDZç§»é™¤ï¼Œç„¶åä¸€æ—¦æ‰§è¡Œè¿‡è¿™ä¸ªå˜é‡å£°æ˜åæ‰èƒ½å®‰å…¨çš„ä½¿ç”¨ã€‚<br>å¦‚ä¸Šä¾‹æ‰€ç¤ºletæˆ–constå£°æ˜åŒæ ·é€‚ç”¨äºä»»ä½•å°è¯•ä½¿ç”¨ä¸€ä¸ªå˜é‡åœ¨å®ƒå®šä¹‰ä¹‹å‰ï¼Œå°½ç®¡ä½¿ç”¨å®‰å…¨æ“ä½œç¬¦typeofã€‚ç„¶è€Œå½“å˜é‡åœ¨å£°æ˜å—çš„å¤–è¾¹æ˜¯å¯ä»¥ä½¿ç”¨typeofçš„ï¼Œå°½ç®¡å¾—åˆ°çš„ä¸æ˜¯ä½ åé¢èµ‹å€¼çš„ï¼Œçœ‹å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">console.log(typeof value);     // &quot;undefined&quot;</span><br><span class="line"></span><br><span class="line">if (condition) &#123;</span><br><span class="line">    let value = &quot;blue&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºå˜é‡valueæ²¡æœ‰åœ¨TDZæ‰€æœ‰å½“typeofæ“ä½œç¬¦æ‰§è¡Œåœ¨å˜é‡å£°æ˜å—å¤–ï¼Œtypeofä»…ä»…è¿”å›ä¸€ä¸ªâ€undefinedâ€,è¿™æ„å‘³ç€æ²¡æœ‰valueç»‘å®šåˆ°å½“å‰ä½œç”¨åŸŸã€‚<br>TDZåªæ˜¯å—ç»‘å®šï¼ˆblock blindingsï¼‰ä¸€ä¸ªç‰¹åˆ«çš„æ–¹é¢,å¦ä¸€ä¸ªæ–¹é¢ä½“ç°åœ¨ä½¿ç”¨åœ¨å¾ªç¯ä¸Šã€‚</p>
<h4 id="åœ¨å¾ªç¯ä¸­çš„å—ç»‘å®š"><a href="#åœ¨å¾ªç¯ä¸­çš„å—ç»‘å®š" class="headerlink" title="åœ¨å¾ªç¯ä¸­çš„å—ç»‘å®š"></a>åœ¨å¾ªç¯ä¸­çš„å—ç»‘å®š</h4><p>ä¹Ÿè®¸ç¨‹åºå‘˜æœ€å¸Œæœ›çœ‹åˆ°çœ‹åˆ°å—çº§ä½œç”¨åŸŸå‡ºç°åœ¨forå¾ªç¯ä¸­ï¼Œå¾ªç¯è®¡æ•°å˜é‡ä¸€æ¬¡æ€§ä½¿ç”¨è¿™æ„å‘³ç€åªèƒ½åœ¨å¾ªç¯ä¸­ä½¿ç”¨ï¼Œä½†è¿™åœ¨javascriptä¸­å¹¶ä¸å¸¸è§ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for (var i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">    process(items[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// i is still accessible here</span><br><span class="line">console.log(i);    </span><br></pre></td></tr></table></figure>
<p>åœ¨å…¶ä»–è¯­è¨€ä¸­å—çº§ä½œç”¨åŸŸæ˜¯é»˜è®¤çš„ï¼Œåœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­åªç”¨å½“iå˜é‡åªèƒ½åœ¨forå¾ªç¯ä¸­è®¿é—®åˆ°æ—¶æ‰èƒ½åˆ°è¾¾æˆ‘ä»¬é¢„æœŸçš„æ•ˆæœï¼Œç„¶è€Œåœ¨è¿™é‡Œçš„iä»»ç„¶åœ¨forå¾ªç¯åå¯ä»¥è®¿é—®åˆ°ï¼Œè¿™æ˜¯å› ä¸ºvarå£°æ˜è¢«æå‡äº†ï¼Œå¦‚æœç”¨letä»£æ›¿ï¼Œå°†ä¼šè¡¨ç°æˆ‘ä»¬é¢„æœŸçš„æ•ˆæœï¼Œå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for (let i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">    process(items[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// i is not accessible here - throws an error</span><br><span class="line">console.log(i);</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œå˜é‡iåªå­˜åœ¨äºforå¾ªç¯ï¼Œä¸€æ—¦å¾ªç¯ç»“æŸï¼Œå˜é‡iå°±ä¸èƒ½å†å…¶ä»–åœ°æ–¹è®¿é—®åˆ°äº†ã€‚</p>
<h4 id="å¾ªç¯ä¸­çš„å‡½æ•°"><a href="#å¾ªç¯ä¸­çš„å‡½æ•°" class="headerlink" title="å¾ªç¯ä¸­çš„å‡½æ•°"></a>å¾ªç¯ä¸­çš„å‡½æ•°</h4><p>varçš„ç‰¹æ€§ä¸ºå‡½æ•°åœ¨å¾ªç¯ä¸­é•¿æœŸåˆ¶é€ ç€é—®é¢˜ï¼Œå› ä¸ºå¾ªç¯å˜é‡æ˜¯ä»å¤–å±‚å¾ªç¯ä½œç”¨åŸŸä¸­è·å–ï¼Œçœ‹å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var funcs = [];</span><br><span class="line"></span><br><span class="line">for (var i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">    funcs.push(function() &#123; console.log(i); &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">funcs.forEach(function(func) &#123;</span><br><span class="line">    func();     // outputs the number &quot;10&quot; ten times</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ä½ ä¹Ÿè®¸é€šå¸¸æœŸå¾…è¿™ä»½ä»£ç ä¼šæ‰“å°å‡ºæ•°å­—0åˆ°9ï¼Œä½†æ˜¯ç»“æœæ˜¯æ•°å­—10æ‰“å°äº†åéï¼Œé‚£æ˜¯å› ä¸ºåœ¨æ¯æ¬¡å¾ªç¯éå†ä¸­å…±äº«ç›¸åŒçš„iï¼Œä¸€æ—¦å¾ªç¯ç»“æŸiçš„å€¼å°±ä¸º10ï¼Œæ‰€ä»¥å½“console.log(i)è¢«è°ƒç”¨æ—¶ï¼Œiçš„å€¼å°±è¢«æ‰“å°å‡ºæ¥ã€‚<br>ä¸ºäº†ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œå¼€å‘è€…ä½¿ç”¨ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°åœ¨forå¾ªç¯å†…éƒ¨ï¼Œå¼ºè¿«æ¯æ¬¡å¾ªç¯ä¼ é€’ä¸€ä¸ªiçš„å¤åˆ¶å˜é‡ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var funcs = [];</span><br><span class="line"></span><br><span class="line">for (var i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">    funcs.push((function(value) &#123;</span><br><span class="line">        return function() &#123;</span><br><span class="line">            console.log(value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;(i)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">funcs.forEach(function(func) &#123;</span><br><span class="line">    func();     // outputs 0, then 1, then 2, up to 9</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ç‰ˆä»£ç ä¸­ç”¨äº†ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°åœ¨å¾ªç¯çš„å†…éƒ¨ï¼Œå˜é‡iè¢«ä¼ åˆ°ç«‹å³æ‰§è¡Œå‡½æ•°ä¸­ï¼Œè¿™æ„å‘³ç€åˆ›å»ºäº†ä¸€ä»½å¤åˆ¶å¹¶å‚¨å­˜åˆ°valueä¸­ã€‚æ‰€ä»¥æ¯æ¬¡è¿­ä»£å¾ªç¯æ‰èƒ½å‡ºç°é¢„æœŸçš„0åˆ°9ã€‚å¹¸è¿çš„æ˜¯åœ¨EMACSript6ä¸­ä½¿ç”¨å—çº§ç»‘å®šçš„letå’Œconstå¯ä»¥è½»æ¾çš„åšåˆ°ã€‚</p>
<h4 id="å¾ªç¯ä¸­çš„letå£°æ˜"><a href="#å¾ªç¯ä¸­çš„letå£°æ˜" class="headerlink" title="å¾ªç¯ä¸­çš„letå£°æ˜"></a>å¾ªç¯ä¸­çš„letå£°æ˜</h4><p>ä¸€ä¸ªletå£°æ˜å¯ä»¥æœ‰æ•ˆçš„ç®€åŒ–å’Œæ›¿ä»£å…ˆå‰çš„ç«‹å³æ‰§è¡Œå‡½æ•°ï¼ˆIIFEï¼‰ã€‚åœ¨æ¯ä¸ªå¾ªç¯éå†ä¸­ï¼Œå¾ªç¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å˜é‡å¹¶ç”¨å…ˆå‰éå†çš„å˜é‡ååˆå§‹åŒ–å®ƒï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ç”Ÿè·¯æ‰ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œå¹¶å¾—åˆ°ç›¸åŒçš„ç»“æ„ï¼Œæƒ³ä¸‹é¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var funcs = [];</span><br><span class="line"></span><br><span class="line">for (let i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">    funcs.push(function() &#123;</span><br><span class="line">        console.log(i);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">funcs.forEach(function(func) &#123;</span><br><span class="line">    func();     // outputs 0, then 1, then 2, up to 9</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå¾ªç¯å’Œå…ˆå‰çš„ç”¨varå’Œç«‹å³æ‰§è¡Œå‡½æ•°æ•ˆæœä¸€æ ·ï¼Œä½†æ˜¯æ¸…æ™°ï¼Œæ•´æ´ã€‚letå£°æ˜åœ¨æ¯æ¬¡å¾ªç¯æ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„å˜é‡iï¼Œæ‰€ä»¥æ¯ä¸ªå‡½æ•°åœ¨å¾ªç¯å†…éƒ¨å¾—åˆ°å±äºè‡ªå·±çš„iï¼ŒåŒç†for-inå’Œfor-ofå¾ªç¯ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var funcs = [],</span><br><span class="line">    object = &#123;</span><br><span class="line">        a: true,</span><br><span class="line">        b: true,</span><br><span class="line">        c: true</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">for (let key in object) &#123;</span><br><span class="line">    funcs.push(function() &#123;</span><br><span class="line">        console.log(key);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">funcs.forEach(function(func) &#123;</span><br><span class="line">    func();     // outputs &quot;a&quot;, then &quot;b&quot;, then &quot;c&quot;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­for-inå¾ªç¯ä¸forå¾ªç¯å±•ç°äº†åŒæ ·çš„è¡¨ç°è¡Œä¸ºï¼Œæ¯æ¬¡å¾ªç¯éå†ï¼Œä¸€ä¸ªæ–°çš„keyç»‘å®šåˆ›å»ºï¼Œæ‰€ä»¥æ¯ä¸ªå‡½æ•°æ‹¥æœ‰å±äºè‡ªå·±çš„æ‹·è´å˜é‡keyï¼Œç»“æœå°±æ˜¯æ¯ä¸ªå‡½æ•°è¾“å‡ºä¸åŒçš„valueï¼Œå¦‚æœæ˜¯ç”¨varå£°æ˜çš„keyï¼Œå…¨éƒ¨çš„å‡½æ•°å°†è¾“å‡ºâ€câ€ã€‚</p>
<h4 id="åœ¨å¾ªç¯ä¸­çš„å¸¸é‡å£°æ˜"><a href="#åœ¨å¾ªç¯ä¸­çš„å¸¸é‡å£°æ˜" class="headerlink" title="åœ¨å¾ªç¯ä¸­çš„å¸¸é‡å£°æ˜"></a>åœ¨å¾ªç¯ä¸­çš„å¸¸é‡å£°æ˜</h4><p>åœ¨EMASCript6ä¸­æ²¡æœ‰æ˜ç¡®çš„å£°æ˜ä¸å…è®¸contså£°æ˜åœ¨å¾ªç¯ä¸­ä½¿ç”¨ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸åŒçš„è¡¨ç°è¡Œä¸ºåŸºäºä½ é€‰æ‹©çš„forå¾ªç¯ç±»å‹ï¼Œå¯¹äºæ™®é€šforå¾ªç¯ï¼Œä½ å¯ä»¥ç”¨constè¿›è¡Œåˆå§‹åŒ–ï¼Œä½†æ˜¯ä¸€æ—¦ä½ è¯•ç€æ”¹å˜è¿™ä¸ªå€¼å®ƒå°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå¦‚ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var funcs = [];</span><br><span class="line"></span><br><span class="line">// throws an error after one iteration</span><br><span class="line">for (const i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">    funcs.push(function() &#123;</span><br><span class="line">        console.log(i);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢ä»£ç ä¸­ï¼Œiå˜é‡ä»¥å¸¸é‡å£°æ˜ï¼Œç¬¬ä¸€æ¬¡éå†å¾ªç¯ï¼Œå½“iæ˜¯0æ—¶ï¼Œæ‰§è¡ŒæˆåŠŸï¼Œä½†i++æ‰§è¡Œæ—¶å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºå®ƒå°è¯•æ”¹å˜ä¸€ä¸ªå¸¸é‡ï¼Œå¦‚æ­¤ä»¥åï¼Œä½ åªèƒ½ç”¨constå˜é‡è¿›è¡Œå£°æ˜ä½ ä¸ä¼šæ”¹å˜çš„å¾ªç¯ä¸­ã€‚  </p>
<p>å¦ä¸€æ–¹é¢åœ¨for-inæˆ–for-ofä¸­ä½¿ç”¨constå’Œletå£°æ˜å˜é‡å¹¶æ— åŒºåˆ«ï¼Œæ‰€ä»¥ä¸‹é¢ä»£ç å°†ä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var funcs = [],</span><br><span class="line">    object = &#123;</span><br><span class="line">        a: true,</span><br><span class="line">        b: true,</span><br><span class="line">        c: true</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">// doesn&#x27;t cause an error</span><br><span class="line">for (const key in object) &#123;</span><br><span class="line">    funcs.push(function() &#123;</span><br><span class="line">        console.log(key);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">funcs.forEach(function(func) &#123;</span><br><span class="line">    func();     // outputs &quot;a&quot;, then &quot;b&quot;, then &quot;c&quot;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™æ®µä»£ç å‡ ä¹å’Œä¸Šé¢â€å¾ªç¯ä¸­çš„letå£°æ˜â€ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ketyçš„å€¼åœ¨å¾ªç¯ä¸­ä¸èƒ½æ”¹å˜ï¼Œconståœ¨for-ofå’Œfor-inå¾ªç¯èµ·ä½œç”¨æ˜¯å› ä¸ºå¾ªç¯åˆå§‹å™¨åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ç»‘å®šåœ¨æ¯ä¸ªéå†ä¸­è€Œä¸æ˜¯å°è¯•æ”¹å˜å·²ç»å­˜åœ¨çš„ç»‘å®šã€‚</p>
<h4 id="å…¨å±€å—ç»‘å®š"><a href="#å…¨å±€å—ç»‘å®š" class="headerlink" title="å…¨å±€å—ç»‘å®š"></a>å…¨å±€å—ç»‘å®š</h4><p>letå’Œconstå¦ä¸€ä¸ªä¸åŒäºvaræ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸçš„è¡Œä¸ºï¼Œå½“varåœ¨å…¨å±€ä½œç”¨åŸŸä½¿ç”¨æ—¶ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å…¨å±€å˜é‡ï¼Œè¿™æ„å‘³ç€ä¸€ä¸ªå…¨å±€å˜é‡å±æ€§ï¼ˆåœ¨æµè§ˆå™¨ä¸­æ˜¯windowï¼‰ã€‚åŒæ—¶ä¹Ÿæ„å‘³ç€ä½ ä¹Ÿè®¸æ„å¤–çš„é‡å†™äº†ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å…¨å±€å˜é‡ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// in a browser</span><br><span class="line">var RegExp = &quot;Hello!&quot;;</span><br><span class="line">console.log(window.RegExp);     // &quot;Hello!&quot;</span><br><span class="line"></span><br><span class="line">var ncz = &quot;Hi!&quot;;</span><br><span class="line">console.log(window.ncz);        // &quot;Hi!&quot;</span><br></pre></td></tr></table></figure>
<p>å°½ç®¡RegExpå·²ç»åœ¨å…¨å±€å¯¹è±¡windowä¸Šå®šä¹‰è¿‡äº†ï¼Œä½†æ˜¯è¢«varå£°æ˜é‡å†™äº†è¿™æ˜¯ä¸å®‰å…¨çš„ã€‚ç¤ºä¾‹ä»£ç ç¤ºèŒƒäº†ä¸€ä¸ªæ–°çš„å…¨å±€å˜é‡RegExpé‡å†™åŸæœ‰å˜é‡ã€‚åŒæ ·ç›¸ä¼¼çš„nczè¢«å®šä¹‰æˆä¸€ä¸ªå…¨å±€å˜é‡å¹¶ä¸”ç«‹å³è¢«å®šä¹‰æˆwindowä¸Šçš„ä¸€ä¸ªå±æ€§ï¼Œè¿™æ˜¯javascriptçš„å·¥ä½œæ–¹å¼ã€‚  </p>
<p>å¦‚æœä½ æ¢letæˆ–conståœ¨å…¨å±€å£°æ˜ï¼Œåœ¨å…¨å±€ä½œç”¨åŸŸäº§ç”Ÿä¸€ä¸ªæ–°çš„ç»‘å®šä½†æ˜¯ä¸ä¼šæ·»åŠ å±æ€§åˆ°å…¨å±€å¯¹è±¡ä¸Šï¼Œè¿™ä¹Ÿæ„å‘³ç€ä½ ä¸èƒ½é€šè¿‡letæˆ–è€…consté‡æ–°å…¨å±€å˜é‡ï¼Œä½ åªèƒ½å±è”½å®ƒï¼Œè¿™é‡Œæ˜¯å®ä¾‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// in a browser</span><br><span class="line">let RegExp = &quot;Hello!&quot;;</span><br><span class="line">console.log(RegExp);                    // &quot;Hello!&quot;</span><br><span class="line">console.log(window.RegExp === RegExp);  // false</span><br><span class="line"></span><br><span class="line">const ncz = &quot;Hi!&quot;;</span><br><span class="line">console.log(ncz);                       // &quot;Hi!&quot;</span><br><span class="line">console.log(&quot;ncz&quot; in window);           // false</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™æ®µå®ä¾‹ä»£ç ä¸­ä¸€ä¸ªä½¿ç”¨letå£°æ˜çš„RegExpåˆ›å»ºç»‘å®šå¹¶å±è”½å…¨å±€RegExoã€‚è¿™æ„å‘³ç€window.RegExpå’ŒRegExpå¹¶ä¸å…¨ç­‰ï¼Œæ‰€ä»¥åœ¨å…¨å±€ä½œç”¨åŸŸä¸­å¹¶ä¸å­˜åœ¨ç ´åï¼ŒåŒæ ·ï¼Œcontså£°æ˜ä¸ºnczåˆ›å»ºçš„ç»‘å®šä¹Ÿä¸ä¼šåœ¨å…¨å±€å¯¹è±¡ä¸Šåˆ›å»ºä¸€ä¸ªå±æ€§ã€‚è¿™ç§èƒ½åŠ›è®©letå’Œconståœ¨å…¨å±€ä½œç”¨åŸŸä¸Šç”³æ˜æ›´åŠ å®‰å…¨ã€‚</p>
<h4 id="å—çº§ç»‘å®šæœ€ä½³å®è·µè¿›åŒ–è¿‡ç¨‹"><a href="#å—çº§ç»‘å®šæœ€ä½³å®è·µè¿›åŒ–è¿‡ç¨‹" class="headerlink" title="å—çº§ç»‘å®šæœ€ä½³å®è·µè¿›åŒ–è¿‡ç¨‹"></a>å—çº§ç»‘å®šæœ€ä½³å®è·µè¿›åŒ–è¿‡ç¨‹</h4><p>å½“ä½¿ç”¨ä½¿ç”¨ECMAScript6å¼€å‘æ—¶ï¼Œè¿™é‡Œæµä¼ ç€ä¸€ä¸ªä¿¡ä»»ï¼Œä½ åº”è¯¥é»˜è®¤ä½¿ç”¨letè€Œä¸æ˜¯varå£°æ˜å˜é‡ï¼Œå¯¹äºå¾ˆå¤šjavascriptå¼€å‘è€…æ¥è¯´ï¼Œletçš„ç‰¹æ€§åˆšå¥½æ˜¯æˆ‘ä»¬æœŸå¾…ä¸­çš„varã€‚æ‰€ä»¥ç›´æ¥æ›¿æ¢æ˜¾å¾—å¾ˆæœ‰é“ç†ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“ä½ éœ€è¦ä¿®æ”¹ä¿æŠ¤æ˜¯ä½ åº”è¯¥ä½¿ç”¨constå£°æ˜å˜é‡ã€‚<br>ç„¶è€Œå½“æ›´å¤šçš„å¼€å‘è€…èµšåˆ°ä½¿ç”¨ECMAScript6å¼€å‘æ—¶ï¼Œä¸€ä¸ªæ–°çš„ç†å¿µæ›´åŠ æµè¡Œèµ·æ¥ï¼šé»˜è®¤ä½¿ç”¨constå£°æ˜å˜é‡ï¼Œåªæœ‰å½“ä½ çŸ¥é“å˜é‡å°†ä¼šæ”¹å˜æ—¶ä½¿ç”¨letå£°æ˜ã€‚è¿™å…¶ä¸­çš„åŸå› æ˜¯å¤§å¤šæ•°å˜é‡åœ¨å…¶åˆå§‹åŒ–åä¸è¦æ”¹å˜å…¶å€¼ï¼Œå› ä¸ºé¢„æƒ³ä¸åˆ°çš„å€¼æ”¹å˜é€šå¸¸æ˜¯bugsçš„æºå¤´ã€‚è¿™ä¸ªæƒ³æ³•å…·æœ‰å·¨å¤§çš„å¸å¼•åŠ›å¹¶ä¸”å€¼å¾—ä½ åœ¨æœªæ¥ä½¿ç”¨ECMAScript6ä¸­ä½¿ç”¨ã€‚</p>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>letå’Œconstçš„å—çº§ç»‘å®šå°†è¯æ³•ä½œç”¨åŸŸå¼•å…¥äº†javscriptã€‚è¿™äº›å£°æ˜å°†ä¸ä¼šæå‡åªä¼šå­˜åœ¨äºå£°æ˜çš„å—ä¸­ã€‚å®ƒä»¬æä¾›çš„è¡¨ç°è¡Œä¸ºå°†æ›´åŠ åƒå…¶ä»–è¯­è¨€å¹¶ä¸”æ›´å°‘çš„é€ æˆæ„æƒ³ä¸åˆ°çš„é”™è¯¯ï¼Œå‰¯ä½œç”¨æ˜¯ä½ å°†ä¸èƒ½åƒä»¥å‰å£°æ˜ä¸€æ ·è®¿é—®å®ƒä»¬ï¼Œç”šè‡³ä¸èƒ½ç”¨ä»¥å‰çš„å®‰å…¨æ“ä½œç¬¦typeofã€‚å½“ä½ åœ¨å—çº§ç»‘å®šä¹‹å‰è¯•å›¾è·å–ä¸€ä¸ªå˜é‡æ—¶å°†ä¼šå¼•èµ·ä¸€ä¸ªå› ä¸ºTDZé€ æˆçš„é”™è¯¯ã€‚<br>åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œletå’Œconstä¸varçš„è¡¨ç°éƒ½å¾ˆç›¸ä¼¼ï¼Œç„¶è€Œè¿™å¹¶ä¸é€‚ç”¨äºå¾ªç¯ï¼Œå¯¹äºfor-inå’Œfor-ofå¾ªç¯letå’Œconstéƒ½åœ¨æ¯æ¬¡å¾ªç¯åˆ›å»ºä¸€ä¸ªæ–°çš„ç»‘å®šï¼Œè€Œä¸æ˜¯å¾ªç¯åçš„æœ€åä¸€é¡¹ï¼ˆåƒvarä¸€æ ·ï¼‰ã€‚åŒæ ·çš„letå£°æ˜ä¹Ÿé€‚ç”¨äºforï¼Œå½“å°è¯•å§constç”¨åœ¨forå¾ªç¯å¹¶ä¸”æ”¹å˜constå˜é‡æ—¶å°†é€ æˆä¸€ä¸ªé”™è¯¯ã€‚<br>å½“å‰çš„æœ€ä½³å®è·µæ˜¯é»˜è®¤ä½¿ç”¨conståªå½“ä½ çŸ¥é“å˜é‡å°†ä¼šæ”¹å˜æ—¶ä½¿ç”¨letï¼Œè¿™æ ·åšä¼šä¿è¯ä½ ä»£ç ä¸€å®šç¨‹åº¦çš„ä¸å¯å˜å½¢ï¼Œä»è€Œè¾¾åˆ°é˜²æ²»ä¸€å®šç±»å‹çš„é”™è¯¯ã€‚</p>
]]></content>
      <categories>
        <category>javscript</category>
      </categories>
  </entry>
  <entry>
    <title>ç¬¬äºŒç«  å­—ç¬¦ä¸²ä¸æ­£åˆ™è¡¨è¾¾å¼</title>
    <url>/2017/06/24/%E7%AC%AC2%E7%AB%A0%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8E%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    <content><![CDATA[<h2 id="å­—ç¬¦ä¸²ä¸æ­£åˆ™è¡¨è¾¾å¼"><a href="#å­—ç¬¦ä¸²ä¸æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="å­—ç¬¦ä¸²ä¸æ­£åˆ™è¡¨è¾¾å¼"></a>å­—ç¬¦ä¸²ä¸æ­£åˆ™è¡¨è¾¾å¼</h2><p>å­—ç¬¦ä¸²æ— ç–‘åœ¨ç¼–ç¨‹ä¸­æœ€é‡è¦çš„ç±»å‹ä¹‹ä¸€ï¼Œå®ƒä»¬å‡ ä¹å‡ºç°åœ¨æ¯ä¸ªé«˜çº§ç¨‹åºè¯­è¨€ä¸­ï¼Œå¹¶ä¸”èƒ½é«˜æ•ˆçš„è¿ç”¨å®ƒä»¬æ˜¯å¼€å‘è€…åˆ›é€ æœ‰ç”¨ç¨‹åºçš„åŸºç¡€ï¼Œç”šè‡³äºæ­£åˆ™è¡¨è¾¾èƒ½ç»™å¼€å‘è€…é¢å¤–çš„èƒ½åŠ›ä½¿ç”¨å­—ç¬¦ä¸²ä¹Ÿå˜å¾—éå¸¸é‡è¦ã€‚è®°ä½è¿™äº›äº‹å®ä»¥åï¼ŒECMAScript6çš„åˆ›å»ºè€…é€šè¿‡å¯¹å­—ç¬¦ä¸²å’Œæ­£åˆ™å¢åŠ æ–°å±æ€§å’Œé•¿ä¹…ä»¥æ¥ç¼ºå¤±çš„æ–¹æ³•æ¥è¾¾åˆ°æå‡ã€‚è¿™ç« ä¸­æˆ‘ä»¬å°†ä¸€ä¸€æµè§ˆè¿™ä¸¤ç§æ”¹å˜ã€‚</p>
<span id="more"></span>

<h3 id="æ›´å¥½çš„Unicodeæ”¯æŒ"><a href="#æ›´å¥½çš„Unicodeæ”¯æŒ" class="headerlink" title="æ›´å¥½çš„Unicodeæ”¯æŒ"></a>æ›´å¥½çš„Unicodeæ”¯æŒ</h3><p>åœ¨ECMAScript6ä¹‹å‰ï¼Œjavscriptå­—ç¬¦ä¸²ä»¥16ä½å­—ç¬¦ç¼–ç ï¼ˆUTF-16ï¼‰ã€‚æ¯è¿ç»­çš„16ä½æ˜¯ä¸€ä¸ªç¼–ç å•ä½ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ã€‚æ‰€æœ‰çš„å­—ç¬¦ä¸²å±æ€§å’Œæ–¹æ³•å¦‚lengthå±æ€§ï¼ŒcharAt()æ–¹æ³•éƒ½æ˜¯åŸºäº16ä½ç¼–ç å•ä½ï¼Œ16ä½é€šå¸¸æ˜¯æ»¡è¶³åŒ…å«çš„ä»»ä½•å­—ç¬¦ï¼Œä½†æ˜¯å¤šäºå­—ç¬¦æ‰©å±•åˆ°Unicodeä»¥åå°±ä¸å†æ»¡è¶³äº†ã€‚</p>
<h3 id="UTF-16ç¼–ç å­—"><a href="#UTF-16ç¼–ç å­—" class="headerlink" title="UTF-16ç¼–ç å­—"></a>UTF-16ç¼–ç å­—</h3><p>é™åˆ¶ç€å­—ç¬¦é•¿åº¦åˆ°16ä½æ˜¯ä¸å¯èƒ½æ»¡è¶³Uncodeå£°æ˜æä¾›ä¸€ä¸ªä¸ºå…¨çƒæ¯ä¸ªå­—ç¬¦æä¾›ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ ‡è¯†ç¬¦çš„ç›®çš„ã€‚é‚£äº›å…¨å±€ç‹¬ä¸€æ— äºŒçš„æ ‡è¯†ç¬¦è¢«ç§°ä½œç å­—ï¼Œä»ç®€å•çš„æ•°å­—0å¼€å§‹ï¼Œç å­—æ­£æ˜¯ä½ ä¹Ÿè®¸ä¼šæƒ³çš„å­—ç¬¦ç¼–ç ï¼Œä¸€ä¸ªæ•°å­—ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼Œä¸€ä¸ªå­—ç¬¦ç¼–ç å¿…é¡»è®©ç å­—ç¼–è¯‘æˆå†…éƒ¨å¯¹åº”å…³ç³»ï¼ˆå¦‚UTF-16ï¼‰çš„ä»£ç å•å…ƒï¼Œä¸€ä¸ªç å­—å¯ä»¥ç”±å¤šä¸ªä»£ç å•å…ƒç»„æˆã€‚ </p>
<p>åœ¨UTF-16ä¸­ç¬¬ä¸€ä¸ª2^16^çš„ç å­—ä»£è¡¨ä¸€ä¸ªå•ç‹¬16ä½ä»£ç å•å…ƒï¼Œè¿™ä¸ªåŒºåŸŸçš„è¢«ç§°ä½œBMPï¼Œä»»ä½•ä¸åœ¨è¿™ä¸ªèŒƒå›´å†…çš„ç å­—è¢«å½“åšåœ¨å…¶ä¸­ä¸€ä¸ªè¡¥å……å¹³é¢ä¸­ï¼Œåœ¨è¡¥å……å¹³é¢ä¸­çš„ç å­—ä¸å†èƒ½å•ç‹¬ç”¨16å­—èŠ‚è¡¨ç¤ºã€‚åœ¨UTF-16é€šè¿‡å¼•è¿›ä»£ç†ç¼–ç å¯¹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä»£ç†ç¼–ç å¯¹è¡¨ç¤ºä¸€ä¸ªç å­ç”¨ä¸¤ä¸ª16å­—èŠ‚ç¼–ç å•å…ƒè¡¨ç¤ºï¼Œè¿™å°±æ„å‘³ç€ä»»ä½•ä¸€ä¸ªå•ç‹¬å­—ç¬¦åœ¨å­—ç¬¦ä¸²ä¸­è¦ä¹ˆç”¨ä¸€ä¸ªï¼ˆ16å­—èŠ‚BMPï¼‰æˆ–è€…ä¸¤ä¸ªï¼ˆ32å­—èŠ‚ï¼‰ç¼–ç å•å…ƒè¡¨ç¤ºã€‚  </p>
<p>åœ¨ECAMScript5ä¸­ï¼Œæ‰€æœ‰çš„å­—ç¬¦ä¸²æ“ä½œéƒ½æ˜¯åŸºäºä¸€ä¸ª16ä½ç¼–ç å•å…ƒçš„ï¼Œè¿™æ„å‘³ç€ä½ ä¼šåœ¨UTF-16ä¸­åŒ…å«ä»£ç†ç¼–ç å¯¹ä¸­å¾—åˆ°æ„æƒ³ä¸åˆ°çš„ç»“æœï¼Œå¦‚ä¸‹ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var text = &quot;ğ ®·&quot;;</span><br><span class="line"></span><br><span class="line">console.log(text.length);           // 2</span><br><span class="line">console.log(/^.$/.test(text));      // false</span><br><span class="line">console.log(text.charAt(0));        // &quot;&quot;</span><br><span class="line">console.log(text.charAt(1));        // &quot;&quot;</span><br><span class="line">console.log(text.charCodeAt(0));    // 55362</span><br><span class="line">console.log(text.charCodeAt(1));    // 57271</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå•ç‹¬çš„Unicodeå­—ç¬¦â€ğ ®·â€ä½¿ç”¨ä»£ç†ç¼–ç å¯¹è¡¨ç¤ºçš„ï¼Œå¹¶ä¸”åœ¨javascriptä¸­å­—ç¬¦ä¸²æ“ä½œéƒ½æ˜¯æŠŠè¿™ä¸ªå­—ç¬¦å½“åšä¸¤ä¸ª16ä½å­—ç¬¦ã€‚è¿™æ„å‘³ç€ï¼š</p>
<ul>
<li>å½“textçš„é•¿åº¦åº”è¯¥ä¸º1æ—¶ç»“æœä¸º2</li>
<li>ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åœ¨åŒ¹é…å•ä¸ªå­—ç¬¦ä¸²çš„æ—¶å€™å¤±è´¥ï¼Œè¿™æ˜¯å› ä¸ºjsæŠŠå®ƒå½“åšä¸¤ä¸ªå­—ç¬¦</li>
<li>å­—ç¬¦ä¸²æ–¹æ³•chartAt()ä¸èƒ½è¿”å›ä¸€ä¸ªæ­£ç¡®å­—ç¬¦ä¸²ï¼Œå› ä¸ºæ²¡æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„å¯æ‰“å°16ä½ç¼–ç ã€‚</li>
</ul>
<p>chatCodeAt()æ–¹æ³•ä¹Ÿä¸èƒ½è¯†åˆ«å¯¹åº”å­—ç¬¦å±æ€§ã€‚å®ƒåªè¿”å›ä¸ç¼–ç å•å…ƒå¯¹åº”çš„16ä½æ•°å­—ï¼Œä½†è¿™å°±æ˜¯ä½ èƒ½åœ¨ECMAScript5ä¸­å¾—åˆ°æœ€ä¸ºæ¥è¿‘textçœŸå®å€¼çš„æ–¹æ³•ã€‚  </p>
<p>åœ¨å¦ä¸€æ–¹é¢ECMAScript6ï¼Œå¼ºåˆ¶æ€§UTF-16å­—ç¬¦ä¸²ç¼–ç æ¥è§£å†³åƒä¸Šé¢çš„å¼ºè°ƒçš„é—®é¢˜ï¼Œä¸€ç³»åˆ—çš„åŸºäºä»£ç†ç¼–ç å¯¹æ ‡å‡†ç¼–ç ï¼Œå…¶ä½™çš„è¿™ä¸ªç« èŠ‚å°†ç¤ºä¾‹è¿™äº›æ ‡å‡†ã€‚</p>
<h4 id="codePointAt-æ–¹æ³•"><a href="#codePointAt-æ–¹æ³•" class="headerlink" title="codePointAt()æ–¹æ³•"></a>codePointAt()æ–¹æ³•</h4><p>åœ¨ECMAScript6ä¸­æ·»åŠ äº†ä¸€ä¸ªå®Œå…¨æ”¯æŒUTF-16çš„æ–¹æ³•codePointAt(),è¿™ä¸ªæ–¹æ³•å°†æ ¹æ®ç»™å®šçš„å­—ç¬¦ä¸²ä½ç½®æ£€ç´¢å¯¹åº”Unicodeç¼–ç ï¼Œè¿™ä¸ªæ–¹æ³•æ¥å—çš„æ˜¯ç¼–ç å•å…ƒä½ç½®è€Œä¸æ˜¯å­—ç¬¦ä½ç½®å¹¶ä¸”è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œå¦‚ä¸‹ä¾‹ä»£ç æ‰€ç¤ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var text = &quot;ğ ®·a&quot;;</span><br><span class="line"></span><br><span class="line">console.log(text.charCodeAt(0));    // 55362</span><br><span class="line">console.log(text.charCodeAt(1));    // 57271</span><br><span class="line">console.log(text.charCodeAt(2));    // 97</span><br><span class="line"></span><br><span class="line">console.log(text.codePointAt(0));   // 134071</span><br><span class="line">console.log(text.codePointAt(1));   // 57271</span><br><span class="line">console.log(text.codePointAt(2));   // 97</span><br></pre></td></tr></table></figure>
<p>å½“ä¸ºBMPå­—ç¬¦æ—¶codePointAt()æ–¹æ³•å’ŒcharCodeAt()è¿”å›æ˜¯ç›¸åŒçš„ï¼Œä¸Šä¾‹ä¸­ç¬¬ä¸€ä¸ªåœ¨textä¸­å­—ç¬¦æ˜¯éBMPå­—ç¬¦è¿™æ„å‘³ç€è¿™ä¸ªå­—ç¬¦ç”±ä¸¤ä¸ªç¼–ç å•å…ƒç»„æˆï¼ŒåŒæ—¶é•¿åº¦å±æ€§ä¸º3è€Œä¸æ˜¯2ã€‚å½“å‚æ•°ä¸º0æ—¶æ–¹æ³•charCodeAt()åªè¿”å›ç¬¬ä¸€ä¸ªç¼–ç å•å…ƒï¼Œä½†æ˜¯codePointAt()ä¸ç®¡å­—ç åŒ…å«æ˜¯ä¸æ˜¯å¤šä¸ªç¼–ç å•å…ƒéƒ½å°†è¿”å›ä¸€ä¸ªå®Œæ•´çš„å­—ç ã€‚ä¸¤ä¸ªæ–¹æ³•åœ¨å‚æ•°ä¸º1ï¼ˆç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç¬¬äºŒä¸ªç¼–ç å•å…ƒï¼‰å’Œ2ï¼ˆâ€™aâ€™å­—ç¬¦ï¼‰æ—¶è¿”å›çš„éƒ½ä¸€è‡´ã€‚  </p>
<p>åœ¨å­—ç¬¦ä¸Šè°ƒç”¨codePointAt()æ–¹æ³•æ˜¯æœ€ç®€å•åˆ¤å®šå­—ç¬¦æ˜¯å¦ç”¨ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªç¼–ç å•å…ƒï¼ˆæ³¨ï¼šè¿™é‡ŒåŸä½œè€…å†™çš„æ˜¯code points ä½†æ˜¯åº”è¯¥æ˜¯code units ç¼–ç å•å…ƒï¼‰,å¦‚ä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function is32Bit(c) &#123;</span><br><span class="line">    return c.codePointAt(0) &gt; 0xFFFF;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(is32Bit(&quot;ğ ®·&quot;));         // true</span><br><span class="line">console.log(is32Bit(&quot;a&quot;));   </span><br></pre></td></tr></table></figure>
<p>ä¸Šä¾‹ä¸­ç”¨åå…­è¿›åˆ¶çš„FFFFè¡¨ç¤º16å­—èŠ‚ï¼Œæ‰€ä»¥ä»»ä½•è¶…è¿‡è¿™ä¸ªæ•°å­—çš„ç å­—ä¸€å®šæœ‰ä¸¤ä¸ªç¼–ç å•å…ƒæ„æˆçš„ï¼ˆæ€»å…±32å­—èŠ‚ï¼‰</p>
<h4 id="æ–¹æ³•String-fromCodePoint"><a href="#æ–¹æ³•String-fromCodePoint" class="headerlink" title="æ–¹æ³•String.fromCodePoint()"></a>æ–¹æ³•String.fromCodePoint()</h4><p>å½“ECMAScript æä¾›ä¸€ä¸ªæ–¹æ³•å°†å­—ç¬¦è½¬æ¢ä¸ºæ•°å­—ï¼ŒåŒæ ·ä¹Ÿä¼šæä¾›ä¸€ä¸ªå°†æ•°å­—è½¬æ¢åˆ°å­—ç¬¦çš„ã€‚å¦‚ä¸‹ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">console.log(String.fromCodePoint(134071));  // &quot;ğ ®·&quot;</span><br></pre></td></tr></table></figure>
<p>ä½ æŠŠString.fromCodePoint()å½“åšString.fromCharCode()å‡çº§ç‰ˆå°±å¯ä»¥äº†ã€‚å½“å­—ç¬¦åœ¨BMPèŒƒå›´å†…æ—¶ä¸¤è€…éƒ½è¿”å›ç›¸åŒçš„ç»“æ„ã€‚åªæœ‰å½“å­—ç¬¦èŒƒå›´è¶…å‡ºäº†BMPæ—¶æ‰ä¼šæœ‰åŒºåˆ«ã€‚</p>
<h4 id="æ–¹æ³•normalize"><a href="#æ–¹æ³•normalize" class="headerlink" title="æ–¹æ³•normalize()"></a>æ–¹æ³•normalize()</h4><p>Unicodeå¦ä¸€ä¸ªæœ‰è¶£çš„åœ°æ–¹æ˜¯ï¼Œä¸åŒçš„å­—ç¬¦åœ¨æ’åºæˆ–è€…æ¯”è¾ƒçš„æ—¶å€™è¢«è®¤ä¸ºç›¸ç­‰ã€‚è¿™é‡Œæœ‰ä¸¤ç§ä¸åŒçš„æ–¹å¼å®šä¹‰è¿™äº›å…³ç³»ï¼Œé¦–å…ˆè§„èŒƒæ€§çš„ç›¸ç­‰æŒ‡çš„æ˜¯ä¸¤ä¸ªåºåˆ—ç ç‚¹åœ¨å„ä¸ªæ–¹é¢éƒ½çœ‹èµ·æ¥éƒ½å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚å¦‚ä¸€ä¸ªç”±ä¸¤ä¸ªå­—ç¬¦æ‹¼æ¥èµ·æ¥çš„çš„å­—ç¬¦å¯ä»¥è§„èŒƒæ€§çš„ç›¸ç­‰ä¸å¦ä¸€ä¸ªå­—ç¬¦ã€‚ç¬¬äºŒç§å…³ç³»ä¸ºå…¼å®¹æ€§çš„ç›¸ç­‰ï¼Œä¸¤ä¸ªå…¼å®¹æ€§ç›¸ç­‰çš„åºåˆ—ç ç‚¹çœ‹èµ·æ¥ä¸åŒä½†æ˜¯å¯ä»¥åœ¨æŸäº›æƒ…å†µä¸‹äº’æ¢ã€‚<br>å› ä¸ºè¿™äº›å…³ç³»æŸäº›æœ¬è´¨ä¸Šç›¸åŒçš„æ–‡æœ¬å¯èƒ½åŒ…å«ä¸åŒçš„ç ç‚¹åºåˆ—ï¼Œå¦‚å­—ç¬¦â€Ã¦â€å’ŒåŒ…å«ä¸¤ä¸ªå­—ç¬¦â€aeâ€ä¹Ÿè®¸å¯ä»¥äº’æ¢ä½†æ˜¯ä¸¥æ ¼ä¸Šå¹¶ä¸ç›¸ç­‰è§¦å‘ç”¨æŸç§æ–¹å¼æ ‡å‡†åŒ–ã€‚  </p>
<p> ECMAScript6 ä¸ºUnicodeæ ‡å‡†åŒ–æä¾›äº†normalize()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥æ¥å—ä»¥ä¸‹å­—ç¬¦ä¸²å‚æ•°è¿›è¡ŒUnicodeæ ‡å‡†åŒ–ã€‚</p>
<ul>
<li>â€œNFCâ€ é»˜è®¤</li>
<li>â€œNFDâ€</li>
<li>â€œNFKCâ€</li>
<li>â€œNFKDâ€<br> è§£é‡Šè¿™å››ç§æ–¹å¼çš„å·®åˆ«è¶…å‡ºäº†æœ¬ä¹¦çš„èŒƒå›´äº†ï¼Œåªè¦è®°ä½å½“æ¯”è¾ƒå­—ç¬¦ä¸²æ—¶ï¼Œä¸¤ä¸ªå­—ç¬¦ä¸²å¿…é¡»æ ‡å‡†åŒ–ä¸ºåŒä¸€ç§æ ¼å¼åå†æ¯”è¾ƒï¼Œå¦‚ä¸‹ä¾‹ï¼š <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> var normalized = values.map(function(text) &#123;</span><br><span class="line">    return text.normalize();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">normalized.sort(function(first, second) &#123;</span><br><span class="line">    if (first &lt; second) &#123;</span><br><span class="line">        return -1;</span><br><span class="line">    &#125; else if (first === second) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return 1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<p> ä¸Šé¢çš„ä»£ç å°†åœ¨valueæ•°ç»„ä¸­çš„å­—ç¬¦ä¸²åŒä¸€æ ‡å‡†åŒ–åæ‰èƒ½è¿›è¡Œå‡†ç¡®çš„æ’åºï¼Œä½ ä¹Ÿå¯ä»¥åœ¨åŸå§‹æ•°ç»„ä¸Šè°ƒç”¨normalize(),å¦‚ä¸‹ï¼š<br> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> values.sort(function(first, second) &#123;</span><br><span class="line">    var firstNormalized = first.normalize(),</span><br><span class="line">        secondNormalized = second.normalize();</span><br><span class="line"></span><br><span class="line">    if (firstNormalized &lt; secondNormalized) &#123;</span><br><span class="line">        return -1;</span><br><span class="line">    &#125; else if (firstNormalized === secondNormalized) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return 1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p> å†æ¬¡è¯´æ˜ï¼Œç”¨ç›¸åŒçš„æ–¹å¼åºåˆ—å·æ˜¯ç›¸å½“é‡è¦çš„ï¼Œä¸Šé¢çš„ä¾‹å­ç”¨çš„æ˜¯é»˜è®¤çš„NFCï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥è½»æ¾æŒ‡å®šå…¶ä¸­ä¸€ç§ï¼Œå¦‚ä¸‹ï¼š<br> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">values.sort(function(first, second) &#123;</span><br><span class="line">    var firstNormalized = first.normalize(&quot;NFD&quot;),</span><br><span class="line">        secondNormalized = second.normalize(&quot;NFD&quot;);</span><br><span class="line"></span><br><span class="line">    if (firstNormalized &lt; secondNormalized) &#123;</span><br><span class="line">        return -1;</span><br><span class="line">    &#125; else if (firstNormalized === secondNormalized) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return 1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br> ä½ ä¹‹å‰ä¹Ÿè®¸ä»æ¥æ²¡æœ‰æ‹…å¿ƒè¿‡Unicodeæ ‡å‡†åŒ–ï¼Œé‚£ä¹ˆä½ ä¹Ÿè®¸ç°åœ¨ä¸ä¼šè¿‡å¤šä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœä½ æ›¾ç»å¼€å‘è¿‡å›½é™…åŒ–åº”ç”¨ï¼Œä½ ç»å¯¹å‘ç°normalize()ç›¸å½“æœ‰ç”¨ã€‚</p>
<p> åœ¨ECMAScriptä¸­ä¸æ­¢è¿™äº›æ–¹æ³•å¯¹Unicodeå­—ç¬¦ä¸²è¿›è¡Œäº†æ”¹è¿›ï¼Œes6è¿˜å¢åŠ äº†ä¸¤ä¸ªæœ‰ç”¨çš„è¯­æ³•ã€‚</p>
<h3 id="æ­£åˆ™è¡¨è¾¾å¼ä¸­uä¿®é¥°ç¬¦"><a href="#æ­£åˆ™è¡¨è¾¾å¼ä¸­uä¿®é¥°ç¬¦" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼ä¸­uä¿®é¥°ç¬¦"></a>æ­£åˆ™è¡¨è¾¾å¼ä¸­uä¿®é¥°ç¬¦</h3><p> é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ä½ å¯ä»¥å¯¹å­—ç¬¦ä¸²å®Œæˆè®¸å¤šæ™®é€šçš„æ“ä½œï¼Œä½†æ˜¯è®°ä½ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ˜¯ä»¥16ä½å­—èŠ‚çš„ç¼–ç å•å…ƒä»£è¡¨ä¸€ä¸ªå­—ç¬¦ä½œä¸ºå‰æçš„ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ECMAScript6å®šä¹‰äº†è¡¨ç¤ºUnicodeæ ‡å‡†çš„uä¿®é¥°ç¬¦ã€‚</p>
<h4 id="å®æˆ˜ä¿®é¥°ç¬¦u"><a href="#å®æˆ˜ä¿®é¥°ç¬¦u" class="headerlink" title="å®æˆ˜ä¿®é¥°ç¬¦u"></a>å®æˆ˜ä¿®é¥°ç¬¦u</h4><p>å½“ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼è®¾ç½®äº†ä¿®é¥°ç¬¦uæ—¶ï¼Œå°±å°†æ¨¡å¼ä»ç¼–ç å•å…ƒåˆ‡æ¢åˆ°å­—ç¬¦æ¨¡å¼ã€‚è¿™æ„å‘³ç€æ­£åˆ™è¡¨è¾¾å¼èƒ½æ­£ç¡®è¯†åˆ«å­—ç¬¦ä¸²ä¸­ä»£ç†ç¼–ç å¯¹ï¼Œçœ‹ä¸‹é¢ä»£ç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var text = &quot;ğ ®·&quot;;</span><br><span class="line"></span><br><span class="line">console.log(text.length);           // 2</span><br><span class="line">console.log(/^.$/.test(text));      // false</span><br><span class="line">console.log(/^.$/u.test(text));     // true</span><br></pre></td></tr></table></figure>
<p>æ­£åˆ™è¡¨è¾¾å¼&#x2F;^.$&#x2F;å°†åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²åªåŒ…å«ä¸€ä¸ªå­—ç¬¦ï¼Œå½“æ²¡æœ‰è®¾ç½®uä¿®é¥°ç¬¦çš„æ—¶å€™ï¼Œæ­£åˆ™è¡¨è¾¾å¼åŸºäºç¼–ç å•å…ƒåŒ¹é…ï¼Œæ‰€ä»¥æ—¥è¯­å­—ç¬¦ï¼ˆç”¨ä¸¤ä¸ªç¼–ç å•å…ƒè¡¨ç¤ºï¼‰å°†ä¸ä¼šè¢«è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œä¸€æ—¦è®¾ç½®uä¿®é¥°ç¬¦åæ­£åˆ™è¡¨è¾¾å¼åŸºäºå­—ç¬¦è€Œä¸æ˜¯ç¼–ç å•å…ƒåŒ¹é…æ‰€ä»¥èƒ½åŒ¹é…æ—¥è¯­å­—ç¬¦ã€‚  </p>
<h4 id="è®¡ç®—ç ä½æ•°é‡"><a href="#è®¡ç®—ç ä½æ•°é‡" class="headerlink" title="è®¡ç®—ç ä½æ•°é‡"></a>è®¡ç®—ç ä½æ•°é‡</h4><p>ä¸å¹¸çš„æ˜¯ï¼ŒECMAScript6å¹¶æ²¡æä¾›è®¡ç®—å­—ç¬¦ä¸²çš„ç ç‚¹æ•°æ–¹æ³•ï¼Œä½†æ˜¯é€šè¿‡uä¿®é¥°ç¬¦ï¼Œä½ å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è®¡ç®—å‡ºæ¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function codePointLength(text) &#123;</span><br><span class="line">    var result = text.match(/[\s\S]/gu);</span><br><span class="line">    return result ? result.length : 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(codePointLength(&quot;abc&quot;));    // 3</span><br><span class="line">console.log(codePointLength(&quot;ğ ®·bc&quot;));   // 3</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­ä¸­è°ƒç”¨match()æ¥åŒ¹é…textï¼Œåœ¨Unicodeä¸­çš„å­—ç¬¦ä¸²â€abcâ€å’Œâ€ğ ®·bcâ€éƒ½åŒ…å«3ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥é•¿åº¦ä¹Ÿæ˜¯3.  </p>
<h4 id="æ£€æŸ¥uä¿®é¥°ç¬¦æ”¯æŒç¨‹åº¦"><a href="#æ£€æŸ¥uä¿®é¥°ç¬¦æ”¯æŒç¨‹åº¦" class="headerlink" title="æ£€æŸ¥uä¿®é¥°ç¬¦æ”¯æŒç¨‹åº¦"></a>æ£€æŸ¥uä¿®é¥°ç¬¦æ”¯æŒç¨‹åº¦</h4><p>æ—¢ç„¶uä¿®é¥°ç¬¦æ—¶æ–°çš„è¯­æ³•å˜åŒ–ï¼Œåœ¨ä¸å…¼å®¹ECMAScript6çš„jså¼•æ“ä¸­ä½¿ç”¨å°†ä¼šå¯¼è‡´ä¸€ä¸ªè¯­æ³•é”™è¯¯ã€‚æœ€å®‰å…¨çš„æ£€æŸ¥æ”¯æŒç¨‹åº¦çš„å‡½æ•°å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function hasRegExpU() &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        var pattern = new RegExp(&quot;.&quot;, &quot;u&quot;);</span><br><span class="line">        return true;</span><br><span class="line">    &#125; catch (ex) &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•ä¸­åœ¨RegExpæ„é€ å™¨æ€»ä½¿ç”¨uä¿®é¥°ç¬¦å‚æ•°ï¼Œåœ¨æ”¯æŒè¿™ä¸ªè¯­æ³•çš„è€jså¼•æ“ä¸­ä¹Ÿä¼šæ­£ç¡®ï¼Œä½†æ˜¯åœ¨ä¸æ”¯æŒçš„å¼•æ“ä¸­å°†ä¼šæŠ¥é”™ã€‚</p>
<h3 id="å…¶ä»–å…³äºå­—ç¬¦ä¸²çš„æ”¹å˜"><a href="#å…¶ä»–å…³äºå­—ç¬¦ä¸²çš„æ”¹å˜" class="headerlink" title="å…¶ä»–å…³äºå­—ç¬¦ä¸²çš„æ”¹å˜"></a>å…¶ä»–å…³äºå­—ç¬¦ä¸²çš„æ”¹å˜</h3><p>jsçš„å­—ç¬¦ä¸²æ€»æ˜¯è½åä¸å…¶ä»–ç›¸ä¼¼ç‰¹æ€§çš„è¯­è¨€ï¼Œå¦‚åªæœ‰åœ¨ECMACript5ä¸­stringsæœ€ç»ˆå¾—åˆ°äº†trim()æ–¹æ³•ï¼Œè€Œåœ¨ES6ä¸­å°†ä¼šç”¨æ–°çš„æ–¹æ³•ç»§ç»­æ‰©å±•è§£æå­—ç¬¦ä¸²èƒ½åŠ›ã€‚</p>
<h4 id="è¯†åˆ«å­å­—ç¬¦ä¸²çš„æ–¹æ³•"><a href="#è¯†åˆ«å­å­—ç¬¦ä¸²çš„æ–¹æ³•" class="headerlink" title="è¯†åˆ«å­å­—ç¬¦ä¸²çš„æ–¹æ³•"></a>è¯†åˆ«å­å­—ç¬¦ä¸²çš„æ–¹æ³•</h4><p>åœ¨jsä¸­ç¬¬ä¸€ä¸ªè¢«å¼•è¿›æ¥åˆ¤å®šå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«å…¶ä»–å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œä½†åœ¨ES6ä¸­åŒ…å«å¦‚ä¸‹3ä¸ªæ–¹æ³•ï¼Œä»–ä»¬è¢«è®¾è®¡æˆç›¸åŒçš„ä½œç”¨ï¼š</p>
<ul>
<li>æ–¹æ³•includes() åŒ…å«æŒ‡å®šæ–‡æœ¬è¿”å›trueå¦åˆ™è¿”å›false</li>
<li>æ–¹æ³•startWith() åŒ…å«ä»¥æŒ‡å®šæ–‡æœ¬å¼€å§‹çš„Stringè¿”å›trueå¦åˆ™è¿”å›false</li>
<li>æ–¹æ³•endWith() åŒ…å«ä»¥æŒ‡å®šæ–‡æœ¬ç»“æŸçš„Stringè¿”å›trueå¦åˆ™è¿”å›false</li>
</ul>
<p>æ¯ä¸ªæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæœç´¢æ–‡æœ¬å’Œä¸€ä¸ªå¯é€‰çš„æœç´¢èµ·ç‚¹ä¸‹æ ‡ï¼Œå½“è¿ä¸ªå‚æ•°éƒ½æä¾›æ—¶ï¼Œincludes()å’ŒstartWith()ä»ä¸‹æ ‡å¤„å¼€å§‹åŒ¹é…åŒæ—¶endsWith()ä»åŒ¹é…å­—ç¬¦é•¿åº¦å‡å»ä¸‹æ ‡å¤„å¼€å§‹æœç´¢ï¼Œå½“ç¬¬äºŒä¸ªå‚æ•°çœç•¥æ‰åï¼Œincludes()å’ŒstartWith()ä»å­—ç¬¦ä¸²å¼€å¤´å¼€å§‹åŒ¹é…ï¼ŒendWith()ä»æœ€åå¼€å§‹åŒ¹é…ï¼Œäº‹å®ä¸Šç¬¬äºŒä¸ªå‚æ•°å°†å‡å°‘æœå¯»çš„æ•°é‡ï¼Œè¿™é‡Œæ˜¯ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var msg = &quot;Hello world!&quot;;</span><br><span class="line"></span><br><span class="line">console.log(msg.startsWith(&quot;Hello&quot;));       // true</span><br><span class="line">console.log(msg.endsWith(&quot;!&quot;));             // true</span><br><span class="line">console.log(msg.includes(&quot;o&quot;));             // true</span><br><span class="line"></span><br><span class="line">console.log(msg.startsWith(&quot;o&quot;));           // false</span><br><span class="line">console.log(msg.endsWith(&quot;world!&quot;));        // true</span><br><span class="line">console.log(msg.includes(&quot;x&quot;));             // false</span><br><span class="line"></span><br><span class="line">console.log(msg.startsWith(&quot;o&quot;, 4));        // true</span><br><span class="line">console.log(msg.endsWith(&quot;o&quot;, 8));          // true</span><br><span class="line">console.log(msg.includes(&quot;o&quot;, 8));          // false</span><br></pre></td></tr></table></figure>
<p>å‰å…­ä¸ªç¤ºä¾‹ä¸­éƒ½æ²¡æœ‰è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦çš„è¯å®ƒä»¬å°†åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²ã€‚æœ€åä¸‰ä¸ªç¤ºä¾‹ä¸­åªåŒ¹é…äº†éƒ¨åˆ†å­—ç¬¦ä¸²ã€‚msg.startsWith(â€œoâ€, 4)ä»msgä¸‹æ ‡4å¼€å§‹åŒ¹é…ã€‚msg.endsWith(â€œoâ€,8)æ˜¯ä»å­—ç¬¦ä¸²ä¸‹æ ‡4å¼€å§‹ï¼Œå› ä¸ºå­—ç¬¦ä¸²é•¿åº¦12å‡8ç­‰äº4ã€‚msg.includes(â€œoâ€, 8)æ˜¯ä»å­—ç¬¦ä¸²ä¸‹æ ‡8å¼€å§‹çš„è¿™æ­£æ˜¯â€worldâ€ä¸­çš„â€râ€ã€‚  </p>
<p>è¿™å‡ ä¸ªæ–¹æ³•æœ€ç»ˆéƒ½è¿”å›booleanå€¼ï¼Œå¦‚æœä½ æƒ³è¦è·å–å®é™…åŒ¹é…çš„ä¸‹æ ‡å¯ä»¥ç”¨indexOf()æˆ–è€…lastIndexOf()</p>
<h4 id="repeat-æ–¹æ³•"><a href="#repeat-æ–¹æ³•" class="headerlink" title="repeat()æ–¹æ³•"></a>repeat()æ–¹æ³•</h4><p>ES6å¯¹å­—ç¬¦ä¸²æ–°åŠ äº†ä¸€ä¸ªrepeat()æ–¹æ³•,è¿™ä¸ªæ–¹æ³•æ¥å—ä¸€ä¸ªæ•°å­—å‚æ•°è¡¨ç¤ºè¿™ä¸ªå­—ç¬¦ä¸²é‡å¤çš„æ¬¡æ•°ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªè§„å®šé‡å¤æ¬¡æ•°æ–°å­—ç¬¦ä¸²ã€‚å¦‚ä¸‹ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">console.log(&quot;x&quot;.repeat(3));         // &quot;xxx&quot;</span><br><span class="line">console.log(&quot;hello&quot;.repeat(2));     // &quot;hellohello&quot;</span><br><span class="line">console.log(&quot;abc&quot;.repeat(4));       // &quot;abcabcabcabc&quot;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•æ¯”ä¸Šé¢æ‰€æœ‰çš„æ–¹æ³•ç®€å•ï¼Œåœ¨æ“ä½œæ–‡æœ¬æ—¶å°¤å…¶æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨ä»£ç æ ¼å¼åŒ–å·¥å…·ä¸­çš„åˆ›å»ºç¼©å‡åŸºæœ¬ï¼Œåƒä¸‹é¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// indent using a specified number of spaces</span><br><span class="line">var indent = &quot; &quot;.repeat(4),</span><br><span class="line">    indentLevel = 0;</span><br><span class="line"></span><br><span class="line">// whenever you increase the indent</span><br><span class="line">var newIndent = indent.repeat(++indentLevel);</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨ç¬¬ä¸€ä¸ªrepeat()æ—¶åˆ›å»ºäº†4ä¸ªç©ºæ ¼çš„å­—ç¬¦ä¸²ï¼Œç„¶åç”¨å˜é‡indentLevelè·Ÿè¸ªç¼©å‡åŸºæœ¬ï¼Œæœ€åå†è°ƒç”¨repeat()åŠ ä¸Šé€’å¢å˜é‡indentLevelæ§åˆ¶ç©ºæ ¼çš„ä¸ªæ•°ã€‚</p>
<h3 id="å…¶ä»–å…³äºæ­£åˆ™è¡¨è¾¾å¼çš„å˜åŒ–"><a href="#å…¶ä»–å…³äºæ­£åˆ™è¡¨è¾¾å¼çš„å˜åŒ–" class="headerlink" title="å…¶ä»–å…³äºæ­£åˆ™è¡¨è¾¾å¼çš„å˜åŒ–"></a>å…¶ä»–å…³äºæ­£åˆ™è¡¨è¾¾å¼çš„å˜åŒ–</h3><p>åœ¨javascriptä¸­æ­£åˆ™è¡¨è¾¾å¼å¯¹äºæ“ä½œå­—ç¬¦ä¸²æ˜¯ç›¸å½“é‡è¦ï¼Œåƒè¿™é—¨è¯­è¨€çš„å…¶ä»–éƒ¨åˆ†ï¼Œå®ƒä»¬åœ¨æœ€è¿‘çš„ç‰ˆæœ¬ä¸­éƒ½æ²¡æœ‰å¤ªå¤šçš„å˜åŒ–ï¼Œç„¶è€ŒES6ä¹Ÿéšç€å­—ç¬¦ä¸²çš„æ”¹å˜è€Œæ”¹å˜æ›´æ–°ã€‚</p>
]]></content>
      <categories>
        <category>javscript</category>
      </categories>
  </entry>
  <entry>
    <title>ç¬¬ä¸‰ç«  å‡½æ•°</title>
    <url>/2017/06/30/%E7%AC%AC3%E7%AB%A0%20%E5%87%BD%E6%95%B0/</url>
    <content><![CDATA[<h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><p>å‡½æ•°åœ¨ä»»ä½•è¯­è¨€ä¸­éƒ½æ˜¯ç›¸å½“é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨ES6ä¹‹å‰ï¼Œjsçš„å‡½æ•°ä»è¿™é—¨è¯­è¨€è¢«åˆ›å»ºèµ·å°±æ²¡æœ‰æ”¹å˜è¿‡ã€‚å®ƒç•™ä¸‹äº†ä¸€äº›åˆ—é—®é¢˜å’Œæ€ªå¼‚è¡Œä¸ºä»è€Œç›´æ¥å¯¼è‡´äº†æ›´åŠ å®¹æ˜“å‡ºé”™å’Œå®ç°åŸºæœ¬çš„åŠŸèƒ½éœ€è¦æ›´å¤šçš„ä»£ç ã€‚  </p>
<span id="more"></span>


<h3 id="å‡½æ•°ä¸­çš„é»˜è®¤å‚æ•°å€¼"><a href="#å‡½æ•°ä¸­çš„é»˜è®¤å‚æ•°å€¼" class="headerlink" title="å‡½æ•°ä¸­çš„é»˜è®¤å‚æ•°å€¼"></a>å‡½æ•°ä¸­çš„é»˜è®¤å‚æ•°å€¼</h3><p>jsä¸­å‡½æ•°ç‹¬ç‰¹ä¹‹å¤„åœ¨äºä¸ç®¡å‡½æ•°å£°æ˜å®šä¹‰äº†å¤šå°‘ä¸ªå‚æ•°å®é™…è°ƒç”¨æ—¶å¯ä»¥ä¼ ä»»ä½•æ•°é‡çš„å‚æ•°ï¼Œè¿™ä¸ªç‰¹æ€§å¯ä»¥è®©ä½ å°†å‡½æ•°å®šä¹‰æˆå¯ä»¥å¤„ç†ä¸åŒæ•°é‡å‚æ•°çš„å‡½æ•°ï¼Œå½“å‚æ•°æ²¡æœ‰ä¼ æ—¶é€šå¸¸ç”±é»˜è®¤å€¼å¡«å……ã€‚è¿™ä¸ªç« èŠ‚å°†è®²è§£å¦‚ä½•é€šè¿‡argumentå¯¹è±¡ä¸Šçš„ä¸€äº›é‡è¦ä¿¡æ¯åœ¨ES6å‰åä½¿ç”¨é»˜è®¤å‚æ•°ï¼Œä½¿ç”¨å‚æ•°è¡¨è¾¾å¼å’Œå…¶ä»–çš„TDZã€‚</p>
<h4 id="åœ¨ES5ä¸­æ¨¡ä»¿é»˜è®¤å‚æ•°å€¼"><a href="#åœ¨ES5ä¸­æ¨¡ä»¿é»˜è®¤å‚æ•°å€¼" class="headerlink" title="åœ¨ES5ä¸­æ¨¡ä»¿é»˜è®¤å‚æ•°å€¼"></a>åœ¨ES5ä¸­æ¨¡ä»¿é»˜è®¤å‚æ•°å€¼</h4><p>åœ¨ES5ä¹‹å‰ä½ ä¼šä½¿ç”¨ä¸‹ä¾‹æ–¹å¼æ¥åˆ›å»ºä¸€ä¸ªæ‹¥æœ‰é»˜è®¤å‚æ•°å€¼çš„å‡½æ•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function makeRequest(url, timeout, callback) &#123;</span><br><span class="line"></span><br><span class="line">    timeout = timeout || 2000;</span><br><span class="line">    callback = callback || function() &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    // the rest of the function</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œtimeoutå’Œcallbackæ—¶é—´ä¸Šéƒ½æ˜¯å¯é€‰å‚æ•°ï¼Œè¿™æ˜¯å› ä¸ºå®ƒä»¬åœ¨è°ƒç”¨æ—¶æ²¡æœ‰ä¼ å…¥æ—¶éƒ½ä¼šæœ‰ä¸€ä¸ªé»˜è®¤å€¼ã€‚é€»è¾‘æˆ–è¿ç®—ç¬¦ï¼ˆ||ï¼‰å½“ç¬¬ä¸€ä¸ªä¸ºå‡æ—¶æ€»ä¼šè¿”å›ç¬¬äºŒä¸ªçš„å€¼ï¼Œæ—¢ç„¶å½¢å‚æ²¡æœ‰æè¿‡å°±ä¼šè¢«ç½®ä¸ºundefined,é€»è¾‘æˆ–è¿ç®—ç¬¦å¸¸å¸¸è¢«ç”¨åœ¨æä¾›é»˜è®¤å‚æ•°ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ¼æ´ï¼Œåœ¨å®é™…è°ƒç”¨ä¸­timeoutä¹Ÿå¯èƒ½ä¸º0ï¼Œå› ä¸º0åœ¨boolean()æ±‚å€¼ä¸ºfalseæ‰€ä»¥timeoutå°†ä¼šè¢«æ›¿æ¢ä¸º200.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function makeRequest(url, timeout, callback) &#123;</span><br><span class="line"></span><br><span class="line">    timeout = (typeof timeout !== &quot;undefined&quot;) ? timeout : 2000;</span><br><span class="line">    callback = (typeof callback !== &quot;undefined&quot;) ? callback : function() &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    // the rest of the function</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¦è®©è¿™ä¸ªæ–¹æ³•æ›´å®‰å…¨ï¼Œè¿™éœ€è¦æ›´å¤šé¢å¤–çš„ä»£ç ï¼Œè®¸å¤šæµè¡Œçš„jsåº“ä½¿ç”¨è¿™ç§æ–¹å¼æ¥æä¾›é»˜è®¤å‚æ•°ã€‚</p>
<h4 id="åœ¨ES6ä¸­çš„é»˜è®¤å‚æ•°å€¼"><a href="#åœ¨ES6ä¸­çš„é»˜è®¤å‚æ•°å€¼" class="headerlink" title="åœ¨ES6ä¸­çš„é»˜è®¤å‚æ•°å€¼"></a>åœ¨ES6ä¸­çš„é»˜è®¤å‚æ•°å€¼</h4><p>ES6ä¸­æä¾›é»˜è®¤å‚æ•°å€¼å°†è¦å®¹æ˜“å¾ˆå¤šï¼Œå½“æ‰§è¡Œå‡½æ•°æ—¶å‚æ•°æ²¡æœ‰æ­£å¸¸ä¼ å…¥é€šè¿‡åˆå§‹åŒ–å‚æ•°æä¾›é»˜è®¤å‚æ•°å€¼ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function makeRequest(url, timeout = 2000, callback = function() &#123;&#125;) &#123;</span><br><span class="line"></span><br><span class="line">    // the rest of the function</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‡½æ•°åªæœŸå¾…ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ï¼Œå…¶ä½™çš„ä¸¤ä¸ªå‚æ•°æ‹¥æœ‰é»˜è®¤å‚æ•°å€¼ï¼Œè¿™æ ·çš„ç»“æœæ˜¯å‡½æ•°ä½“å°†æ›´åŠ å°å·§è¿™æ˜¯å› ä¸ºä½ ä¸éœ€è¦æ·»åŠ ä»£ç æ¥æ£€æŸ¥ç¼ºçœå‚æ•°ã€‚  </p>
<p>å½“è°ƒç”¨makeRequest()æ—¶ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œé»˜è®¤å‚æ•°å°†ä¸èµ·æ•ˆï¼Œå¦‚ä¸‹ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// uses default timeout and callback</span><br><span class="line">makeRequest(&quot;/foo&quot;);</span><br><span class="line"></span><br><span class="line">// uses default callback</span><br><span class="line">makeRequest(&quot;/foo&quot;, 500);</span><br><span class="line"></span><br><span class="line">// doesn&#x27;t use defaults</span><br><span class="line">makeRequest(&quot;/foo&quot;, 500, function(body) &#123;</span><br><span class="line">    doSomething(body);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>ES6è®¤ä¸ºurlæ˜¯å¿…é¡»çš„ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆâ€&#x2F;fooâ€åœ¨ä¸‰æ¬¡è°ƒç”¨makeRequest()æ—¶éƒ½ä¼ å…¥ï¼Œè€Œå…¶ä½™ä¸¤ä¸ªæ‹¥æœ‰é»˜è®¤å‚æ•°å€¼è¢«å½“æˆå¯é€‰é¡¹ã€‚  </p>
<p>å¯ä»¥ä¸ºä»»ä½•å‚æ•°æŒ‡å®šé»˜è®¤å‚æ•°å€¼ï¼ŒåŒ…æ‹¬å“ªäº›åœ¨å‡½æ•°å£°æ˜ä¸­å‰é¢å‚æ•°æ²¡æœ‰é»˜è®¤å‚æ•°å€¼çš„ï¼Œå¦‚ä¸‹æ˜¯å¯ä»¥çš„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function makeRequest(url, timeout = 2000, callback) &#123;</span><br><span class="line"></span><br><span class="line">    // the rest of the function</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œtimeoutçš„é»˜è®¤å‚æ•°åªæœ‰åœ¨ç¬¬äºŒä¸ªå‚æ•°æ²¡æœ‰ä¼ å…¥ï¼Œæˆ–è€…ä¼ å…¥undefinedèµ·æ•ˆï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// uses default timeout</span><br><span class="line">makeRequest(&quot;/foo&quot;, undefined, function(body) &#123;</span><br><span class="line">    doSomething(body);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// uses default timeout</span><br><span class="line">makeRequest(&quot;/foo&quot;);</span><br><span class="line"></span><br><span class="line">// doesn&#x27;t use default timeout</span><br><span class="line">makeRequest(&quot;/foo&quot;, null, function(body) &#123;</span><br><span class="line">    doSomething(body);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™äº›ä¾‹å­ä¸­åªæœ‰ä¼ å…¥nullæ‰ä¼šè¢«å½“åšæœ‰æ•ˆå€¼ï¼Œå…¶ä½™çš„éƒ½å°†ä½¿ç”¨é»˜è®¤å‚æ•°å€¼ã€‚</p>
<h4 id="é»˜è®¤å‚æ•°å€¼æ˜¯å¦‚ä½•å½±å“argumentså¯¹è±¡"><a href="#é»˜è®¤å‚æ•°å€¼æ˜¯å¦‚ä½•å½±å“argumentså¯¹è±¡" class="headerlink" title="é»˜è®¤å‚æ•°å€¼æ˜¯å¦‚ä½•å½±å“argumentså¯¹è±¡"></a>é»˜è®¤å‚æ•°å€¼æ˜¯å¦‚ä½•å½±å“argumentså¯¹è±¡</h4><p>è®°ä½argumentså¯¹è±¡åœ¨ä½¿ç”¨é»˜è®¤å‚æ•°å€¼æ—¶è¡¨ç°ä¼šæœ‰ä¸€äº›ä¸ä¸€æ ·ï¼ŒzaiES5éä¸¥æ ¼æ¨¡å¼ä¸­ï¼Œargumentså¯¹è±¡çš„æ”¹å˜å°†ååº”åˆ°å½¢å‚ä¸Šï¼Œè¿™é‡Œæ˜¯ä¸€äº›ä»£ç†æ¥è§£é‡Šï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function mixArgs(first, second) &#123;</span><br><span class="line">    console.log(first === arguments[0]);</span><br><span class="line">    console.log(second === arguments[1]);</span><br><span class="line">    first = &quot;c&quot;;</span><br><span class="line">    second = &quot;d&quot;;</span><br><span class="line">    console.log(first === arguments[0]);</span><br><span class="line">    console.log(second === arguments[1]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mixArgs(&quot;a&quot;, &quot;b&quot;);</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ˜¯è¾“å‡º:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">true</span><br><span class="line">true</span><br><span class="line">true</span><br><span class="line">true</span><br></pre></td></tr></table></figure>
<p>åœ¨ES5ä¸­argumentså¯¹è±¡ä¸å½¢å‚æ€»æ˜¯åŒæ­¥æ›´æ–°ï¼Œå½“fristå’Œsecondè¢«èµ‹äºˆæ–°çš„å€¼ï¼Œarguments[0]å’Œarguments[1]ä¹Ÿç›¸åº”çš„æ›´æ–°ï¼Œå½“ä½¿ç”¨&#x3D;&#x3D;&#x3D;æ¯”è¾ƒæ—¶ä¼šå¾—åˆ°tureã€‚  </p>
<p>ä½†æ˜¯åœ¨ES5ä¸¥æ ¼æ¨¡å¼ä¸­æ¶ˆé™¤è¿™äº›åœ¨argumnetså¯¹è±¡è®©äººç–‘æƒ‘çš„åœ°æ–¹ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸­argumentså°†ä¸ä¼šå’Œå½¢å‚åŒæ­¥æ›´æ–°ï¼Œè¿™é‡ŒåŒæ ·æ˜¯mixArgs()å‡½æ•°ä½†æ˜¯æ˜¯åœ¨ä¸¥æ ¼æ¨¡å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function mixArgs(first, second) &#123;</span><br><span class="line">    &quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">    console.log(first === arguments[0]);</span><br><span class="line">    console.log(second === arguments[1]);</span><br><span class="line">    first = &quot;c&quot;;</span><br><span class="line">    second = &quot;d&quot;</span><br><span class="line">    console.log(first === arguments[0]);</span><br><span class="line">    console.log(second === arguments[1]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mixArgs(&quot;a&quot;, &quot;b&quot;);</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨mixArgsè¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">true</span><br><span class="line">true</span><br><span class="line">false</span><br><span class="line">false</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡å½“æ”¹å˜firstå’Œsecondå¹¶æ²¡æœ‰å½±å“argumentså¯¹è±¡ï¼Œä½¿ç”¨è¾“å‡ºç»“æœå°†æ˜¯ä½ æ­£å¸¸æœŸå¾…çš„ã€‚<br>åœ¨ES6ä¸­ä¸é¡¾æ˜¯ä¸æ˜¯ä¸¥æ ¼æ¨¡å¼å½“ä½¿ç”¨é»˜è®¤å‚æ•°å€¼å°†ä¼šå¯¼è‡´argumentå¯¹è±¡çš„è¡¨ç°è¡Œä¸ºåƒæ˜¯åœ¨ES5ä¸­ä¸¥æ ¼æ¨¡å¼ä¸€æ ·ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// not in strict mode</span><br><span class="line">function mixArgs(first, second = &quot;b&quot;) &#123;</span><br><span class="line">    console.log(arguments.length);</span><br><span class="line">    console.log(first === arguments[0]);</span><br><span class="line">    console.log(second === arguments[1]);</span><br><span class="line">    first = &quot;c&quot;;</span><br><span class="line">    second = &quot;d&quot;</span><br><span class="line">    console.log(first === arguments[0]);</span><br><span class="line">    console.log(second === arguments[1]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mixArgs(&quot;a&quot;);</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1</span><br><span class="line">true</span><br><span class="line">false</span><br><span class="line">false</span><br><span class="line">false</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œarguments.lengthä¸º1è¿™æ˜¯å› ä¸ºåªæœ‰ä¸€ä¸ªäº§ç”Ÿä¼ å…¥ï¼ŒåŒæ—¶è¿™ä¹Ÿæ„å‘³ç€arguments[1]ä½undefinedï¼Œè¿™æ„å‘³ç€firstç­‰äºarguments[0],åŒæ—¶æ”¹å˜firstå’Œseondå°†ä¸ä¼šååº”åˆ°argumentsï¼Œè¿™ç§è¡¨ç°è¡Œä¸ºåœ¨ä¸¥æ ¼å’Œéä¸¥æ ¼æ¨¡å¼éƒ½æ˜¯å¯è¡Œçš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥é€šè¿‡argumentsæ€»æ˜¯è·å–è°ƒç”¨å‡½æ•°æ—¶å®å‚çš„å€¼ã€‚  </p>
<h4 id="é»˜è®¤å‚æ•°è¡¨è¾¾å¼"><a href="#é»˜è®¤å‚æ•°è¡¨è¾¾å¼" class="headerlink" title="é»˜è®¤å‚æ•°è¡¨è¾¾å¼"></a>é»˜è®¤å‚æ•°è¡¨è¾¾å¼</h4><p>é»˜è®¤å‚æ•°å€¼ä¸­æœ€æœ‰è¶£çš„æ˜¯é»˜è®¤å€¼ä¸ä¸€å®šæ˜¯åŸå§‹å€¼ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡æ‰§è¡Œä¸€ä¸ªå‡½æ•°æ¥è·å–é»˜è®¤å‚æ•°å€¼åƒè¿™æ ·ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function getValue() &#123;</span><br><span class="line">    return 5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function add(first, second = getValue()) &#123;</span><br><span class="line">    return first + second;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(add(1, 1));     // 2</span><br><span class="line">console.log(add(1));        // 6</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œç¬¬äºŒä¸ªå‚æ•°æ²¡æœ‰æä¾›ï¼Œgetvalue()è¢«è°ƒç”¨è·å–æ­£ç¡®çš„é»˜è®¤å‚æ•°å€¼ï¼Œè®°ä½getVlue()åªæœ‰åœ¨è°ƒç”¨add()æ˜¯æ²¡æœ‰ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°æ—¶æ‰è¢«è°ƒç”¨ï¼Œåœ¨å‡½æ•°å£°æ˜è§£æçš„æ—¶å€™ä¸ä¼šè¢«è°ƒç”¨ï¼Œè¿™æ„å‘³ç€å¦‚æœgetvalue()è¢«é‡å†™äº†ï¼Œä»–å¯èƒ½è¿”å›ä¸åŒçš„å€¼ï¼Œå¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let value = 5;</span><br><span class="line"></span><br><span class="line">function getValue() &#123;</span><br><span class="line">    return value++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function add(first, second = getValue()) &#123;</span><br><span class="line">    return first + second;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(add(1, 1));     // 2</span><br><span class="line">console.log(add(1));        // 6</span><br><span class="line">console.log(add(1));        // 7</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œvalueçš„å€¼ä»¥5å¼€å§‹å¹¶ä¸”åœ¨æ¯æ¬¡è°ƒç”¨getVlau()åé€’å¢ï¼Œå½“ç¬¬äºŒæ¬¡è°ƒç”¨add(1)æ—¶è¿”å›7è¿™æ˜¯å› ä¸ºvalueé€’å¢è¿‡äº†ã€‚  </p>
<p>è¿™ä¸ªè¡Œä¸ºç‰¹å¾åˆå¼•è¿›äº†æ–°çš„èƒ½åŠ›ï¼Œä½ å¯ä»¥ä½¿ç”¨å‰é¢çš„å‚æ•°ä½œä¸ºåé¢å‚æ•°çš„é»˜è®¤å‚æ•°å€¼ï¼Œè¿™é‡Œæ˜¯ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function add(first, second = first) &#123;</span><br><span class="line">    return first + second;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(add(1, 1));     // 2</span><br><span class="line">console.log(add(1));        // 2</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„é»˜è®¤å€¼æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¿™æ„å‘³ç€åªéœ€ä¼ å…¥ä¸€ä¸ªå‚æ•°è®©ä¸¤ä¸ªå‚æ•°æ‹¥æœ‰ç›¸åŒçš„å€¼ï¼Œæ‰€ä»¥add(1,1)è¿”å›å’Œadd(1)ä¸€æ ·ï¼Œæƒ³æ›´è¿œä¸€äº›ï¼Œä½ å¯ä»¥å°†ç¬¬ä¸€ä¸ªå‚æ•°å½“åšç¬¬äºŒä¸ªå‚æ•°çš„é»˜è®¤å‚æ•°è¡¨è¾¾å¼ä¸­çš„å‚æ•°ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function getValue(value) &#123;</span><br><span class="line">    return value + 5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function add(first, second = getValue(first)) &#123;</span><br><span class="line">    return first + second;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(add(1, 1));     // 2</span><br><span class="line">console.log(add(1));        // 7</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­ä¸­è®¾ç½®secondç­‰äºgetValue(first)è¿”å›çš„å€¼ï¼Œæ‰€ä»¥add(1,1)ä»»ç„¶ç­‰äº2ï¼Œadd(1)è¿”å›7ã€‚<br>åœ¨è°ƒç”¨add(undefined,1)æ—¶å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºsecondæ˜¯åœ¨firstä¹‹åå®šä¹‰ï¼Œå› æ­¤ä¸èƒ½å°†ä¸å­˜åœ¨çš„å˜é‡èµ‹å€¼ä¸ºé»˜è®¤å‚æ•°ï¼Œä¸ºäº†ç†è§£ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Œé‡æ–°ç†è§£ä¸‹TDZå¾ˆé‡è¦ã€‚</p>
<h4 id="é»˜è®¤å‚æ•°å€¼ä¸­çš„TDZ"><a href="#é»˜è®¤å‚æ•°å€¼ä¸­çš„TDZ" class="headerlink" title="é»˜è®¤å‚æ•°å€¼ä¸­çš„TDZ"></a>é»˜è®¤å‚æ•°å€¼ä¸­çš„TDZ</h4><p>ç¬¬ä¸€ç« ä¸­ä»‹ç»çš„æš‚æ—¶æ€§æ­»åŒº(TDZ)æ˜¯é’ˆå¯¹çš„letå’Œconstï¼Œå¹¶ä¸”åœ¨é»˜è®¤å‚æ•°å€¼ä¸­å½“å‚æ•°ä¸èƒ½è·å–åˆ°æ—¶ä¹Ÿæœ‰ä¸€ä¸ªTDZï¼Œå’Œletå£°æ˜ç›¸ä¼¼çš„æ˜¯æ¯ä¸ªå‚æ•°åˆ›å»ºä¸€ä¸ªç»‘å®šæ ‡è¯†ç¬¦ï¼Œè¿™ä¸ªæ ‡è¯†ç¬¦åœ¨æ²¡æœ‰åˆå§‹åŒ–å‰è®¿é—®å°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå‚æ•°çš„åˆå§‹åŒ–æ˜¯å‘ç”Ÿåœ¨å‡½æ•°è°ƒç”¨æ—¶ï¼Œæ—¢ä¸æ˜¯åœ¨ä¼ å€¼æ—¶ä¹Ÿä¸åœ¨ä½¿ç”¨é»˜è®¤å‚æ•°å€¼æ—¶ã€‚  </p>
<p>ä¸ºäº†æ¢ç©¶é»˜è®¤å‚æ•°å€¼çš„TDZï¼Œå†çœ‹ä¸€ä¸‹é»˜è®¤å‚æ•°è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function getValue(value) &#123;</span><br><span class="line">    return value + 5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function add(first, second = getValue(first)) &#123;</span><br><span class="line">    return first + second;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(add(1, 1));     // 2</span><br><span class="line">console.log(add(1));        // 7</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨add(1,1)å’Œadd(1)å®é™…ä¸Šç›¸å½“äºæ‰§è¡Œäº†åˆ›å»ºfirstå’Œsecondå‚æ•°å€¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// JavaScript representation of call to add(1, 1)</span><br><span class="line">let first = 1;</span><br><span class="line">let second = 1;</span><br><span class="line"></span><br><span class="line">// JavaScript representation of call to add(1)</span><br><span class="line">let first = 1;</span><br><span class="line">let second = getValue(first);</span><br></pre></td></tr></table></figure>
<p>å½“ç¬¬ä¸€æ¬¡æ‰§è¡Œadd()æ—¶ï¼Œfirstå’Œsecondç»‘å®šè¢«æ·»åŠ åˆ°ä¸€ä¸ªå‚æ•°ç‰¹å®šçš„TDZä¸­(å’Œletçš„è¿è¡Œæ–¹å¼ç›¸åŒ)ï¼Œæ‰€ä»¥å½“secondå¯ä»¥ç”¨firstæ¥åˆå§‹åŒ–å› ä¸ºfirståœ¨é‚£ä¸ªæ—¶å€™å·²ç»åˆå§‹åŒ–äº†ï¼Œåè¿‡æ¥å°±ä¸å¯ä»¥ï¼Œç°åœ¨çœ‹é‡å†™add()å‡½æ•°:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function add(first = second, second) &#123;</span><br><span class="line">    return first + second;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(add(1, 1));         // 2</span><br><span class="line">console.log(add(undefined, 1)); // throws error</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­è°ƒç”¨add(1,1)å’Œadd(undefined, 1)å¯¹åº”ç€ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// JavaScript representation of call to add(1, 1)</span><br><span class="line">let first = 1;</span><br><span class="line">let second = 1;</span><br><span class="line"></span><br><span class="line">// JavaScript representation of call to add(undefined, 1)</span><br><span class="line">let first = second;</span><br><span class="line">let second = 1;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­è°ƒç”¨add(undefined,1)å°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºåœ¨åˆå§‹åŒ–firstæ—¶secondè¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œåœ¨è¿™ä¸ªæ—¶å€™secondåœ¨TDZä¸­ä»»ä½•å¯¹secondçš„å¼•ç”¨éƒ½å°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¿™å’Œç¬¬ä¸€ç« ä¸­è®¨è®ºçš„letç»‘å®šä¸€æ ·ã€‚  </p>
<h3 id="åŒ¿åå‚æ•°"><a href="#åŒ¿åå‚æ•°" class="headerlink" title="åŒ¿åå‚æ•°"></a>åŒ¿åå‚æ•°</h3><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ç« ä¸­åªæ˜¯è¦†ç›–äº†å‡½æ•°å®šä¹‰ä¸­çš„å‘½åå‚æ•°ï¼Œä½†æ˜¯jså‡½æ•°æ²¡æœ‰é™åˆ¶ä½ ä¼ å…¥å‚æ•°æ•°é‡å’Œå‘½åå‚æ•°æ•°é‡çš„å…³ç³»ï¼Œä½ å¯ä»¥å¤šä¼ ä¹Ÿå¯ä»¥å°‘ä¼ ä¸å‘½åå‚æ•°æ•°é‡ï¼Œé»˜è®¤å‚æ•°å€¼æ˜¯å¤„ç†å°‘ä¼ å‚æ•°çš„æƒ…å†µï¼Œå¹¶ä¸”ES6ä¹Ÿåœ¨å¯»æ±‚å¤šä¼ å‚æ•°çš„æƒ…å†µã€‚  </p>
<h4 id="åœ¨ES5ä¸­çš„åŒ¿åå‚æ•°"><a href="#åœ¨ES5ä¸­çš„åŒ¿åå‚æ•°" class="headerlink" title="åœ¨ES5ä¸­çš„åŒ¿åå‚æ•°"></a>åœ¨ES5ä¸­çš„åŒ¿åå‚æ•°</h4><p>æ—©äº›æ—¶å€™jsæä¾›äº†argumentså¯¹è±¡æ¥æ£€æŸ¥å½“åœ¨å‡½æ•°å®šä¹‰æ—¶æ²¡æœ‰ä¸€ä¸€æŒ‡å®šæ¯ä¸€ä¸ªå‚æ•°è€Œè°ƒç”¨æ—¶å‡½æ•°çš„æ‰€æœ‰å‚æ•°ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ£€æµ‹argumentsæœ‰æ•ˆï¼Œç»è¿‡å¤„ç†èµ·æ¥æœ‰äº›éº»çƒ¦ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function pick(object) &#123;</span><br><span class="line">    let result = Object.create(null);</span><br><span class="line"></span><br><span class="line">    // start at the second parameter</span><br><span class="line">    for (let i = 1, len = arguments.length; i &lt; len; i++) &#123;</span><br><span class="line">        result[arguments[i]] = object[arguments[i]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let book = &#123;</span><br><span class="line">    title: &quot;Understanding ECMAScript 6&quot;,</span><br><span class="line">    author: &quot;Nicholas C. Zakas&quot;,</span><br><span class="line">    year: 2015</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">let bookData = pick(book, &quot;author&quot;, &quot;year&quot;);</span><br><span class="line"></span><br><span class="line">console.log(bookData.author);   // &quot;Nicholas C. Zakas&quot;</span><br><span class="line">console.log(bookData.year);     // 2015</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‡½æ•°åœ¨æ¨¡ä»¿Underscore.jsåº“çš„pick()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç»™å®šå¯¹è±¡å­é›†çš„å‰¯æœ¬ï¼Œè¿™ä¸ªä¾‹å­ä¸­åªæœ‰ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºåŸå§‹å¯¹è±¡å¤–å…¶ä»–éƒ½æ˜¯è¦è¿”å›å¯¹è±¡çš„å±æ€§ã€‚  </p>
<p>å¯¹äºpick()å‡½æ•°è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„çš„ï¼Œé¦–å…ˆè¿™ä¸ªå‡½æ•°å¯¹äºèƒ½å¤„ç†å¤šä¸ªå‚æ•°çš„æš—ç¤ºä¸€ç‚¹éƒ½ä¸æ˜æ˜¾ï¼Œç¬¬äºŒç‚¹ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå‚æ•°å‘½åä¸”ç›´æ¥ä½¿ç”¨çš„ï¼Œå½“ä½ åœ¨å¯»æ‰¾å±æ€§æ¥å¤åˆ¶æ—¶ï¼Œä½ å¿…é¡»è¦ä»argumentsä¸‹æ ‡1è€Œä¸æ˜¯0å¼€å§‹ï¼Œè®°ä½æ­£ç¡®çš„ä½¿ç”¨argumentså¹¶ä¸éš¾ï¼Œä½†æ˜¯è¿™éœ€è¦ä½ å¤šè®°ä¸€ä»¶äº‹äº†ã€‚</p>
<h4 id="ä¸å®šå‚æ•°-rest-parameters"><a href="#ä¸å®šå‚æ•°-rest-parameters" class="headerlink" title="ä¸å®šå‚æ•°(rest parameters)"></a>ä¸å®šå‚æ•°(rest parameters)</h4><p>ä¸å®šå‚æ•°æ˜¯ç”±ä¸‰ä¸ªç‚¹(â€¦)åŠ ä¸Šä¸€ä¸ªå‘½åå‚æ•°ç»„æˆï¼Œè¿™ä¸ªå‘½åå‚æ•°å˜æˆä¸€ä¸ªåŒ…å«å…¶ä½™ä¼ å…¥å‡½æ•°å‚æ•°çš„æ•°ç»„ï¼Œçœ‹pick()æ˜¯å¦‚ä½•ç”¨å¤šç”¨å‚æ•°é‡å†™çš„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function pick(object, ...keys) &#123;</span><br><span class="line">    let result = Object.create(null);</span><br><span class="line"></span><br><span class="line">    for (let i = 0, len = keys.length; i &lt; len; i++) &#123;</span><br><span class="line">        result[keys[i]] = object[keys[i]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­çš„å‡½æ•°ï¼Œkeyså°±æ˜¯ä¸å®šå‚æ•°å®ƒåŒ…å«äº†åœ¨objectä¹‹åä¼ å…¥çš„æ‰€æœ‰å‚æ•°ï¼ˆä¸åƒargumentsåŒ…å«æ‰€æœ‰ä¼ å…¥å‚æ•°ï¼‰è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨ä»å¤´å¼€å§‹éå†keysä¸ç”¨æ‹…å¿ƒå‡ºé”™ï¼Œä½œä¸ºç¦åˆ©ä½ å¯ä»¥é€šè¿‡çœ‹å‡½æ•°å°±çŸ¥é“ä»–å¯ä»¥å¤„ç†ä»»æ„æ•°é‡çš„å‚æ•°ã€‚  </p>
<ul>
<li>notes:ä¸å®šå‚æ•°ä¸ä¼šå½±å“å‡½æ•°çš„lengthå±æ€§ï¼Œè¿™ä¸ªå±æ€§åªå—å‘½åå‚æ•°ä¸ªæ•°å½±å“ï¼Œpick()çš„lengthå€¼ä¸º1å› ä¸ºåªæœ‰ä¸€ä¸ªå‘½åå‚æ•°ã€‚</li>
</ul>
<h4 id="ä¸å®šå‚æ•°çš„é™åˆ¶"><a href="#ä¸å®šå‚æ•°çš„é™åˆ¶" class="headerlink" title="ä¸å®šå‚æ•°çš„é™åˆ¶"></a>ä¸å®šå‚æ•°çš„é™åˆ¶</h4><p>è¿™é‡Œæœ‰ä¸¤æ¡å¯¹ä¸å®šå‚æ•°çš„é™åˆ¶ï¼Œé¦–å…ˆä¸€ä¸ªå‡½æ•°åªèƒ½æœ‰ä¸€ä¸ªä¸å®šå‚æ•°ï¼Œå¹¶ä¸”ä¸å®šå‚æ•°ä¸€å®šåªèƒ½æ˜¯æœ€åä¸€ä¸ªï¼Œå¦‚ä¸‹ä»£ç å°†ä¸ä¼šèµ·æ•ˆï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Syntax error: Can&#x27;t have a named parameter after rest parameters</span><br><span class="line">function pick(object, ...keys, last) &#123;</span><br><span class="line">    let result = Object.create(null);</span><br><span class="line"></span><br><span class="line">    for (let i = 0, len = keys.length; i &lt; len; i++) &#123;</span><br><span class="line">        result[keys[i]] = object[keys[i]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå‚æ•°lastæ¥åœ¨ä¸å®šå‚æ•°keysåé¢ï¼Œå°†ä¼šé€ æˆä¸€ä¸ªè¯­æ³•é”™è¯¯ã€‚  </p>
<p>ç¬¬äºŒä¸ªé™åˆ¶æ˜¯ä¸å®šå‚æ•°ä¸èƒ½åœ¨å¯¹è±¡å­—é¢é‡setterä½¿ç”¨ï¼Œè¿™æ„å‘³ç€ä¸‹é¢ä»£ç å°†ä¼šé€ æˆä¸€ä¸ªè¯­æ³•é”™è¯¯:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let object = &#123;</span><br><span class="line"></span><br><span class="line">    // Syntax error: Can&#x27;t use rest param in setter</span><br><span class="line">    set name(...value) &#123;</span><br><span class="line">        // do something</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé™åˆ¶å­˜åœ¨æ˜¯å› ä¸ºå¯¹è±¡å­—é¢é‡settersé™åˆ¶ä¸ºä¸ªå‚æ•°ï¼Œä¸å®šå‚æ•°å®šä¹‰ä¸Šæ¥è¯´å¯ä»¥æ˜¯æ— é™ä¸ªå‚æ•°ï¼Œæ‰€ä»¥åœ¨è¿™æ ·çš„ä¸Šä¸‹åˆä¸­ä¸èƒ½ä½¿ç”¨ã€‚  </p>
<h4 id="ä¸å®šå‚æ•°å¯¹argumentså¯¹è±¡çš„å½±å“"><a href="#ä¸å®šå‚æ•°å¯¹argumentså¯¹è±¡çš„å½±å“" class="headerlink" title="ä¸å®šå‚æ•°å¯¹argumentså¯¹è±¡çš„å½±å“"></a>ä¸å®šå‚æ•°å¯¹argumentså¯¹è±¡çš„å½±å“</h4><p>åœ¨ESä¸­ä¸å®šå‚æ•°è¢«è®¾è®¡æˆå–ä»£argumentsï¼Œåœ¨åŸæ¥çš„ES4ä¸­åºŸé™¤äº†argumentså’Œæ–°å¢ä¸å®šå‚æ•°å…è®¸ä¼ å…¥ä¸å—é™åˆ¶æ•°é‡çš„å‚æ•°ï¼ŒES4æœ€ç»ˆæ²¡èƒ½å®ç°ï¼Œä½†æ˜¯è¿™ä¸ªè¿™ä¸ªæƒ³æ³•ä¿ç•™ä¸‹æ¥äº†å¹¶åœ¨ES6ä¸­è¢«é‡æ–°å¼•è¿›äº†ï¼Œå°½ç®¡agumentsæ²¡æœ‰ä»è¿™é—¨è¯­è¨€ä¸­ç§»é™¤ã€‚   </p>
<p>argumentså¯¹è±¡å’Œä¸å®šå‚æ•°åœ¨å‡½æ•°è¢«è°ƒç”¨æ˜¯å…±åŒååº”ç€ä¼ å…¥çš„å‚æ•°ï¼Œå¦‚ä¸‹ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function checkArgs(...args) &#123;</span><br><span class="line">    console.log(args.length);</span><br><span class="line">    console.log(arguments.length);</span><br><span class="line">    console.log(args[0], arguments[0]);</span><br><span class="line">    console.log(args[1], arguments[1]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">checkArgs(&quot;a&quot;, &quot;b&quot;);</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨checkArgs()è¾“å‡º:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2</span><br><span class="line">2</span><br><span class="line">a a</span><br><span class="line">b b</span><br></pre></td></tr></table></figure>
<p>argumentså¯¹è±¡é‚£ä¸ªä»ç„¶ååº”ç€ä¼ å…¥çš„å‚æ•°ä¸ç®¡æœ‰æ²¡ä½¿ç”¨ä¸å®šå‚æ•°ã€‚  </p>
<p>ä½ æ‰€çŸ¥é“çš„å…¨éƒ¨æ˜¯å¯ä»¥å¼€å§‹ä½¿ç”¨ä¸å®šå‚æ•°äº†ã€‚</p>
<h4 id="Functionæ„é€ å™¨æ–°å¢ç‰¹æ€§"><a href="#Functionæ„é€ å™¨æ–°å¢ç‰¹æ€§" class="headerlink" title="Functionæ„é€ å™¨æ–°å¢ç‰¹æ€§"></a>Functionæ„é€ å™¨æ–°å¢ç‰¹æ€§</h4><p>Functionæ„é€ å™¨ä½œä¸ºjsçš„ä¸€éƒ¨åˆ†å¹¶ä¸ç»å¸¸ä½¿ç”¨ï¼Œå®ƒèƒ½è®©ä½ åŠ¨æ€çš„åˆ›å»ºå‡½æ•°ï¼Œæ„é€ å™¨çš„å‚æ•°ä¸ºç”Ÿæˆå‡½æ•°çš„å‚æ•°å’Œå‡½æ•°ä½“ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œè¿™é‡Œæ˜¯ä¾‹å­:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var add = new Function(&quot;first&quot;, &quot;second&quot;, &quot;return first + second&quot;);</span><br><span class="line"></span><br><span class="line">console.log(add(1, 1));     // 2</span><br></pre></td></tr></table></figure>

<p>ES6å…è®¸Functionæ„é€ å™¨ä½¿ç”¨é»˜è®¤å‚æ•°å’Œä¸å®šå‚æ•°ï¼Œä½ åªéœ€æ·»åŠ ç›¸åº”çš„æ ‡ç¤ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var add = new Function(&quot;first&quot;, &quot;second = first&quot;,</span><br><span class="line">        &quot;return first + second&quot;);</span><br><span class="line"></span><br><span class="line">console.log(add(1, 1));     // 2</span><br><span class="line">console.log(add(1));        // 2</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªä¾‹å­ä¸­secondè¢«èµ‹äºˆfirstçš„é»˜è®¤å€¼ã€‚  </p>
<p>å¯¹äºä¸å®šå‚æ•°ä½ åªéœ€æ·»åŠ â€¦ åœ¨æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var pickFirst = new Function(&quot;...args&quot;, &quot;return args[0]&quot;);</span><br><span class="line"></span><br><span class="line">console.log(pickFirst(1, 2));   // 1</span><br></pre></td></tr></table></figure>

<h3 id="å±•å¼€è¿ç®—ç¬¦"><a href="#å±•å¼€è¿ç®—ç¬¦" class="headerlink" title="å±•å¼€è¿ç®—ç¬¦"></a>å±•å¼€è¿ç®—ç¬¦</h3><p>ä¸ä¸å®šå‚æ•°æœ€ç›¸å…³çš„æ˜¯å±•å¼€è¿ç®—ç¬¦ï¼Œä¸å®šå‚æ•°å…è®¸ä½ ç”¨å¤šä¸ªç‹¬ç«‹çš„å‚æ•°åˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œç„¶è€Œå±•å¼€è¿ç®—ç¬¦å…è®¸ä½ ç”¨ä¸€ä¸ªç»™å®šæ•°ç»„åˆ†å‰²æˆç‹¬ç«‹çš„é¡¹å½“åšå‚æ•°ä¼ å…¥å‡½æ•°ï¼Œçœ‹Math.max()æ–¹æ³•ï¼Œå®ƒå…è®¸ä½ æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°å¹¶è¿”å›å…¶ä¸­å€¼æœ€é«˜çš„ï¼Œè¿™é‡Œæ˜¯ä½¿ç”¨çš„ä¾‹å­:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let value1 = 25,</span><br><span class="line">    value2 = 50;</span><br><span class="line"></span><br><span class="line">console.log(Math.max(value1, value2));      // 50</span><br></pre></td></tr></table></figure>
<p>å½“ä½ å¤„ç†åªæœ‰ä¸¤ä¸ªå€¼æ˜¯Math.max()éå¸¸ç®€å•ï¼Œä¼ å…¥ä¸¤ä¸ªå€¼è¿”å›æœ€é«˜çš„ï¼Œä½†æ˜¯ä½ è¦ä½¿ç”¨ä¸€ä¸ªæ•°ç»„ä¼ å…¥æ—¶ï¼ŸMath.max()ä¸å…è®¸ä½ ä½¿ç”¨æ•°ç»„ï¼Œåœ¨æ—©å…ˆçš„ES5ä¸­ï¼Œä½ è¦ä¹ˆè¢«è¿™ä¸ªæ•°ç»„å›°ä½è¦ä¹ˆä½¿ç”¨apply()å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let values = [25, 50, 75, 100]</span><br><span class="line"></span><br><span class="line">console.log(Math.max.apply(Math, values));  // 100</span><br></pre></td></tr></table></figure>
<p>è¿™ç§è§£å†³æ–¹æ¡ˆä¼šç”Ÿæ•ˆï¼Œä½†æ˜¯ä½¿ç”¨apply()è¿™ç§æ–¹å¼æœ‰ç‚¹ä»¤äººå›°æƒ‘ï¼ŒåŠ äº†è¿™æ®µé¢å¤–ä»£ç åè¿™å®é™…ä¸Šçœ‹èµ·æ¥æŠ½è±¡äº†ã€‚  </p>
<p>ES6ä¸­æ‰©å±•è¿ç®—ç¬¦è®©è¿™ç§æƒ…å†µçœ‹èµ·æ¥æ›´å®¹æ˜“ï¼Œä½ å¯ä»¥ä¼ å…¥æ•°ç»„è¿›å»è€Œä¸æ˜¯ä½¿ç”¨apply(),jså¼•æ“å°†æ•°ç»„æ‹†åˆ†æˆç‹¬ç«‹çš„å‚æ•°ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let values = [25, 50, 75, 100]</span><br><span class="line"></span><br><span class="line">// equivalent to</span><br><span class="line">// console.log(Math.max(25, 50, 75, 100));</span><br><span class="line">console.log(Math.max(...values));      </span><br></pre></td></tr></table></figure>
<p>ç°åœ¨è°ƒç”¨Math.max()çœ‹èµ·æ¥æ›´åŠ çš„æ–¹ä¾¿äº†å¹¶ä¸”é¿å…äº†thisçš„ç»‘å®šï¼ˆè°ƒç”¨Math.max.applyçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ã€‚  </p>
<p>ä½ ä¹Ÿå¯ä»¥å°†å±•å¼€è¿ç®—ç¬¦å’Œå…¶ä»–å‚æ•°æ··ç”¨ã€‚å¦‚æœä½ æƒ³è®©Math.max()è¿”å›çš„æœ€å°å€¼ä¸º0æ—¶ï¼ˆåªæ˜¯é˜²æ­¢è´Ÿæ•°çš„æƒ…å†µï¼‰ã€‚ä½ å¯ä»¥ä¼ å…¥ä¸€ä¸ªå±•å¼€è¿ç®—ç¬¦çš„å‚æ•°å’Œå¦ä¸€ä¸ªå…¶ä»–å‚æ•°ï¼Œå…¥ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let values = [-25, -50, -75, -100]</span><br><span class="line"></span><br><span class="line">console.log(Math.max(...values, 0));        // 0</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ä¼ å…¥Math.max()çš„æœ€åå‚æ•°ä¸º0ï¼Œè¿™ä¸ªå‚æ•°æ˜¯åœ¨å±•å¼€è¿ç®—ç¬¦å‚æ•°åçš„å‚æ•°ã€‚</p>
<h3 id="ES6ä¸­nameå±æ€§"><a href="#ES6ä¸­nameå±æ€§" class="headerlink" title="ES6ä¸­nameå±æ€§"></a>ES6ä¸­nameå±æ€§</h3><p>ä»‹äºå¯ä»¥æœ‰ä¸åŒçš„æ–¹æ³•å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¯†åˆ«å‡½æ•°åœ¨jsä¸­å¯èƒ½ä¼šæœ‰äº›æŒ‘æˆ˜ã€‚å¦å¤–åŒ¿åå‡½æ•°è¡¨è¾¾å¼åœ¨æ ˆè½¨è¿¹çš„ç»“æœå¸¸å¸¸éš¾ä»¥è§£è¯»ç›´æ¥å¯¼è‡´äº†debugingæœ‰ç‚¹å›°éš¾ã€‚ç»¼åˆè¿™äº›åŸå› ï¼ŒES6ä¸ºå‡½æ•°æ·»åŠ nameå±æ€§ã€‚  </p>
<h4 id="é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„åå­—"><a href="#é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„åå­—" class="headerlink" title="é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„åå­—"></a>é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„åå­—</h4><p>æ‰€ä»¥çš„å‡½æ•°åœ¨ES6ç¨‹åºä¸­éƒ½å°†æœ‰ä¸€ä¸ªåˆé€‚å€¼çš„nameå±æ€§ï¼Œä¸ºäº†çœ‹çœ‹å®é™…ç¨‹åºä¸­åˆ°åº•å¦‚ä½•ï¼Œçœ‹ä¸‹é¢ç¨‹åºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function doSomething() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var doAnotherThing = function() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">console.log(doSomething.name);          // &quot;doSomething&quot;</span><br><span class="line">console.log(doAnotherThing.name);       // &quot;doAnotherThing&quot;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œdosomthing()æœ‰ä¸€ä¸ªnameå±æ€§ç­‰äºâ€dosomethingâ€å› ä¸ºè¿™æ˜¯ä¸€ä¸ªå‡½æ•°å£°æ˜ï¼ŒåŒ¿åå‡½æ•°è¡¨è¾¾å¼doantherThing()æœ‰ä¸€ä¸ªnameå±æ€§ç­‰äºâ€doAntherThingâ€è¿™æ˜¯å› ä¸ºè¿™æ˜¯è¡¨è¾¾å¼èµ‹äºçš„åå­—ã€‚</p>
<h4 id="ç‰¹æ®Šæƒ…å†µä¸‹çš„nameå±æ€§"><a href="#ç‰¹æ®Šæƒ…å†µä¸‹çš„nameå±æ€§" class="headerlink" title="ç‰¹æ®Šæƒ…å†µä¸‹çš„nameå±æ€§"></a>ç‰¹æ®Šæƒ…å†µä¸‹çš„nameå±æ€§</h4><p>å¯¹äºå‡½æ•°å£°æ˜å’ŒåŒ¿åå‡½æ•°è¡¨è¾¾å¼çš„åå­—æ˜¯å®¹æ˜“æ‰¾åˆ°çš„ï¼ŒES6ä¸ºäº†è®©æ‰€æœ‰çš„å‡½æ•°éƒ½è¦åˆé€‚çš„nameå±æ€§åšäº†æ›´å¤šçš„äº‹ï¼Œçœ‹å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var doSomething = function doSomethingElse() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var person = &#123;</span><br><span class="line">    get firstName() &#123;</span><br><span class="line">        return &quot;Nicholas&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    sayName: function() &#123;</span><br><span class="line">        console.log(this.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(doSomething.name);      // &quot;doSomethingElse&quot;</span><br><span class="line">console.log(person.sayName.name);   // &quot;sayName&quot;</span><br><span class="line"></span><br><span class="line">var descriptor = Object.getOwnPropertyDescriptor(person, &quot;firstName&quot;);</span><br><span class="line">console.log(descriptor.get.name); // &quot;get firstName&quot;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒdoSomething.nameæ˜¯â€doSomethingElseâ€è¿™æ˜¯å› ä¸ºåŒ¿åå‡½æ•°è¡¨è¾¾å¼æ‹¥æœ‰è‡ªå·±çš„åå­—ï¼Œå¹¶ä¸”è¿™ä¸ªåå­—ä¼˜å…ˆäºè¢«èµ‹äºˆå˜é‡çš„åå­—ã€‚person.sayName()çš„nameå±æ€§ä¸ºâ€sayNameâ€,è¿™æ˜¯å› ä¸ºè¿™ä¸ªå€¼æ˜¯åœ¨å­—é¢é‡å¯¹è±¡çš„å€¼ã€‚ç›¸ä¼¼çš„person.sayName()å®é™…ä¸Šæ˜¯ä¸€ä¸ªgetterå‡½æ•°ï¼Œä½†æ˜¯æœ‰ç‚¹ä¸åŒçš„æ˜¯nameå±æ€§ä¸ºâ€get firstNameâ€,setterå‡½æ•°ä¹Ÿä¼šåœ¨å‰é¢æ·»åŠ â€setâ€(ä¸ç®¡æ˜¯setterè¿˜æ˜¯getterå‡½æ•°éƒ½å¿…é¡»ä½¿ç”¨Object.getOwnPropertyDescriptor()æ¥æ£€ç´¢)   </p>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªå…³äºå‡½æ•°nameå±æ€§çš„ç‰¹æ®Šæƒ…å†µï¼Œå½“ä½¿ç”¨bind()åè¿”å›çš„å‡½æ•°å®ƒä»¬çš„nameå±æ€§éƒ½å°†åœ¨å‰é¢åŠ ä¸Šâ€boundâ€å±æ€§ï¼Œå½“å‡½æ•°æ˜¯ä½¿ç”¨Functionæ„é€ å™¨ç”Ÿæˆçš„éƒ½å°†æœ‰ä¸ªâ€anonymousâ€çš„nameå±æ€§ï¼Œå¦‚ä¸‹ä¾‹:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var doSomething = function() &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">console.log(doSomething.bind().name);   // &quot;bound doSomething&quot;</span><br><span class="line"></span><br><span class="line">console.log((new Function()).name);     // &quot;anonymous&quot;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ç»‘å®šå‡½æ•°çš„nameå±æ€§æ€»æ˜¯åœ¨å‰é¢åŠ ä¸Šâ€boundâ€å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ç»‘å®šç‰ˆçš„doSomething() nameå±æ€§ä¸ºâ€bound doSomethingâ€ã€‚</p>
<p>è®°ä½nameçš„å€¼å¯¹äºä»»ä½•å‡½æ•°éƒ½ä¸ä¸€å®šæ˜¯åŒä¸€ä¸ªnameå€¼ã€‚nameå±æ€§æ˜¯è®©ä½ debuggingçš„ï¼Œè€Œä¸æ˜¯ä½¿ç”¨nameçš„å€¼å¾—åˆ°å‡½æ•°çš„å¼•ç”¨ã€‚  </p>
<h4 id="æ¾„æ¸…å‡½æ•°çš„å¤šé‡æ€§"><a href="#æ¾„æ¸…å‡½æ•°çš„å¤šé‡æ€§" class="headerlink" title="æ¾„æ¸…å‡½æ•°çš„å¤šé‡æ€§"></a>æ¾„æ¸…å‡½æ•°çš„å¤šé‡æ€§</h4><p>åœ¨æ—©å…ˆçš„ES5ä¸­å‡½æ•°åœ¨è°ƒç”¨æ—¶æœ‰æ²¡ä½¿ç”¨newå…·æœ‰å¤šé‡æ€§ï¼Œå½“ä½¿ç”¨äº†newè¿™æ—¶å‡½æ•°å†…éƒ¨çš„thiså€¼æ˜¯ä¸€ä¸ªæ–°å¯¹è±¡å¹¶ä¸”é»˜è®¤å°†æ–°å¯¹è±¡è¿”å›ï¼Œå¦‚ä¸‹ä»£ç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function Person(name) &#123;</span><br><span class="line">    this.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var person = new Person(&quot;Nicholas&quot;);</span><br><span class="line">var notAPerson = Person(&quot;Nicholas&quot;);</span><br><span class="line"></span><br><span class="line">console.log(person);        // &quot;[Object object]&quot;</span><br><span class="line">console.log(notAPerson);    // &quot;undefined&quot;</span><br></pre></td></tr></table></figure>
<p>å½“æ²¡æœ‰ä½¿ç”¨newè°ƒç”¨Person()æ—¶åˆ›é€ çš„notPersonå€¼ä¸ºundefined(å¹¶ä¸”åœ¨éä¸¥æ ¼æ¨¡å¼çš„å…¨å±€å¯¹è±¡å˜é‡ä¸Šè®¾ç½®nameå±æ€§)ï¼Œé€šå¸¸åœ¨jsä¸­å‡½æ•°é¦–å­—æ¯å¤§å†™æš—ç¤ºæ˜¯ä¸€ä¸ªç”¨newè°ƒç”¨çš„å‡½æ•°ã€‚è¿™æ ·çš„å¤šé‡æ„ä¹‰è°ƒç”¨åœ¨ES6ä¸­ä¹Ÿåšäº†ç›¸åº”çš„æ”¹å˜ã€‚  </p>
<p>åœ¨jsä¸­å‡½æ•°æ‹¥æœ‰ä¸¤ä¸ªä¸åŒçš„å†…éƒ¨ä¸“ç”¨æ–¹æ³•åˆ†åˆ«æ˜¯ï¼š[[Call]]å’Œ[[Construct]]ã€‚å½“å‡½æ•°è°ƒç”¨æ—¶æ²¡æœ‰ä½¿ç”¨newï¼Œ[[Call]]æ–¹æ³•è¢«æ‰§è¡Œäº†ï¼Œå®ƒçš„è¡¨ç°å½¢å¼ä¸ºå‡½æ•°ä½“å†…éƒ¨ä»£ç æ‰§è¡Œäº†ã€‚å½“ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¶ä½¿ç”¨äº†newï¼Œè¿™æ—¶[[Construct]]æ–¹æ³•è¢«è°ƒç”¨äº†ã€‚æ–¹æ³•[[Counstruct]]è¡¨è¾¾åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œè°ƒç”¨ä¸€ä¸ªæ–°ç›®æ ‡ï¼ŒåŒæ—¶ç”¨thisè®¾ç½®æ–°ç›®æ ‡æ¥æ‰§è¡Œå‡½æ•°ä½“ï¼Œä¸€ä¸ªæ‹¥æœ‰[[Construct]]çš„å‡½æ•°åˆ«å«åšæ„é€ å™¨ã€‚  </p>
<ul>
<li>è®°ä½ä¸æ˜¯æ‰€æœ‰çš„å‡½æ•°æœ‰[[Construct]]æ–¹æ³•ï¼Œæ‰€ä»¥ä¸æ˜¯æ‰€æœ‰å‡½æ•°å¯ä»¥ä½¿ç”¨newè°ƒç”¨ï¼Œåœ¨æ¥ä¸‹æ¥è®¨è®ºçš„ç®­å¤´å‡½æ•°å°±æ²¡æœ‰[[Constuct]]å‡½æ•°ã€‚</li>
</ul>
<h3 id="åœ¨ES5ä¸­ä¸€ä¸ªå‡½æ•°æ˜¯å¦‚ä½•è°ƒç”¨"><a href="#åœ¨ES5ä¸­ä¸€ä¸ªå‡½æ•°æ˜¯å¦‚ä½•è°ƒç”¨" class="headerlink" title="åœ¨ES5ä¸­ä¸€ä¸ªå‡½æ•°æ˜¯å¦‚ä½•è°ƒç”¨"></a>åœ¨ES5ä¸­ä¸€ä¸ªå‡½æ•°æ˜¯å¦‚ä½•è°ƒç”¨</h3><p>åœ¨ES5ä¸­åˆ¤æ–­ä¸€ä¸ªå‡½æ•°æ˜¯å¦æ˜¯ç”¨newè°ƒç”¨æœ€æµè¡Œçš„æ–¹æ³•æ˜¯ä½¿ç”¨instanceofï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function Person(name) &#123;</span><br><span class="line">    if (this instanceof Person) &#123;</span><br><span class="line">        this.name = name;   // using new</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        throw new Error(&quot;You must use new with Person.&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var person = new Person(&quot;Nicholas&quot;);</span><br><span class="line">var notAPerson = Person(&quot;Nicholas&quot;);  // throws error</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œç”¨thisçš„å€¼æ¥æ£€æŸ¥æ˜¯ä¸æ˜¯æ„é€ å™¨çš„å®ä¾‹ï¼Œå¦‚æœæ˜¯ï¼Œä»£ç å°†æ­£å¸¸æ‰§è¡Œï¼Œå¦‚æœthisä¸æ˜¯Personçš„å®ä¾‹å°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¿™æ˜¯å› ä¸º[[Constuct]]æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªPersonå®ä¾‹å¹¶å¤åˆ¶ç»™thisã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•å¹¶ä¸å¯é å› ä¸ºthiså¯ä»¥æ˜¯Personå®ä¾‹å¹¶ä¸”åœ¨ä¸é€‚ç”¨newçš„æƒ…å†µä¸‹ï¼Œå¦‚ä¸‹ä¾‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function Person(name) &#123;</span><br><span class="line">    if (this instanceof Person) &#123;</span><br><span class="line">        this.name = name;   // using new</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        throw new Error(&quot;You must use new with Person.&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var person = new Person(&quot;Nicholas&quot;);</span><br><span class="line">var notAPerson = Person.call(person, &quot;Michael&quot;);    // works!</span><br></pre></td></tr></table></figure>
<p>å½“è°ƒç”¨Person.call()æ—¶ä¼ å…¥personä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¿™æ„å‘³ç€åœ¨Personå‡½æ•°ä½“å†…thisè¢«è®¾ç½®ä¸ºpersonäº†ï¼Œå¯¹äºè¿™ä¸ªå‡½æ•°ï¼Œè¿™æ˜¯æ²¡æœ‰åŠæ³•å»åŒºåˆ†æ˜¯å¦é€‚ç”¨newè°ƒç”¨çš„ã€‚</p>
<h4 id="new-target-å…ƒå±æ€§"><a href="#new-target-å…ƒå±æ€§" class="headerlink" title="new.target å…ƒå±æ€§"></a>new.target å…ƒå±æ€§</h4><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒES6å¼•è¿›new.targetè¿™ä¸ªå…ƒå±æ€§ã€‚åŸå±æ€§æ˜¯å…³äºç›®æ ‡ï¼ˆå¦‚newï¼‰çš„éå¯¹è±¡ä¿¡æ¯ã€‚å½“å‡½æ•°çš„[[Constructor]]æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œnew.targetä¼šè¢«èµ‹äºˆnewæ“ä½œç¬¦ç›®æ ‡å€¼ï¼Œè¿™ä¸ªtargeté€šå¸¸æ˜¯åˆ›å»ºæ–°å®ä¾‹çš„æ„é€ å™¨ï¼Œå¦‚æœ[[call]]è¢«æ‰§è¡Œæ—¶ï¼Œnew.targetä¸ºundefinedã€‚  </p>
<p>è¿™ä¸ªnewçš„å…ƒå±æ€§è®©ä½ å¯ä»¥å®‰å…¨çš„æ£€æŸ¥functionæ˜¯å¦æ˜¯ä½¿ç”¨newè°ƒç”¨çš„å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function Person(name) &#123;</span><br><span class="line">    if (typeof new.target !== &quot;undefined&quot;) &#123;</span><br><span class="line">        this.name = name;   // using new</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        throw new Error(&quot;You must use new with Person.&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var person = new Person(&quot;Nicholas&quot;);</span><br><span class="line">var notAPerson = Person.call(person, &quot;Michael&quot;);    // error!</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ä½¿ç”¨new.targetä»£æ›¿instanceof,å½“æ²¡æœ‰ä½¿ç”¨newè°ƒç”¨Personæ—¶æ„é€ å™¨å°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚  </p>
<p>ä½ ä¹Ÿå¯ä»¥æŒ‡å®šç‰¹æ®Šçš„æ„é€ å™¨å’Œnew.targetè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function Person(name) &#123;</span><br><span class="line">    if (new.target === Person) &#123;</span><br><span class="line">        this.name = name;   // using new</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        throw new Error(&quot;You must use new with Person.&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function AnotherPerson(name) &#123;</span><br><span class="line">    Person.call(this, name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var person = new Person(&quot;Nicholas&quot;);</span><br><span class="line">var anotherPerson = new AnotherPerson(&quot;Nicholas&quot;);  // error!</span><br></pre></td></tr></table></figure>
<ul>
<li>è­¦å‘Šï¼šnew.targetä¸èƒ½å†å‡½æ•°å¤–ä½¿ç”¨ï¼ˆè¯­æ³•é”™è¯¯ï¼‰</li>
</ul>
<h3 id="å—çº§å‡½æ•°"><a href="#å—çº§å‡½æ•°" class="headerlink" title="å—çº§å‡½æ•°"></a>å—çº§å‡½æ•°</h3><p>åœ¨æ—©å…ˆçš„ES3ä¸­å‡½æ•°å£°æ˜åœ¨ä¸€ä¸ªå—çº§é‡Œï¼ˆå—çº§å‡½æ•°ï¼‰æŠ€æœ¯ä¸Šå›å¼•èµ·ä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼Œä½†æ˜¯ä¸æ˜¯æ‰€æœ‰çš„æµè§ˆå™¨éƒ½æ”¯æŒè¿™æ ·çš„è¡Œä¸ºï¼Œä¸å¹¸çš„æ˜¯è¿™ç§è¯­æ³•åœ¨æ¯ä¸ªæµè§ˆé‡Œè¡¨ç°å¾—æœ‰ç‚¹ä¸åŒï¼Œæ‰€ä»¥åœ¨å®è·µä¸­æœ€å¥½æ˜¯é¿å…åœ¨å—çº§ä¸­å£°æ˜å‡½æ•°(æœ€å¥½çš„æ›¿ä»£æ–¹æ³•æ˜¯ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼)ã€‚  </p>
<p>ä¸ºäº†åŒä¸€ä¸ªè¿™ä¸ªè¡Œä¸ºçš„ä¸ä¸€è‡´ï¼Œåœ¨ES5ä¸¥æ ¼æ¨¡å¼ä¸‹å‡½æ•°å£°æ˜å‘ç”Ÿåœ¨å—éƒ½ä¼šå…¥ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">if (true) &#123;</span><br><span class="line"></span><br><span class="line">    // Throws a syntax error in ES5, not so in ES6</span><br><span class="line">    function doSomething() &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ES5ä¸­è¿™ä¸ªä»£ç å°†æŠ›å‡ºä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼Œä½†åœ¨ES6ä¸­å‡½æ•°doSomething()è¢«è®¤ä¸ºä¸€ä¸ªå—çº§å£°æ˜ï¼Œå¹¶ä¸”èƒ½åœ¨ç›¸åŒçš„å—ä¸­è·å–åˆ°å¹¶è°ƒç”¨ã€‚å¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">if (true) &#123;</span><br><span class="line"></span><br><span class="line">    console.log(typeof doSomething);        // &quot;function&quot;</span><br><span class="line"></span><br><span class="line">    function doSomething() &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    doSomething();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(typeof doSomething);            // &quot;undefined&quot;</span><br></pre></td></tr></table></figure>
<p>å—çº§å‡½æ•°åœ¨å®šä¹‰å—ä¸­è¢«æå‡åˆ°å—é¡¶éƒ¨ï¼Œæ‰€ä»¥typeof doSomething è¿”å›â€functionâ€å°½ç®¡è¿™æ˜¯åœ¨å£°æ˜å‡½æ•°å‰çš„ä»£ç ï¼Œä¸€æ—¦ifå—æ‰§è¡Œå®Œæˆï¼ŒdoSomething()å°†ä¸å†å­˜åœ¨ã€‚  </p>
<h4 id="ä½•æ—¶ä½¿ç”¨å—çº§å‡½æ•°"><a href="#ä½•æ—¶ä½¿ç”¨å—çº§å‡½æ•°" class="headerlink" title="ä½•æ—¶ä½¿ç”¨å—çº§å‡½æ•°"></a>ä½•æ—¶ä½¿ç”¨å—çº§å‡½æ•°</h4><p>å—çº§å‡½æ•°å’Œletå‡½æ•°è¡¨è¾¾å¼å¾ˆåƒä¸€æ—¦æ‰§è¡Œæµç¦»å¼€äº†å®šä¹‰å—å­˜å‚¨çš„å†…å®¹å°±å°†ç§»é™¤ï¼Œä¸€ä¸ªå…³é”®ä¸åŒçš„åœ°æ–¹æ˜¯å—çº§å‡½æ•°ä¼šæœ‰å‡½æ•°æå‡ï¼Œä½†æ˜¯ä½¿ç”¨letçš„å‡½æ•°è¡¨è¾¾å¼ä¸ä¼šæå‡ï¼Œå¦‚ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">if (true) &#123;</span><br><span class="line"></span><br><span class="line">    console.log(typeof doSomething);        // throws error</span><br><span class="line"></span><br><span class="line">    let doSomething = function () &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    doSomething();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(typeof doSomething);</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¸­ï¼Œä»£ç åœåœ¨äº†typeof doSomethingæ‰§è¡Œæ—¶ï¼Œè¿™æ˜¯å› ä¸ºletå£°æ˜è¿˜æ²¡æ‰§è¡Œè®©doSomethingåœç•™åœ¨TDZï¼ŒçŸ¥é“è¿™ç‚¹ä¸åŒåï¼Œä½ å°±å¯ä»¥æ ¹æ®æ˜¯å¦éœ€è¦å‡½æ•°æå‡æ˜¯ä½¿ç”¨å—çº§å‡½æ•°å£°æ˜è¿˜æ˜¯ä½¿ç”¨letå£°æ˜å—çº§è¡¨è¾¾å¼ã€‚</p>
<h4 id="éä¸¥æ ¼æ¨¡å¼ä¸‹çš„å—çº§å‡½æ•°"><a href="#éä¸¥æ ¼æ¨¡å¼ä¸‹çš„å—çº§å‡½æ•°" class="headerlink" title="éä¸¥æ ¼æ¨¡å¼ä¸‹çš„å—çº§å‡½æ•°"></a>éä¸¥æ ¼æ¨¡å¼ä¸‹çš„å—çº§å‡½æ•°</h4><p>ES6åŒæ ·å…è®¸å—çº§å‡½æ•°åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ä½¿ç”¨ï¼Œç»ç®¡è¡¨ç°è¡Œä¸ºä¼šç¨æœ‰ä¸ä¸€è‡´ï¼Œå‡½æ•°æå‡ä¸å†æ˜¯åœ¨å—çš„é¡¶éƒ¨ï¼Œè€Œæ˜¯æå‡åˆ°åŒ…å«å‡½æ•°æˆ–å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// ECMAScript 6 behavior</span><br><span class="line">if (true) &#123;</span><br><span class="line"></span><br><span class="line">    console.log(typeof doSomething);        // &quot;function&quot;</span><br><span class="line"></span><br><span class="line">    function doSomething() &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    doSomething();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(typeof doSomething);            // &quot;function&quot;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒdoSomething()è¢«æå‡å…¨å±€ä½œç”¨åŸŸä¸­äº†æ‰€ä»¥åœ¨æ‰§è¡Œå®Œifå—åä»»ç„¶å­˜åœ¨ï¼ŒES6æ ‡å‡†åŒ–äº†è¿™ç§åŸæ¥åœ¨ä¼—å¤šæµè§ˆå™¨ä¸­ä¸å…¼å®¹çš„è¡Œä¸ºï¼Œæ‰€ä»¥åœ¨æ‰€æœ‰çš„ES6è¿è¡Œæ—¶é’Ÿéƒ½å°†è¡¨ç°ä¸€è‡´ã€‚  </p>
<p>å°½ç®¡å—çº§å‡½æ•°æå‡äº†ä½ åœ¨jså£°æ˜å‡½æ•°çš„èƒ½åŠ›ï¼Œä½†æ˜¯ES6ä¹Ÿå¼•è¿›äº†ä¸€ç§å…¨æ–°çš„å‡½æ•°å£°æ˜æ–¹å¼ã€‚  </p>
<h3 id="ç®­å¤´å‡½æ•°"><a href="#ç®­å¤´å‡½æ•°" class="headerlink" title="ç®­å¤´å‡½æ•°"></a>ç®­å¤´å‡½æ•°</h3><p>åœ¨å´­æ–°çš„ES6ä¸­ç®­å¤´å‡½æ•°æ˜¯æœ€æœ‰è¶£çš„éƒ¨åˆ†ä¹‹ä¸€ï¼Œç®­å¤´å‡½æ•°å¦‚å…¶åå­—ä¸€æ ·é€šè¿‡æ–°è¯­æ³•ç®­å¤´â€&#x3D;&gt;â€å®šä¹‰å‡½æ•°ï¼Œä½†æ˜¯ç®­å¤´å‡½æ•°å’ŒåŸæ¥ä¼ ç»Ÿå‡½æ•°æœ‰å¾ˆå¤šé‡è¦çš„ä¸åŒåœ°æ–¹:  </p>
<ul>
<li>__æ²¡æœ‰ this, super, arguments,å’Œ new.target ç»‘å®š__ï¼Œç®­å¤´å‡½æ•°è¿™äº›å€¼æ˜¯ç”±åŒ…å«æœ€è¿‘çš„å®¹å™¨æä¾›ã€‚</li>
<li><strong>ä¸èƒ½ä½¿ç”¨newè°ƒç”¨</strong> ç®­å¤´å‡½æ•°æ²¡æœ‰[[Constuct]]æ–¹æ³•æ‰€ä»¥ä¸èƒ½è¢«å½“åšæ„é€ å™¨ï¼Œå¦‚æœä½¿ç”¨newè°ƒç”¨ç®­å¤´å‡½æ•°å°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</li>
<li><strong>æ²¡æœ‰prototype</strong>  æ—¢ç„¶ä½ ä¸åœ¨è°ƒç”¨ç®­å¤´å‡½æ•°æ—¶ä½¿ç”¨newï¼Œè¿™é‡Œå°±æ²¡è¦å¯¹prototypeçš„éœ€è¦äº†ï¼Œä½¿ç”¨ç®­å¤´å‡½æ•°çš„prototypeå±æ€§å¹¶ä¸å­˜åœ¨ã€‚</li>
<li><strong>ä¸æ”¹å˜thiså€¼</strong> å‡½æ•°å†…éƒ¨çš„thiså€¼åœ¨æ•´ä¸ªå‡½æ•°ç”Ÿå‘½å‘¨æœŸéƒ½å°†ä¸ä¼šæ”¹å˜ã€‚</li>
<li><strong>æ²¡æœ‰argumentå¯¹è±¡</strong>  æ—¢ç„¶ç®­å¤´å‡½æ•°æ²¡æœ‰argumentsç»‘å®šï¼Œä½ å¿…é¡»ä¾èµ–å‘½åå’Œä¸å®šå‚æ•°æ¥è·å–å‡½æ•°çš„å‡½æ•°ã€‚</li>
<li><strong>ä¸æ”¯æŒé‡å¤å‘½åå‚æ•°</strong> ç®­å¤´å‡½æ•°ä¸ç®¡æ˜¯åœ¨ä¸¥æ ¼æˆ–è€…éä¸¥æ ¼æ¨¡å¼éƒ½ä¸æ”¯æŒé‡å¤å‘½åå‚æ•°ï¼Œä¸ä¹‹ç›¸å¯¹çš„æ˜¯éç®­å¤´å‡½æ•°åªæœ‰åœ¨ä¸¥æ ¼æ¨¡å¼æ‰ä¸æ”¯æŒé‡å¤å‘½åå‚æ•°ã€‚</li>
</ul>
<p> äº§ç”Ÿè¿™äº›å·®å¼‚æœ‰ä»¥ä¸‹åŸå› ã€‚é¦–å…ˆthisç»‘å®šæ˜¯jsé”™è¯¯å¸¸è§æ¥æºï¼Œthisåœ¨å‡½æ•°ä½“å†…å¾ˆéš¾è·Ÿè¸ªï¼Œå› æ­¤ä¼šå¯¼è‡´ä¸€äº›æ„æƒ³ä¸åˆ°çš„è¡Œä¸ºï¼Œä½†æ˜¯ç®­å¤´å‡½æ•°æ¶ˆé™¤äº†è¿™ä¸ªç–‘æƒ‘ï¼Œå…¶æ¬¡é€šè¿‡é™åˆ¶ç®­å¤´å‡½æ•°åœ¨æ‰§è¡Œçš„æ—¶å€™å°±ä¸€ä¸ªthiså€¼ï¼Œjså¼•æ“å¯ä»¥æ›´å®¹æ˜“ä¼˜åŒ–è¿™äº›æ“ä½œï¼Œä¸åƒæ™®é€šçš„å‡½æ•°å¯ä»¥ä½œä¸ºæ„é€ å™¨æˆ–è€…å…¶ä»–ä¿®æ”¹ã€‚   </p>
<p> å…¶ä½™çš„ä¸åŒåŒæ ·å¯ä»¥é›†ä¸­åœ¨å‡å°‘å‡½æ•°å†…é”™è¯¯å’Œæ­§ä¹‰ï¼Œé€šè¿‡è¿™æ ·åšjså¼•æ“å¯ä»¥æ›´å¥½çš„ä¼˜åŒ–ç®­å¤´å‡½æ•°ã€‚ </p>
<ul>
<li>note: ç®­å¤´å‡½æ•°åŒæ ·æ‹¥æœ‰nameå±æ€§å¹¶ä¸”éµå¾ªå…¶ä»–å‡½æ•°éµå¾ªçš„è§„åˆ™.</li>
</ul>
<h4 id="ç®­å¤´å‡½æ•°è¯­æ³•"><a href="#ç®­å¤´å‡½æ•°è¯­æ³•" class="headerlink" title="ç®­å¤´å‡½æ•°è¯­æ³•"></a>ç®­å¤´å‡½æ•°è¯­æ³•</h4><p> ç®­å¤´å‡½æ•°çš„ä½¿ç”¨è¯­æ³•æœ‰å¾ˆå¤šç§è¿™äº›éƒ½å–å†³äºä½ æƒ³å®Œæˆä»€ä¹ˆï¼Œæ‰€æœ‰çš„è¯­æ³•éƒ½ä»¥å‡½æ•°å‚æ•°å¼€å§‹ï¼Œç´§æ¥ç€ç®­å¤´ï¼Œæœ€åæ˜¯å‡½æ•°ä½“ã€‚å‡½æ•°å‚æ•°å’Œå‡½æ•°çš„ä½¿ç”¨æ–¹å¼å–å†³äºä½ ä½¿ç”¨çš„ç›®çš„ï¼Œå¦‚ä¸‹ï¼š<br> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> var reflect = value =&gt; value;</span><br><span class="line"></span><br><span class="line">// effectively equivalent to:</span><br><span class="line"></span><br><span class="line">var reflect = function(value) &#123;</span><br><span class="line">    return value;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br> å½“ç®­å¤´å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œå°±ä¸€ä¸ªå‚æ•°æ²¡æœ‰æ›´å¤šçš„è¯­æ³•äº†ï¼Œåœ¨ç®­å¤´çš„åé¢ä¹Ÿæ˜¯å³è¾¹è¡¨è¾¾å¼æ±‚å€¼å¹¶ç«‹å³è¿”å›ï¼Œå°½ç®¡æ²¡æœ‰æ˜ç¡®çš„returnè¯­å¥ï¼Œè¿™ä¸ªç®­å¤´å‡½æ•°å°†è¿”å›ä»¥ç¬¬ä¸€ä¸ªä¼ å…¥çš„å‚æ•°å€¼ã€‚  </p>
<p> å¦‚æœä½ ä¼ å…¥è¶…è¿‡ä¸€ä¸ªå‚æ•°çš„å‚æ•°ï¼Œä½ å¿…é¡»åœ¨å‚æ•°çš„ä¸¤è¾¹åŠ åœ†æ‹¬å·åŒ…ä½å®ƒä»¬ã€‚  </p>
<p> å¦‚æœè¿™ä¸ªç®­å¤´å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œä½ å¿…é¡»ç”¨ä¸€å¯¹åœ†æ‹¬å·åŒ…ä½ä¸€ä¸ªç©ºçš„å£°æ˜ï¼Œå¦‚ä¸‹ï¼š<br> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> var getName = () =&gt; &quot;Nicholas&quot;;</span><br><span class="line"></span><br><span class="line">// effectively equivalent to:</span><br><span class="line"></span><br><span class="line">var getName = function() &#123;</span><br><span class="line">    return &quot;Nicholas&quot;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p> å½“ä½ çš„ç®­å¤´å‡½æ•°å‡½æ•°ä½“åŒ…å«è¶…è¿‡ä¸€ä¸ªè¡¨è¾¾å¼çš„æ—¶å€™ï¼Œä½ å°±éœ€è¦ç”¨ä¸€å¯¹æ‹¬å¼§åŒ…ä½ã€‚<br> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> var sum = (num1, num2) =&gt; &#123;</span><br><span class="line">    return num1 + num2;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// effectively equivalent to:</span><br><span class="line"></span><br><span class="line">var sum = function(num1, num2) &#123;</span><br><span class="line">    return num1 + num2;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br> å¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªä»€ä¹ˆéƒ½ä¸åšçš„ç®­å¤´å‡½æ•°ï¼Œå¦‚ä¸‹ï¼š<br> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> var doNothing = () =&gt; &#123;&#125;;</span><br><span class="line"></span><br><span class="line">// effectively equivalent to:</span><br><span class="line"></span><br><span class="line">var doNothing = function() &#123;&#125;;</span><br></pre></td></tr></table></figure></p>
<p>æ‹¬å¼§é€šå¸¸æ˜¯ç”¨æ¥è¡¨ç¤ºå‡½æ•°ä½“çš„ï¼Œä½†æ˜¯åœ¨ç®­å¤´å‡½æ•°çš„å‡½æ•°ä½“åªæƒ³è¿”å›ä¸€ä¸ªå¯¹è±¡å­—é¢é‡æ—¶å¿…é¡»è¢«åŒ…ä¸€å¯¹åœ†æ‹¬å·é‡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var getTempItem = id =&gt; (&#123; id: id, name: &quot;Temp&quot; &#125;);</span><br><span class="line"></span><br><span class="line">// effectively equivalent to:</span><br><span class="line"></span><br><span class="line">var getTempItem = function(id) &#123;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">        id: id,</span><br><span class="line">        name: &quot;Temp&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å°†å¯¹è±¡å­—é¢é‡ç”¨åœ†æ‹¬å·åŒ…è£¹èµ·æ¥æ˜¯è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ç›´é¢é‡è€Œä¸æ˜¯å‡½æ•°ä½“ã€‚</p>
<h4 id="åˆ›å»ºç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼"><a href="#åˆ›å»ºç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼" class="headerlink" title="åˆ›å»ºç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼"></a>åˆ›å»ºç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼</h4><p>jsä¸­ä¸€ä¸ªå¾ˆä½¿ç”¨å‡½æ•°æµè¡Œçš„æ–¹å¼æ˜¯ç«‹å³æ‰§è¡Œå‡½æ•°(IIFE)ï¼ŒIIFEè®©ä½ å®šä¹‰ä¸€ä¸ªåŒ¿åå‡½æ•°åå¹¶ç«‹å³æ‰§è¡Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¿å­˜ï¼Œå½“ä½ æƒ³åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸå’Œç¨‹åºä¸­çš„å…¶ä»–ä½œç”¨åŸŸç›¸éš”ç¦»æ—¶å°±å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let person = function(name) &#123;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">        getName: function() &#123;</span><br><span class="line">            return name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">&#125;(&quot;Nicholas&quot;);</span><br><span class="line"></span><br><span class="line">console.log(person.getName());      // &quot;Nicholas&quot;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™æ®µä»£ç ä¸­ï¼ŒIIFEè¢«ç”¨ä½œåˆ›å»ºä¸€ä¸ªæ‹¥æœ‰getName()æ–¹æ³•çš„å¯¹è±¡ï¼Œè¿™ä¸ªæ–¹æ³•å°†nameå‚æ•°ä½œä¸ºè¿”å›å€¼ã€‚å®ƒæœ‰æ•ˆçš„å°†nemè®¾ç½®ä¸ºè¿”å›å¯¹è±¡çš„ç§æœ‰å±æ€§ã€‚  </p>
<p>ä½ ä¹Ÿå¯ä»¥ç”¨ç®­å¤´å‡½æ•°å®ŒæˆåŒæ ·çš„äº‹ï¼Œåªè¦ä½ å°†ç®­å¤´å‡½æ•°ç”¨åœ†æ‹¬å·åŒ…è£¹èµ·æ¥ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let person = ((name) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">        getName: function() &#123;</span><br><span class="line">            return name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">&#125;)(&quot;Nicholas&quot;);</span><br><span class="line"></span><br><span class="line">console.log(person.getName());      // &quot;Nicholas&quot;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åœ†æ‹¬å·åªå°†ç®­å¤´å‡½æ•°çš„å®šä¹‰åŒ…è£¹èµ·æ¥ï¼Œå¹¶æ²¡æœ‰åŒ…è£¹(â€œNicholasâ€)ï¼Œè¿™å°±å’Œæ™®é€šå‡½æ•°æœ‰ä¸€äº›ä¸ä¸€æ ·ï¼Œåœ¨æ™®é€šå‡½æ•°é‡Œè¿™é‡Œçš„åœ†æ‹¬å·æ—¢å¯ä»¥åœ¨å‡½æ•°ä½“å¤–ï¼Œä¹Ÿå¯ä»¥å°†ä¼ å‚åŒ…ä½ã€‚  </p>
<h4 id="æ²¡æœ‰thisç»‘å®š"><a href="#æ²¡æœ‰thisç»‘å®š" class="headerlink" title="æ²¡æœ‰thisç»‘å®š"></a>æ²¡æœ‰thisç»‘å®š</h4><p>jsä¸­æœ€å®¹æ˜“å‡ºé”™çš„åœ°æ–¹ä¹‹ä¸€å°±å‡½æ•°å†…éƒ¨thisçš„ç»‘å®šï¼Œå› ä¸ºå•ä¸ªå‡½æ•°thisçš„å€¼ä¾èµ–äºæ‰§è¡Œæ—¶çš„ä¸Šä¸‹åˆç¯å¢ƒï¼ˆå¯¹è±¡ï¼‰ï¼Œå®ƒå¾ˆæœ‰å¯èƒ½çš„ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚ä¸‹ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var PageHandler = &#123;</span><br><span class="line"></span><br><span class="line">    id: &quot;123456&quot;,</span><br><span class="line"></span><br><span class="line">    init: function() &#123;</span><br><span class="line">        document.addEventListener(&quot;click&quot;, function(event) &#123;</span><br><span class="line">            this.doSomething(event.type);     // error</span><br><span class="line">        &#125;, false);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    doSomething: function(type) &#123;</span><br><span class="line">        console.log(&quot;Handling &quot; + type  + &quot; for &quot; + this.id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¸­ï¼Œå¯¹è±¡PageHandlerç”¨æ¥å¤„ç†é¡µé¢ä¸Šçš„äº¤äº’æ•ˆæœï¼Œinit()æ–¹æ³•æ˜¯æ¥åˆå§‹åŒ–äº¤äº’å½“è°ƒç”¨this.dosomething(),ç„¶è€Œè¿™æ®µä»£ç ä¸ä¼šèµ·æ•ˆã€‚   </p>
<p>è°ƒç”¨this.doSomething()æŠ¥é”™ï¼Œæ˜¯å› ä¸ºthisæŒ‡å‘äº‹ä»¶ç›®æ ‡å¯¹è±¡(è¿™æ®µä»£ç æŒ‡å‘document)ï¼Œè€Œä¸æ˜¯PageHandler,å¦‚æœä½ å°è¯•åœ¨documentä¸Šè°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•å°±å°†æŠ¥é”™ã€‚  </p>
<p>ä½ å¯ä»¥é€šè¿‡è°ƒç”¨bind()æ–¹æ³•å°†å‡½æ•°ä¸Šthisçš„å€¼ç»‘å®šåˆ°PageHandlerï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var PageHandler = &#123;</span><br><span class="line"></span><br><span class="line">    id: &quot;123456&quot;,</span><br><span class="line"></span><br><span class="line">    init: function() &#123;</span><br><span class="line">        document.addEventListener(&quot;click&quot;, (function(event) &#123;</span><br><span class="line">            this.doSomething(event.type);     // no error</span><br><span class="line">        &#125;).bind(this), false);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    doSomething: function(type) &#123;</span><br><span class="line">        console.log(&quot;Handling &quot; + type  + &quot; for &quot; + this.id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨è¿™æ®µä»£ç å¯ä»¥å¦‚æœŸå¾…ä¸€æ ·æ‰§è¡Œï¼Œä½†æ˜¯å®ƒçœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ªï¼Œé€šè¿‡è°ƒç”¨bind(this)ä½ å®é™…ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°thiså€¼ç»‘å®šåˆ°ç›®å‰çš„thiså€¼ä¸Šä¹Ÿå°±æ˜¯PageHandlerã€‚ä¸ºäº†é¿å…äº§ç”Ÿè¿™æ®µå¤šä½™çš„ä»£ç ï¼Œç®­å¤´å‡½æ•°æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚  </p>
<p>ç®­å¤´å‡½æ•°æ²¡æœ‰thisç»‘å®šï¼Œè¿™æ„å‘³ç€ç®­å¤´å‡½æ•°thisçš„å€¼åªç”±ä½œç”¨åŸŸé“¾ä¸Šä¸Šæ®µä½œç”¨åŸŸè§‰å®šï¼Œå¦‚æœç®­å¤´å‡½æ•°è¢«ä¸€ä¸ªéç®­å¤´å‡½æ•°åŒ…å«ï¼Œthiså°±å°†å’ŒåŒ…å«å‡½æ•°çš„thisä¸€æ ·ï¼Œå¦åˆ™thisçš„å€¼å°±ç­‰äºå…¨å±€ä½œç”¨ä¸Šthisçš„å€¼ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç”¨ç®­å¤´å‡½æ•°å†™çš„æ–¹æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var PageHandler = &#123;</span><br><span class="line"></span><br><span class="line">    id: &quot;123456&quot;,</span><br><span class="line"></span><br><span class="line">    init: function() &#123;</span><br><span class="line">        document.addEventListener(&quot;click&quot;,</span><br><span class="line">                event =&gt; this.doSomething(event.type), false);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    doSomething: function(type) &#123;</span><br><span class="line">        console.log(&quot;Handling &quot; + type  + &quot; for &quot; + this.id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­ä¸­çš„äº‹ä»¶å¤„ç†æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°è°ƒç”¨this.doSomething()ï¼Œthisçš„å€¼å’Œè°ƒç”¨init()æ–¹æ³•çš„thiså€¼ä¸€æ ·ï¼Œæ‰€ä»¥è¿™ç‰ˆä»£ç å’Œä½¿ç”¨bind(this)çš„ä¸€æ ·ï¼Œå°½ç®¡doSomething()æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œä½†æ˜¯æ•´ä¸ªå‡½æ•°ä½“åªæœ‰ä¸€ä¸ªè¯­å¥ï¼Œä½¿ç”¨è¿™é‡Œå°±æ²¡å¿…è¦ç”¨æ‹¬å¼§ã€‚   </p>
<p>ç®­å¤´å‡½æ•°è¢«è®¾è®¡æˆä¸€æ¬¡æ€§å‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½è¢«newè°ƒç”¨ï¼Œè¿™å°±ä¸ºä»€ä¹ˆç¼ºå°‘prototypeå±æ€§åŸå› äº†ï¼Œå¦‚æœä½ å°è¯•newæ“ä½œç¬¦å’Œç®­å¤´å‡½æ•°ä¸€èµ·ä½¿ç”¨ï¼Œä½ å°†å¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var MyType = () =&gt; &#123;&#125;,</span><br><span class="line">    object = new MyType();  // error - you can&#x27;t use arrow functions with &#x27;new&#x27;</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ç›—ç”¨ newMype()å°†ä¼šå¤±è´¥ï¼Œè¿™æ˜¯å› ä¸ºMyTypeæ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°å› æ­¤æ²¡æœ‰[[Constrcut]]è¡Œä¸ºï¼Œè¿™æ ·çš„è¯jså¼•æ“çŸ¥é“ä¸èƒ½ä½¿ç”¨newè°ƒç”¨ç®­å¤´å‡½æ•°å°±èƒ½æ›´å¥½çš„ä¼˜åŒ–ã€‚</p>
<h4 id="ç®­å¤´å‡½æ•°å’Œæ•°ç»„"><a href="#ç®­å¤´å‡½æ•°å’Œæ•°ç»„" class="headerlink" title="ç®­å¤´å‡½æ•°å’Œæ•°ç»„"></a>ç®­å¤´å‡½æ•°å’Œæ•°ç»„</h4><p>ç®­å¤´å‡½æ•°ç®€æ´çš„è¯­æ³•ä½¿å®ƒåœ¨å¤„ç†æ•°ç»„æ—¶æ›´åŠ ç†æƒ³ï¼Œå¦‚æœä½ æƒ³ç”¨æ™®é€šå‡½æ•°ä¸ºä¸€ä¸ªæ•°ç»„æ’åºï¼Œä½ å¯ä»¥å¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var result = values.sort(function(a, b) &#123;</span><br><span class="line">    return a - b;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ç®­å¤´å‡½æ•°å°†ä¼šæ›´åŠ ç®€æ´ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var result = values.sort((a, b) =&gt; a - b);</span><br></pre></td></tr></table></figure>

<h4 id="æ²¡æœ‰argumentsç»‘å®š"><a href="#æ²¡æœ‰argumentsç»‘å®š" class="headerlink" title="æ²¡æœ‰argumentsç»‘å®š"></a>æ²¡æœ‰argumentsç»‘å®š</h4><p>ç»ç®¡ç®­å¤´å‡½æ•°æ²¡æœ‰å®ƒè‡ªå·±çš„argumentså¯¹è±¡ï¼Œä½†æ˜¯å®ƒå¯ä»¥ä»åŒ…æ¢å®ƒçš„å‡½æ•°é‡Œè·å–åˆ°ä¸€ä¸ªargumentså¯¹è±¡ï¼Œè¿™ä¸ªargumentså¯¹è±¡ä¼šä¸€ç›´å­˜åœ¨ä¸ç®¡ç®­å¤´å‡½æ•°æ˜¯ä¸æ˜¯åæ‰§è¡Œã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function createArrowFunctionReturningFirstArg() &#123;</span><br><span class="line">    return () =&gt; arguments[0];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var arrowFunction = createArrowFunctionReturningFirstArg(5);</span><br><span class="line"></span><br><span class="line">console.log(arrowFunction());       // 5</span><br></pre></td></tr></table></figure>
<p>åœ¨createArrowFunctionReturnFirstArg()é‡Œarguments[0]å€åˆ›å»ºçš„ç®­å¤´å‡½æ•°å¼•ç”¨ï¼Œè¿™ä¸ªå¼•ç”¨åŒ…å«äº†ä¼ å…¥createArrowFunctionReturnFirstArg()çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå½“ç®­å¤´å‡½æ•°åæ‰§è¡Œè¿”å›5,å°½ç®¡ç®­å¤´å‡½æ•°å·²ç»ä¸åœ¨åˆ›å»ºçš„ä¸Šä¸‹æ–‡ä¸­äº†ï¼Œä½†æ˜¯æ ¹æ®ä½œç”¨åŸŸé“¾çš„å…³ç³»ä»»ç„¶å¯ä»¥è®¿é—®åˆ°argmentsã€‚  </p>
<h4 id="è¯†åˆ«ç®­å¤´å‡½æ•°"><a href="#è¯†åˆ«ç®­å¤´å‡½æ•°" class="headerlink" title="è¯†åˆ«ç®­å¤´å‡½æ•°"></a>è¯†åˆ«ç®­å¤´å‡½æ•°</h4><p>å°½ç®¡ç®­å¤´å‡½æ•°ä½¿ç”¨å’Œæ™®é€šå‡½æ•°ä¸åŒçš„è¯­æ³•ï¼Œä½†æ˜¯ä»æ—§æ˜¯å‡½æ•°ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥é¡¹æ™®é€šå‡½æ•°ä¸€æ ·è¯†åˆ«ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var comparator = (a, b) =&gt; a - b;</span><br><span class="line"></span><br><span class="line">console.log(typeof comparator);                 // &quot;function&quot;</span><br><span class="line">console.log(comparator instanceof Function);    // true</span><br></pre></td></tr></table></figure>

<p>ç®­å¤´å‡½æ•°typeofå’Œinstanceofçš„console.log()ç»“æœå’Œæ™®é€šå‡½æ•°çš„ä¸€æ ·ã€‚</p>
<p>åƒå…¶ä»–å‡½æ•°ä¸€æ ·ï¼Œä½ ä¹Ÿå¯ä»¥å¯¹ç®­å¤´å‡½æ•°ä½¿ç”¨call(),apply(),å’Œbind()ï¼Œå°½ç®¡this-bindingå°†ä¸ä¼šå½±å“ï¼Œè¿™é‡Œæœ‰äº›ä¾‹å­:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var sum = (num1, num2) =&gt; num1 + num2;</span><br><span class="line"></span><br><span class="line">console.log(sum.call(null, 1, 2));      // 3</span><br><span class="line">console.log(sum.apply(null, [1, 2]));   // 3</span><br><span class="line"></span><br><span class="line">var boundSum = sum.bind(null, 1, 2);</span><br><span class="line"></span><br><span class="line">console.log(boundSum());                // 3</span><br></pre></td></tr></table></figure>
<p>sum()å‡½æ•°è°ƒç”¨æ—¶ä½¿ç”¨call()å’Œapply()æ¥ä¼ å…¥å‚æ•°ï¼Œè¿™å’Œå…¶ä»–å‡½æ•°ä¸€æ ·ï¼Œbind()æ–¹æ³•çš„ä½¿ç”¨æ–¹æ³•ä¹Ÿå’Œå…¶ä»–å‡½æ•°è°ƒç”¨ä¸€æ ·ã€‚  </p>
<p>ç®­å¤´å‡½æ•°é€‚ç”¨äºåœ¨ä»»ä½•å¯ä»¥ä½¿ç”¨åŒ¿åå‡½æ•°è¡¨è¾¾å¼çš„åœ°æ–¹ï¼Œä¸‹ä¸€éƒ¨åˆ†å°†è¦†ç›–ES6å¦ä¸€ä¸ªé‡è¦çš„æ”¹å˜ï¼Œä½†æ˜¯è¿™ä¸ªæ˜¯å†…éƒ¨çš„ï¼Œå¹¶æ²¡æœ‰æ–°è¯­æ³•ã€‚  </p>
<h4 id="å°¾è°ƒå‡½æ•°ä¼˜åŒ–"><a href="#å°¾è°ƒå‡½æ•°ä¼˜åŒ–" class="headerlink" title="å°¾è°ƒå‡½æ•°ä¼˜åŒ–"></a>å°¾è°ƒå‡½æ•°ä¼˜åŒ–</h4><p>ä¹Ÿè®¸åœ¨ES6çš„å‡½æ•°å˜åŒ–ä¸­æœ€æœ‰è¶£çš„åœ°æ–¹æ˜¯å¼•æ“ä¼˜åŒ–ï¼Œæ‰€è°“çš„å¼•æ“ä¼˜åŒ–å°±å°¾è°ƒå‡½æ•°çš„ä¼˜åŒ–ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function doSomething() &#123;</span><br><span class="line">    return doSomethingElse();   // tail call</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°¾è°ƒå‡½æ•°åœ¨ES5å¤„ç†æ–¹å¼å’Œå…¶ä»–å‡½æ•°è°ƒç”¨å¤„ç†æ–¹å¼ä¸€æ ·ï¼šä¸€ä¸ªæ–°çš„æ ˆå¸§åˆ›å»ºå¹¶åˆ«å‹å…¥å‡½æ•°è°ƒç”¨çš„è°ƒç”¨æ ˆé‡Œï¼Œè¿™æ„å‘³å…ˆå‰æ‰€æœ‰çš„æ ˆå¸§éƒ½ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä½†æ˜¯è¿™æ„å‘³ç€å½“å®¹æ˜“é€ æˆè°ƒç”¨æ ˆè¿‡å¤§çš„é—®é¢˜ã€‚  </p>
<h3 id="å°¾è°ƒå‡½æ•°åŒºåˆ«"><a href="#å°¾è°ƒå‡½æ•°åŒºåˆ«" class="headerlink" title="å°¾è°ƒå‡½æ•°åŒºåˆ«"></a>å°¾è°ƒå‡½æ•°åŒºåˆ«</h3><p>ES6ä¸ºäº†æŸäº›å°¾é€’å½’åœ¨ä¸¥æ ¼æ¨¡å¼(éä¸¥æ ¼æ¨¡å¼ä¸‹çš„å°¾è°ƒç”¨ä¸å˜)ä¸‹å‡å°‘è°ƒç”¨æ ˆçš„ä½“ç§¯é‡‡å–äº†ä¸€å®šä¼˜åŒ–æªæ–½ï¼Œå…·ä½“è€Œè¨€ä¸å†ä¸ºå°¾è°ƒç”¨åˆ›å»ºæ–°çš„æ ˆå¸§ï¼Œå°†å½“å‰æ ˆå¸§æ¸…é™¤ï¼Œå¹¶é‡å¤ä½¿ç”¨ï¼ˆå‰ä½“æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼‰:  </p>
<ul>
<li><ol>
<li>å°¾è°ƒç”¨ä¸éœ€è¦è®¿é—®å½“å‰æ ˆå¸§å˜é‡(æ„å‘³ç€å‡½æ•°ä¸æ˜¯é—­åŒ…)</li>
</ol>
</li>
<li><ol start="2">
<li>å½“å‰å‡½æ•°åœ¨å°¾è°ƒç”¨æ—¶æ²¡æœ‰é™¤äº†returnä»¥å¤–çš„æ“ä½œã€‚</li>
</ol>
</li>
<li><ol start="3">
<li>å½“å‰å‡½æ•°è°ƒç”¨çš„ç»“æœä¸ºå°¾è°ƒç”¨è¿”å›çš„å€¼ã€‚</li>
</ol>
</li>
</ul>
<p>å¦‚ä¸‹ä»£ç å¾ˆå®¹æ˜“æ»¡è¶³è¿™æ‰€æœ‰3æ¡è§„åˆ™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">function doSomething() &#123;</span><br><span class="line">    // optimized</span><br><span class="line">    return doSomethingElse();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‡½æ•°ä¸­ä½¿ç”¨äº†å°¾è°ƒç”¨doSinethingElse(),å¹¶ä¸”ç«‹å³è¿”å›ç»“æœï¼Œæ²¡æœ‰å¯¹æœ¬åœ°ä½œç”¨åŸŸä»»ä½•å˜é‡çš„è®¿é—®ï¼Œä¸€ä¸ªå°å°çš„å˜åŒ–ï¼Œå°†ä¸åšä¼˜åŒ–:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">function doSomething() &#123;</span><br><span class="line">    // not optimized - no return</span><br><span class="line">    doSomethingElse();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">function doSomething() &#123;</span><br><span class="line">    // not optimized - must add after returning</span><br><span class="line">    return 1 + doSomethingElse();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">function doSomething() &#123;</span><br><span class="line">    // not optimized - call isn&#x27;t in tail position</span><br><span class="line">    var result = doSomethingElse();</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">function doSomething() &#123;</span><br><span class="line">    var num = 1,</span><br><span class="line">        func = () =&gt; num;</span><br><span class="line"></span><br><span class="line">    // not optimized - function is a closure</span><br><span class="line">    return func();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¦‚ä½•åˆ©ç”¨å°¾è°ƒç”¨ä¼˜åŒ–"><a href="#å¦‚ä½•åˆ©ç”¨å°¾è°ƒç”¨ä¼˜åŒ–" class="headerlink" title="å¦‚ä½•åˆ©ç”¨å°¾è°ƒç”¨ä¼˜åŒ–"></a>å¦‚ä½•åˆ©ç”¨å°¾è°ƒç”¨ä¼˜åŒ–</h4><p>åœ¨å®é™…å·¥ä½œä¸­ï¼Œå°¾è°ƒç”¨ä¼˜åŒ–éƒ½æ˜¯å¹•åå‘ç”Ÿçš„æ‰€ä»¥ä½ ä¸éœ€è¦æƒ³å¤ªå¤šé™¤éä½ è¯•å›¾ä¼˜åŒ–ä¸€ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªæœ€åŸºç¡€çš„ä½¿ç”¨å°¾è°ƒç”¨ä¼˜åŒ–çš„åœ°æ–¹å°±é€’å½’å‡½æ•°ï¼Œè¿™é‡Œä¼˜åŒ–éœ€è¦æå¤§çš„åŠªåŠ›ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function factorial(n) &#123;</span><br><span class="line"></span><br><span class="line">    if (n &lt;= 1) &#123;</span><br><span class="line">        return 1;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line"></span><br><span class="line">        // not optimized - must multiply after returning</span><br><span class="line">        return n * factorial(n - 1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function factorial(n, p = 1) &#123;</span><br><span class="line"></span><br><span class="line">    if (n &lt;= 1) &#123;</span><br><span class="line">        return 1 * p;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        let result = n * p;</span><br><span class="line"></span><br><span class="line">        // optimized</span><br><span class="line">        return factorial(n - 1, result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å‡½æ•°åœ¨ES6ä¸­å¹¶æ²¡æœ‰ç»å†å¤ªå¤šå˜åŒ–ï¼Œä½†æ˜¯ä¸€äº›åˆ—å¢åŠ çš„å˜åŒ–è®©å‡½æ•°æ›´å®¹æ˜“ä½¿ç”¨ã€‚  </p>
<p>å‡½æ•°é»˜è®¤å‚æ•°è®©ä½ åœ¨æŸäº›å‚æ•°æ²¡æœ‰ä¼ å…¥æ—¶æ›´å®¹æ˜“æŒ‡å®šé»˜è®¤å€¼ï¼Œåœ¨ES6ä¹‹å‰æŒ‡å®šé»˜è®¤å‚æ•°å€¼å°†éœ€è¦æ›´å¤šä»£ç æ£€æŸ¥å‚æ•°æ˜¯å¦ä¼ å…¥å¹¶æŒ‡å®šé»˜è®¤å€¼ã€‚  </p>
<p>ä¸å®šå‚æ•°è®©ä½ æŒ‡å®šä¸€ä¸ªæ•°ç»„åŒ…å«æ‰€æœ‰å‰©ä½™å‚æ•°ã€‚ç”¨ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„å°†æ¯”ä½¿ç”¨argumentså¯¹è±¡å°†æ›´åŠ çµæ´»ã€‚  </p>
<p>æ‰©å±•æ“ä½œç¬¦å’Œä¸å®šå‚æ•°æ˜¯ä¸€å¯¹å°ä¼™ä¼´ï¼Œæ‰©å±•æ“ä½œç¬¦è®©ä½ å°†ä¸€ä¸ªæ•°ç»„è½¬æ¢ä¸ºä¸€ç³»åˆ—è°ƒç”¨å‡½æ•°æ—¶çš„å‚æ•°ï¼Œåœ¨ES6ä¹‹å‰è¦è¾¾åˆ°ç›¸åº”çš„æ•ˆæœï¼Œè¦ä¹ˆæ‰‹å·¥æŒ‡å®šæ¯ä¸ªå‚æ•°æˆ–ä½¿ç”¨apply(),ä½†æ˜¯æœ‰äº†æ‰©å±•æ“ä½œç¬¦åä½ å¯ä»¥è½»æ¾çš„å°†æ•°ç»„ä¼ å…¥å‡½æ•°è°ƒç”¨å¹¶ä¸ç”¨æ‹…å¿ƒthisçš„æŒ‡å‘(apply()ä¼šæ”¹å˜thisæŒ‡å‘)ã€‚   </p>
<p>ä¸ºå‡½æ•°æ–°å¢çš„nameå±æ€§å°†å¸®åŠ©ä½ bebuggingå’Œæ±‚å€¼æ—¶æ›´å®¹æ˜“è¯†åˆ«å‡½æ•°ï¼Œå¦å¤–ES6ä¸­æ­£å¼å®šä¹‰äº†å—çº§å‡½æ•°çš„è¡Œä¸ºã€‚</p>
<p>åœ¨ES6ä¸­æ™®é€šå‡½æ•°çš„æ‰§è¡Œè¢«[[Call]]å®šä¹‰ï¼Œå½“å‡½æ•°ç”¨newæ‰§è¡Œçš„è¡Œä¸ºè¢«[[Construct]]å®šä¹‰ã€‚å…ƒå±æ€§new.targetä¹Ÿå…è®¸ä½ çŸ¥é“å‡½æ•°åˆ°åº•æ˜¯æ™®é€šè°ƒç”¨è¿˜æ˜¯newè°ƒç”¨ã€‚  </p>
<p>åœ¨ES6çš„å‡½æ•°ä¸­æœ€å¤§çš„æ”¹å˜å°±æ˜¯ç®­å¤´å‡½æ•°äº†ï¼Œå®ƒè¢«è®¾è®¡æˆä»£æ›¿åŒ¿åå‡½æ•°è¡¨è¾¾å¼ã€‚ç®­å¤´å‡½æ•°æ‹¥æœ‰æ›´åŠ ç®€æ´çš„è¯­æ³•å’Œè¯æ³•ä¸Šthisçš„ç»‘å®šï¼Œå¹¶ä¸”æ²¡æœ‰argumentså¯¹è±¡ã€‚å¦å¤–ç®­å¤´å‡½æ•°ä¸èƒ½æ”¹å˜thisçš„ç»‘å®šï¼Œæ‰€ä»¥ä¸èƒ½è¢«å½“åšå‡½æ•°æ„é€ å™¨&gt;</p>
<p>å°¾è°ƒç”¨ä¼˜åŒ–è®©ä½ åœ¨æŸäº›æƒ…å†µä¸‹ä¿æŒæ›´å°ä½“ç§¯çš„è°ƒç”¨æ ˆï¼Œè¿™ç§ä¼˜åŒ–æ˜¯ç”±jså¼•æ“è‡ªåŠ¨æ‰§è¡Œçš„ï¼Œä½†æ˜¯ä½ å¾—é‡å†™ä½ çš„é€’å½’å‡½æ•°æ‰èƒ½äº«å—åˆ°è¿™ç§ä¼˜åŒ–ã€‚</p>
]]></content>
  </entry>
  <entry>
    <title>ç¬¬äº”ç«  è§£æ„</title>
    <url>/2017/07/25/%E7%AC%AC5%E7%AB%A0%20%E8%A7%A3%E6%9E%84/</url>
    <content><![CDATA[<h3 id="è§£æ„"><a href="#è§£æ„" class="headerlink" title="è§£æ„"></a>è§£æ„</h3><p>å¯¹è±¡å’Œæ•°ç»„å­—é¢é‡æ˜¯jsä¸­æœ€å¸¸ç”¨çš„æ ‡è®°ï¼Œå¹¶ä¸”å¤šäºJSONæ•°æ®æ ¼å¼çš„æµè¡Œå®ƒä»¬æˆä¸ºäº†è¿™é¢è¯­è¨€é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚å¯¹äºå®šä¹‰å¯¹è±¡å’Œæ•°ç»„æ—¶ç›¸å½“å¸¸è§çš„ï¼ŒåŒæ ·ä»è¿™äº›ç»“æ„ä¸­ç³»ç»Ÿçš„å–å‡ºéœ€è¦çš„éƒ¨åˆ†ä¹Ÿæ˜¯åŒæ ·å¸¸è§ã€‚ES6ä¸ºäº†ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹æ·»åŠ äº†destructuringï¼ˆè§£æ„ï¼šå°†å¤§æ•°æ®ç»“æ„åˆ†è§£ä¸ºå¾ˆå¤šå°æ•°æ®ç»“æ„çš„è¿‡ç¨‹ï¼‰ã€‚è¿™ç§ä¸­å°†ä¸ºä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨åœ¨å¯¹è±¡å’Œæ•°ç»„ä¸Šä½¿ç”¨è§£æ„ã€‚  </p>
<span id="more"></span>
<h4 id="ä¸ºä»€ä¹ˆè§£æ„æ˜¯æœ‰ç”¨çš„"><a href="#ä¸ºä»€ä¹ˆè§£æ„æ˜¯æœ‰ç”¨çš„" class="headerlink" title="ä¸ºä»€ä¹ˆè§£æ„æ˜¯æœ‰ç”¨çš„"></a>ä¸ºä»€ä¹ˆè§£æ„æ˜¯æœ‰ç”¨çš„</h4><p>åœ¨ES5å’Œä¹‹å‰ï¼Œä¸ºäº†ä»å¯¹è±¡å’Œæ•°ç»„ä¸­æå–ä¿¡æ¯éœ€è¦å¾ˆå¤šçœ‹èµ·æ¥ä¸€æ ·çš„ä»£ç ï¼Œå¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let options = &#123;</span><br><span class="line">        repeat: true,</span><br><span class="line">        save: false</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">// extract data from the object</span><br><span class="line">let repeat = options.repeat,</span><br><span class="line">    save = options.save;</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¸ºäº†ä»å¯¹è±¡optionsè·å–repeatå’Œsaveå€¼å¹¶å°†ä¹‹ç”¨ä¿å­˜åˆ°åŒåçš„æœ¬åœ°å˜é‡ï¼Œè™½ç„¶è¿™æ®µä»£ç çœ‹èµ·ç®€å•ä½†æ˜¯æƒ³è±¡ä¸‹å¦‚æœä½ æœ‰å¾ˆå¤šå˜é‡éœ€è¦èµ‹å€¼ï¼Œä½ éœ€è¦ä¸€ä¸ªä¸€ä¸ªèµ‹å€¼.å¹¶ä¸”å¦‚æœè¿™æ˜¯ä¸€ä¸ªæ··ä¹±çš„æ•°æ®ç»“æ„ä½ éœ€è¦ä¸ºäº†ä¸€ç‚¹æ•°æ®è€Œéå†æ•´ä¸ªæ•°æ®ç»“æ„ã€‚  </p>
<h3 id="å¯¹è±¡è§£æ„"><a href="#å¯¹è±¡è§£æ„" class="headerlink" title="å¯¹è±¡è§£æ„"></a>å¯¹è±¡è§£æ„</h3><p>å¯¹è±¡è§£æ„è¯­æ³•ï¼šç”¨å¯¹è±¡å­—é¢é‡èµ‹å€¼æ“ä½œç¬¦å·¦è¾¹éƒ¨åˆ†è¡¨ç¤ºï¼Œå¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let node = &#123;</span><br><span class="line">    type: &quot;Identifier&quot;,</span><br><span class="line">    name: &quot;foo&quot;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">let &#123;type, name&#125; = node;</span><br><span class="line"></span><br><span class="line">console.log(type); // &quot;Identifier&quot;</span><br><span class="line">console.log(name); // &quot;foo&quot;</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¸­node.typeå’Œnode.nameçš„å€¼åˆ†åˆ«å­˜åœ¨äº†typeå’Œnameä¸­ï¼Œè¿™ä¸ªè¯­æ³•å’Œç¬¬4ç« ä¸­ä»‹ç»çš„å¯¹è±¡å­—é¢é‡åˆå§‹åŒ–é€Ÿè®°ä¸€æ ·ã€‚æ ‡è¯†ç¬¦typeå’Œnameå£°æ˜ä¸ºæœ¬åœ°å˜é‡å¹¶ä»nodeå¯¹è±¡ä¸­è¯»å–å€¼ã€‚</p>
<ul>
<li>noteï¼šåœ¨ä½¿ç”¨è§£æ„å£°æ˜å˜é‡ï¼ˆvar let constï¼‰éƒ½å¿…é¡»æä¾›ä¸€ä¸ªåˆå§‹åŒ–å€¼ï¼ˆç­‰å·å³è¾¹ï¼‰</li>
</ul>
<h4 id="è§£æ„èµ‹å€¼"><a href="#è§£æ„èµ‹å€¼" class="headerlink" title="è§£æ„èµ‹å€¼"></a>è§£æ„èµ‹å€¼</h4><p>åˆ°ç›®å‰ä¸ºæ­¢å¯¹è±¡è§£æ„éƒ½æ˜¯åœ¨å˜é‡å£°æ˜ä¸Šï¼Œä½†æ˜¯åœ¨èµ‹å€¼ä¸­ä¹Ÿå¯ä»¥ç”¨è§£æ„ï¼Œå¦‚ä¸‹ï¼Œå½“ä½ åœ¨å˜é‡å®šä¹‰åæƒ³é‡æ–°èµ‹å€¼æ—¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let node = &#123;</span><br><span class="line">    type: &quot;Identifier&quot;,</span><br><span class="line">    name: &quot;foo&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    type = &quot;Literal&quot;,</span><br><span class="line">    name = 5;</span><br><span class="line"></span><br><span class="line">    // assign different values using destructuring</span><br><span class="line">    (&#123; type, name &#125; = node);</span><br><span class="line"></span><br><span class="line">    console.log(type);      // &quot;Identifier&quot;</span><br><span class="line">    console.log(name);      // &quot;foo&quot;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡nodeä¸­typeå’Œnameåœ¨å£°æ˜çš„åŒæ—¶èµ‹å€¼åˆå§‹åŒ–ï¼ŒåŒæ—¶ä¸¤ä¸ªåŒåå˜é‡typeå’Œnameå£°æ˜å¹¶èµ‹å€¼åˆå§‹åŒ–ã€‚ä¸‹ä¸€è¡Œä»£ç ä¸­åˆ©ç”¨è§£æ„å˜é‡ä»nodeå¯¹è±¡ä¸­è¯»å–ç›¸åº”çš„å€¼ï¼Œæ³¨æ„ä½ å¿…é¡»åœ¨è§£æ„èµ‹å€¼è¯­å¥ä¸¤æ­¥åŠ å›­æ‹¬å·ã€‚è¿™æ˜¯å› ä¸ºèŠ±æ‹¬å·ä¸€èˆ¬æœŸå¾…ä¸ºä¸€ä¸ªå—çº§è¯­å¥ï¼ŒåŒæ—¶å—çº§è¯­å¥æ˜¯ä¸èƒ½å‡ºç°åœ¨èµ‹å€¼è¯­å¥å·¦è¾¹çš„ã€‚åŠ ä¸Šåœ†æ‹¬å·åçš„èŠ±æ‹¬å·è¡¨ç¤ºä¸åº”è¯¥è§£é‡Šä¸ºå—çº§è¯­å¥è€Œåº”è¯¥è§£é‡Šä¸ºè¡¨è¾¾å¼ã€‚</p>
<p>ä¸€ä¸ªè§£æ„èµ‹å€¼è¡¨è¾¾å¼çš„æ±‚å€¼ç»“æœä¸ºè¡¨è¾¾å¼å³è¾¹(&#x3D;å·çš„åé¢)ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨ä»»ä½•éœ€è¦ä½¿ç”¨è§£æ„èµ‹å€¼è¡¨è¾¾å¼æ±‚å€¼ç»“æœçš„åœ°æ–¹åœ°æ–¹ä½¿ç”¨ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let node = &#123;</span><br><span class="line">        type: &quot;Identifier&quot;,</span><br><span class="line">        name: &quot;foo&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    type = &quot;Literal&quot;,</span><br><span class="line">    name = 5;</span><br><span class="line"></span><br><span class="line">function outputInfo(value) &#123;</span><br><span class="line">    console.log(value === node);        // true</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">outputInfo(&#123; type, name &#125; = node);</span><br><span class="line"></span><br><span class="line">console.log(type);      // &quot;Identifier&quot;</span><br><span class="line">console.log(name);      // &quot;foo&quot;</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨å‡½æ•°uptpuInfo()æ—¶ä¼ å…¥äº†ä¸€ä¸ªè§£æ„èµ‹å€¼è¡¨è¾¾å¼ã€‚è¿™ä¸ªè¡¨è¾¾å¼æ±‚å€¼ç»“æœä¸ºnodeï¼ŒåŒæ—¶typeå’Œnameéƒ½è¢«èµ‹å€¼ã€‚</p>
<ul>
<li>warningï¼š å¦‚æœè§£æ„èµ‹å€¼è¡¨è¾¾å¼çš„(&#x3D;å·åé¢çš„è¡¨è¾¾å¼)å³è¾¹æ±‚å€¼ä¸ºnullæˆ–è€…undefinedåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºä»»ä½•å°è¯•åœ¨nullæˆ–è€…undefinedè¯»å–å±æ€§éƒ½å°†æŠ›å‡ºä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ã€‚</li>
</ul>
<h4 id="é»˜è®¤å€¼"><a href="#é»˜è®¤å€¼" class="headerlink" title="é»˜è®¤å€¼"></a>é»˜è®¤å€¼</h4><p>å½“ä½ åœ¨ä½¿ç”¨è§£æ„èµ‹å€¼è¯­å¥æ—¶ï¼Œä½ æŒ‡å®šçš„æœ¬åœ°å˜é‡åœ¨å¯¹è±¡ä¸Šå¹¶ä¸å­˜åœ¨åŒåå±æ€§æ—¶ï¼Œæœ¬åœ°å˜é‡ä¼šè¢«èµ‹å€¼ä¸ºundefined,å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let node = &#123;</span><br><span class="line">        type: &quot;Identifier&quot;,</span><br><span class="line">        name: &quot;foo&quot;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">let &#123; type, name, value &#125; = node;</span><br><span class="line"></span><br><span class="line">console.log(type);      // &quot;Identifier&quot;</span><br><span class="line">console.log(name);      // &quot;foo&quot;</span><br><span class="line">console.log(value);     // undefined</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µå•é¢å®šä¹‰äº†ä¸€ä¸ªå¤šä½™çš„æœ¬åœ°å˜é‡valueå¹¶ä¸”å°è¯•èµ‹å€¼ï¼Œä½†æ˜¯åœ¨nodeä¸Šå¹¶æ²¡æœ‰å¯¹åº”çš„valueå±æ€§ï¼Œæ‰€ä»¥æœ€ç»ˆè¢«èµ‹å€¼ä¸ºundefinedã€‚  </p>
<p>ä½ å¯ä»¥é€‰æ‹©æ€§çš„ä¸ºç‰¹å®šä¸å­˜åœ¨çš„å±æ€§æ·»åŠ é»˜è®¤å€¼ï¼Œä½ åªéœ€è¦åœ¨æŒ‡å®šå±æ€§ååé¢åŠ ä¸Š&#x3D;å’Œç›¸åº”çš„é»˜è®¤å€¼ï¼Œå¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let node = &#123;</span><br><span class="line">        type: &quot;Identifier&quot;,</span><br><span class="line">        name: &quot;foo&quot;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">let &#123; type, name, value = true &#125; = node;</span><br><span class="line"></span><br><span class="line">console.log(type);      // &quot;Identifier&quot;</span><br><span class="line">console.log(name);      // &quot;foo&quot;</span><br><span class="line">console.log(value);     // true</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™æ®µä¾‹å­ä¸­ï¼Œå˜é‡valueè¢«èµ‹äºˆäº†trueçš„é»˜è®¤å€¼ï¼Œé»˜è®¤å€¼åªæœ‰åœ¨nodeä¸Šæ²¡æœ‰å¯¹åº”å±æ€§æˆ–è€…å±æ€§å€¼ä¸ºundefinedæ—¶èµ·æ•ˆï¼Œè¿™ä¸ªå’Œç¬¬ä¸‰ç« ä¸­å‡½æ•°çš„é»˜è®¤å‚æ•°ç›¸ä¼¼ã€‚</p>
<h4 id="èµ‹äºˆä¸åŒçš„æœ¬åœ°å˜é‡å"><a href="#èµ‹äºˆä¸åŒçš„æœ¬åœ°å˜é‡å" class="headerlink" title="èµ‹äºˆä¸åŒçš„æœ¬åœ°å˜é‡å"></a>èµ‹äºˆä¸åŒçš„æœ¬åœ°å˜é‡å</h4><p>ç›®å‰ä¸ºæ­¢ï¼Œæ¯ä¸ªè§£æ„èµ‹å€¼éƒ½æ˜¯åˆ©ç”¨çš„å¯¹è±¡å±æ€§åå’Œæœ¬åœ°å˜é‡åç›¸åŒçš„æ¡ä»¶ï¼Œä½†æ˜¯ES6å…è®¸ä½ ä½¿ç”¨ä¸åŒåå­—æ¥èµ‹å€¼ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let node = &#123;</span><br><span class="line">        type: &quot;Identifier&quot;,</span><br><span class="line">        name: &quot;foo&quot;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">let &#123; type: localType, name: localName &#125; = node;</span><br><span class="line"></span><br><span class="line">console.log(localType);     // &quot;Identifier&quot;</span><br><span class="line">console.log(localName);     // &quot;foo&quot;</span><br></pre></td></tr></table></figure>
<h4 id="æ•°ç»„è§£æ„"><a href="#æ•°ç»„è§£æ„" class="headerlink" title="æ•°ç»„è§£æ„"></a>æ•°ç»„è§£æ„</h4><p>æ•°ç»„è§£æ„è¯­æ³•ä¸å¯¹è±¡è§£æ„è¯­æ³•ç›¸å½“ç›¸ä¼¼ï¼Œå®ƒåªæ˜¯ç”¨æ•°ç»„å­—é¢é‡è¯­æ³•ä»£æ›¿äº†å¯¹è±¡å­—é¢é‡è¯­æ³•è€Œå·²ï¼Œå…·ä½“çš„è§£æ„æ“ä½œç”±æ•°ç»„ä¸­çš„ä½ç½®å†³å®šï¼Œè€Œä¸æ˜¯å¯¹è±¡ä¸­å±æ€§åã€‚å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let colors = [ &quot;red&quot;, &quot;green&quot;, &quot;blue&quot; ];</span><br><span class="line"></span><br><span class="line">let [ firstColor, secondColor ] = colors;</span><br><span class="line"></span><br><span class="line">console.log(firstColor);        // &quot;red&quot;</span><br><span class="line">console.log(secondColor);       // &quot;green&quot;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„æ•°ç»„è§£æ„å°†æ•°ç»„ä¸­â€redâ€å’Œâ€greenâ€å€¼å­˜åœ¨å˜é‡firstColorå’ŒsecondColorä¸Šï¼Œä¹‹æ‰€ä»¥ä¼šè¿™æ ·æ˜¯å› ä¸ºå®ƒä»¬åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œè‡³äºå˜é‡åå­—å¯ä»¥éšä¾¿å–ï¼Œå¦‚æœåœ¨å¯¹åº”ä½ç½®æ²¡æœ‰å“åº”çš„å˜é‡åè§£æ„å°†å¿½ç•¥å®ƒã€‚è®°ä½è§£æ„è¿‡ç¨‹æ˜¯ä¸ä¼šç»™ä¸æ•°ç»„æœ¬èº«ã€‚  </p>
<p>åœ¨æ•°ç»„è§£æ„ä¸­ä½ ä¹Ÿå¯ä»¥çœç•¥æ‰ä½ ä¸æƒ³è¦çš„å€¼åªåœ¨å¯¹åº”ä½ç½®æä¾›ç›¸åº”çš„å˜é‡åï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let colors = [ &quot;red&quot;, &quot;green&quot;, &quot;blue&quot; ];</span><br><span class="line"></span><br><span class="line">let [ , , thirdColor ] = colors;</span><br><span class="line"></span><br><span class="line">console.log(thirdColor);        // &quot;blue&quot;</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç åˆ©ç”¨äº†è§£æ„èµ‹å€¼æ¥è·å–æ•°ç»„(colors)é‡Œçš„ç¬¬ä¸‰é¡¹ã€‚åœ¨thridColorå‰é¢çš„é€—å·éƒ½æ˜¯æ•°ç»„é¡¹çš„å ä½ç¬¦ï¼Œä½ å¯ä»¥è½»æ¾çš„é€‰å‡ºæ•°ç»„ä¸­é—´ä½ç½®çš„å˜é‡è€Œä¸éœ€è¦æä¾›å‰é¢å˜é‡çš„åå­—ã€‚  </p>
<ul>
<li>__warning__ï¼šå’Œå¯¹è±¡è§£æ„ä¸€æ ·ä½ å¿…é¡»ä¸ºåˆå§‹åŒ–å€¼é€šè¿‡varï¼Œletï¼Œconst</li>
</ul>
<h4 id="è§£æ„èµ‹å€¼-1"><a href="#è§£æ„èµ‹å€¼-1" class="headerlink" title="è§£æ„èµ‹å€¼"></a>è§£æ„èµ‹å€¼</h4><p>ä½ ä¹Ÿåˆ©ç”¨è§£æ„æ¥èµ‹å€¼ï¼Œä½†æ˜¯å’Œå¯¹è±¡è§£æ„ä¸ä¸€æ ·çš„æ˜¯ä½ éœ€è¦ä¸ºå˜é‡åŠ ä¸€å±‚å¤§æ‹¬å·ï¼Œå¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let colors = [ &quot;red&quot;, &quot;green&quot;, &quot;blue&quot; ],</span><br><span class="line">    firstColor = &quot;black&quot;,</span><br><span class="line">    secondColor = &quot;purple&quot;;</span><br><span class="line"></span><br><span class="line">[ firstColor, secondColor ] = colors;</span><br><span class="line"></span><br><span class="line">console.log(firstColor);        // &quot;red&quot;</span><br><span class="line">console.log(secondColor);       // &quot;green&quot;</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¸­çš„è§£æ„èµ‹å€¼å’Œå‰ä¸€æ¬¡çš„æ•°ç»„è§£æ„ä¾‹å­ç›¸ä¼¼ï¼Œå”¯ä¸€çš„ä¸åŒæ˜¯firstColorå’ŒsecondColorå…ˆå®šä¹‰ï¼Œå¤§å¤šæ•°è¿™äº›å°±æ˜¯ä½ éœ€è¦çŸ¥é“å…³äºæ•°ç»„è§£æ„çš„ä¸œè¥¿äº†ï¼Œä½†æ˜¯æ›´å¤šçš„æ˜¯ä½ ä¼šå‘ç°çŸ¥é“è¿™äº›å°±å·²ç»å¾ˆæœ‰ç”¨äº†ã€‚  </p>
<p>æ•°ç»„è§£æ„èµ‹å€¼æœ‰ä¸€ä¸ªéå¸¸ç‹¬ç‰¹ç”¨å¤„ï¼Œé‚£å°±æ˜¯äº¤æ¢ä¸¤ä¸ªå˜é‡å€¼ã€‚å€¼çš„äº¤æ¢åœ¨æ’åºç®—æ•°ä¸­æ˜¯ä¸€ç§ç›¸å½“å¸¸è§„çš„æ“ä½œï¼Œåœ¨ES5ä¸­äº¤æ¢ä¸¤ä¸ªå˜é‡å€¼éœ€è¦ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œå¦‚:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Swapping variables in ECMAScript 5</span><br><span class="line">let a = 1,</span><br><span class="line">    b = 2,</span><br><span class="line">    tmp;</span><br><span class="line"></span><br><span class="line">tmp = a;</span><br><span class="line">a = b;</span><br><span class="line">b = tmp;</span><br><span class="line"></span><br><span class="line">console.log(a);     // 2</span><br><span class="line">console.log(b);     // 1</span><br></pre></td></tr></table></figure>
<p>ES5ä¸­äº¤æ¢aå’Œbå€¼ä¸­é—´å˜é‡tmpæ˜¯å¿…ä¸å¯å°‘çš„ï¼Œåˆ©ç”¨è§£æ„èµ‹å€¼å°±ä¸å†éœ€è¦è¿™æ ·çš„é¢å¤–å˜é‡ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Swapping variables in ECMAScript 6</span><br><span class="line">let a = 1,</span><br><span class="line">    b = 2;</span><br><span class="line"></span><br><span class="line">[ a, b ] = [ b, a ];</span><br><span class="line"></span><br><span class="line">console.log(a);     // 2</span><br><span class="line">console.log(b);     // 1</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Warning</strong>: å’Œå¯¹è±¡è§£æ„ç›¸åŒå½“è§£æ„èµ‹å€¼è¡¨è¾¾å¼å³è¾¹æ•°ç»„é¡¹æœ‰æ±‚å€¼ä¸ºnullæˆ–undefinedæ—¶éƒ½å°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</li>
</ul>
<h4 id="é»˜è®¤å€¼-1"><a href="#é»˜è®¤å€¼-1" class="headerlink" title="é»˜è®¤å€¼"></a>é»˜è®¤å€¼</h4><p>æ•°ç»„è§£æ„èµ‹å€¼è¿è¡Œä½ ä¸ºæ•°ç»„ä¸­ä»»ä½•ä½ç½®é¡¹æä¾›é»˜è®¤å€¼ï¼ŒåŒæ ·çš„å½“ç»™å®šçš„ä½ç½®ä¸å­˜åœ¨ï¼Œæˆ–è€…å­˜åœ¨å€¼ä¸ºundefinedæ—¶è¿™ä¸ªé»˜è®¤å€¼è¢«ä½¿ç”¨ï¼Œå¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let colors = [ &quot;red&quot; ];</span><br><span class="line"></span><br><span class="line">let [ firstColor, secondColor = &quot;green&quot; ] = colors;</span><br><span class="line"></span><br><span class="line">console.log(firstColor);        // &quot;red&quot;</span><br><span class="line">console.log(secondColor);       // &quot;green&quot;</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¸­ï¼Œcolorsæ•°ç»„åªæœ‰ä¸€é¡¹ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰ä¸ºsecondColoræ‰€åŒ¹é…é¡¹ï¼Œä½†æ˜¯å› ä¸ºsecondColoræœ‰é»˜è®¤é¡¹ï¼Œæœ€ç»ˆå®ƒçš„å€¼å°±ä¸ºé»˜è®¤é¡¹å€¼ã€‚  </p>
<h4 id="å¤æ‚æ•°ç»„è§£æ„"><a href="#å¤æ‚æ•°ç»„è§£æ„" class="headerlink" title="å¤æ‚æ•°ç»„è§£æ„"></a>å¤æ‚æ•°ç»„è§£æ„</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let colors = [ &quot;red&quot;, [ &quot;green&quot;, &quot;lightgreen&quot; ], &quot;blue&quot; ];</span><br><span class="line"></span><br><span class="line">// later</span><br><span class="line"></span><br><span class="line">let [ firstColor, [ secondColor ] ] = colors;</span><br><span class="line"></span><br><span class="line">console.log(firstColor);        // &quot;red&quot;</span><br><span class="line">console.log(secondColor);       // &quot;green&quot;</span><br></pre></td></tr></table></figure>

<h4 id="ä¸å®šé¡¹æ•°ç»„è§£æ„"><a href="#ä¸å®šé¡¹æ•°ç»„è§£æ„" class="headerlink" title="ä¸å®šé¡¹æ•°ç»„è§£æ„"></a>ä¸å®šé¡¹æ•°ç»„è§£æ„</h4><p>ç¬¬ä¸‰ç« ä¸ºå‡½æ•°å¼•è¿›äº†ä¸å®šå‚æ•°ï¼ŒåŒæ ·æ•°ç»„è§£æ„ä¹Ÿæœ‰ç±»ä¼¼çš„æ¦‚å¿µä¸å®šé¡¹(rest items),ä¸å®šé¡¹ç”¨â€¦åŠ ä¸€ä¸ªå˜é‡åè¯­æ³•è¡¨ç¤ºæ•°ç»„ä¸­å…¶ä½™é¡¹ï¼Œå¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let colors = [ &quot;red&quot;, &quot;green&quot;, &quot;blue&quot; ];</span><br><span class="line"></span><br><span class="line">let [ firstColor, ...restColors ] = colors;</span><br><span class="line"></span><br><span class="line">console.log(firstColor);        // &quot;red&quot;</span><br><span class="line">console.log(restColors.length); // 2</span><br><span class="line">console.log(restColors[0]);     // &quot;green&quot;</span><br><span class="line">console.log(restColors[1]);     // &quot;blue&quot;</span><br></pre></td></tr></table></figure>
<p>colorsä¸­çš„ç¬¬ä¸€é¡¹èµ‹å€¼ç»™firstColorï¼Œç„¶åå…¶ä½™é¡¹èµ‹å€¼ç»™ä¸€ä¸ªæ–°æ•°ç»„restColors.   </p>
<p>jsæ•°ç»„èƒ½åŠ›ä¸­æœ‰ä¸€é¡¹æ˜æ˜¾çš„é—æ¼é‚£å°±æ˜¯å¤åˆ¶ï¼Œåœ¨ES5ä¸­ï¼Œå¼€å‘è€…å¸¸å¸¸ä½¿ç”¨concat()æ–¹æ³•æ¥ä»£æ›¿å¤åˆ¶æ•°ç»„æ–¹æ³•ï¼Œå¦‚ï¼š </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// cloning an array in ECMAScript 5</span><br><span class="line">var colors = [ &quot;red&quot;, &quot;green&quot;, &quot;blue&quot; ];</span><br><span class="line">var clonedColors = colors.concat();</span><br><span class="line"></span><br><span class="line">console.log(clonedColors);      //&quot;[red,green,blue]&quot;</span><br></pre></td></tr></table></figure>
<p>concat()æ–¹æ³•æ„åœ¨å°†ä¸¤ä¸ªæ•°ç»„è¿æ¥ï¼Œå½“è°ƒç”¨æ—¶æ²¡æœ‰ä¼ å‚å°†è¿”å›è°ƒç”¨è€…çš„ä¸€ä»½å¤åˆ¶ï¼Œåœ¨ES6ä¸­ï¼Œåœ¨ES6ä¸­å¯ä»¥ç”¨æ•°æ®ç»“æ„ä¸­çš„ä¸å®šé¡¹åšç›¸åŒçš„äº‹æƒ…ï¼Œå¦‚:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// cloning an array in ECMAScript 6</span><br><span class="line">let colors = [ &quot;red&quot;, &quot;green&quot;, &quot;blue&quot; ];</span><br><span class="line">let [ ...clonedColors ] = colors;</span><br><span class="line"></span><br><span class="line">console.log(clonedColors);      //&quot;[red,green,</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>warning</strong>: ä¸å®šé¡¹åœ¨æ•°ç»„è§£æ„æ—¶å¿…é¡»ä¸ºæœ€åä¸€é¡¹ï¼Œä¸å®šé¡¹åé¢ä¸èƒ½æ·»åŠ é€—å·å¦‚æœæœ‰å°†æŠ¥é”™ã€‚</li>
</ul>
<h3 id="æ··åˆè§£æ„"><a href="#æ··åˆè§£æ„" class="headerlink" title="æ··åˆè§£æ„"></a>æ··åˆè§£æ„</h3><p> å¯¹è±¡å’Œæ•°ç»„è§£æ„å¯ä»¥ä¸€èµ·ä½¿ç”¨ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ä»ä¸€ä¸ªå¯¹è±¡æ•°ç»„ç›¸äº’åµŒå¥—çš„è§£æ„ä¸­æå–æƒ³è¦çš„å€¼ã€‚å¦‚ï¼š<br> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> let node = &#123;</span><br><span class="line">        type: &quot;Identifier&quot;,</span><br><span class="line">        name: &quot;foo&quot;,</span><br><span class="line">        loc: &#123;</span><br><span class="line">            start: &#123;</span><br><span class="line">                line: 1,</span><br><span class="line">                column: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            end: &#123;</span><br><span class="line">                line: 1,</span><br><span class="line">                column: 4</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        range: [0, 3]</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">let &#123;</span><br><span class="line">    loc: &#123; start &#125;,</span><br><span class="line">    range: [ startIndex ]</span><br><span class="line">&#125; = node;</span><br><span class="line"></span><br><span class="line">console.log(start.line);        // 1</span><br><span class="line">console.log(start.column);      // 1</span><br><span class="line">console.log(startIndex);        // 0</span><br></pre></td></tr></table></figure><br>è¿™æ®µä»£ç å°†node.loc.startå’Œnode.range[0]çš„å€¼æå–åˆ°å¯¹åº”çš„startå’ŒstartIndexä¸­äº†ï¼Œåˆ©ç”¨è¿™ç§æ··åˆè§£æ„ä½ å°±å¯ä»¥ä»JSONä¸­æå–ä»»ä½•ä½ æƒ³è¦çš„å€¼ã€‚  </p>
<h3 id="è§£æ„å‚æ•°"><a href="#è§£æ„å‚æ•°" class="headerlink" title="è§£æ„å‚æ•°"></a>è§£æ„å‚æ•°</h3><p>è§£æ„æ‹¥æœ‰å¾ˆå¤šæœ‰ç”¨çš„ä½¿ç”¨åœºæ™¯ï¼Œå…¶ä¸­ä¹‹ä¸€å°±ä¸ºå‡½æ•°ä¼ å‚æ—¶.å½“jså‡½æ•°éœ€è¦æ¥å—å¾ˆå¤šå‚æ•°é¡¹æ—¶ï¼Œä¸€ä¸ªå¸¸è§çš„æ¨¡å¼åˆ›å»ºä¸€ä¸ªoptionå¯¹è±¡æ¥æŒ‡å®šè¿™äº›å‚æ•°ï¼Œå¦‚:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// properties on options represent additional parameters</span><br><span class="line">function setCookie(name, value, options) &#123;</span><br><span class="line"></span><br><span class="line">    options = options || &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    let secure = options.secure,</span><br><span class="line">        path = options.path,</span><br><span class="line">        domain = options.domain,</span><br><span class="line">        expires = options.expires;</span><br><span class="line"></span><br><span class="line">    // code to set the cookie</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// third argument maps to options</span><br><span class="line">setCookie(&quot;type&quot;, &quot;js&quot;, &#123;</span><br><span class="line">    secure: true,</span><br><span class="line">    expires: 60000</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>è®¸å¤šçš„jsåº“éƒ½åŒ…å«setCookie()è¿™ä¸ªå‡½æ•°ï¼Œå‡½æ•°nameå’Œvalueå‚æ•°å¿…é€‰ï¼Œä½†æ˜¯secure,path,domain,expireså¯é€‰ï¼Œæ—¢ç„¶è¿™äº›å±æ€§é¡ºåºéƒ½æ²¡æœ‰ä¼˜å…ˆçº§ï¼Œå°†è¿™äº›å±æ€§æ·»åŠ åˆ°ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ä¸Šæ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹æ³•ï¼Œä½†æ˜¯è¿™æ ·ä¸€æ¥ä½ å°±ä¸èƒ½é€šè¿‡çœ‹å‡½æ•°å®šä¹‰çŸ¥é“è¦ä¼ å…¥å“ªäº›å‚æ•°ï¼Œä½ å¿…é¡»çœ‹å‡½æ•°ä½“ã€‚  </p>
<p>è§£æ„å‚æ•°æä¾›äº†ä¸€ä¸ªæ›´å¥½æ›¿ä»£æ–¹æ¡ˆï¼Œè¿™æ ·ä½ å°±å¯ä»¥çœ‹å‡½æ•°å®šä¹‰è€ŒçŸ¥é“è¦ä¼ å“ªäº›å‚æ•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function setCookie(name, value, &#123; secure, path, domain, expires &#125;) &#123;</span><br><span class="line"></span><br><span class="line">    // code to set the cookie</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setCookie(&quot;type&quot;, &quot;js&quot;, &#123;</span><br><span class="line">    secure: true,</span><br><span class="line">    expires: 60000</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="å¿…ä¼ çš„è§£æ„å‚æ•°"><a href="#å¿…ä¼ çš„è§£æ„å‚æ•°" class="headerlink" title="å¿…ä¼ çš„è§£æ„å‚æ•°"></a>å¿…ä¼ çš„è§£æ„å‚æ•°</h4><p>è§£æ„å‚æ•°æœ‰ä¸€ä¸ªå¥‡æ€ªçš„åœ°æ–¹æ˜¯ï¼Œåœ¨ä½¿ç”¨è§£æ„å‚æ•°æ—¶å¦‚æœæ²¡æœ‰æä¾›é»˜è®¤å€¼å’Œè°ƒç”¨æ—¶å¹¶æ²¡ä¼ è§£æ„çš„å¯¹è±¡å°†ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Error!</span><br><span class="line">setCookie(&quot;type&quot;, &quot;js&quot;);</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸‰ä¸ªå‚æ•°ç¼ºå¤±æ—¶ï¼Œå…¶å€¼å¦‚é¢„æƒ³ä¸€æ ·å°†è¢«è®¾ä¸ºundifined,é€ æˆé”™è¯¯çš„åŸå› æ˜¯å› ä¸ºè§£æ„å‚æ•°å®é™…ä¸Šå°±æ˜¯è§£æ„å£°æ˜çš„ç®€å†™ï¼Œå½“è°ƒç”¨setCookie()æ—¶ï¼Œjså¼•æ“å®é™…ä¼šè¿™æ ·åšï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function setCookie(name, value, options) &#123;</span><br><span class="line"></span><br><span class="line">    let &#123; secure, path, domain, expires &#125; = options;</span><br><span class="line"></span><br><span class="line">    // code to set the cookie</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè§£æ„å‚æ•°æ˜¯å¿…é€‰çš„ï¼Œè¿™æ ·çš„è¡Œä¸ºæ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯å¦‚æœä½ çš„è§£æ„å‚æ•°æ—¶å¯é€‰æ—¶ï¼Œä½ å¯ä»¥ä¸ºè§£æ„å‚æ•°æä¾›ä¸€ä¸ªé»˜è®¤å€¼ï¼Œå¦‚:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function setCookie(name, value, &#123; secure, path, domain, expires &#125; = &#123;&#125;) &#123;</span><br><span class="line"></span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="è§£æ„å‚æ•°é»˜è®¤å€¼"><a href="#è§£æ„å‚æ•°é»˜è®¤å€¼" class="headerlink" title="è§£æ„å‚æ•°é»˜è®¤å€¼"></a>è§£æ„å‚æ•°é»˜è®¤å€¼</h4><p>ä½ å¯ä»¥ä¸ºè§£æ„å‚æ•°æŒ‡å®šé»˜è®¤å€¼ï¼Œè¿™å’Œä½ è§£æ„èµ‹å€¼æ—¶å¾ˆåƒã€‚åªéœ€è¦åœ¨å‚æ•°åé¢æ·»åŠ ç­‰å·å’Œç‰¹å®šçš„é»˜è®¤å‚æ•°å€¼ï¼Œå¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function setCookie(name, value,</span><br><span class="line">    &#123;</span><br><span class="line">        secure = false,</span><br><span class="line">        path = &quot;/&quot;,</span><br><span class="line">        domain = &quot;example.com&quot;,</span><br><span class="line">        expires = new Date(Date.now() + 360000000)</span><br><span class="line">    &#125; = &#123;&#125;</span><br><span class="line">) &#123;</span><br><span class="line"></span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>javscript</category>
      </categories>
  </entry>
  <entry>
    <title>this</title>
    <url>/2017/12/05/%E7%AC%AC%E4%B8%89%E7%AB%A0this/</url>
    <content><![CDATA[<ul>
<li>1 <a href="#1">å¯¼è¨€</a></li>
<li>2 <a href="#2">å®šä¹‰</a></li>
<li>3 <a href="#3">å…¨å±€ç¯å¢ƒä¸‹çš„thiså€¼</a></li>
<li>4 <a href="#4">å‡½æ•°ä¸­çš„thiså€¼</a><ul>
<li>1 <a href="#4.1">å¼•ç”¨ç±»å‹</a></li>
<li>2  <a href="#4.2">å‡½æ•°è°ƒç”¨ä¸éå¼•ç”¨ç±»å‹</a></li>
<li>3  <a href="#4.3">å¼•ç”¨ç±»å‹ä¸thisçš„å€¼ä¸ºnull</a></li>
<li>4  <a href="#4.4">æ„é€ å™¨å‡½æ•°ä¸­çš„thiså€¼</a></li>
<li>5  <a href="#4.5">æ‰‹åŠ¨è®¾ç½®å‡½æ•°è°ƒç”¨æ—¶thisçš„å€¼</a><span id="more"></span></li>
</ul>
</li>
</ul>
<h2 id="å¯¼è¨€"><a href="#å¯¼è¨€" class="headerlink" title="å¯¼è¨€"></a><span id="1">å¯¼è¨€</span></h2><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å°†è®¨è®ºæ›´å¤šå’Œ<a href="http://dmitrysoshnikov.com/ecmascript/chapter-1-execution-contexts/">æ‰§è¡Œä¸Šä¸‹æ–‡</a>ç›¸å…³çš„ç»†èŠ‚.è¿™æ¬¡æˆ‘ä»¬è®¨è®ºçš„è¯é¢˜ä¸ºthiså…³é”®å­—.  </p>
<p>å®è·µè¡¨æ˜,thisåœ¨ä¸åŒæ‰§è¡Œä¸Šä¸‹æ–‡çš„å€¼å¸¸å¸¸å¼•èµ·è®¨è®º. </p>
<p>è®¸å¤šçš„å¼€å‘è€…å¸¸å¸¸è®¤ä¸ºå…³é”®å­—thisåœ¨ç¼–ç¨‹è¯­è¨€ä¸­åªå’Œé¢å‘å¯¹è±¡ç¼–ç¨‹ç›¸å…³,ä¹Ÿå°±æ˜¯thisåªæ˜¯æŒ‡å‘ç”±æ„é€ å‡½æ•°åˆ›å»ºçš„å¯¹è±¡.åœ¨ECMAScriptä¸­thisæ¦‚å¿µä¹Ÿçš„ç¡®æ˜¯è¿™æ ·å®ç°äº†ï¼Œä½†æ˜¯å¦‚æˆ‘ä»¬æ‰€è§åˆ°äº†,thiså¹¶ä¸æ­¢æ­¢äºæ–°åˆ›å»ºçš„å¯¹è±¡.  </p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹thiså€¼åœ¨ECMAScriptä¸­çš„å…·ä½“ç»†èŠ‚.  </p>
<h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a><span id="2">å®šä¹‰</span></h2><p>thisæ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡çš„ä¸€ä¸ªå±æ€§.å®ƒæ˜¯ä¸Šä¸‹æ–‡ä»£ç æ‰§è¡Œæ—¶çš„ä¸€ä¸ªç‰¹åˆ«å¯¹è±¡.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">activeExecutionContext = &#123;</span><br><span class="line">    VO: &#123;...&#125;,</span><br><span class="line">    this: thisValue</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡ŒVOæ˜¯<a href="http://dmitrysoshnikov.com/ecmascript/chapter-2-variable-object/">å˜é‡å¯¹è±¡</a>,å®ƒåœ¨æˆ‘ä»¬å…ˆå‰ç« èŠ‚ä¸­æœ‰è®¨è®º.  </p>
<p>thisç›´æ¥å’Œè¿™ä¸ªä¸Šä¸‹æ–‡çš„<a href="http://dmitrysoshnikov.com/ecmascript/chapter-1-execution-contexts/#types-of-executable-code">å¯æ‰§è¡Œä»£ç ç±»å‹</a>ç›¸å…³.å®ƒçš„å€¼åœ¨è¿›å…¥ä¸Šä¸‹æ–‡æ—¶å†³å®š,ä¸”åœ¨ä»£ç è¿è¡Œæ—¶ä¸å¯æ”¹å˜.  </p>
<p>è®©æˆ‘ä»¬ä»”ç»†çœ‹è¿™äº›ä¾‹å­.</p>
<h2 id="åœ¨å…¨å±€ç¯å¢ƒä¸‹thisçš„å€¼"><a href="#åœ¨å…¨å±€ç¯å¢ƒä¸‹thisçš„å€¼" class="headerlink" title="åœ¨å…¨å±€ç¯å¢ƒä¸‹thisçš„å€¼"></a><span id='3'>åœ¨å…¨å±€ç¯å¢ƒä¸‹thisçš„å€¼</span></h2><p>åœ¨è¿™é‡Œæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¶³å¤Ÿç®€å•.åœ¨å…¨å±€ç¯å¢ƒä¸‹,thisçš„å€¼æ€»æ˜¯å…¨å±€å¯¹è±¡æœ¬èº«.å› æ­¤å¯ä»¥ç›´æ¥å¼•ç”¨å®ƒ.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// explicit property definition of</span><br><span class="line">// the global object</span><br><span class="line">this.a = 10; // global.a = 10</span><br><span class="line">console.log(a); // 10</span><br><span class="line"> </span><br><span class="line">// implicit definition via assigning</span><br><span class="line">// to unqualified identifier</span><br><span class="line">b = 20;</span><br><span class="line">console.log(this.b); // 20</span><br><span class="line"> </span><br><span class="line">// also implicit via variable declaration</span><br><span class="line">// because variable object of the global context</span><br><span class="line">// is the global object itself</span><br><span class="line">var c = 30;</span><br><span class="line">console.log(this.c); // 30</span><br></pre></td></tr></table></figure>


<h2 id="åœ¨å‡½æ•°ä¸­thisçš„å€¼"><a href="#åœ¨å‡½æ•°ä¸­thisçš„å€¼" class="headerlink" title="åœ¨å‡½æ•°ä¸­thisçš„å€¼"></a><span id="4">åœ¨å‡½æ•°ä¸­thisçš„å€¼</span></h2><p>å½“thisåœ¨å‡½æ•°ä¸­å°±å˜å¾—æœ‰è¶£äº†,è¿™ç§æƒ…å†µå°†æ›´éš¾å’Œå¼•èµ·æ›´å¤šè®¨è®º.  </p>
<p>thisåœ¨è¿™ç§ä»£ç é‡Œæœ€ä¸»è¦çš„ç‰¹ç‚¹æ˜¯å®ƒçš„å€¼æ˜¯åŠ¨æ€ç»‘å®šåˆ°å‡½æ•°çš„.  </p>
<p>å¦‚ä¸Šé¢æ‰€æåˆ°çš„ä¸€æ ·,thiså€¼æ˜¯åœ¨è¿›å…¥ä¸Šä¸‹æ–‡æ—¶å†³å®šçš„.å¹¶ä¸”åœ¨å‡½æ•°ä»£ç ä¸­thiså€¼å¯ä»¥æ¯æ¬¡éƒ½ç»å¯¹ä¸ä¸€æ ·.  </p>
<p>ä½†æ˜¯,åœ¨è¿è¡Œæ—¶çš„thiså€¼æ˜¯ä¸å˜çš„.i.eä½ ç»å¯¹ä¸å¯èƒ½å¯¹å®ƒèµ‹äºˆä¸€ä¸ªæ–°çš„å€¼,é‚£æ˜¯å› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªå˜é‡å€¼(ç›¸åçš„æ˜¯,åœ¨Pythonä¸­å®ƒè¢«æ˜ç¡®å®šä¹‰ä¸ºselfå¯¹è±¡,ä¸”è¿™ä¸ªå¯¹è±¡å¯ä»¥åœ¨è¿è¡Œæ—¶æ”¹å˜):  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var foo = &#123;x: 10&#125;;</span><br><span class="line"> </span><br><span class="line">var bar = &#123;</span><br><span class="line">  x: 20,</span><br><span class="line">  test: function () &#123;</span><br><span class="line"> </span><br><span class="line">    console.log(this === bar); // true</span><br><span class="line">    console.log(this.x); // 20</span><br><span class="line">     </span><br><span class="line">    this = foo; // error, can&#x27;t change this value</span><br><span class="line">  </span><br><span class="line">    console.log(this.x); // if there wasn&#x27;t an error, then would be 10, not 20</span><br><span class="line"> </span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">// on entering the context this value is</span><br><span class="line">// determined as &quot;bar&quot; object; why so - will</span><br><span class="line">// be discussed below in detail</span><br><span class="line"> </span><br><span class="line">bar.test(); // true, 20</span><br><span class="line"> </span><br><span class="line">foo.test = bar.test;</span><br><span class="line"> </span><br><span class="line">// however here this value will now refer</span><br><span class="line">// to &quot;foo&quot; â€“ even though we&#x27;re calling the same function</span><br><span class="line"> </span><br><span class="line">foo.test(); // false, 10</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥ä»€ä¹ˆæ ·çš„å› ç´ å†³å®šåœ¨å‡½æ•°ä»£ç ä¸­thisçš„å€¼?è¿™é‡Œä¸»è¦æœ‰å‡ ä¸ªå› ç´ .  </p>
<p>é¦–å…ˆ,é€šå¸¸çš„ä¸€ä¸ªå‡½æ•°è°ƒç”¨,thisçš„å€¼ç”±è°ƒç”¨è€…(æ¿€æ´»ä¸Šä¸‹æ–‡çš„ä»£ç )å†³å®š.i.e.åœ¨çˆ¶çº§ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨å‡½æ•°ï¼Œthisçš„å€¼ç”±è°ƒç”¨è¡¨è¾¾å¼çš„å½¢å¼å†³å®š(æ¢å¥è¯è¯´ä¹Ÿæ˜¯å°±å‡½æ•°å¦‚ä½•è¯­æ³•ä¸Šè°ƒç”¨).  </p>
<p>å°†è¿™ä¸ªæ¦‚å¿µè®°ä½å’Œç†è§£æ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸ºåªæœ‰è¿™æ ·ä½ æ‰èƒ½å¯¹thisåœ¨ä»»ä½•ä¸Šä¸‹æ–‡çš„å€¼éƒ½å‡†ç¡®çŸ¥é“. è¿™ä¸ªæ¦‚å¿µå‡†ç¡®çš„è¯´æ˜¯è°ƒç”¨è¡¨è¾¾å¼çš„å½¢å¼(the form of a call expression),i.e.è°ƒç”¨å‡½æ•°çš„æ–¹å¼å½±å“è¿™ä¸ªä¸Šä¸‹æ–‡thiså€¼.  </p>
<p>(æˆ‘ä»¬åœ¨ä¸€äº›jsæ–‡ç« ç”šè‡³ä¹¦ä¸Šçœ‹åˆ°,thisçš„å€¼ä¾èµ–äºå‡½æ•°æ˜¯å¦‚ä½•å®šä¹‰çš„ï¼šå¦‚æœä¸€ä¸ªå…¨å±€å‡½æ•°é‚£ä¹ˆthiså€¼å°±è®¾ç½®ä¸ºå…¨å±€å¯¹è±¡,å¦‚æœå‡½æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•é‚£ä¹ˆthisçš„å€¼æ€»æ˜¯è®¾ç½®ä¸ºè¿™ä¸ªå¯¹è±¡â€“å¤šä¹ˆé”™è¯¯çš„æè¿°).æˆ‘ä»¬ç»§ç»­,æˆ‘ä»¬çœ‹åˆ°ç”šè‡³æ™®é€šå…¨å±€å‡½æ•°é€šè¿‡ä¸åŒå½¢å¼çš„è°ƒç”¨è¡¨è¾¾å¼thisçš„ä¹Ÿä¼šæœ‰ä¸åŒ.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">  console.log(this);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">foo(); // global</span><br><span class="line"> </span><br><span class="line">console.log(foo === foo.prototype.constructor); // true</span><br><span class="line"> </span><br><span class="line">// but with another form of the call expression</span><br><span class="line">// of the same function, this value is different</span><br><span class="line"> </span><br><span class="line">foo.prototype.constructor(); // foo.prototype</span><br></pre></td></tr></table></figure>

<p>è¿™å’Œå¯¹è±¡ä¸Šå®šä¹‰çš„æ–¹æ³•ç›¸ä¼¼ï¼Œthisçš„å€¼ä¸æ€»æ˜¯ä¸ºé‚£ä¸ªå¯¹è±¡: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var foo = &#123;</span><br><span class="line">  bar: function () &#123;</span><br><span class="line">    console.log(this);</span><br><span class="line">    console.log(this === foo);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">foo.bar(); // foo, true</span><br><span class="line"> </span><br><span class="line">var exampleFunc = foo.bar;</span><br><span class="line"> </span><br><span class="line">console.log(exampleFunc === foo.bar); // true</span><br><span class="line"> </span><br><span class="line">// again with another form of the call expression</span><br><span class="line">// of the same function, we have different this value</span><br><span class="line"> </span><br><span class="line">exampleFunc(); // global, false</span><br></pre></td></tr></table></figure>


<p>æ‰€ä»¥è°ƒç”¨è¡¨è¾¾å¼æ˜¯å¦‚ä½•å½±å“thisçš„å€¼?ä¸ºäº†å®Œå…¨çš„ç†è§£å¦‚ä½•å½±å“thiså€¼,æˆ‘ä»¬éœ€è¦äº†è§£ä¸€ç§å†…éƒ¨ç±»å‹â€“ å¼•ç”¨ç±»å‹( Referece type ).  </p>
<h3 id="å¼•ç”¨ç±»å‹"><a href="#å¼•ç”¨ç±»å‹" class="headerlink" title="å¼•ç”¨ç±»å‹"></a><span id="4.1">å¼•ç”¨ç±»å‹</span></h3><p>ç”¨ä¼ªä»£ç è¡¨ç¤ºå¼•ç”¨ç±»å‹å¯ä»¥æŠŠå®ƒå½“æˆä¸€ä¸ªæ‹¥æœ‰ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡:base(i.e.å±æ€§æ‰€å±ä¸å¯¹è±¡)å’Œå±æ€§åï¼š  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var valueOfReferenceType = &#123;</span><br><span class="line">  base: &lt;base object&gt;,</span><br><span class="line">  propertyName: &lt;property name&gt;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼šä»ES5å¼€å§‹å¼•ç”¨åŒ…å«å±æ€§å¯ä»¥ä½¿ç”¨â€ä¸¥æ ¼(stirct)â€â€“è¿™ä¸ªæ ‡è¯†å†³å®šå¼•ç”¨æ˜¯å¦åœ¨ä¸¥æ ¼æ¨¡å¼é‡Œæ±‚å€¼.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;use strict&#x27;;</span><br><span class="line"> </span><br><span class="line">// Access foo.</span><br><span class="line">foo;</span><br><span class="line"> </span><br><span class="line">// Reference for `foo`.</span><br><span class="line">const fooReference = &#123;</span><br><span class="line">  base: global,</span><br><span class="line">  propertyName: &#x27;foo&#x27;,</span><br><span class="line">  strict: true,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸ºå¼•ç”¨ç±»å‹(Reference type)çš„å€¼åªæœ‰ä¸¤ç§æƒ…å†µä¸­ï¼š</p>
<ul>
<li>1 å½“å¤„ç†ä¸€ä¸ªæ ‡è¯†ç¬¦æ—¶</li>
<li>2 æˆ–è€…å¤„ç†ä¸€ä¸ªå±æ€§è®¿é—®ç¬¦</li>
</ul>
<p>æ ‡è¯†ç¬¦åœ¨æ ‡è¯†ç¬¦æ±‚å€¼è¿‡ç¨‹å†³å®š. ä¸”å…·ä½“å¯ä»¥å‚è€ƒ<a href="http://dmitrysoshnikov.com/ecmascript/chapter-4-scope-chain/">ç¬¬4ç« .ä½œç”¨åŸŸé“¾</a>,æœ€ç»ˆä¼šè¿”å›ä¸€ä¸ªä¸ºå¼•ç”¨ç±»å‹çš„å€¼(å®ƒå¯¹thiså¾ˆé‡è¦).  </p>
<p>æ ‡è¯†ç¬¦æœ‰è¿™äº›ç±»å‹ï¼šå˜é‡å,å‡½æ•°åï¼Œå‡½æ•°å‚æ•°ï¼Œåœ¨å…¨å±€å¯¹è±¡ä¸Šçš„ä¸è§„èŒƒå±æ€§,å¦‚ä¸‹ä¾‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var foo = 10;</span><br><span class="line">function bar() &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>ä½œä¸ºå¤„ç†æ ‡è¯†ç¬¦çš„ä¸­é—´ç»“æœå¼•ç”¨ç±»å‹å€¼,å¦‚ä¸‹:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var fooReference = &#123;</span><br><span class="line">  base: global,</span><br><span class="line">  propertyName: &#x27;foo&#x27;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">var barReference = &#123;</span><br><span class="line">  base: global,</span><br><span class="line">  propertyName: &#x27;bar&#x27;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†ä»å¼•ç”¨ç±»å‹çš„åˆ°å¯¹è±¡çœŸæ­£çš„å€¼ï¼Œè¿˜éœ€è¦ç»è¿‡getValueæ–¹æ³•,ä¼ªä»£ç å¦‚ä¸‹: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function GetValue(value) &#123;</span><br><span class="line"> </span><br><span class="line">  if (Type(value) != Reference) &#123;</span><br><span class="line">    return value;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  var base = GetBase(value);</span><br><span class="line"> </span><br><span class="line">  if (base === null) &#123;</span><br><span class="line">    throw new ReferenceError;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  return base.[[Get]](GetPropertyName(value));</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­çš„å†…éƒ¨æ–¹æ³•[[Get]]è¿”å›è¿™ä¸ªå¯¹è±¡å±æ€§çš„çœŸæ­£å€¼,è¿™å’Œä»åŸå‹é“¾ä¸Šè·å–å±æ€§çš„åˆ†æç›¸åŒ.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GetValue(fooReference); // 10</span><br><span class="line">GetValue(barReference); // function object &quot;bar&quot;</span><br></pre></td></tr></table></figure>

<p>å±æ€§è®¿é—®å™¨ä¹Ÿæœ‰ä¸¤ç§ç±»å‹ï¼šç‚¹æ ‡è®°(å½“æå‰çŸ¥é“å±æ€§åä¸ºä¸€ä¸ªåˆç†çš„æ ‡è¯†ç¬¦åæ—¶),æˆ–è€…æ–¹æ‹¬å·æ ‡è®°:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">foo.bar();</span><br><span class="line">foo[&#x27;bar&#x27;]();</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿”å›çš„ä¸­é—´è®¡ç®—è¿‡ç¨‹ä¸­,æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¹Ÿå¯ä»¥å¾—åˆ°å¼•ç”¨ç±»å‹çš„å€¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var fooBarReference = &#123;</span><br><span class="line">  base: foo,</span><br><span class="line">  propertyName: &#x27;bar&#x27;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">GetValue(fooBarReference); // function object &quot;bar&quot;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥åœ¨å‡½æ•°ä¸Šä¸‹æ–‡ä¸­å¼•ç”¨ç±»å‹æ˜¯å¦‚ä½•ä¸thisçš„å€¼ç›¸å…³è”çš„?â€“é‡è¦çš„æ—¶åˆ»æ¥åˆ°äº†.åœ¨å‡½æ•°ä¸Šä¸‹æ–‡ä¸­thiså€¼çš„ä¸€èˆ¬å‡†ä¿¡è§„åˆ™å¦‚ä¸‹:  </p>
<ul>
<li>åœ¨å‡½æ•°ä¸Šä¸‹æ–‡ä¸­thisçš„å€¼æ˜¯å¤´è°ƒç”¨è€…æä¾›,å¹¶ä¸”ç”±å½“å‰è°ƒç”¨è¡¨è¾¾å¼å½¢å¼å†³å®š(å‡½æ•°æ˜¯å¦‚ä½•è¯­æ³•ä¸Šè°ƒç”¨).</li>
</ul>
<p>å¦‚æœåœ¨è°ƒç”¨åœ†æ‹¬å·(â€¦)çš„å³è¾¹,æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å€¼é‚£ä¹ˆthisçš„å€¼å°±è¢«è®¾å®šä¸ºå¼•ç”¨ç±»å‹çš„baseå¯¹è±¡.  </p>
<p>å‰©ä½™çš„å…¶ä»–æƒ…å†µ(i.e:å’Œå¼•ç”¨ç±»å‹ä¸ä¸€æ ·çš„å€¼),thiså€¼è¢«è®¾ç½®ä¸ºnull.ä½†æ˜¯å› ä¸ºthisçš„å€¼ä¸ºnullæ²¡æœ‰ä»»ä½•é“ç†,æ‰€ä»¥å°±éšå¼è½¬ä¸ºå…¨å±€å¯¹è±¡.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">  return this;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">foo(); // global</span><br></pre></td></tr></table></figure>

<p>åœ¨è°ƒç”¨åœ†æ‹¬å·çš„å·¦è¾¹æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹å€¼(å› ä¸ºfooæ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦):  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var fooReference = &#123;</span><br><span class="line">  base: global,</span><br><span class="line">  propertyName: &#x27;foo&#x27;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å¯¹åº”çš„thiså€¼ä¸ºå¼•ç”¨ç±»å‹çš„beseå¯¹è±¡,type i.e. å…¨å±€å¯¹è±¡.  </p>
<p>å’Œå±æ€§è®¿é—®å™¨ç›¸ä¼¼çš„:   </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var foo = &#123;</span><br><span class="line">  bar: function () &#123;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">foo.bar(); // foo</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬è¿™ä¸ªå¼•ç”¨ç±»å‹å€¼çš„baseå°±æ˜¯fooå¯¹è±¡.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var fooBarReference = &#123;</span><br><span class="line">  base: foo,</span><br><span class="line">  propertyName: &#x27;bar&#x27;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯,å¯¹åŒä¸€ä¸ªå‡½æ•°ç”¨å¦ä¸€è°ƒç”¨è¡¨è¾¾å¼è°ƒç”¨é‚£ä¹ˆthisçš„å€¼å°±ä¸ä¸€æ ·äº†:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var test = foo.bar;</span><br><span class="line">test(); // global</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºtestsæ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦,ä¹Ÿå°±ä¼šäº§ç”Ÿå¦å¤–çš„å¼•ç”¨ç±»å‹,å®ƒçš„baseå¯¹è±¡(å…¨å±€å¯¹è±¡)å°±ä¼šè¢«å½“åšthisçš„å€¼:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var testReference = &#123;</span><br><span class="line">  base: global,</span><br><span class="line">  propertyName: &#x27;test&#x27;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ³¨æ„:åœ¨ES5ä¸­çš„ä¸¥æ ¼æ¨¡å¼,thisçš„å€¼åœ¨ä¸æ˜¯å…¨å±€å¯¹è±¡è€Œæ˜¯undefined</li>
</ul>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å‡†ç¡®çš„çŸ¥é“,ä¸ºä»€ä¹ˆåŒæ ·çš„å‡½æ•°ç”¨ä¸åŒçš„è°ƒç”¨è¡¨è¾¾å¼æ¿€æ´»,æ‹¥æœ‰ä¸åŒçš„thiså€¼â€“ç­”æ¡ˆæ˜¯æœ‰ä¸åŒä¸­é—´å¼•ç”¨ç±»å‹å€¼:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">  console.log(this);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">foo(); // global, because</span><br><span class="line"> </span><br><span class="line">var fooReference = &#123;</span><br><span class="line">  base: global,</span><br><span class="line">  propertyName: &#x27;foo&#x27;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">console.log(foo === foo.prototype.constructor); // true</span><br><span class="line"> </span><br><span class="line">// another form of the call expression</span><br><span class="line"> </span><br><span class="line">foo.prototype.constructor(); // foo.prototype, because</span><br><span class="line"> </span><br><span class="line">var fooPrototypeConstructorReference = &#123;</span><br><span class="line">  base: foo.prototype,</span><br><span class="line">  propertyName: &#x27;constructor&#x27;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–thiså€¼ä¾‹å­:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">  console.log(this.bar);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">var x = &#123;bar: 10&#125;;</span><br><span class="line">var y = &#123;bar: 20&#125;;</span><br><span class="line"> </span><br><span class="line">x.test = foo;</span><br><span class="line">y.test = foo;</span><br><span class="line"> </span><br><span class="line">x.test(); // 10</span><br><span class="line">y.test(); // 20</span><br></pre></td></tr></table></figure>

<h3 id="å‡½æ•°è°ƒç”¨ä¸éå¼•ç”¨ç±»å‹"><a href="#å‡½æ•°è°ƒç”¨ä¸éå¼•ç”¨ç±»å‹" class="headerlink" title="å‡½æ•°è°ƒç”¨ä¸éå¼•ç”¨ç±»å‹"></a><span id="4.2">å‡½æ•°è°ƒç”¨ä¸éå¼•ç”¨ç±»å‹</span></h3><p>å¦‚æˆ‘ä»¬æ‰€æåˆ°çš„,åœ¨è°ƒç”¨åœ†æ‹¬å·çš„å·¦è¾¹ä¸æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹å€¼æ—¶,thisçš„å€¼è‡ªåŠ¨è®¾ç½®ä¸ºnull,å¹¶ä¸”æœ€åè¢«è®¾ç½®ä¸ºå…¨å±€å¯¹è±¡.  </p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢è¡¨è¾¾å¼:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(function () &#123;</span><br><span class="line">  console.log(this); // null =&gt; global</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šé¢çš„æƒ…å†µä¸­,æˆ‘ä»¬çš„å‡½æ•°å¯¹è±¡é‚£ä¸ªä¸æ˜¯å¼•ç”¨ç±»å‹(ä¸æ˜¯æ ‡è¯†ç¬¦ä¹Ÿä¸æ˜¯å±æ€§è®¿é—®å™¨),ç›¸åº”çš„thisçš„å€¼æœ€ç»ˆè¢«è®¾ç½®ä¸ºå…¨å±€å¯¹è±¡.  </p>
<p>çœ‹ä¸€äº›å¤æ‚çš„ä¾‹å­:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var foo = &#123;</span><br><span class="line">  bar: function () &#123;</span><br><span class="line">    console.log(this);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">foo.bar(); // Reference, OK =&gt; foo</span><br><span class="line">(foo.bar)(); // Reference, OK =&gt; foo</span><br><span class="line"> </span><br><span class="line">(foo.bar = foo.bar)(); // global?</span><br><span class="line">(false || foo.bar)(); // global?</span><br><span class="line">(foo.bar, foo.bar)(); // global?</span><br></pre></td></tr></table></figure>

<p>ä¸ºä»€ä¹ˆä¸€ä¸ªå±æ€§è®¿é—®å™¨,åœ¨æŸäº›æ—¶å€™thisçš„å€¼ä¸æ˜¯beseå¯¹è±¡è€Œæ˜¯å…¨å±€å¯¹è±¡?</p>
<p>æœ€åä¸‰ä¸ªè°ƒç”¨,åœ¨è¿›è¡ŒæŸäº›æ“ä½œå,è°ƒç”¨åœ†æ‹¬å·çš„å·¦è¾¹å·²ç»ä¸æ˜¯å¼•ç”¨ç±»å‹äº†.  </p>
<p>ç¬¬ä¸€ä¸ªè°ƒç”¨æ¯”è¾ƒæ˜æ˜¾å°±ä¸è¯´äº†.</p>
<p>ç¬¬äºŒç§æƒ…å†µæœ‰ä¸€ä¸ªåœ†æ‹¬å·è¿ç®—ç¬¦,æ²¡æœ‰ä»€ä¹ˆå‰¯ä½œç”¨,è°ƒç”¨åœ†æ‹¬å·çš„å·¦è¾¹ä»»ç„¶æ˜¯å¼•ç”¨ç±»å‹å€¼,æ‰€ä»¥è¿”å›foo.  </p>
<p>ç¬¬ä¸‰ç§æƒ…å†µä¸­,èµ‹å€¼è¿ç®—ç¬¦ä¸å’Œåœ†æ‹¬å·è¿ç®—ç¬¦ä¸€æ ·,å®ƒä¼šè°ƒç”¨GetValueæ–¹æ³•(<a href="http://bclary.com/2004/11/07/#a-11.13.1">11.13.1</a>çš„ç¬¬ä¸‰æ­¥),è¿”å›ä¸€ä¸ªå‡½æ•°å¯¹è±¡æœ¬èº«(è€Œä¸æ˜¯å¼•ç”¨ç±»å‹å€¼)è¿™æ„å‘³ç€thisçš„å€¼ä¸ºè®¾ç½®ä¸ºnullæœ€ç»ˆè®¾ç½®ä¸ºå…¨å±€.  </p>
<p>å’Œç¬¬å››ç§å’Œç¬¬äº”ç§æƒ…å†µç›¸ä¼¼çš„â€“é€—å·è¿ç®—ç¬¦ä¸é€»è¾‘æˆ–è¡¨è¾¾å¼è°ƒç”¨GetValueæ–¹æ³•,å“åº”çš„ä¼šè¿”å›å‡½æ•°æœ¬èº«å€¼è€Œä¸æ˜¯å¼•ç”¨ç±»å‹å€¼,thisæœ€ç»ˆè®¾ç½®ä¸ºå…¨å±€å¯¹è±¡.  </p>
<h3 id="å¼•ç”¨ç±»å‹ä¸thisçš„å€¼ä¸ºnull"><a href="#å¼•ç”¨ç±»å‹ä¸thisçš„å€¼ä¸ºnull" class="headerlink" title="å¼•ç”¨ç±»å‹ä¸thisçš„å€¼ä¸ºnull"></a><span id="4.3">å¼•ç”¨ç±»å‹ä¸thisçš„å€¼ä¸ºnull</span></h3><p>è¿™é‡Œå­˜åœ¨ä¸€ç§æƒ…å†µï¼šå½“è°ƒç”¨åœ†æ‹¬å·å·¦è¾¹æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹å€¼,ä½†æ˜¯thiså€¼ä»»ç„¶å…¨å±€å¯¹è±¡.è¿™æ˜¯å› ä¸ºå¼•ç”¨ç±»å‹çš„baseå¯¹è±¡ä¸ºä¸€ä¸ª<a href="http://dmitrysoshnikov.com/ecmascript/chapter-2-variable-object/#variable-object-in-function-context">æ¿€æ´»å¯¹è±¡(activation object)</a>.   </p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨å†…éƒ¨å‡½æ•°è°ƒç”¨å‘ç°è¿™ç§æƒ…å†µ,å¦‚æˆ‘ä»¬æ‰€çŸ¥æœ¬åœ°å˜é‡,å†…éƒ¨å‡½æ•°,å½¢å‚éƒ½è¢«å­˜å‚¨åœ¨å‡½æ•°çš„ä¸€ä¸ªæ¿€æ´»å¯¹è±¡ä¸­:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">  function bar() &#123;</span><br><span class="line">    console.log(this); // global</span><br><span class="line">  &#125;</span><br><span class="line">  bar(); // the same as AO.bar()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¿€æ´»å¯¹è±¡è¿”å›thisçš„å€¼æ€»æ˜¯null(i.e.ä¼ªä»£ç AO.bar()ä¸null.bar()ç­‰ä»·).æœ€ç»ˆthiså€¼è¢«è½¬æ¢ä¸ºå…¨å±€å¯¹è±¡.</p>
<p>å¦‚æœåœ¨ä¸€ä¸ªwithè¯­å¥ä¸­,é‚£å°±ä¸ä¸€æ ·äº†. è¿™æ˜¯å› ä¸ºwithè¯­å¥å°†ä¸€ä¸ªå¯¹è±¡æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾çš„å‰ç«¯.i.e.è¿™ä¸ªå¯¹è±¡é‚£ä¸ªåœ¨æ¿€æ´»å¯¹è±¡å‰.æ‰€ä»¥å¯¹åº”æ‹¥æœ‰å¼•ç”¨ç±»å‹å€¼(è¦ä¹ˆé€šè¿‡æ ‡è¯†ç¬¦è¦ä¹ˆé€šè¿‡å±æ€§è®¿é—®å™¨).å®ƒçš„baseå¯¹è±¡å°±ä¸å’Œæ¿€æ´»å¯¹è±¡çš„beseå¯¹è±¡ç›¸åŒäº†.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var x = 10;</span><br><span class="line"> </span><br><span class="line">with (&#123;</span><br><span class="line"> </span><br><span class="line">  foo: function () &#123;</span><br><span class="line">    console.log(this.x);</span><br><span class="line">  &#125;,</span><br><span class="line">  x: 20</span><br><span class="line"> </span><br><span class="line">&#125;) &#123;</span><br><span class="line"> </span><br><span class="line">  foo(); // 20</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// because</span><br><span class="line"> </span><br><span class="line">var  fooReference = &#123;</span><br><span class="line">  base: __withObject,</span><br><span class="line">  propertyName: &#x27;foo&#x27;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å’Œcatchä»å¥ç›¸ä¼¼,ä½†æ˜¯ES5ä¸ES3è¡¨ç°ä¸ä¸€è‡´.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">  throw function () &#123;</span><br><span class="line">    console.log(this);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125; catch (e) &#123;</span><br><span class="line">  e(); // __catchObject - in ES3, global - fixed in ES5</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// on idea</span><br><span class="line"> </span><br><span class="line">var eReference = &#123;</span><br><span class="line">  base: __catchObject,</span><br><span class="line">  propertyName: &#x27;e&#x27;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">// but, as this is a bug</span><br><span class="line">// then this value is forced to global</span><br><span class="line">// null =&gt; global</span><br><span class="line"> </span><br><span class="line">var eReference = &#123;</span><br><span class="line">  base: global,</span><br><span class="line">  propertyName: &#x27;e&#x27;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åŒæ ·çš„ä¹Ÿå‘ç”Ÿåœ¨å…·åå‡½æ•°è¡¨è¾¾å¼é€’å½’è°ƒç”¨ä¸­. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(function foo(bar) &#123;</span><br><span class="line"> </span><br><span class="line">  console.log(this);</span><br><span class="line"> </span><br><span class="line">  !bar &amp;&amp; foo(1); // &quot;should&quot; be special object, but always (correct) global</span><br><span class="line"> </span><br><span class="line">&#125;)(); // global</span><br></pre></td></tr></table></figure>

<h3 id="æ„é€ å™¨å‡½æ•°ä¸­çš„thiså€¼"><a href="#æ„é€ å™¨å‡½æ•°ä¸­çš„thiså€¼" class="headerlink" title="æ„é€ å™¨å‡½æ•°ä¸­çš„thiså€¼"></a><span id="4.4">æ„é€ å™¨å‡½æ•°ä¸­çš„thiså€¼</span></h3><p>å’Œthisç›¸å…³çš„æ›´å¤šæ˜¯åœ¨æ„é€ å‡½æ•°ä¸­thiså€¼.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function A() &#123;</span><br><span class="line">  console.log(this); // newly created object, below - &quot;a&quot; object</span><br><span class="line">  this.x = 10;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">var a = new A();</span><br><span class="line">console.log(a.x); // 10</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ç§æƒ…å†µ,new æ“ä½œç¬¦ä¼šè°ƒç”¨å‡½æ•°å†…éƒ¨æ–¹æ³•[[Construct]],ä¾æ¬¡,åœ¨å¯¹è±¡åˆ›å»ºå¥½å,è°ƒç”¨å†…éƒ¨æ–¹æ³•[[Call]],æ‰€æœ‰Aå‡½æ•°åˆ›å»ºçš„å¯¹è±¡éƒ½æŒ‡å‘this.  </p>
<h3 id="æ‰‹åŠ¨è®¾ç½®å‡½æ•°è°ƒç”¨æ—¶thisçš„å€¼"><a href="#æ‰‹åŠ¨è®¾ç½®å‡½æ•°è°ƒç”¨æ—¶thisçš„å€¼" class="headerlink" title="æ‰‹åŠ¨è®¾ç½®å‡½æ•°è°ƒç”¨æ—¶thisçš„å€¼"></a><span id="4.5">æ‰‹åŠ¨è®¾ç½®å‡½æ•°è°ƒç”¨æ—¶thisçš„å€¼</span></h3><p>åœ¨Function.prototypeå®šä¹‰äº†ä¸¤ä¸ªå¯ä»¥æ”¹å˜thiså€¼çš„æ–¹æ³•ï¼Œcall,apply.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var b = 10;</span><br><span class="line"> </span><br><span class="line">function a(c) &#123;</span><br><span class="line">  console.log(this.b);</span><br><span class="line">  console.log(c);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">a(20); // this === global, this.b == 10, c == 20</span><br><span class="line"> </span><br><span class="line">a.call(&#123;b: 20&#125;, 30); // this === &#123;b: 20&#125;, this.b == 20, c == 30</span><br><span class="line">a.apply(&#123;b: 30&#125;, [40]) // this === &#123;b: 30&#125;, this.b == 30, c == 40</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>javascript</category>
      </categories>
  </entry>
  <entry>
    <title>ç¬¬å››ç«  å¯¹è±¡</title>
    <url>/2017/07/10/%E7%AC%AC4%E7%AB%A0%20%E5%AF%B9%E8%B1%A1/</url>
    <content><![CDATA[<h3 id="å¯¹è±¡åŠŸèƒ½æ‰©å±•"><a href="#å¯¹è±¡åŠŸèƒ½æ‰©å±•" class="headerlink" title="å¯¹è±¡åŠŸèƒ½æ‰©å±•"></a>å¯¹è±¡åŠŸèƒ½æ‰©å±•</h3><p>ES6åœ¨æ”¹è¿›å¯¹è±¡èƒ½åŠ›ä¸ŠèŠ±äº†å¾ˆå¤šçš„åŠŸå¤«ï¼Œè¿™æ˜¯å› ä¸ºåŸºæœ¬å¤§éƒ¨åˆ†jsçš„å€¼éƒ½æ˜¯æŸç§ç±»å‹çš„å¯¹è±¡ï¼Œå¦å¤–éšç€jsåº”ç”¨ç¨‹åºå¤æ‚ç¨‹åº¦çš„æå‡ä»£ç ä¸­å¯¹è±¡æ•°é‡ä¹Ÿéšä¹‹æå‡ã€‚è¿™ä¹Ÿæ„å‘³ç€å¯¹è±¡éœ€è¦æ›´åŠ é«˜æ•ˆçš„ä½¿ç”¨ã€‚  </p>
<p>ES6é€šè¿‡å„ç§æ–¹æ³•æ”¹è¿›å¯¹è±¡ï¼Œä»ç®€å•çš„è¯­æ³•æ‰©å±•å†åˆ°æä¾›æ›´å¤šé€‰æ‹©å¤„ç†å¯¹è±¡ã€‚ </p>
<span id="more"></span> 

<h4 id="å¯¹è±¡ç±»å‹"><a href="#å¯¹è±¡ç±»å‹" class="headerlink" title="å¯¹è±¡ç±»å‹"></a>å¯¹è±¡ç±»å‹</h4><p>jsä½¿ç”¨æ··åˆæœ¯è¯­æ¥æè¿°æ ‡å‡†é‡Œçš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯é€šè¿‡æ‰§è¡Œç¯å¢ƒ(æµè§ˆå™¨ï¼ŒNode.js)æ¥æè¿°ï¼ŒES6è§„æ ¼ä¹¦é‡Œæ˜ç¡®å®šä¹‰äº†æ¯ç§ç±»åˆ«çš„å¯¹è±¡ã€‚å¯¹äºå…¨é¢äº†è§£è¿™é¢è¯­è¨€ç†è§£è¿™äº›æœ¯è¯­æ˜¯ç›¸å½“é‡è¦çš„ï¼Œå¯¹è±¡çš„ç±»åˆ«å¦‚ä¸‹ï¼š</p>
<ul>
<li>__æ™®é€šå¯¹è±¡__æ‹¥æœ‰æ‰€æœ‰åœ¨jsä¸­å†…ç½®é»˜è®¤è¡Œä¸ºçš„å¯¹è±¡ã€‚</li>
<li>__å¤–æ¥å¯¹è±¡__æ‹¥æœ‰å’Œå†…ç½®è¡Œä¸ºå’Œé»˜è®¤è¡Œä¸ºä¸ä¸€è‡´çš„å¯¹è±¡ã€‚</li>
<li>__æ ‡å‡†å¯¹è±¡__å“ªäº›ç”±ES6å®šä¹‰çš„å¯¹è±¡ï¼Œå¦‚Array,Dateç­‰ï¼Œæ ‡å‡†å¯¹è±¡æœ‰å¯èƒ½æ˜¯æ™®é€šå¯¹è±¡ä¹Ÿæœ‰å¯èƒ½æ˜¯å¤–æ¥å¯¹è±¡ã€‚</li>
<li>__å†…ç½®å¯¹è±¡__åœ¨jså¼€å§‹æ‰§è¡Œä¹‹å‰å°±å­˜åœ¨çš„å¯¹è±¡ï¼Œæ‰€æœ‰æ ‡å‡†å¯¹è±¡å¯¹è±¡éƒ½æ˜¯å†…ç½®å¯¹è±¡ã€‚</li>
</ul>
<p>æˆ‘å°†åœ¨æ•´æœ¬ä¹¦é‡Œç”¨è¿™äº›æœ¯è¯­æ¥è§£é‡ŠES6å®šä¹‰çš„å¯¹è±¡</p>
<h4 id="å¯¹è±¡å­—é¢é‡è¯­æ³•æ‰©å±•"><a href="#å¯¹è±¡å­—é¢é‡è¯­æ³•æ‰©å±•" class="headerlink" title="å¯¹è±¡å­—é¢é‡è¯­æ³•æ‰©å±•"></a>å¯¹è±¡å­—é¢é‡è¯­æ³•æ‰©å±•</h4><p>å¯¹è±¡å­—é¢é‡æ˜¯jsä¸­æœ€æµè¡Œçš„æ¨¡å¼ä¹‹ä¸€ï¼ŒJSONå°±æ˜¯åŸºäºå®ƒçš„è¯­æ³•ï¼Œå¹¶ä¸”å‡ ä¹å­˜åœ¨äºæ‰€æœ‰çš„åœ¨å› ç‰¹ç½‘ä¸Šjsæ–‡ä»¶ï¼Œå®ƒæµè¡Œçš„åŸå› åœ¨äºå…¶ç®€æ´åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ã€‚å¹¸è¿çš„æ˜¯ES6é€šè¿‡å„ç§æ‰©å±•è¯­æ³•çš„æ–¹æ³•ä½¿ç”¨å¯¹è±¡å­—é¢é‡æ›´åŠ æœ‰ç”¨ã€‚  </p>
<h4 id="å±æ€§åˆå§‹åŒ–é€Ÿè®°"><a href="#å±æ€§åˆå§‹åŒ–é€Ÿè®°" class="headerlink" title="å±æ€§åˆå§‹åŒ–é€Ÿè®°"></a>å±æ€§åˆå§‹åŒ–é€Ÿè®°</h4><p>åœ¨æ—©å…ˆES5ä¹‹å‰ï¼Œå¯¹è±¡å­—é¢é‡åªæ˜¯ç®€å•çš„name-valueå¯¹é›†åˆï¼Œè¿™æ„å‘³ç€å½“å±æ€§å’Œå€¼åˆå§‹åŒ–æ—¶æœ‰å¯èƒ½é‡å¤ï¼Œå¦‚ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function createPerson(name, age) &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        name: name,</span><br><span class="line">        age: age</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ES6ä¸­ä½ å¯ä»¥é€šè¿‡å±æ€§åˆå§‹åŒ–é€Ÿè®°æ¶ˆé™¤å±æ€§å’Œæœ¬åœ°å˜é‡ã€‚å½“å¯¹è±¡å±æ€§å’Œæœ¬åœ°å±æ€§åŒåæ—¶ï¼Œä½ å¯ä»¥ä»…åŒ…å«åå­—è€Œä¸éœ€è¦å†’å·å’Œå€¼ï¼Œå¦‚ä¾‹createPerson()å¯ä»¥ç”¨ES6çš„æ–¹å¼é‡å†™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function createPerson(name, age)&#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        name, </span><br><span class="line">        age</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“å¯¹è±¡å­—é¢é‡çš„ä¸€ä¸ªå±æ€§åªæœ‰ä¸€ä¸ªåå­—ï¼Œjså¼•æ“å°†åœ¨é™„è¿‘ä½œç”¨åŸŸå¯»æ‰¾ä¸ä¹‹åå­—ç›¸åŒçš„å˜é‡ï¼Œå¦‚æœæ‰¾åˆ°äº†ç›¸åŒåå­—å˜é‡ï¼Œå°†è¿™ä¸ªå˜é‡çš„å€¼èµ‹ç»™å­—é¢é‡çš„è¿™åŒåå˜é‡ï¼Œåœ¨ä¸Šé¢ä¾‹å­ä¸­å¯¹è±¡å­—é¢é‡å±æ€§nameå°±è¢«èµ‹äºˆæœ¬åœ°å˜é‡nameå€¼ã€‚  </p>
<p>è¿™ç§æ‰©å±•è®©å¯¹è±¡å­—é¢é‡åˆå§‹åŒ–æ›´åŠ ç®€æ´å¹¶ä¸”å¯¹æ¶ˆé™¤å‘½åé”™è¯¯èµ·ç€ä¸€å®šçš„å¸®åŠ©ï¼Œåœ¨jsä¸­å°†å±æ€§çš„å€¼èµ‹äºˆä¸€ä¸ªæœ¬åœ°åŒåå˜é‡çš„å€¼æ˜¯ä¸€ç§éå¸¸å¸¸è§æ¨¡å¼ï¼Œè¿™è®©è¿™ç§æ‰©å±•ç›¸å½“å—æ¬¢è¿ã€‚  </p>
<h4 id="ç®€æ´æ–¹æ³•"><a href="#ç®€æ´æ–¹æ³•" class="headerlink" title="ç®€æ´æ–¹æ³•"></a>ç®€æ´æ–¹æ³•</h4><p>ES6ä¸­æ·»åŠ äº†ä¸€ç§åœ¨å¯¹è±¡å­—é¢ä¸­æ·»åŠ æ–¹æ³•çš„è¯­æ³•ï¼Œåœ¨æ—©å…ˆçš„ES5å’Œä¹‹å‰çš„è¯­æ³•ä¸­ï¼Œä½ åœ¨å¯¹è±¡å­—é¢é‡ä¸­æ·»åŠ æ–¹æ³•å¿…é¡»éœ€è¦æŒ‡å®šä¸€ä¸ªåå­—å’Œä¸€ä¸ªå®Œæ•´çš„å‡½æ•°å®šä¹‰ï¼Œå¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var person = &#123;</span><br><span class="line">    name: &quot;Nicholas&quot;,</span><br><span class="line">    sayName: function() &#123;</span><br><span class="line">        console.log(this.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>åœ¨ES6ä¸­ï¼Œå¯ä»¥å°†è¿™ç§è¯­æ³•é€šè¿‡æ¶ˆé™¤åˆ†å·å’Œfunctionå…³é”®è¯æ¥ç®€åŒ–ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥é‡å†™å‰é¢çš„ä¾‹å­å¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var person = &#123;</span><br><span class="line">    name: &quot;Nicholas&quot;,</span><br><span class="line">    sayName() &#123;</span><br><span class="line">        console.log(this.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§é€Ÿå†™è¯­æ³•ä¹Ÿç§°ç®€æ´æ–¹æ³•è¯­æ³•ï¼Œåƒå…ˆå‰çš„é‚£ä¸ªå¯¹è±¡Personï¼ŒsayNameå±æ€§è¢«èµ‹äºˆäº†ä¸€ä¸ªåŒ¿åå‡½æ•°å¹¶ä¸”å’ŒES5ä¸­sayName()å‡½æ•°å…·æœ‰ç›¸åŒç‰¹æ€§ã€‚å”¯ä¸€çš„ä¸åŒæ˜¯ç®€æ´æ–¹æ³•ä¹Ÿè®¸ä½¿ç”¨superï¼Œä½†æ˜¯éç®€æ´æ–¹æ³•ä¹Ÿè®¸ä¸éœ€è¦ã€‚</p>
<h4 id="è®¡ç®—å±æ€§åç§°"><a href="#è®¡ç®—å±æ€§åç§°" class="headerlink" title="è®¡ç®—å±æ€§åç§°"></a>è®¡ç®—å±æ€§åç§°</h4><p>åœ¨ES5å’Œä¹‹å‰ä¸­åœ¨å¯¹è±¡å®ä¾‹ä¸Šå¯ä»¥ä½¿ç”¨æ–¹æ‹¬å·è€Œä¸æ˜¯ç‚¹æ ‡è®°æ¥è®¡ç®—å±æ€§ï¼Œæ–¹æ‹¬å·è®©ä½ å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å’Œå˜é‡æ¥æŒ‡å®šå±æ€§åï¼Œè¿™äº›å­—ç¬¦ä¸²åŒ…å«çš„å­—ç¬¦å¦‚æœè¢«å½“åšæ ‡è¯†ç¬¦ä½¿ç”¨ä¼šé€ æˆä¸€ä¸ªè¯­æ³•é”™è¯¯ã€‚å¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var person = &#123;&#125;,</span><br><span class="line">    lastName = &quot;last name&quot;;</span><br><span class="line"></span><br><span class="line">person[&quot;first name&quot;] = &quot;Nicholas&quot;;</span><br><span class="line">person[lastName] = &quot;Zakas&quot;;</span><br><span class="line"></span><br><span class="line">console.log(person[&quot;first name&quot;]);      // &quot;Nicholas&quot;</span><br><span class="line">console.log(person[lastName]);          // &quot;Zakas&quot;</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºlastNameè¢«èµ‹å€¼ä¸ºâ€last nameâ€,å±æ€§åå­—æœ‰ç©ºæ ¼å°±ä¸èƒ½ä½¿ç”¨ä½¿ç”¨ç‚¹æ ‡è®°ã€‚  </p>
<p>å¦å¤–ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²å­—é¢é‡å½“åšå¯¹è±¡å­—é¢é‡å±æ€§åï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var person = &#123;</span><br><span class="line">    &quot;first name&quot;: &quot;Nicholas&quot;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">console.log(person[&quot;first name&quot;]);      // &quot;Nicholas&quot;</span><br></pre></td></tr></table></figure>
<p>è¿™ç§æ¨¡å¼åœ¨å±æ€§åç§°æå‰çŸ¥é“æƒ…å†µä¸‹å¯ä»¥ç”¨å­—ç¬¦ä¸²å­—é¢é‡è¡¨ç¤ºï¼Œç„¶è€Œå¦‚æœå±æ€§åâ€first nameâ€è¢«åŒ…å«åœ¨ä¸€ä¸ªå˜é‡ä¸­æˆ–è€…å¿…é¡»é€šè¿‡è®¡ç®—ï¼Œè¿™å°±æ²¡æœ‰ ç”¨ES5æ–¹å¼å®šä¹‰å¯¹è±¡å­—é¢é‡çš„å±æ€§äº†ã€‚  </p>
<p>åœ¨ES6ä¸­ï¼Œè®¡ç®—å±æ€§åç§°æ˜¯å¯¹è±¡å­—é¢é‡è¯­æ³•çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”å®ƒä»¬ä¹ŸåŒæ ·ä½¿ç”¨æ–¹æ‹¬å·ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var lastName = &quot;last name&quot;;</span><br><span class="line"></span><br><span class="line">var person = &#123;</span><br><span class="line">    &quot;first name&quot;: &quot;Nicholas&quot;,</span><br><span class="line">    [lastName]: &quot;Zakas&quot;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">console.log(person[&quot;first name&quot;]);      // &quot;Nicholas&quot;</span><br><span class="line">console.log(person[lastName]);          // &quot;Zakas&quot;</span><br></pre></td></tr></table></figure>
<p>å¯¹è±¡å­—é¢é‡ä¸­çš„æ–¹æ‹¬å·æš—ç¤ºè¿™ä¸ªå±æ€§åç§°æ˜¯è®¡ç®—è¿‡çš„ï¼Œæ‰€ä»¥å®ƒçš„å†…å®¹è¢«æ±‚å€¼ä¸ºå­—ç¬¦ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ä½ ä¹Ÿå¯ä»¥ç”¨æ–¹æ‹¬å·åŒ…å«ä¸€ä¸ªè¡¨è¾¾å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var suffix = &quot; name&quot;;</span><br><span class="line"></span><br><span class="line">var person = &#123;</span><br><span class="line">    [&quot;first&quot; + suffix]: &quot;Nicholas&quot;,</span><br><span class="line">    [&quot;last&quot; + suffix]: &quot;Zakas&quot;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">console.log(person[&quot;first name&quot;]);      // &quot;Nicholas&quot;</span><br><span class="line">console.log(person[&quot;last name&quot;]);       // &quot;Zakas&quot;</span><br></pre></td></tr></table></figure>
<p>è¿™äº›å±æ€§è¢«æ±‚å€¼ä¸ºâ€first nameâ€å’Œâ€last nameâ€,ä¹‹åè¿™äº›å­—ç¬¦ä¸²å¯ä»¥è¢«å½“åšå¯¹è±¡å±æ€§çš„å¼•ç”¨ã€‚</p>
<h3 id="æ–°æ–¹æ³•"><a href="#æ–°æ–¹æ³•" class="headerlink" title="æ–°æ–¹æ³•"></a>æ–°æ–¹æ³•</h3><p>åœ¨ESè®¾è®¡ç›®æ ‡ä¸­ï¼Œæœ‰ä¸€ä¸ªä»ES5å°±å¼€å§‹äº†çš„ï¼Œé‚£å°±æ˜¯é€šè¿‡åœ¨å…¨å±€å¯¹è±¡å¢åŠ æ–°çš„æ–¹æ³•æ¥é¿å…åœ¨Object.prototypeä¸Šåˆ›å»ºæ–°çš„å…¨å±€æ–¹æ³•æˆ–å‡½æ•°ã€‚å› æ­¤ES6å¼•è¿›è®¸å¤šæ–°æ–¹æ³•åœ¨å…¨å±€å¯¹è±¡ä¸Šç»“æœæ˜¯è®©æŸäº›å·¥ä½œæ›´å®¹æ˜“ã€‚</p>
<h4 id="Object-is"><a href="#Object-is" class="headerlink" title="Object.is()"></a>Object.is()</h4><p>åœ¨jsä¸­å½“ä½ æƒ³å¯¹æ¯”ä¸¤ä¸ªå€¼æ—¶ï¼Œä½ ä¹Ÿè®¸ä¼šç”¨ç­‰äºæ“ä½œç¬¦(&#x3D;&#x3D;)æˆ–å…¨ç­‰æ“ä½œç¬¦(&#x3D;&#x3D;&#x3D;)æ¥æ¯”è¾ƒã€‚å¤§å¤šæ•°å¼€å‘è€…æ›´å–œæ¬¢åè€…ï¼Œè¿™æ˜¯å› ä¸ºè¿™æ ·å¯ä»¥é¿å…æ¯”è¾ƒä¸­çš„å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚ä½†æ˜¯å°±ç®—æ˜¯å…¨ç­‰æ“ä½œç¬¦ä¹Ÿä¸å¯èƒ½å®Œå…¨æ­£ç¡®ã€‚å¦‚ +0å’Œ-0é€šè¿‡å…¨ç­‰ç¬¦(&#x3D;&#x3D;&#x3D;)æ¯”è¾ƒä¹Ÿç›¸ç­‰ï¼Œä½†æ˜¯åœ¨jså¼•æ“ä¸­å®ƒä»¬è¡¨ç¤ºä¸¤ç§ä¸ä¸€æ ·çš„å€¼ï¼ŒåŒæ · NaN &#x3D;&#x3D;&#x3D; NaN è¿”å›falseï¼Œè¿™å°±å¿…é¡»è¦ç”¨isNaN()æ¥æ£€æŸ¥NaNå±æ€§äº†ã€‚   </p>
<p>ES6é€šè¿‡å¼•è¿›Object.is()æ–¹æ³•æ¥å¼¥è¡¥å…¨ç­‰æ“ä½œç¬¦(&#x3D;&#x3D;&#x3D;)çš„ç¼ºé™·ï¼Œè¿™ä¸ªæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°å¦‚æœè¿”å›trueåˆ™è¡¨æ˜çœŸæ­£çš„ç›¸ç­‰ï¼Œåªæœ‰å½“ä¸¤ä¸ªå€¼æ‹¥æœ‰ç›¸åŒç±»å‹å’Œå€¼æ—¶æ‰èƒ½ç®—çœŸæ­£ç›¸ç­‰:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">console.log(+0 == -0);              // true</span><br><span class="line">console.log(+0 === -0);             // true</span><br><span class="line">console.log(Object.is(+0, -0));     // false</span><br><span class="line"></span><br><span class="line">console.log(NaN == NaN);            // false</span><br><span class="line">console.log(NaN === NaN);           // false</span><br><span class="line">console.log(Object.is(NaN, NaN));   // true</span><br><span class="line"></span><br><span class="line">console.log(5 == 5);                // true</span><br><span class="line">console.log(5 == &quot;5&quot;);              // true</span><br><span class="line">console.log(5 === 5);               // true</span><br><span class="line">console.log(5 === &quot;5&quot;);             // false</span><br><span class="line">console.log(Object.is(5, 5));       // true</span><br><span class="line">console.log(Object.is(5, &quot;5&quot;));     // false</span><br></pre></td></tr></table></figure>
<p>åœ¨è®¸å¤šæƒ…å†µï¼ŒObject.is()å’Œå…¨ç­‰æ“ä½œç¬¦(&#x3D;&#x3D;&#x3D;)ä½œç”¨ç›¸åŒ,å”¯ä¸€çš„ä¸åŒå°±ä½“ç°åœ¨+0å’Œ-0ï¼ŒNaNçš„æ¯”è¾ƒä¸Šï¼Œä½†æ˜¯æ²¡æœ‰å¿…è¦åœæ­¢ä½¿ç”¨å…¨ç­‰æ“ä½œç¬¦(&#x3D;&#x3D;&#x3D;),æ˜¯å¦é€‰æ‹©ä½¿ç”¨Object.is()å–å†³äºä½ ä»£ç å®é™…æƒ…å†µã€‚</p>
<h4 id="Obejct-assign"><a href="#Obejct-assign" class="headerlink" title="Obejct.assign()"></a>Obejct.assign()</h4><p>åœ¨jsä¸­æ··åˆæ˜¯å¯¹è±¡ç»„æˆæœ€æµè¡Œçš„æ¨¡å¼ï¼Œåœ¨ä½¿ç”¨æ··åˆæ—¶ä¸€ä¸ªå¯¹è±¡æ¥å—å¦ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œè®¸å¤šjsåº“éƒ½æœ‰å®ç°è¿™æ ·çš„ä¸€ä¸ªæ··åˆæ–¹æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function mixin(receiver, supplier)&#123;</span><br><span class="line">    Object.keys(supplier).forEach(function(key)&#123;</span><br><span class="line">        receiver[key] = supplier[key];</span><br><span class="line">    &#125;);</span><br><span class="line">    return receiver;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªmixin()æ–¹æ³•é€šè¿‡éå†supplieræœ¬èº«å±æ€§æ¥å¤åˆ¶åˆ°receiverä¸Š()(è¿™æ˜¯ä¸€ä¸ªæµ…å¤åˆ¶ï¼Œå½“å¤åˆ¶ä¸€ä¸ªå¯¹è±¡æ—¶åªå¤åˆ¶å¯¹è±¡çš„ä¸€ä¸ªå¼•ç”¨)ã€‚è¿™è®©receiverä¸éœ€è¦ç»§æ‰¿è€Œå¾—åˆ°æ–°å±æ€§ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function EventTarget() &#123; /*...*/ &#125;</span><br><span class="line">EventTarget.prototype = &#123;</span><br><span class="line">    constructor: EventTarget,</span><br><span class="line">    emit: function() &#123; /*...*/ &#125;,</span><br><span class="line">    on: function() &#123; /*...*/ &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var myObject = &#123;&#125;;</span><br><span class="line">mixin(myObject, EventTarget.prototype);</span><br><span class="line"></span><br><span class="line">myObject.emit(&quot;somethingChanged&quot;);</span><br></pre></td></tr></table></figure>
<p>è¿™é‡ŒmyObject é€šè¿‡æ¥æ”¶EventTarget.prototypeå¯¹è±¡è¡Œä¸ºï¼Œè€Œè·å¾—ç›¸åº”çš„è®¢é˜…å’Œå‘å¸ƒèƒ½åŠ›ã€‚  </p>
<p>è¿™ç§æ¨¡å¼æµè¡Œåˆ°ES6éƒ½ä¸ºä¹‹æ·»åŠ ä¸€ä¸ªObejct.assign()æ–¹æ³•ï¼Œå®ƒçš„è¡¨ç°æ–¹å¼å’Œmixin()éƒ½ç›¸åŒæ¥æ”¶ä¸€ä¸ªreceiverå’Œå¤šä¸ªsuppliersï¼Œæœ€åè¿”å›ä¸€ä¸ªceceiverï¼Œå®ƒçš„åå­—ä»mixinå˜åˆ°assign,åŒæ—¶è¿™ä¸ªåå­—ååº”å®é™…çš„æ“ä½œã€‚å› ä¸ºè¿™ä¸ªmixin()å‡½æ•°å®é™…ä¸Šä½¿ç”¨ &#x3D;æ“ä½œç¬¦ï¼Œæ‰€ä»¥ä¸èƒ½å¤åˆ¶ accessor å±æ€§ï¼ŒObject.assign()å°±æ˜¯ååº”è¿™ä¸ªåŒºåˆ«çš„ã€‚  </p>
<p>ä½ å¯ä»¥åœ¨ä»»ä½•ä½¿ç”¨mixin()çš„åœ°æ–¹ä½¿ç”¨Object.assign()ï¼Œå¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function EventTarget() &#123; /*...*/ &#125;</span><br><span class="line">EventTarget.prototype = &#123;</span><br><span class="line">    constructor: EventTarget,</span><br><span class="line">    emit: function() &#123; /*...*/ &#125;,</span><br><span class="line">    on: function() &#123; /*...*/ &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var myObject = &#123;&#125;</span><br><span class="line">Object.assign(myObject, EventTarget.prototype);</span><br><span class="line"></span><br><span class="line">myObject.emit(&quot;somethingChanged&quot;);</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•Object.assign()å¯ä»¥æ¥å—ä»»æ„å¤šä¸ªsuppliersï¼Œreceiveræ¥å—å±æ€§çš„é¡ºåºç”±suppliersæŒ‡å®šï¼Œè¿™å°±æ„å‘³ç€ç¬¬äºŒä¸ªsupplierå¯ä»¥é‡å†™ç¬¬ä¸€ä¸ªsupplierèµ‹ç»™receiverçš„å€¼ã€‚å¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var receiver = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">Object.assign(receiver,</span><br><span class="line">    &#123;</span><br><span class="line">        type: &quot;js&quot;,</span><br><span class="line">        name: &quot;file.js&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        type: &quot;css&quot;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">console.log(receiver.type);     // &quot;css&quot;</span><br><span class="line">console.log(receiver.name);     // &quot;file.js&quot;</span><br></pre></td></tr></table></figure>
<p>reviver.typeçš„å€¼ä¸ºâ€cssâ€å› ä¸ºç¬¬äºŒä¸ªsupplieré‡å†™ç¬¬ä¸€ä¸ªèµ‹äºˆçš„å€¼ã€‚  </p>
<p>Object.assignæ–¹æ³•åœ¨ES6ä¸­å¹¶ä¸æ˜¯ä»€ä¹ˆå¤§çš„æ·»åŠ ï¼Œä½†è¿™ä¼šæ ¼å¼åŒ–è®¸å¤šjsåº“çš„è¿™ä¸ªæ–¹æ³•ã€‚</p>
<h4 id="å¯¹è±¡å­—é¢é‡å±æ€§åé‡å "><a href="#å¯¹è±¡å­—é¢é‡å±æ€§åé‡å " class="headerlink" title="å¯¹è±¡å­—é¢é‡å±æ€§åé‡å "></a>å¯¹è±¡å­—é¢é‡å±æ€§åé‡å </h4><p>ES5ä¸¥æ ¼æ¨¡å¼ä¸­å¼•è¿›äº†æ£€æŸ¥å¯¹è±¡å­—é¢é‡å±æ€§é‡å ï¼Œå¦‚æœå‘ç°æœ‰é‡å å±æ€§å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">var person = &#123;</span><br><span class="line">    name: &quot;Nicholas&quot;,</span><br><span class="line">    name: &quot;Greg&quot;        // syntax error in ES5 strict mode</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œåœ¨ES6ä¸­æ— è®ºæ˜¯å¦åœ¨ä¸¥æ ¼æ¨¡å¼éƒ½å°†ä¸ä¼šæ£€æŸ¥å±æ€§åé‡å ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">var person = &#123;</span><br><span class="line">    name: &quot;Nicholas&quot;,</span><br><span class="line">    name: &quot;Greg&quot;        // no error in ES6 strict mode</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">console.log(person.name);       // &quot;Greg&quot;</span><br></pre></td></tr></table></figure>

<h4 id="å¯æšä¸¾å±æ€§æ’åº"><a href="#å¯æšä¸¾å±æ€§æ’åº" class="headerlink" title="å¯æšä¸¾å±æ€§æ’åº"></a>å¯æšä¸¾å±æ€§æ’åº</h4><p>ES5å¹¶æ²¡æœ‰å®šä¹‰å¯¹è±¡æšä¸¾æ—¶å±æ€§é¡ºåºï¼Œå®ƒå°†è¿™äº›éƒ½äº¤ç»™jså¼•æ“è‡ªè¡Œå†³å®šã€‚ç„¶è€Œåœ¨ES6ä¸­æ˜ç¡®å®šä¹‰äº†æšä¸¾å±æ€§æ—¶å±æ€§è¿”å›çš„é¡ºåºï¼Œå®ƒå½±å“Object.getOwnPropertyNames()å’ŒReflect.ownKeys()ä»¥åŠObject.assign()ã€‚  </p>
<p>å¯¹è±¡è‡ªèº«å±æ€§æšä¸¾åŸºæœ¬é¡ºåºï¼š  </p>
<ul>
<li><ol>
<li>æ‰€æœ‰æ•°å­—é”®æŒ‰å‡åºæ’åºã€‚</li>
</ol>
</li>
<li><ol start="2">
<li>æ‰€æœ‰å­—ç¬¦ä¸²æŒ‰æ·»åŠ åˆ°å¯¹è±¡é¡ºåºã€‚</li>
</ol>
</li>
<li><ol start="3">
<li>æ‰€æœ‰symbolé”®æŒ‰æ·»åŠ åˆ°å¯¹è±¡é¡ºåºã€‚</li>
</ol>
</li>
</ul>
<p>å¦‚ä¸‹ä¾‹ï¼š </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var obj = &#123;</span><br><span class="line">    a: 1,</span><br><span class="line">    0: 1,</span><br><span class="line">    c: 1,</span><br><span class="line">    2: 1,</span><br><span class="line">    b: 1,</span><br><span class="line">    1: 1</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">obj.d = 1;</span><br><span class="line"></span><br><span class="line">console.log(Object.getOwnPropertyNames(obj).join(&quot;&quot;));     // &quot;012acbd&quot;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•Object.getOwnPropertyNames()è¿”å›å¯¹è±¡é”®å€¼ä»¥0,1,2,a,c,d,bçš„é¡ºåº.æ³¨æ„æ•°å­—é”®é›†åˆåœ¨ä¸€èµ·å¹¶æ’åºåè¿”å›ï¼Œå°½ç®¡è¿™ä¸æ˜¯å¯¹è±¡å­—é¢é‡ä¸­é¡ºåºã€‚å­—ç¬¦ä¸²é”®å€¼åœ¨æ•°å­—é”®å€¼ä¹‹åä»¥æ·»åŠ åˆ°å¯¹è±¡çš„é¡ºåºæ’åºï¼Œå…ˆæ˜¯åœ¨å¯¹è±¡å­—é¢é‡ä¸Šçš„ï¼Œç„¶åæ˜¯åŠ¨æ€æ·»åŠ çš„ã€‚</p>
<ul>
<li>noteï¼šåœ¨æœ€æ–°çš„chromeä¸­Object.keys(),for-in,JSON.stringify()ä¹Ÿæ˜¯æŒ‰è¿™ç§é¡ºåºæ’åºçš„ã€‚</li>
</ul>
<h3 id="æ›´åŠ å¼ºå¤§çš„Prototypes"><a href="#æ›´åŠ å¼ºå¤§çš„Prototypes" class="headerlink" title="æ›´åŠ å¼ºå¤§çš„Prototypes"></a>æ›´åŠ å¼ºå¤§çš„Prototypes</h3><p>åœ¨jsä¸­Prototypesæ˜¯ç»§æ‰¿çš„åŸºçŸ³ï¼Œå¹¶ä¸”åœ¨ES6ä¸­prototypeså°†æ›´å¼ºå¤§ï¼Œåœ¨jsçš„æ—©äº›ç‰ˆæœ¬ä¸­prototypesçš„ä½¿ç”¨è¢«ä¸¥é‡çš„é™åˆ¶èµ·æ¥ï¼Œç„¶è€Œéšç€è¿™é—¨è¯­è¨€çš„æˆç†Ÿå’Œå¼€å‘è€…æ›´åŠ ç†Ÿæ‚‰ä½¿ç”¨Prototypes,å¼€å‘è€…æƒ³æ›´å¤šçš„æ§åˆ¶prototypeså¹¶ä¸”ä»¥ä¸€ç§æ›´ç®€å•çš„æ–¹å¼ä½¿ç”¨ã€‚ç»“æœæ˜¯ES6å¼•è¿›äº†ä¸€äº›åœ¨prototypeä¸Šçš„æ”¹è¿›ã€‚</p>
<h4 id="å¯¹è±¡ä¸Šprototypeæ”¹å˜"><a href="#å¯¹è±¡ä¸Šprototypeæ”¹å˜" class="headerlink" title="å¯¹è±¡ä¸Šprototypeæ”¹å˜"></a>å¯¹è±¡ä¸Šprototypeæ”¹å˜</h4><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¯¹è±¡çš„prototypeåœ¨å¯¹è±¡è¢«åˆ›å»ºæ—¶(æ„é€ å™¨ï¼ŒObject.create())å°±æŒ‡å®šäº†ï¼Œå¯¹è±¡çš„prototypeåœ¨å¯¹è±¡å®ä¾‹åŒ–åæ²¡æœ‰æ”¹å˜æ˜¯ES5ä¸­jsç¨‹åºæœ€å¤§çš„å‰æå‡è®¾ã€‚å°½ç®¡ES5æ·»åŠ äº†Object.getPrototypeOf()æ–¹æ³•æ¥æ£€æµ‹å¯¹è±¡çš„prototypeã€‚ä½†æ˜¯ç°çŠ¶æ˜¯ä»ç„¶ç¼ºå°‘æ ‡å‡†æ–¹æ³•æ”¹å˜å®ä¾‹åŒ–åå¯¹è±¡çš„prototypeã€‚  </p>
<p>ES6é€šè¿‡å¢åŠ Object.setPrototypeof()æ–¹æ³•æ¥æ”¹å˜è¿™ç§å‡è®¾ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥ä»»ä½•å¯¹è±¡çš„prototypeã€‚è¿™ä¸ªæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ç¬¬ä¸€ä¸ªä¸ºå°†è¦æ”¹å˜prototypeçš„å¯¹è±¡ç¬¬äºŒä¸ªä¸ºèµ‹å€¼çš„prototypeå€¼ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let person = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        return &quot;Hello&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">let dog = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        return &quot;Woof&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// prototype is person</span><br><span class="line">let friend = Object.create(person);</span><br><span class="line">console.log(friend.getGreeting());                      // &quot;Hello&quot;</span><br><span class="line">console.log(Object.getPrototypeOf(friend) === person);  // true</span><br><span class="line"></span><br><span class="line">// set prototype to dog</span><br><span class="line">Object.setPrototypeOf(friend, dog);</span><br><span class="line">console.log(friend.getGreeting());                      // &quot;Woof&quot;</span><br><span class="line">console.log(Object.getPrototypeOf(friend) === dog);     // true</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸¤ä¸ªåŸºæœ¬å¯¹è±¡ï¼špersonï¼Œdog.ä¸¤ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªè¿”å›å­—ç¬¦ä¸²çš„æ–¹æ³•getGreeting(),å¯¹è±¡friendä¸€å¼€å§‹ç»§æ‰¿è‡ªpersonå¯¹è±¡ï¼Œè¿™æ„å‘³ç€è°ƒç”¨getGreeting()æ—¶è¾“å‡ºâ€Helloâ€.å½“å¯¹è±¡çš„prototypeå˜æˆå¯¹è±¡dogæ—¶,è°ƒç”¨person.getGreeting()è¾“å‡ºä¸ºâ€Woofâ€è¿™æ˜¯å› ä¸ºåŸæ¥çš„ä¸personå¯¹è±¡çš„ç»‘å®šå·²ç»æ–­è£‚ã€‚  </p>
<p>å¯¹è±¡çš„prototypeå®é™…ä¸Šæ˜¯ä¸€ä¸ªè¢«å«åš[[Prototype]]çš„å†…éƒ¨åªè¯»å±æ€§ï¼Œæ–¹æ³•Object.getPrototypeOf()è¿”å›å­˜å‚¨åœ¨[[Prototype]]çš„å€¼åŒæ—¶æ–¹æ³•Object.setPrototypeOf()æ”¹å˜å­˜å‚¨åœ¨[[Prototype]]çš„å€¼ï¼Œç„¶è€Œè¿™äº›ä¸æ˜¯å”¯ä¸€èƒ½æ“ä½œ[[Prototype]]çš„æ–¹æ³•ã€‚  </p>
<h4 id="ç”¨Superå¼•ç”¨è®¿é—®Prototype"><a href="#ç”¨Superå¼•ç”¨è®¿é—®Prototype" class="headerlink" title="ç”¨Superå¼•ç”¨è®¿é—®Prototype"></a>ç”¨Superå¼•ç”¨è®¿é—®Prototype</h4><p>åŸæ¥æåˆ°è¿‡ï¼Œprototypesåœ¨jsä¸­ç›¸å½“é‡è¦å¹¶ä¸”ä¸ºäº†æ›´å®¹æ˜“ä½¿ç”¨å®ƒES6ä¸ºæ­¤èŠ±äº†å¾ˆå¤šåŠŸå¤«åœ¨ä¸Šé¢ï¼Œè¿™å…¶ä¸­æœ‰superå¼•ç”¨ï¼Œè¿™è®©è®¿é—®å¯¹è±¡çš„prototypeåŠŸèƒ½æ›´åŠ å®¹æ˜“ï¼Œå¦‚ä¸‹ä¸ºäº†é‡è½½prototypeä¸ŠåŒåå‡½æ•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let person = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        return &quot;Hello&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">let dog = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        return &quot;Woof&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let friend = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        return Object.getPrototypeOf(this).getGreeting.call(this) + &quot;, hi!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// set prototype to person</span><br><span class="line">Object.setPrototypeOf(friend, person);</span><br><span class="line">console.log(friend.getGreeting());                      // &quot;Hello, hi!&quot;</span><br><span class="line">console.log(Object.getPrototypeOf(friend) === person);  // true</span><br><span class="line"></span><br><span class="line">// set prototype to dog</span><br><span class="line">Object.setPrototypeOf(friend, dog);</span><br><span class="line">console.log(friend.getGreeting());                      // &quot;Woof, hi!&quot;</span><br><span class="line">console.log(Object.getPrototypeOf(friend) === dog);     // true</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåœ¨å¯¹è±¡firendä¸Šè°ƒç”¨å’Œprototypeä¸ŠåŒåçš„getGreeting()æ–¹æ³•ã€‚Object.getPrototypeOf()æ˜¯ä¸ºä¿éšœæ­£ç¡®çš„prototypeè¢«ä½¿ç”¨ï¼Œå¦ä¸€æ®µé¢å¤–çš„ä»£ç .call(this)æ˜¯ä¸ºäº†ä¿éšœåœ¨prototypeä¸­thiså€¼è®¾ç½®æ­£ç¡®ã€‚  </p>
<p>ä¸ºäº†ä½¿ç”¨åŸå‹(prototype)ä¸Šçš„æ–¹æ³•è€Œä½¿ç”¨Object.getPrototypeOf()å’Œ.call(this)è¿™çœ‹èµ·æ¥æœ‰ç‚¹å¤æ‚äº†ï¼Œæ‰€ä»¥ES6å¼•è¿›äº†super,superæŒ‡å‘å½“å‰å¯¹è±¡prototypeï¼Œç­‰æ•ˆäºObject.getPrototypeOf(this),ä½ å¯ä»¥ç®€åŒ–getGreeting()æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let friend = &#123;</span><br><span class="line">    getGreeting()&#123;</span><br><span class="line">        // in the previous example, this is the same as:</span><br><span class="line">        // Object.getPrototypeOf(this).getGreeting.call(this)</span><br><span class="line">        return super.getGreeting() +&quot; ,h1!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨super.getGreeting()ç›¸å½“äºè°ƒç”¨Object.getPrototypeOf(this).call(this),ä½ å¯ä»¥é€šè¿‡superå¼•ç”¨è°ƒç”¨åœ¨åŸå‹ä¸Šä»»ä½•æ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœåŸå‹é“¾ä¸Šæ²¡æœ‰æ­¤æ–¹æ³•å°±ä¼šé€ æˆä¸€ä¸ªè¯­æ³•é”™è¯¯ã€‚  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let friend = &#123;</span><br><span class="line">    getGreeting: function() &#123;</span><br><span class="line">        // syntax error</span><br><span class="line">        return super.getGreeting() + &quot;, hi!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­ä¸­è°ƒç”¨super.getGreeting()é€ æˆä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºsuperåœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸‹æ˜¯æ— æ•ˆçš„ã€‚</p>
<h4 id="æ­£å¼å®šä¹‰æ–¹æ³•"><a href="#æ­£å¼å®šä¹‰æ–¹æ³•" class="headerlink" title="æ­£å¼å®šä¹‰æ–¹æ³•"></a>æ­£å¼å®šä¹‰æ–¹æ³•</h4><p>åœ¨ES6ä¹‹å‰ï¼Œæ–¹æ³•(method)çš„æ¦‚å¿µæ²¡æœ‰æ­£å¼å®šä¹‰ï¼Œæ–¹æ³•åªæ˜¯å¯¹è±¡ä¸Šä¸ºå‡½æ•°è€Œä¸æ˜¯æ•°æ®çš„å±æ€§ï¼Œç„¶è€ŒES6æ­£å¼å®šä¹‰æ–¹æ³•ï¼šä¸€ä¸ªæ‹¥æœ‰å†…éƒ¨å±æ€§[[HomeObject]]çš„å‡½æ•°ï¼Œè¿™ä¸ªå±æ€§åŒ…å«è¿™ä¸ªå‡½æ•°å±äºçš„å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let person = &#123;</span><br><span class="line"></span><br><span class="line">    // method</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        return &quot;Hello&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// not a method</span><br><span class="line">function shareGreeting() &#123;</span><br><span class="line">    return &quot;Hi!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­ä¸­å®šä¸€ä¸ªäº†ä¸€ä¸ªæ‹¥æœ‰æ–¹æ³•getGreeting()çš„å¯¹è±¡personã€‚getGreeting()çš„[[HomeObject]]å€¼ä¸ºpersonï¼Œå¦ä¸€æ–¹é¢shareGreeting()æ²¡æœ‰[[HomeObject]]å±æ€§ï¼Œè¿™æ˜¯å› ä¸ºè¿™ä¸ªå‡½æ•°åˆ›å»ºæ—¶æ²¡æœ‰æŒ‡å®šä¸ºä¸€ä¸ªå¯¹è±¡å±æ€§ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹è¿™ç§å·®åˆ«å¹¶ä¸æ˜æ˜¾ï¼Œä½†åœ¨ä½¿ç”¨superæ—¶ç‰¹åˆ«é‡è¦ã€‚  </p>
<p>ä»»ä½•superå¼•ç”¨æ˜¯åŸºäº[[HomeObject]]çš„ï¼Œç¬¬ä¸€æ­¥æ˜¯åŸºäº[[HomeObject]]è°ƒç”¨Object.getPrototypeOf()æ‰¾å¯»prototypeçš„å¼•ç”¨ï¼Œå¦‚æœåœ¨prototypeä¸Šæ‰¾åˆ°éœ€è¦è°ƒç”¨çš„åŒåå±æ€§æˆ–å‡½æ•°ï¼Œæœ€åthisç»‘å®šæ–¹æ³•è°ƒç”¨ï¼Œå¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let person = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        return &quot;Hello&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// prototype is person</span><br><span class="line">let friend = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        return super.getGreeting() + &quot;, hi!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Object.setPrototypeOf(friend, person);</span><br><span class="line"></span><br><span class="line">console.log(friend.getGreeting());  // &quot;Hello, hi!&quot;</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨friend.getGreeting()è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ç”±person.getGreetingå’Œâ€ hi!â€ç»„æˆã€‚friend.getGreeting()çš„[[HomeObject]]ä¸ºfriend,æ‰€ä»¥friendçš„prototypeä¸ºperson,æœ€ç»ˆsuper.getGreeting()ç­‰æ•ˆäºperson.getGreeting.call(this)ã€‚</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ES6å¯¹å¯¹è±¡å­—é¢é‡åšäº†å‡ å¤„æ”¹å˜ï¼Œç®€å†™å±æ€§å®šä¹‰è®©å½“å‰ä½œç”¨åŸŸåŒåå±æ€§èµ‹å€¼æ›´æ–¹ä¾¿äº†ï¼Œè®¡ç®—å±æ€§åç§°è®©ä½ å¯ä»¥æŒ‡å®šéå­—é¢é‡å€¼ä½œä¸ºå±æ€§åç§°ï¼Œç®€å†™æ–¹æ³•è®©ä½ åœ¨å®šä¹‰æ–¹æ³•æ—¶å°‘æ‰“ä¸€äº›å­—ç¬¦ï¼ˆ:functionï¼‰ï¼ŒES6å¯¹è±¡ä¸¥æ ¼æ¨¡å¼ä¸‹é‡å¤å®šä¹‰å±æ€§åä¸å†é™åˆ¶è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨ä¸¥æ ¼æ¨¡å¼å®šä¹‰ä¸¤ä¸ªé‡åå±æ€§è€Œå¾—åˆ°æœ€åä¸ªå±æ€§ã€‚   </p>
<p>Object.assign()ç›¸å½“äºä¸€ä¸ªæ ‡å‡†çš„mixinæ¨¡å¼ã€‚Object.is()æ˜¯å¯ä»¥æ›´åŠ ä¸¥æ ¼çš„ç­‰äºæ¯”è¾ƒç”šè‡³æ¯”&#x3D;&#x3D;&#x3D;è¿˜ä¸¥æ ¼ã€‚   </p>
<p>æšä¸¾è‡ªèº«å±æ€§çš„é¡ºåºä¹Ÿåœ¨ES6ä¸­å¾—åˆ°æ˜ç¡®å®šä¹‰ï¼Œæ•°å­—å‡åºä¼˜å…ˆï¼Œå…¶æ¬¡å­—ç¬¦ï¼Œæœ€åsymbol keysã€‚   </p>
<p>å¤šäºES6å¯¹è±¡åœ¨åˆ›å»ºåä»ç„¶å¯ä»¥é€šè¿‡æ–¹æ³•Object.setPrototypeOf()æ”¹å˜å…¶prototype.   </p>
<p>æœ€ç»ˆä½ å¯ä»¥é€šè¿‡å…³é”®å­—superè°ƒç”¨åŸå‹å¯¹è±¡ä¸Šçš„æ–¹æ³•ã€‚ï¼ˆï¼Ÿï¼‰</p>
]]></content>
      <categories>
        <category>javscript</category>
      </categories>
  </entry>
  <entry>
    <title>httpç¼“å­˜è¯¦è§£</title>
    <url>/2017/10/25/%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3/</url>
    <content><![CDATA[<h2 id="1-HTTPç¼“å­˜æ¦‚è¿°"><a href="#1-HTTPç¼“å­˜æ¦‚è¿°" class="headerlink" title="1 HTTPç¼“å­˜æ¦‚è¿°"></a>1 HTTPç¼“å­˜æ¦‚è¿°</h2><p>httpç¼“å­˜æ˜¯ä¸€ç§åˆ©ç”¨ç¬¬ä¸€æ¬¡è¯·æ±‚åä¿å­˜å‰¯æœ¬å…¶åçš„è¯·æ±‚å¯ä»¥åˆ©ç”¨ç¼“å­˜å“åº”çš„æŠ€æœ¯ï¼Œå®ƒçš„ä¸»è¦ç›®çš„ä¸ºèŠ‚çœæµé‡ä»¥åŠå¢åŠ èµ„æºå“åº”é€Ÿåº¦ã€‚  </p>
<h3 id="1-1-HTTPç¼“å­˜çš„åŸºæœ¬æœºåˆ¶"><a href="#1-1-HTTPç¼“å­˜çš„åŸºæœ¬æœºåˆ¶" class="headerlink" title="1.1 HTTPç¼“å­˜çš„åŸºæœ¬æœºåˆ¶"></a>1.1 HTTPç¼“å­˜çš„åŸºæœ¬æœºåˆ¶</h3><p>æ¯æ¬¡å¦‚æœè¦è·å–ç¼“å­˜å°±å¾—èµ°è¿‡ä¸€å¥—ç¼“å­˜æœºåˆ¶ï¼Œå…·ä½“å¦‚ä¸‹å›¾ï¼š<br><img src="/2017/10/25/%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3/cacheMechanism.png" alt="cacheMechanism">  </p>
<span id="more"></span>
<p>ç”¨æˆ·å‘èµ·è¯·æ±‚åï¼Œä¼šç°åœ¨ç¼“å­˜ä¸­æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ç›¸åŒ¹é…çš„ç¼“å­˜ï¼Œå¦‚æœæ²¡æœ‰å°±å‘æºæœåŠ¡å™¨å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œå¦‚æœæœ‰çš„è¯å°±ä¼šæ£€æµ‹è¿™ä¸ªç¼“å­˜æ˜¯å¦â€æ–°é²œâ€ï¼Œå¦‚æœæ–°é²œçš„è¯å°±ç›´æ¥å°†ç¼“å­˜è¿”å›ç”¨æˆ·ï¼Œè‹¥ä¸æ–°é²œå°±ä¼šå‘æºæœåŠ¡å™¨å‘é€å¸¦æœ‰éªŒè¯æ ‡è¯†çš„è¯·æ±‚æ¥éªŒè¯æ˜¯å¦å¯ä»¥ä½¿ç”¨è¿™ä¸ªå·²ç»è¿‡æœŸçš„ç¼“å­˜ï¼Œè‹¥è¿™ä¸ªéªŒè¯æ ‡è¯†éƒ½é€šè¿‡äº†éªŒè¯é‚£ä¹ˆå°±ä¼šå‘å‘é€ä¸€ä¸ª304(not modified)å“åº”ï¼Œè¿™ä¸ªå“åº”æ²¡æœ‰å¯¹åº”çš„å“åº”ä½“å®ƒåªä¼šæ›´æ–°ç¼“å­˜çš„æ–°é²œåº¦ï¼Œè‹¥æœªé€šè¿‡åˆ™é‡æ–°è¿”å›ä¸€ä¸ªå¸¦æœ‰å“åº”ä½“çš„å“åº”ã€‚<br>æ¦‚å†µèµ·æ¥å¯ä»¥å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>(1) æ¥æ”¶â€”â€”ç¼“å­˜ä»ç½‘ç»œä¸­è¯»å–æŠµè¾¾çš„è¯·æ±‚æŠ¥æ–‡ã€‚</p>
</li>
<li><p>(2) è§£æâ€”â€”ç¼“å­˜å¯¹æŠ¥æ–‡è¿›è¡Œè§£æï¼Œæå–å‡º URL å’Œå„ç§é¦–éƒ¨ã€‚</p>
</li>
<li><p>(3) æŸ¥è¯¢â€”â€”ç¼“å­˜æŸ¥çœ‹æ˜¯å¦æœ‰æœ¬åœ°å‰¯æœ¬å¯ç”¨ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±è·å–ä¸€ä»½å‰¯æœ¬ï¼ˆå¹¶å°†å…¶ä¿<br>å­˜åœ¨æœ¬åœ°ï¼‰ ã€‚</p>
</li>
<li><p>(4) æ–°é²œåº¦æ£€æµ‹â€”â€”ç¼“å­˜æŸ¥çœ‹å·²ç¼“å­˜å‰¯æœ¬æ˜¯å¦è¶³å¤Ÿæ–°é²œï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±è¯¢é—®æœåŠ¡å™¨æ˜¯<br>å¦æœ‰ä»»ä½•æ›´æ–°ã€‚</p>
</li>
<li><p>(5) åˆ›å»ºå“åº”â€”â€”ç¼“å­˜ä¼šç”¨æ–°çš„é¦–éƒ¨å’Œå·²ç¼“å­˜çš„ä¸»ä½“æ¥æ„å»ºä¸€æ¡å“åº”æŠ¥æ–‡ã€‚</p>
</li>
<li><p>(6) å‘é€â€”â€”ç¼“å­˜é€šè¿‡ç½‘ç»œå°†å“åº”å‘å›ç»™å®¢æˆ·ç«¯ã€‚</p>
</li>
<li><p>(7) æ—¥å¿—â€”â€”ç¼“å­˜å¯é€‰åœ°åˆ›å»ºä¸€ä¸ªæ—¥å¿—æ–‡ä»¶æ¡ç›®æ¥æè¿°è¿™ä¸ªäº‹åŠ¡</p>
</li>
<li><p>noteï¼š ä¸Šé¢éƒ½æ˜¯ç†æƒ³æƒ…å†µä¸‹æ¯”å¦‚è¯´æ²¡æœ‰cache-controlçš„æ§åˆ¶ï¼Œéƒ½æ˜¯å¯ç¼“å­˜çš„å“åº”ï¼Œå“åº”éƒ½æˆåŠŸä¹‹ç±»ã€‚</p>
</li>
</ul>
<h3 id="1-2-ç¼“å­˜åŸºæœ¬ç§ç±»"><a href="#1-2-ç¼“å­˜åŸºæœ¬ç§ç±»" class="headerlink" title="1.2 ç¼“å­˜åŸºæœ¬ç§ç±»"></a>1.2 ç¼“å­˜åŸºæœ¬ç§ç±»</h3><p>ç¼“å­˜å¯ä»¥è¢«å•ä¸ªç”¨æˆ·ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥è¢«æˆåƒä¸Šä¸‡äººä½¿ç”¨ã€‚å•ç”¨æˆ·ç¼“å­˜è¢«ç§°ä¸ºâ€ç§ç”¨ç¼“å­˜(private cache)â€,ä¸€èˆ¬çš„æµè§ˆå™¨éƒ½å…·æœ‰å†…ç½®çš„ç§æœ‰ç¼“å­˜ï¼Œå¤šç”¨æˆ·ç¼“å­˜è¢«ç§°ä¸ºâ€å…±äº«ç¼“å­˜(shared cache)â€ä¸€èˆ¬ç”±å…±äº«ä»£ç†æœåŠ¡å™¨æ¥å®ç°æˆ–è€…å«ä»£ç†ç¼“å­˜(proxy cache)ã€‚</p>
<ul>
<li>noteï¼š ç¼“å­˜ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯å¤šçº§ç¼“å­˜<br><img src="/2017/10/25/%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3/cacheType.png" alt="cacheMechanism"></li>
</ul>
<h3 id="1-3-æ§åˆ¶ç¼“å­˜cache-control"><a href="#1-3-æ§åˆ¶ç¼“å­˜cache-control" class="headerlink" title="1.3 æ§åˆ¶ç¼“å­˜cache-control"></a>1.3 æ§åˆ¶ç¼“å­˜cache-control</h3><p>ç¼“å­˜æœºåˆ¶ç”±æœåŠ¡ç«¯å’Œå®¢æœåŠ¡å…±åŒå®ç°é»˜è®¤ç¼“å­˜æœºåˆ¶ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡cache-controlä¸å…¶ä»–çš„å¤´ä¿¡æ¯é…åˆä¿®æ”¹é»˜è®¤ç¼“å­˜çš„è¡Œä¸ºï¼Œæ¯”å¦‚è¯´ä¸€èˆ¬é»˜è®¤ç¼“å­˜GETè¯·æ±‚ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡cache-controlï¼špublicæŒ‡ä»¤æ¥è®©POSTä¹Ÿå¯ä»¥ç¼“å­˜ã€‚å…·ä½“çš„æŒ‡ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//è¿™ä»½å›¾è¡¨æ¥è‡ª RFC2616</span><br><span class="line"> Cache-Control   = &quot;Cache-Control&quot; &quot;:&quot; 1#cache-directive</span><br><span class="line">  cache-directive = cache-request-directive</span><br><span class="line">       | cache-response-directive</span><br><span class="line">  cache-request-directive =</span><br><span class="line">         &quot;no-cache&quot;                          ; Section 14.9.1</span><br><span class="line">       | &quot;no-store&quot;                          ; Section 14.9.2</span><br><span class="line">       | &quot;max-age&quot; &quot;=&quot; delta-seconds         ; Section 14.9.3, 14.9.4</span><br><span class="line">       | &quot;max-stale&quot; [ &quot;=&quot; delta-seconds ]   ; Section 14.9.3</span><br><span class="line">       | &quot;min-fresh&quot; &quot;=&quot; delta-seconds       ; Section 14.9.3</span><br><span class="line">       | &quot;no-transform&quot;                      ; Section 14.9.5</span><br><span class="line">       | &quot;only-if-cached&quot;                    ; Section 14.9.4</span><br><span class="line">       | cache-extension                     ; Section 14.9.6</span><br><span class="line">   cache-response-directive =</span><br><span class="line">         &quot;public&quot;                               ; Section 14.9.1</span><br><span class="line">       | &quot;private&quot; [ &quot;=&quot; &lt;&quot;&gt; 1#field-name &lt;&quot;&gt; ] ; Section 14.9.1</span><br><span class="line">       | &quot;no-cache&quot; [ &quot;=&quot; &lt;&quot;&gt; 1#field-name &lt;&quot;&gt; ]; Section 14.9.1</span><br><span class="line">       | &quot;no-store&quot;                             ; Section 14.9.2</span><br><span class="line">       | &quot;no-transform&quot;                         ; Section 14.9.5</span><br><span class="line">       | &quot;must-revalidate&quot;                      ; Section 14.9.4</span><br><span class="line">       | &quot;proxy-revalidate&quot;                     ; Section 14.9.4</span><br><span class="line">       | &quot;max-age&quot; &quot;=&quot; delta-seconds            ; Section 14.9.3</span><br><span class="line">       | &quot;s-maxage&quot; &quot;=&quot; delta-seconds           ; Section 14.9.3</span><br><span class="line">       | cache-extension                        ; Section 14.9.6</span><br><span class="line">  cache-extension = token [ &quot;=&quot; ( token | quoted-string ) ]</span><br></pre></td></tr></table></figure>
<ul>
<li>note:cache-controlæŒ‡ä»¤æ˜¯å•å‘çš„ï¼Œè¯·æ±‚æœ‰å“åº”ä¸ä¸€å®šæœ‰ï¼Œå¹¶ä¸”åœ¨è®¡ç®—å¦‚æ–°é²œåº¦çš„æ—¶å€™ä¼˜å…ˆçº§ä¸ä¸€æ ·ã€‚</li>
</ul>
<h4 id="1-3-1-ç¼“å­˜æ–¹å¼æ§åˆ¶"><a href="#1-3-1-ç¼“å­˜æ–¹å¼æ§åˆ¶" class="headerlink" title="1.3.1 ç¼“å­˜æ–¹å¼æ§åˆ¶"></a>1.3.1 ç¼“å­˜æ–¹å¼æ§åˆ¶</h4><p>æ§åˆ¶ç¼“å­˜æ–¹å¼çš„æœ‰è¿™å‡ ç§no-cache,no-store,public,priviate</p>
<ul>
<li><p>no-cacheï¼š<br>åœ¨è¯·æ±‚â€no-cacheâ€æŒ‡ä»¤æš—ç¤ºç€ç¼“å­˜å¿…é¡»åœ¨æˆåŠŸçš„ä»æºæœåŠ¡å™¨ä¸ŠéªŒè¯åæ‰èƒ½ä½¿ç”¨ï¼Œåœ¨å“åº”ä¸­ä¹Ÿä¸€æ ·ã€‚</p>
</li>
<li><p>no-store:<br>åŒ…å«è¿™ä¸ªå­˜å‚¨æŒ‡ä»¤æš—ç¤ºç¼“å­˜ä¸€å®šä¸èƒ½å­˜å‚¨è¯·æ±‚æˆ–å“åº”çš„ä»»ä½•éƒ¨åˆ†ï¼Œâ€ä¸€å®šä¸èƒ½å­˜å‚¨â€åœ¨è¿™ä¸ªè¯­å¢ƒä¸­æ„å‘³ç€ç¼“å­˜ä¸€å®šä¸èƒ½æœ‰æ„çš„å°†ä¿¡æ¯å‚¨å­˜åœ¨å›ºæ€å­˜å‚¨å™¨ä¸Šï¼ŒåŒæ—¶åœ¨ä¿¡æ¯è½¬å‘åå°½å¿«å°½åŠ›å°†å…¶å†…å­˜ä¸­ç§»é™¤ã€‚</p>
</li>
</ul>
<p>è¿™ä¸ªæŒ‡ä»¤å¹¶ä¸å¯é ä¸”æ²¡æœ‰å……åˆ†çš„æœºåˆ¶æ¥ä¿éšœå…¶éšç§ã€‚ç‰¹åˆ«æ˜¯åœ¨æ¶æ„æˆ–åå•†ç¼“å­˜ä¸­ä¹Ÿè®¸ä¸ä¼šè¯†åˆ«ï¼Œå¹¶ä¸”åœ¨å’Œç½‘ç»œé€šä¿¡è¿‡ç¨‹ä¸­å¯èƒ½è¢«é»‘æ‰ã€‚  </p>
<p>æ³¨æ„ï¼šå¦‚æœä¸€ä¸ªè¯·æ±‚ä¸­åŒ…å«è¿™ä¸ªæŒ‡ä»¤å¹¶ä¸”åœ¨ç¼“å­˜ä¸­æ‰¾åˆ°åŒ¹é…å“åº”ï¼Œé‚£ä¹ˆè¿™ä¸ªno-storeè¯·æ±‚æŒ‡ä»¤å¹¶ä¸èƒ½é€‚ç”¨äºè¿™ä¸ªå·²ç»å­˜å‚¨å¥½çš„å“åº”ã€‚</p>
<ul>
<li><p>publicï¼š<br>è¿™ä¸ªå“åº”æŒ‡ä»¤æš—ç¤ºç€ä»»ä½•ç¼“å­˜éƒ½å¯ä»¥å­˜å‚¨è¿™ä¸ªå“åº”ï¼Œå“ªæ€•è¿™ä¸ªå“åº”é»˜è®¤ä¸å¯ç¼“å­˜ï¼Œæˆ–è€…åªèƒ½ç¼“å­˜åœ¨ç§æœ‰ç¼“å­˜(åŒ…å«è®¤è¯ä¿¡æ¯çš„å“åº”åªèƒ½æ˜¯ç§æœ‰ç¼“å­˜ï¼Œé»˜è®¤æƒ…å†µä¸‹åªæœ‰ç‰¹å®šå“åº”çŠ¶æ€ç çš„å“åº”æ‰èƒ½å­˜å‚¨)</p>
</li>
<li><p>private<br>è¿™ä¸ªç¼“å­˜æŒ‡ä»¤æš—ç¤ºå“åº”æ¶ˆæ¯åªèƒ½è¢«å•ä¸ªç”¨æˆ·å­˜å‚¨ï¼Œä¸€å®šä¸èƒ½è¢«å…±äº«ç¼“å­˜æ‰€å­˜å‚¨ã€‚å¦‚æœå“åº”é»˜è®¤ä¸èƒ½ç¼“å­˜ä½†æ˜¯æœ‰ç§æœ‰å­˜å‚¨æŒ‡ä»¤åä¹Ÿå¯ä»¥å˜å¾—å¯ç¼“å­˜ã€‚</p>
</li>
</ul>
<h3 id="1-4-æ–°é²œåº¦æ£€æµ‹"><a href="#1-4-æ–°é²œåº¦æ£€æµ‹" class="headerlink" title="1.4 æ–°é²œåº¦æ£€æµ‹"></a>1.4 æ–°é²œåº¦æ£€æµ‹</h3><p>æ–°é²œåº¦æ£€æµ‹ä¸ä½¿ç”¨æ—¶æœŸ(age)å’Œæ–°é²œç”Ÿå­˜æœŸ(freshness_lifttime)ç›¸å…³ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$is_fresh_enough = ($age &lt; $freshness_lifetime);</span><br></pre></td></tr></table></figure>
<p>ageè¡¨ç¤ºçš„æ˜¯å“åº”ä»æºæœåŠ¡å™¨å“åº”(æˆ–åœ¨éªŒè¯å)ä¹‹åç»å†çš„æ€»æ—¶é—´ï¼Œè¿™å…¶ä¸­åŒ…æ‹¬åœ¨å› ç‰¹ç½‘å’Œç½‘å…³ä¸­æ¸¸è¡çš„æ—¶é—´ï¼Œä¸­é—´èŠ‚ç‚¹ç¼“å­˜å­˜å‚¨æ—¶é—´ï¼Œä»¥åŠå“åº”åœ¨ä½ çš„ç¼“å­˜åœç•™çš„æ—¶é—´ã€‚å…·ä½“è®¡ç®—å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$apparent_age = max(0, $time_got_response - $Date_header_value);</span><br><span class="line">$corrected_apparent_age = max($apparent_age, $Age_header_value);</span><br><span class="line">$response_delay_estimate = ($time_got_response - $time_issued_request);</span><br><span class="line">$age_when_document_arrived_at_our_cache =</span><br><span class="line">$corrected_apparent_age + $response_delay_estimate;</span><br><span class="line"></span><br><span class="line">$how_long_copy_has_been_in_our_cache = $current_time - $time_got_response;</span><br><span class="line"></span><br><span class="line">$age = $age_when_document_arrived_at_our_cache +</span><br><span class="line">$how_long_copy_has_been_in_our_cache;</span><br></pre></td></tr></table></figure>
<p>freshness_lifttimeè¡¨ç¤ºç¼“å­˜ç”Ÿå­˜çš„æ—¶é—´é•¿åº¦ï¼Œæœ‰æœåŠ¡å™¨å“åº”å’Œå®¢æˆ·ç«¯è¯·æ±‚å…±åŒå†³å®šï¼ŒæœåŠ¡å™¨ç«¯å“åº”å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sub server_freshness_limit</span><br><span class="line">&#123;</span><br><span class="line">  local($heuristic,$server_freshness_limit,$time_since_last_modify);</span><br><span class="line">  $heuristic = 0;</span><br><span class="line">  if ($Max_Age_value_set)</span><br><span class="line">  &#123;</span><br><span class="line">    $server_freshness_limit = $Max_Age_value;</span><br><span class="line">  &#125;</span><br><span class="line">  elseif ($Expires_value_set)</span><br><span class="line">  &#123;</span><br><span class="line">    $server_freshness_limit = $Expires_value - $Date_value;</span><br><span class="line">  &#125;</span><br><span class="line">  elseif ($Last_Modified_value_set)</span><br><span class="line">  &#123;</span><br><span class="line">    $time_since_last_modify = max(0, $Date_value -</span><br><span class="line">  ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ $Last_Modified_value);</span><br><span class="line">    $server_freshness_limit = int($time_since_last_modify *</span><br><span class="line">  ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ $lm_factor);</span><br><span class="line">    $heuristic = 1;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    $server_freshness_limit = $default_cache_min_lifetime;</span><br><span class="line">    $heuristic = 1;</span><br><span class="line">  &#125;</span><br><span class="line">  if ($heuristic)</span><br><span class="line">  &#123;</span><br><span class="line">    if ($server_freshness_limit &gt; $default_cache_max_lifetime)</span><br><span class="line">    &#123; $server_freshness_limit = $default_cache_max_lifetime; &#125;</span><br><span class="line">    if ($server_freshness_limit &lt; $default_cache_min_lifetime)</span><br><span class="line">    &#123; $server_freshness_limit = $default_cache_min_lifetime; &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return($server_freshness_limit);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®¢æˆ·ç«¯çš„è¯·æ±‚å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sub client_modified_freshness_limit</span><br><span class="line">&#123;</span><br><span class="line">  $age_limit = server_freshness_limit( ); ## From Example 7-2</span><br><span class="line">  if ($Max_Stale_value_set)</span><br><span class="line">  &#123;</span><br><span class="line">    if ($Max_Stale_value == $INT_MAX)</span><br><span class="line">    &#123; $age_limit = $INT_MAX; &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123; $age_limit = server_freshness_limit( ) + $Max_Stale_value; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  if ($Min_Fresh_value_set)</span><br><span class="line">  &#123;</span><br><span class="line">    $age_limit = min($age_limit, server_freshness_limit( ) -</span><br><span class="line">  ã€€ã€€ã€€ã€€ã€€ã€€ã€€$Min_Fresh_value_set);</span><br><span class="line">  &#125;</span><br><span class="line">  if ($Max_Age_value_set)</span><br><span class="line">  &#123;</span><br><span class="line">    $age_limit = min($age_limit, $Max_Age_value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ˜æ˜¾æœ€ç»ˆå®¢æˆ·ç«¯cache-controlçš„ä¼˜å…ˆçº§è¦å¤§ä¸€äº›</p>
<h3 id="1-5-å“åº”è¿‡æœŸéªŒè¯"><a href="#1-5-å“åº”è¿‡æœŸéªŒè¯" class="headerlink" title="1.5 å“åº”è¿‡æœŸéªŒè¯"></a>1.5 å“åº”è¿‡æœŸéªŒè¯</h3><p>åœ¨ç¼“å­˜æ–‡æ¡£è¿‡æœŸå‰ï¼Œç¼“å­˜ä»»æ„ä½¿ç”¨è¿™äº›å“åº”ï¼Œè€Œä¸éœ€å’ŒæºæœåŠ¡å™¨ç›¸å…³è”ï¼Œä½†æ˜¯ä¸€æ—¦å“åº”è¿‡æœŸç¼“å­˜çš„å“åº”å°±å¿…é¡»ä¸æºæœåŠ¡å™¨è¿›è¡Œä¸€æ¬¡éªŒè¯ï¼ŒéªŒè¯è¿™äº›å“åº”æ˜¯å¦åœ¨ä¹‹åè¢«ä¿®æ”¹è¿‡ã€‚å¦‚æœä¿®æ”¹è¿‡å°±å¿…é¡»è¿”å›ä¸€ä»½æ–°çš„å“åº”ã€‚  </p>
<p>åœ¨éªŒè¯ä¸­å¯ä»¥æä¾›ä»¥ä¸‹è¯·æ±‚å¤´è¿›è¡ŒéªŒè¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">If-Modified-Since: &#x27;Last-Modified çš„å€¼&#x27;</span><br><span class="line">If-None-Match: &#x27;ETag&#x27;</span><br></pre></td></tr></table></figure>
<p>If-Modified-SinceåŒ…å«çš„æ˜¯æ–‡ä»¶ä¸Šæ¬¡ä¿®æ”¹çš„æ—¶é—´ï¼Œå¦‚æœæºæœåŠ¡å™¨ä¸Šæ¬¡ä¿®æ”¹çš„å®é™…å°äºæˆ–è€…ç­‰äºè¿™ä¸ªå€¼æ—¶ï¼Œå°±è¿”å›304å¹¶æ›´æ–°ç¼“å­˜æ–°é²œåº¦.<br>If-Node-MatchåŒ…å«çš„æ˜¯å“åº”ä¸­çš„Etagå€¼ï¼Œè¿™ä¸ªå€¼æ˜¯é€šè¿‡å“ˆå¸Œè®¡ç®—ä¿¡æ¯äº§ç”Ÿçš„ç‹¬ä¸€æ— äºŒæ ‡è®°å€¼ï¼Œå¦‚æœæºæœåŠ¡å™¨çš„Etagå’Œè¿™ä¸ªå€¼ç›¸åŒåˆ™è¿”å›304å¹¶æ›´æ–°ç¼“å­˜æ–°é²œåº¦.<br>å¦‚æœéªŒè¯æ²¡é€šè¿‡åˆ™è¿”å›ä¸€ä¸ªå…¨æ–°çš„å“åº”ã€‚</p>
<h2 id="2-å¦‚ä½•åˆ©ç”¨ç¼“å­˜"><a href="#2-å¦‚ä½•åˆ©ç”¨ç¼“å­˜" class="headerlink" title="2 å¦‚ä½•åˆ©ç”¨ç¼“å­˜"></a>2 å¦‚ä½•åˆ©ç”¨ç¼“å­˜</h2><p>æ›´å¤šåœ°åˆ©ç”¨ç¼“å­˜èµ„æºï¼Œå¯ä»¥æé«˜ç½‘ç«™çš„æ€§èƒ½å’Œç›¸åº”é€Ÿåº¦ã€‚ä¸ºäº†ä¼˜åŒ–ç¼“å­˜ï¼Œè¿‡æœŸæ—¶é—´è®¾ç½®å¾—å°½é‡é•¿æ˜¯ä¸€ç§å¾ˆå¥½çš„ç­–ç•¥ã€‚å¯¹äºå®šæœŸæˆ–è€…é¢‘ç¹æ›´æ–°çš„èµ„æºï¼Œè¿™ä¹ˆåšæ˜¯æ¯”è¾ƒç¨³å¦¥çš„ï¼Œä½†æ˜¯å¯¹äºé‚£äº›é•¿æœŸä¸æ›´æ–°çš„èµ„æºä¼šæœ‰ç‚¹é—®é¢˜ã€‚è¿™äº›å›ºå®šçš„èµ„æºåœ¨ä¸€å®šæ—¶é—´å†…å—ç›Šäºè¿™ç§é•¿æœŸä¿æŒçš„ç¼“å­˜ç­–ç•¥ï¼Œä½†ä¸€æ—¦è¦æ›´æ–°å°±ä¼šå¾ˆå›°éš¾ã€‚ç‰¹æŒ‡ç½‘é¡µä¸Šå¼•å…¥çš„ä¸€äº›js&#x2F;cssæ–‡ä»¶ï¼Œå½“å®ƒä»¬å˜åŠ¨æ—¶éœ€è¦å°½å¿«æ›´æ–°çº¿ä¸Šèµ„æºã€‚  </p>
<p>webå¼€å‘è€…å‘æ˜äº†ä¸€ç§ Steve Sounders ç§°ä½œåŠ é€Ÿï¼ˆè¯‘è€…æ³¨ï¼šrevvingï¼‰çš„æŠ€æœ¯[1] ã€‚ä¸é¢‘ç¹æ›´æ–°çš„æ–‡ä»¶ä¼šä½¿ç”¨ç‰¹å®šçš„å‘½åæ–¹å¼ï¼šåœ¨URLåé¢ï¼ˆé€šå¸¸æ˜¯æ–‡ä»¶ååé¢ï¼‰ä¼šåŠ ä¸Šç‰ˆæœ¬å·ã€‚åŠ ä¸Šç‰ˆæœ¬å·åçš„èµ„æºå°±è¢«è§†ä½œä¸€ä¸ªå®Œå…¨æ–°çš„ç‹¬ç«‹çš„èµ„æºï¼ŒåŒæ—¶æ‹¥æœ‰ä¸€å¹´ç”šè‡³æ›´é•¿çš„ç¼“å­˜è¿‡æœŸæ—¶é•¿ã€‚ä½†æ˜¯è¿™ä¹ˆåšä¹Ÿå­˜åœ¨ä¸€ä¸ªå¼Šç«¯ï¼Œæ‰€æœ‰å¼•ç”¨è¿™ä¸ªèµ„æºçš„åœ°æ–¹éƒ½éœ€è¦æ›´æ–°é“¾æ¥ã€‚webå¼€å‘è€…ä»¬é€šå¸¸ä¼šé‡‡ç”¨è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·åœ¨å®é™…å·¥ä½œä¸­å®Œæˆè¿™äº›çç¢çš„å·¥ä½œã€‚å½“ä½é¢‘æ›´æ–°çš„èµ„æºï¼ˆjs&#x2F;cssï¼‰å˜åŠ¨äº†ï¼Œåªç”¨åœ¨é«˜é¢‘å˜åŠ¨çš„èµ„æºæ–‡ä»¶ï¼ˆhtmlï¼‰é‡Œåšå…¥å£çš„æ”¹åŠ¨ã€‚  </p>
<p>è¿™ç§æ–¹æ³•è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼šåŒæ—¶æ›´æ–°ä¸¤ä¸ªç¼“å­˜èµ„æºä¸ä¼šé€ æˆéƒ¨åˆ†ç¼“å­˜å…ˆæ›´æ–°è€Œå¼•èµ·æ–°æ—§æ–‡ä»¶å†…å®¹ä¸ä¸€è‡´ã€‚å¯¹äºäº’ç›¸æœ‰ä¾èµ–å…³ç³»çš„csså’Œjsæ–‡ä»¶ï¼Œé¿å…è¿™ç§ä¸ä¸€è‡´æ€§æ˜¯éå¸¸é‡è¦çš„ã€‚<br><img src="/2017/10/25/%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3/employCache.png" alt="employCache"></p>
<p>  å‚è€ƒï¼š</p>
<ul>
<li><a href="https://tools.ietf.org/html/rfc7234#section-5.2">RFC7234</a></li>
<li><a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.8">RFC2616</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching_FAQ">HTTP ç¼“å­˜ |MDN</a></li>
<li><a href="https://developers.google.cn/web/fundamentals/performance/optimizing-content-efficiency/http-caching">HTTP ç¼“å­˜ | google</a></li>
<li><a href="https://book.douban.com/subject/10746113/">HTTPæƒå¨æŒ‡å—</a></li>
</ul>
]]></content>
      <categories>
        <category>http</category>
      </categories>
  </entry>
  <entry>
    <title>è®°ä¸€æ¬¡502é”™è¯¯</title>
    <url>/2020/05/11/%E8%AE%B0%E4%B8%80%E6%AC%A1502%E9%94%99%E8%AF%AF/</url>
    <content><![CDATA[<h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p>ç”Ÿäº§ç¯å¢ƒçš„ä¸€ä¸ªnodejsæ¥å£çªç„¶æŠ¥é”™äº†ï¼Œè¿™ä¸ªæ¥å£ï¼ˆhttp:xxxx&#x2F;api&#x2F;nodeservice&#x2F;screenshotï¼‰æ˜¯ä¸€ä¸ªè¿”å›å½“å‰é¡µé¢æˆªå›¾çš„æ¥å£ï¼ŒæŠ¥é”™è¡¨è±¡ä¸ºè¿™ä¸ªæ¥å£è¯·æ±‚1-2åˆ†é’Ÿå·¦å³åæŠ¥502 Bad Gatewayé”™è¯¯ã€‚å¹¶ä¸”å…¶ä»–ç¯å¢ƒæ— æ³•å¤ç°ã€‚</p>
<span id="more"></span>

<h2 id="æ’é”™"><a href="#æ’é”™" class="headerlink" title="æ’é”™"></a>æ’é”™</h2><ul>
<li><p>(1) ç›´æ¥å»ç”Ÿäº§ç¯å¢ƒæŸ¥çœ‹nodejsæ—¥å¿—å‘ç°è¿™ä¸ªæˆªå›¾é™¤äº†æ—¶é—´æ…¢äº†ç‚¹è¿˜æ˜¯ä¼šæ­£å¸¸äº§ç”Ÿæˆªå›¾ï¼Œå¹¶æ²¡æœ‰é”™è¯¯æ—¥å¿—ã€‚</p>
</li>
<li><p>(2) è½¬å˜æ’æŸ¥æ–¹å‘ç›´æ¥åˆ°ä»£ç†nodejsæ¥å£çš„nginxï¼Œè¿™ä¸ªnginxå’Œnodejséƒ½ä»¥<code>docker container</code>çš„å½¢å¼éƒ¨ç½²åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¹¶ä¸”nginxçš„æ—¥å¿—éƒ½é‡å®šå‘åˆ°å®¹å™¨çš„æ ‡å‡†è¾“å‡ºä¸Š,åœ¨å®¿ä¸»æœºä¸Šä½¿ç”¨ä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># $(docker ps | awk &#x27;/nginx/&#123;print $1&#125;&#x27;) è¿™è¡Œå‘½ä»¤å¼€å¯ä¸€ä¸ªshellå­è¿›ç¨‹è¿”å›å‡ºnginxçš„container ID</span><br><span class="line">docker logs -f  $(docker ps | awk &#x27;/nginx/&#123;print $1&#125;&#x27;) | grep screenshot</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/11/%E8%AE%B0%E4%B8%80%E6%AC%A1502%E9%94%99%E8%AF%AF/nginx_error_log.png" alt="nginx log"><br>å›¾ä¸­æœ‰ç”¨é”™è¯¯ä¿¡æ¯ä¸º<code>upstream prematurely closed connection while reading response header from upstream</code>å­—é¢æ„æ€ä¸º<code>å½“ä»ä¸Šæ¸¸è¯»å–å“åº”æ ‡å¤´æ—¶ï¼Œä¸Šæ¸¸è¿‡æ—©å…³é—­è¿æ¥</code>ï¼Œæ£€æŸ¥äº†nginxçš„å„ç§é…ç½®éƒ½æ²¡é—®é¢˜ã€‚é‚£æ˜¯ä¸æ˜¯å°±å¦‚æ—¥å¿—æç¤ºä¸€æ ·æ˜¯ä¸Šæ¸¸çš„nodejså‡ºäº†é—®é¢˜ã€‚</p>
</li>
<li><p>(3) è½¬åˆ°nodejså®¹å™¨æ¥æŠ“åŒ…åˆ†æï¼Œåœ¨linuxä¸Šä¸€èˆ¬ä½¿ç”¨<code>tcpdump</code>è¿›è¡ŒæŠ“åŒ…ä½†æ˜¯nodejså®¹å™¨é‡Œæ²¡æœ‰å®‰è£…<code>tcpdump</code>ï¼Œå¹¶ä¸”<code>tcpdump</code>ä¸èƒ½ç›´æ¥åœ¨å®¿ä¸»æœºä¸Šç›´æ¥æŠ“å–å®¹å™¨å†…çš„åŒ…ï¼Œå› ä¸ºdockerçš„networkä½¿ç”¨äº†<a href="https://lwn.net/Articles/531114/">namespaceçš„éš”ç¦»</a>ï¼Œä¸¤ä¸ªç¯å¢ƒçš„ç½‘ç»œè¿›è¡Œäº†éš”ç¦»ï¼Œè¿˜å¥½æœ‰ä¸ªnsenterå·¥å…·å¯ä»¥æ ¹æ®å®¹å™¨çš„PIDè¿›å…¥åˆ°å®¹å™¨network namespace</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># $(docker ps | awk &#x27;/nodeservice/&#123;print $1&#125;&#x27;) å’Œä¸Šé¢ä¸€æ ·å¼€å¯ä¸€ä¸ªshellå­è¿›ç¨‹è·å–nodeserviceï¼ˆnodejså®¹å™¨åå­—ï¼‰çš„å®¹å™¨ID </span><br><span class="line"># $(docker inspect --format &quot;&#123;&#123;.State.Pid&#125;&#125;&quot; $containerID) å¼€å¯ä¸€ä¸ªå­è¿›ç¨‹è·å–å®¹å™¨çš„PID </span><br><span class="line">nodePID=$(docker inspect --format &quot;&#123;&#123;.State.Pid&#125;&#125;&quot; $(docker ps | awk &#x27;/nodeservice/&#123;print $1&#125;&#x27;))</span><br><span class="line">nsenter -t $nodePID -n</span><br><span class="line">ifconifg</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/11/%E8%AE%B0%E4%B8%80%E6%AC%A1502%E9%94%99%E8%AF%AF/container.png" alt="container"><br>ç®­å¤´ä¸­å°±æ˜¯è¿™ä¸ªnodejså®¹å™¨çš„ipï¼ˆ10.0.0.69ï¼‰äº†ï¼Œæ¥ä¸‹æ¥ç›´æ¥ä½¿ç”¨tcpdumpæ¥æŠ“åŒ…äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ç½‘å¡ä¸ºeth0 åè®®æŒ‡å®šä¸ºtcp è¿™é‡Œçš„ç«¯å£8080ï¼Œéœ€è¦æ³¨æ„æ˜¯å®¹å™¨å†…éƒ¨ç›‘å¬ç«¯å£å¹¶ä¸æ˜¯å®¹å™¨å¯¹å¤–æš´éœ²ç«¯å£</span><br><span class="line">tcpdump -i eth0 tcp port 8080</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/11/%E8%AE%B0%E4%B8%80%E6%AC%A1502%E9%94%99%E8%AF%AF/tcpdump.png" alt="tcpdump"><br>è¿™ä¸‹å¯ä»¥ä»æˆªå›¾ä¸­æ˜æ˜¾çœ‹å‡ºæ˜¯å®¹å™¨çš„ipï¼ˆ10.0.0.69ï¼‰ä¸»åŠ¨å‘nginxå‘èµ·FINæ–­æ‰TCPè¿æ¥ã€‚é—®é¢˜ä¸€å®šå‡ºåœ¨äº†nodejsäº†</p>
</li>
<li><p>(4)æ¥ä¸‹æ¥çœ‹nodejsæœåŠ¡è¿™é‡Œä¸»è¦ä½¿ç”¨çš„ä¸€ä¸ªå«httpçš„æ¨¡å—ï¼Œ<a href="https://nodejs.org/docs/latest-v10.x/api/http.html#http_server_timeout">è¿™ä¸ªæ¨¡å—åœ¨ä½nodeç‰ˆæœ¬æ—¶è¶…è¿‡2åˆ†é’Ÿä¼šä¸»åŠ¨resetæ‰è¯·æ±‚</a>å¦‚åœ¨10.x.xç‰ˆæœ¬æ—¶é»˜è®¤2ä¸¤åˆ†é’Ÿè‡ªåŠ¨æŒ‚æ‰è¯·æ±‚ï¼Œå½“å‰æœ€æ–°çš„13.10.1ä¸ä¼šï¼Œè¿™é‡Œå’Œæˆ‘ä»¬ç°è±¡å¾ˆæ¥è¿‘ã€‚éªŒè¯ä¸‹æˆ‘ä»¬nodejsçš„ç‰ˆæœ¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker exec -it $(docker ps | awk &#x27;/nodeservice/&#123;print $1&#125;&#x27;) node -v</span><br><span class="line">v10.15.1</span><br></pre></td></tr></table></figure>
<p>æœç„¶æ¥ä¸‹æ¥å°±æ˜¯ä¿®æ”¹äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// ä»£ç ä¸­æ·»åŠ ä¸‹é¢ä¸€è¡Œï¼Œæ—¶é—´è®¾ç½®ä¸º0ä»£è¡¨æ— é™</span><br><span class="line">service.setimeout(0);</span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸ºä»€ä¹ˆnodejsæ—¥å¿—æ²¡æœ‰è®°å½•è¿™ä¸ª reset TCP çš„æ“ä½œï¼Œå› ä¸ºnodejsä¸»è¦è®°å½•äº†erroräº‹ä»¶ï¼Œè€Œè¿™ä¸ªæ˜¯ä¸€ä¸ªtimeoutäº‹ä»¶ã€‚</p>
</li>
</ul>
<p>å‚è€ƒæ–‡æ¡£ï¼š</p>
<ul>
<li><a href="https://lwn.net/Articles/531114/">Namespaces in operation</a></li>
<li><a href="https://nodejs.org/docs/latest-v10.x/api/http.html#http_server_timeout">server.timeout</a></li>
</ul>
]]></content>
      <tags>
        <tag>nodejs docker tcpdump</tag>
      </tags>
  </entry>
  <entry>
    <title>è¯æ³•ç¯å¢ƒï¼šES</title>
    <url>/2018/08/13/%E8%AF%8D%E6%B3%95%E7%8E%AF%E5%A2%83ES/</url>
    <content><![CDATA[<h1 id="è¯¦è§£ECMA-262-5-3-2ç« -è¯æ³•ç¯å¢ƒï¼šECMAScriptçš„å®ç°"><a href="#è¯¦è§£ECMA-262-5-3-2ç« -è¯æ³•ç¯å¢ƒï¼šECMAScriptçš„å®ç°" class="headerlink" title="è¯¦è§£ECMA-262-5 3.2ç«   è¯æ³•ç¯å¢ƒï¼šECMAScriptçš„å®ç°"></a>è¯¦è§£ECMA-262-5 3.2ç«   è¯æ³•ç¯å¢ƒï¼šECMAScriptçš„å®ç°</h1><h2 id="å¯¼è¨€-Intruduction"><a href="#å¯¼è¨€-Intruduction" class="headerlink" title="å¯¼è¨€(Intruduction)"></a>å¯¼è¨€(Intruduction)</h2><p>åœ¨è¿™ä¸€ç« ä¸­æˆ‘ä»¬å°†ç»§ç»­è¯æ³•ç¯å¢ƒçš„è€ƒå¯Ÿ.åœ¨å…ˆå‰çš„<a href="http://dmitrysoshnikov.com/ecmascript/es5-chapter-3-1-lexical-environments-common-theory/#environment-frames-model">3.1ç« </a>æˆ‘ä»¬æ¾„æ¸…äº†å…³äºè¿™ä¸€è¯é¢˜çš„é€šç”¨ç†è®º.ç‰¹åˆ«æ˜¯æˆ‘ä»¬å·²ç»å­¦ä¹ äº†ç¯å¢ƒä¸é™æ€ä½œç”¨åŸŸä»¥åŠé—­åŒ…é—´çš„ç´§å¯†å…³ç³».  </p>
<p>æˆ‘ä»¬å·²ç»çŸ¥é“ECMAScriptä½¿ç”¨äº†ç¯å¢ƒå¸§é“¾çš„æ¨¡å‹,åœ¨è¿™ä¸ªç« èŠ‚ä¸­æˆ‘ä»¬å°†ç€æ‰‹äºè¯æ³•ç¯å¢ƒåœ¨ECMAScriptä¸­çš„å…·ä½“å®ç°.ç‰¹åˆ«æ˜¯æˆ‘ä»¬å°†è®¨è®ºESä¸­ä½¿ç”¨çš„å’Œé€šç”¨ç†è®ºä¸­ç›¸å¯¹åº”ç»“æ„å’Œæœ¯è¯­.  </p>
<p>æˆ‘ä»¬å°†ä»å®šä¹‰å¼€å§‹ï¼Œå°½ç®¡æˆ‘ä»¬å·²ç»åœ¨é€šç”¨ç†è®ºä¸­ç»™å‡ºäº†è¯æ³•ç¯å¢ƒçš„å®šä¹‰ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å°†ç»™å‡ºå’ŒECMA262-5ç›¸å…³çš„å®šä¹‰.  </p>
<span id="more"></span>
<h2 id="å®šä¹‰-Definitions"><a href="#å®šä¹‰-Definitions" class="headerlink" title="å®šä¹‰(Definitions)"></a>å®šä¹‰(Definitions)</h2><p>æ­£å¦‚æˆ‘ä»¬åœ¨é€šç”¨ç†è®ºä¸­è¯´çš„ï¼Œç¯å¢ƒæ˜¯ç”¨äºç®¡ç†åœ¨é€»è¾‘ä¸Šä»£ç åµŒå¥—çš„æ•°æ®(å˜é‡ï¼Œå‡½æ•°ï¼Œç­‰).åŒæ ·çš„ECMAScriptä¹Ÿæ˜¯ç›¸åŒçš„ä½œç”¨.  </p>
<ul>
<li>ä¸€ä¸ªè¯æ³•ç¯å¢ƒå®šä¹‰äº†åœ¨è¯æ³•åµŒå¥—ç»“æ„çš„ä»£ç æƒ…å†µä¸­ï¼Œæ ‡è¯†ç¬¦ä¸å˜é‡å€¼ä»¥åŠå‡½æ•°çš„å…³è”.</li>
</ul>
<p>åœ¨ESä¸­çš„è¯æ³•ç¯å¢ƒåŒ…å«ä¸¤éƒ¨åˆ†ï¼šä¸€æ˜¯ç¯å¢ƒè®°å½•ä»¥åŠä¸€ä¸ªå¯¹å¤–éƒ¨ç¯å¢ƒçš„å¼•ç”¨.I.e.å®šä¹‰ä¸­ç¯å¢ƒå’Œå…ˆå‰æ¨¡å‹ä¸­è®¨è®ºçš„å•å¸§ç›¸å¯¹åº”.å› æ­¤:  </p>
<ul>
<li>ä¸€ä¸ªç¯å¢ƒè®°å½•è¡¨ç¤ºæ ‡è¯†ç¬¦ä¸åˆ›å»ºæ—¶è¯æ³•ä½œç”¨åŸŸç›¸çš„ç»‘å®š</li>
</ul>
<p>è¿™å°±æ˜¯ä¸€ä¸ªç¯å¢ƒè®°å½•ï¼Œå®ƒä¿å­˜ç€å½“å‰ä¸Šä¸‹æ–‡æ˜¾ç¤ºçš„å˜é‡.  </p>
<p>çœ‹ä¸‹é¢ä¾‹å­:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var x = 10;</span><br><span class="line"> </span><br><span class="line">function foo() &#123;</span><br><span class="line">  var y = 20;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çŸ¥é“è¿™é‡Œæœ‰è¿ä¸ªæŠ½è±¡çš„ç¯å¢ƒï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº”ç€å…¨å±€ä¸Šä¸‹æ–‡å’Œfooå‡½æ•°ä¸Šä¸‹æ–‡:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// environment of the global context</span><br><span class="line"> </span><br><span class="line">globalEnvironment = &#123;</span><br><span class="line"> </span><br><span class="line">  environmentRecord: &#123;</span><br><span class="line"> </span><br><span class="line">    // built-ins:</span><br><span class="line">    Object: function,</span><br><span class="line">    Array: function,</span><br><span class="line">    // etc ...</span><br><span class="line"> </span><br><span class="line">    // our bindings:</span><br><span class="line">    x: 10</span><br><span class="line"> </span><br><span class="line">  &#125;,</span><br><span class="line"> </span><br><span class="line">  outer: null // no parent environment</span><br><span class="line"> </span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">// environment of the &quot;foo&quot; function</span><br><span class="line"> </span><br><span class="line">fooEnvironment = &#123;</span><br><span class="line">  environmentRecord: &#123;</span><br><span class="line">    y: 20</span><br><span class="line">  &#125;,</span><br><span class="line">  outer: globalEnvironment</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªouterå¼•ç”¨é€šå¸¸ç”¨äºè¿æ¥å½“å‰ç¯å¢ƒçš„çˆ¶çº§ç¯å¢ƒ,å½“ç„¶çˆ¶çº§å‡½æ•°ä¹Ÿæœ‰è‡ªå·±çš„outeè¿æ¥.å¹¶ä¸”å…¨å±€ç¯å¢ƒçš„outeræŒ‡å‘null.  </p>
<p>å…¨å±€ç¯å¢ƒæ˜¯è¿™ä¸ªä½œç”¨åŸŸé“¾çš„é¡¶ç«¯.è¿™ä¸ESåŸå‹ç»§æ‰¿å¾ˆåƒ:å¦‚æœä¸€ä¸ªå±æ€§æ²¡åœ¨å½“å‰å¯¹è±¡æ‰¾åˆ°,é‚£ä¹ˆå®ƒå°±æœå¯»å…¶åŸå‹,æ¥ç€åŸå‹çš„åŸå‹ä»¥æ­¤ç±»æ¨.ç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢,æˆ–è€…æ‰¾åˆ°åŸå‹çš„é¡¶éƒ¨.ç¯å¢ƒå’Œå®ƒä¸€æ ·ï¼šä¸Šä¸‹æ–‡ä¸­å‡ºç°çš„å˜é‡(æˆ–æ ‡è¯†ç¬¦)åƒå±æ€§ä¸€æ ·,outerè¿æ¥ä»£è¡¨ç€åŸå‹.  </p>
<p>å¦‚å…ˆå‰æ‰€è¯´çš„ä¸€ä¸ªè¯æ³•ç¯å¢ƒå¯èƒ½åŒ…å«å¤šä¸ªå†…éƒ¨è¯æ³•ç¯å¢ƒ.e.g,å¦‚æœä¸€ä¸ªå‡½æ•°åŒ…å«ä¸¤ä¸ªåµŒå¥—å‡½æ•°é‚£ä¹ˆæ¯ä¸ªåµŒå¥—å‡½æ•°çš„outerå¼•ç”¨æŒ‡å‘ç›¸åŒçš„å¤–éƒ¨ç¯å¢ƒ.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line"> </span><br><span class="line">  var x = 10;</span><br><span class="line"> </span><br><span class="line">  function bar() &#123;</span><br><span class="line">    var y = 20;</span><br><span class="line">    console.log(x + y); // 30</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  function baz() &#123;</span><br><span class="line">    var z = 30;</span><br><span class="line">    console.log(x + y); // 40</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">//Environments</span><br><span class="line"> </span><br><span class="line">// &quot;foo&quot; environmnet</span><br><span class="line"> </span><br><span class="line">fooEnvironment = &#123;</span><br><span class="line">  environmentRecord: &#123;x: 10&#125;,</span><br><span class="line">  outer: globalEnvironment</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">// both &quot;bar&quot; and &quot;baz&quot; have the same outer</span><br><span class="line">// environment -- the environment of &quot;foo&quot;</span><br><span class="line"> </span><br><span class="line">barEnvironment = &#123;</span><br><span class="line">  environmentRecord: &#123;y: 20&#125;,</span><br><span class="line">  outer: fooEnvironment</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">bazEnvironment = &#123;</span><br><span class="line">  environmentRecord: &#123;z: 30&#125;,</span><br><span class="line">  outer: fooEnvironment</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ECMAScript å®šä¹‰äº†ä¸¤ç§ç±»å‹çš„ç¯å¢ƒè®°,å®ƒä»¬ä¸»è¦æ˜¯ä¸ºæ˜¯å…¶å®ç°ç›®çš„.ä½†æ˜¯åœ¨æŸäº›ç»†èŠ‚ä¸Šæˆ‘ä»¬è®¤ä¸ºå®ƒä»¬å®Œå…¨ç›¸åŒ. </p>
<h2 id="ç¯å¢ƒè®°å½•ç±»å‹-Environment-record-types"><a href="#ç¯å¢ƒè®°å½•ç±»å‹-Environment-record-types" class="headerlink" title="ç¯å¢ƒè®°å½•ç±»å‹(Environment record types)"></a>ç¯å¢ƒè®°å½•ç±»å‹(Environment record types)</h2><p>åœ¨ES5æ–‡æ¡£ä¸­æŒ‡æ˜äº†ä¸¤ç§ç±»å‹çš„ç¯å¢ƒè®°å½•ï¼šå£°æ˜ç¯å¢ƒè®°å½•å’Œå¯¹è±¡ç¯å¢ƒè®°å½•  </p>
<h3 id="å£°æ˜ç¯å¢ƒè®°å½•-Declarative-environment-record"><a href="#å£°æ˜ç¯å¢ƒè®°å½•-Declarative-environment-record" class="headerlink" title="å£°æ˜ç¯å¢ƒè®°å½•(Declarative environment record)"></a>å£°æ˜ç¯å¢ƒè®°å½•(Declarative environment record)</h3><p>å£°æ˜ç¯å¢ƒè®°å½•é€šå¸¸ç”¨äºå‡ºç°åœ¨å‡½æ•°ä½œç”¨åŸŸçš„å˜é‡,å‡½æ•°,å½¢å‚ç­‰ç­‰.(è¿™ç§æƒ…å†µä¸‹å’Œes3ä¸­æ´»åŠ¨å˜é‡å¾ˆåƒ)å’Œcatchè¯­å¥.  </p>
<p>å¦‚ä¸‹ä¾‹ï¼š  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// all: &quot;a&quot;, &quot;b&quot; and &quot;c&quot;</span><br><span class="line">// bindings are bindings of</span><br><span class="line">// a declarative record</span><br><span class="line"> </span><br><span class="line">function foo(a) &#123;</span><br><span class="line">  var b = 10;</span><br><span class="line">  function c() &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨catchä»å¥ä¸­ç»‘å®šæ˜¯æ˜¯æœŸå¾…å‚æ•°:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125; catch (e) &#123; // &quot;e&quot; is a binding of a declarative record</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šå¸¸æƒ…å†µä¸‹å£°æ˜è®°å½•é»˜è®¤å­˜å‚¨åœ¨ä½é˜¶å·¥å…·ä¸­(å¦‚è™šæ‹Ÿæœºçš„å¯„å­˜å™¨,å› æ­¤èƒ½æä¾›å¿«é€Ÿè®¿é—®),è¿™æ˜¯å’ŒåŸæ¥ES3ä¸­çš„æ´»åŠ¨å¯¹è±¡(activeaction object)ä¸»è¦çš„ä¸åŒ.  </p>
<p>è§„èŒƒæ²¡æœ‰è¦æ±‚(ç”šè‡³é—´æ¥ä¸å»ºè®®)å£°æ˜è®°å½•çš„å®ç°ä»¥ä¸€ç§ä½æ•ˆç‡çš„ç®€å•å¯¹è±¡.è¿™æ ·çš„ç»“æœå¯¼è‡´å£°æ˜ç¯å¢ƒä¸ä¼šç›´æ¥é»˜è®¤æš´éœ²ç»™ç”¨æˆ·çº§åˆ«,è¿™ä¹Ÿæ„å‘³ç€æˆ‘ä»¬ä¸èƒ½åƒè®°å½•çš„å±æ€§ä¸€æ ·ç›´æ¥è®¿é—®è¿™äº›ç»‘å®šï¼ŒåŒæ ·çš„ç”šè‡³åœ¨ES3ä¸­ä¹Ÿä¸èƒ½è®¿é—®(é™¤éåœ¨Rhinoå®ç°çš„åˆ©ç”¨__parent__è®¿é—®).  </p>
<p>éšå½¢çš„,å£°æ˜è®°å½•å…è®¸å…¶ä½¿ç”¨<a href="http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-35.html#%_sec_5.5.6">è¯æ³•å¤„ç†</a>æŠ€æœ¯,è¿™å°±æ„å‘³ç€å¯ä»¥ä¸é€šè¿‡ä»»ä½•ä½œç”¨åŸŸé“¾ç›´æ¥è·å–éœ€è¦çš„å˜é‡â€“ä¸ç®¡ä½œç”¨åŸŸåµŒå¥—å¤šæ·±(å¦‚æœå­˜å‚¨æ˜¯å›ºå®šçš„æˆ–è€…ä¸å˜çš„,æ‰€æœ‰çš„å˜é‡å¤„ç†éƒ½å¯ä»¥åœ¨ç¼–è¯‘ä¹‹å‰å°±å¯çŸ¥é“).ä½†æ˜¯ES5è§„èŒƒå¹¶æ²¡ç›´æ¥æåˆ°è¿™ä¸ªäº‹å®.  </p>
<p>å†è¯´ä¸€æ¬¡,å…³äºä½¿ç”¨å£°æ˜ç¯å¢ƒè®°å½•æ›¿ä»£è€çš„æ´»åŠ¨å¯¹è±¡æ¦‚å¿µä¸€åˆ‡éƒ½æ˜¯ä¸ºäº†å®ç°ä¸Šçš„é«˜æ•ˆ.  </p>
<p>å› æ­¤,å¦‚Brendan Eich<a href="https://mail.mozilla.org/pipermail/es-discuss/2010-April/010915.html">æåˆ°çš„</a>(æœ€åä¸€æ®µ)â€“åœ¨ES3ä¸­æ´»åŠ¨å¯¹è±¡çš„å®ç°ç®€ç›´å°±æ˜¯ä¸€ä¸ªâ€™a bugâ€™  </p>
<p>ç†è®ºä¸Š,ç¯å¢ƒçš„å£°æ˜è®°å½•å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼å®ç°(åŸå‹çš„typeä¸æ˜¯è§„èŒƒé‡Œçš„,è¿™é‡Œåªæ˜¯æˆ‘ç”¨ä½œè¯´æ˜)   </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">environment = &#123;</span><br><span class="line">  // storage</span><br><span class="line">  environmentRecord: &#123;</span><br><span class="line">    type: &quot;declarative&quot;,</span><br><span class="line">    // storage</span><br><span class="line">  &#125;,</span><br><span class="line">  // reference to the parent environment</span><br><span class="line">  outer: &lt;...&gt;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="Evalå’Œå†…éƒ¨å‡½æ•°ä¹Ÿè®¸ä¼šç ´åä¼˜åŒ–-Eval-and-inner-functions-may-break-optimizations"><a href="#Evalå’Œå†…éƒ¨å‡½æ•°ä¹Ÿè®¸ä¼šç ´åä¼˜åŒ–-Eval-and-inner-functions-may-break-optimizations" class="headerlink" title="Evalå’Œå†…éƒ¨å‡½æ•°ä¹Ÿè®¸ä¼šç ´åä¼˜åŒ–(Eval and inner functions may break optimizations)"></a>Evalå’Œå†…éƒ¨å‡½æ•°ä¹Ÿè®¸ä¼šç ´åä¼˜åŒ–(Eval and inner functions may break optimizations)</h4><p>æ³¨æ„,evalå‡½æ•°å¯ä»¥ç ´åç¯å¢ƒè®°å½•çš„é«˜æ•ˆï¼Œè¿™æ˜¯å› ä¸ºä½¿ç”¨evalçš„è¯æ ¹æœ¬ä¸çŸ¥é“å“ªäº›åº”è¯¥ç»‘å®š.  </p>
<p>æ¯”å¦‚è¯´V8å®ç°çš„å¼•æ“(æˆ‘çŒœå…¶ä»–çš„ä¹Ÿä¸€æ ·)ä¼šä¼˜åŒ–å‡½æ•°å¦‚ä¸ä¼šåˆ›å»ºargumentså¯¹è±¡(å¦‚æœå®ƒæ²¡åœ¨å‡½æ•°ä½“å†…å‡ºç°),ä¹Ÿä¸ä¼šä¿å­˜æ²¡ç”¨çš„çˆ¶çº§å˜é‡.è¿™æ ·çš„å‡½æ•°ä¼šæ›´åŠ è½»é‡,å®ƒè‡ªä¼šä¿å­˜ä½¿ç”¨è¯æ³•å˜é‡.I.eå¦‚æœçˆ¶çº§å˜é‡æ²¡æœ‰ä½¿ç”¨â€“å‡½æ•°ç”šè‡³ä¸ä¼šæœ‰é—­åŒ….(æˆªå±è‡ªchrome dev-tools)ï¼š<br><img src="/2018/08/13/%E8%AF%8D%E6%B3%95%E7%8E%AF%E5%A2%83ES/withoutEval.png" alt="withoutEval"> </p>
<p>ç„¶åç›¸åŒçš„å‡½æ•°,ä½†æ˜¯æœ‰ä¸€ä¸ªç©ºçš„evalè°ƒç”¨:</p>
<p><img src="/2018/08/13/%E8%AF%8D%E6%B3%95%E7%8E%AF%E5%A2%83ES/withEval.png" alt="withEval">  </p>
<p>å› ä¸ºä½¿ç”¨äº†evalå°±ä¸èƒ½æå‰çŸ¥é“å“ªäº›æ•°æ®å°†ä¼šè¢«ä½¿ç”¨,æˆ‘ä»¬å°†çœ‹åˆ°æ‰€æœ‰çš„â€é‡é‡ä¸œè¥¿â€, argumnetså¯¹è±¡,å’Œé—­åŒ…å±æ€§ï¼Œieçˆ¶çº§ç¯å¢ƒ.  </p>
<p>è¿›ä¸€æ­¥ï¼Œçœ‹ä¸€çœ‹åä¸€ç§æƒ…å†µçš„outerFn,å®ƒåŒæ ·åˆ›å»ºäº†argumentså¯¹è±¡å› ä¸ºæ‹¥æœ‰å†…éƒ¨å‡½æ•°å› æ­¤å¾ˆéš¾åˆ†æå‡ºå†…éƒ¨å‡½æ•°æ˜¯å¦ä½¿ç”¨argumnets.  </p>
<p>ç„¶è€Œ,è¿™åªæ˜¯ä¸€ç§å®ç°ï¼Œå®ƒè®©æˆ‘ä»¬çœ‹åˆ°äº†æœ‰å“ªäº›ä¼˜åŒ–å¯ä»¥æä¾›ï¼Œä¹Ÿå¯ä»¥æ€ä¹ˆå–æ¶ˆè¿™äº›ä¼˜åŒ–.<br>è®©æˆ‘ä»¬çœ‹çœ‹ç¬¬äºŒç§ç¯å¢ƒè®°å½•ç±»å‹â€“å¯¹è±¡ç¯å¢ƒè®°å½•.  </p>
<h3 id="å¯¹è±¡ç¯å¢ƒè®°å½•-Object-environment-record"><a href="#å¯¹è±¡ç¯å¢ƒè®°å½•-Object-environment-record" class="headerlink" title="å¯¹è±¡ç¯å¢ƒè®°å½•(Object environment record)"></a>å¯¹è±¡ç¯å¢ƒè®°å½•(Object environment record)</h3><p>ç›¸åçš„,å¯¹è±¡ç¯å¢ƒè®°å½•è¢«ç”¨æ¥å®šä¹‰åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸‹çš„å˜é‡ï¼Œå‡½æ•°ä»¥åŠå†…éƒ¨ä½¿ç”¨withè¯­å¥.è¿™äº›ä¸œè¥¿éƒ½ä»¥ä½æ•ˆçš„æ–¹å¼å­˜å‚¨åœ¨ä¸€ä¸ªç®€å•å¯¹è±¡æ¥å®ç°.å¦‚ä¸Šé¢æåˆ°çš„,è¿™ç§æƒ…å†µçš„ç»‘å®šéƒ½æ˜¯ä»¥å¯¹è±¡å±æ€§çš„å½¢å¼.  </p>
<ul>
<li>è¿™ç§å­˜å‚¨ç€ç»‘å®šçš„ä¸Šä¸‹æ–‡è¢«ç§°ä½œç»‘å®šå¯¹è±¡</li>
</ul>
<p>åœ¨å…¨å±€ä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹,å˜é‡å’Œå…¨å±€å¯¹è±¡ç›¸å…³è”,æ­£å› å¦‚æ­¤æˆ‘ä»¬æ‰å¯ä»¥åƒå…¨å±€å¯¹è±¡å±æ€§ä¸€æ ·å¼•ç”¨å®ƒä»¬:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var a = 10;</span><br><span class="line">console.log(a); // 10</span><br><span class="line"> </span><br><span class="line">// &quot;this&quot; in the global context</span><br><span class="line">// is the global object itself</span><br><span class="line">console.log(this.a); // 10</span><br><span class="line"> </span><br><span class="line">// &quot;window&quot; is the reference to the</span><br><span class="line">// global object in the browser environment</span><br><span class="line">console.log(window.a); // 10</span><br></pre></td></tr></table></figure>

<p>åœ¨ä½¿ç”¨withè¯­å¥çš„æƒ…å†µä¸‹,å˜é‡å’Œwithâ€“å¯¹è±¡å±æ€§ç›¸å…³è”:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">with (&#123;a: 10&#125;) &#123;</span><br><span class="line">  console.log(a); // 10</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¯æ¬¡æ‰§è¡Œwithè¯­å¥æ—¶ä¸€ä¸ªæ–°çš„è¯æ³•ç¯å¢ƒå°±è¢«åˆ›å»ºï¼Œè¿™è¯æ³•ç¯å¢ƒçš„ç¯å¢ƒè®°å½•æ˜¯å¯¹è±¡ç¯å¢ƒè®°å½•,è€Œouterç¯å¢ƒæŒ‡å‘å½“å‰è¿è¡Œçš„ç¯å¢ƒ.ç„¶åå°†å½“å‰è¿è¡Œç¯å¢ƒæ›¿æ¢ä¸ºwithåˆ›å»ºçš„æ–°ç¯å¢ƒ.å½“withæ‰§è¡Œå®Œæ¯•å½“å‰è¿è¡Œç¯å¢ƒåˆæ¢å¤ä¸ºåŸæ¥çŠ¶æ€.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var a = 10;</span><br><span class="line">var b = 20;</span><br><span class="line"> </span><br><span class="line">with (&#123;a: 30&#125;) &#123;</span><br><span class="line">  console.log(a + b); // 50</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">console.log(a + b); // 30, restored</span><br></pre></td></tr></table></figure>

<p>ä¼ªä»£ç å¦‚ä¸‹ï¼š  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// initial state</span><br><span class="line">context.lexicalEnvironment = &#123;</span><br><span class="line">  environmentRecord: &#123;a: 10, b: 20&#125;,</span><br><span class="line">  outer: null</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">// &quot;with&quot; executed</span><br><span class="line">previousEnvironment = context.lexicalEnvironment;</span><br><span class="line"> </span><br><span class="line">withEnvironment = &#123;</span><br><span class="line">  environmentRecord: &#123;a: 30&#125;,</span><br><span class="line">  outer: context.lexicalEnvironment</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">// replace current environment</span><br><span class="line">context.lexicalEnvironment = withEnvironment;</span><br><span class="line"> </span><br><span class="line">// &quot;with&quot; completed, restore the environment back</span><br><span class="line">context.lexicalEnvironment = previousEnvironment;</span><br></pre></td></tr></table></figure>

<p>æ•ˆæœä¸Šæ¥çœ‹å’Œcatchä»å¥ä¸€æ ·,åŒæ ·çš„å°†å½“å‰è¿è¡Œç¯å¢ƒæ›¿æ¢ä¸ºæ–°åˆ›å»ºçš„é‚£ä¸ªç¯å¢ƒï¼Œè¿™ä¸è¿‡è¿™ä¸ªç¯å¢ƒçš„ç¯å¢ƒè®°å½•ä¸ºå£°æ˜ç¯å¢ƒè®°å½•.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var e = 10;</span><br><span class="line"> </span><br><span class="line">try &#123;</span><br><span class="line">  throw 20;</span><br><span class="line">&#125; catch (e) &#123; // replace the environment</span><br><span class="line">  console.log(e); // 20</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// and now it&#x27;s restored back</span><br><span class="line">console.log(e); // 10</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æˆ‘å°†çœ‹çœ‹è¿™äº›ç”±withè¯­å¥å’Œcatchä»å¥åˆ›å»ºçš„æš‚æ—¶ç¯å¢ƒä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼æ—¶çš„æ•ˆæœ.   </p>
<p>å› ä¸ºå¯¹è±¡ç¯å¢ƒè®°å½•çš„ä½æ•ˆï¼Œåœ¨ES5ä¸¥æ ¼æ¨¡å¼ä¸‹withè¯­å¥è¢«ç§»é™¤æ‰äº†.  </p>
<p>æ›´å¤šåŸå› æ˜¯ï¼Œwithè¯­å¥åœ¨è®¸å¤šåœºåˆé€ æˆæ··æ·†(å› ä¸ºå˜é‡å’Œå‡½æ•°å£°æ˜çš„æå‡)å¹¶ä¸”å…¶ä¸­ä¸€äº›çœŸå¾ˆè®©äººå›°æƒ‘,è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆwithåœ¨ES5ä¸¥æ ¼æ¨¡å¼ä¸‹å»é™¤.  </p>
<p>å°†å…¨å±€å¯¹è±¡ä»ä½œç”¨åŸŸé“¾çš„åº•éƒ¨ç§»é™¤æ˜¯ä¸‹ä¸€ä»£ESçš„è®¡åˆ’,å…¨å±€ç¯å¢ƒè®°å½•ä¹Ÿå°†ä»å¯¹è±¡è½¬ä¸ºå£°æ˜,ä½¿ç”¨modulesè¿™æ ·çš„ä½“ç³»,å…¨å±€ç»‘å®šå¦‚parseInt,Mathç­‰ç­‰éƒ½å°†åªæ˜¯å¼•å…¥åˆ°å…¨å±€ä¸Šä¸‹æ–‡ä¸­,ä½†æ˜¯æŠ€æœ¯ä¸Šæ¥è¯´å®ƒä»¬å°†ä¸å†æ˜¯å…¨å±€å¯¹è±¡çš„å±æ€§äº†,å› ä¸ºå·²ç»æ²¡æœ‰å…¨å±€å¯¹è±¡äº†.   </p>
<p>ç†è®ºä¸Šæ¥è¯´,ä¸€ä¸ªæ‹¥æœ‰å¯¹è±¡ç¯å¢ƒè®°å½•çš„ç¯å¢ƒ,å¯ä»¥ä»¥è¿™ç§æ–¹å¼å‘ˆç°:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">environment = &#123;</span><br><span class="line">  // storage</span><br><span class="line">  environmentRecord: &#123;</span><br><span class="line">    type: &quot;object&quot;,</span><br><span class="line">    bindingObject: &#123;</span><br><span class="line">      // storage</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  // reference to the parent environment</span><br><span class="line">  outer: &lt;...&gt;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è§„èŒƒæœ‰è¯´æ˜åˆ°,bingdingObjectæ˜¯çœŸæ­£å¯¹è±¡(e.g. å…¨å±€å¯¹è±¡)çš„æŸç§æ˜ å°„,ä½†ä¸æ˜¯æ‰€æœ‰åœ¨åŸå§‹å¯¹è±¡çš„å±æ€§éƒ½è¢«å½“åšç»‘å®šå¯¹è±¡çš„å±æ€§,æ¯”å¦‚è¯´,å±æ€§åä¸èƒ½ä¸ºæ ‡è¯†ç¬¦çš„å˜é‡å°±æ²¡æœ‰åŒ…å«åœ¨ç»‘å®šå¯¹è±¡ä¸Šï¼Œè¿™æ˜¯ç›¸å½“ç¬¦åˆé€»è¾‘çš„è¿™æ˜¯å› ä¸ºå®ƒä»¬ä¸èƒ½è¢«å½“åšå˜é‡å¼•ç”¨:   </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// global properties</span><br><span class="line">this[&#x27;a&#x27;] = 10; // included in the binding object</span><br><span class="line">this[&#x27;hello world&#x27;] = 20; // isn&#x27;t included</span><br><span class="line"> </span><br><span class="line">console.log(a); // 10, can refer</span><br><span class="line">console.log(hello world); // cannot, syntax error</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œ,å¦‚ä½•å°†åŸå§‹å¯¹è±¡åŒæ­¥çš„ç»‘å®šè§„èŒƒå¹¶æ²¡æœ‰å…·ä½“æŒ‡å‡º.  </p>
<h2 id="æ‰§è¡Œä¸Šä¸‹æ–‡ç»“æ„-Structure-of-execution-context"><a href="#æ‰§è¡Œä¸Šä¸‹æ–‡ç»“æ„-Structure-of-execution-context" class="headerlink" title="æ‰§è¡Œä¸Šä¸‹æ–‡ç»“æ„(Structure of execution context)"></a>æ‰§è¡Œä¸Šä¸‹æ–‡ç»“æ„(Structure of execution context)</h2><p>è¿™é‡Œæˆ‘ä»¬å°†ç®€å•æåŠES5ä¸­æ‰§è¡Œä¸Šä¸‹æ–‡çš„ç»“æ„.å®ƒå’ŒES3ä¸­çš„æœ‰ä¸€ç‚¹ä¸åŒ,å¹¶ä¸”æœ‰å¦‚ä¸‹å±æ€§:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ExecutionContextES5 = &#123;</span><br><span class="line">  ThisBinding: &lt;this value&gt;,</span><br><span class="line">  VariableEnvironment: &#123; ... &#125;,</span><br><span class="line">  LexicalEnvironment: &#123; ... &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šä¸‹æ–‡ä¸­æœ‰å˜é‡ç¯å¢ƒå’Œè¯æ³•ç¯å¢ƒ,è¿™å¯¹é˜…è¯»è§„èŒƒçš„è¯»è€…å¸¸å¸¸é€ æˆç–‘æƒ‘ï¼Œæˆ‘ä»¬å°†ç®€å•çš„æ¾„æ¸…å®ƒä»¬ï¼Œä½†æ˜¯è¿™é‡Œåªæ˜¯ç®€å•æ³¨æ„è¿™æ˜¯ä¸»è¦æ˜¯æ¥åŒºåˆ†<a href="http://dmitrysoshnikov.com/ecmascript/chapter-5-functions/#function-declaration">å‡½æ•°å£°æ˜</a>å’Œ<a href="http://dmitrysoshnikov.com/ecmascript/chapter-5-functions/#function-expression">å‡½æ•°è¡¨è¾¾å¼</a>çš„[[Scope]]å€¼.  </p>
<p>è®©æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹æ‰§è¡Œç¯å¢ƒçš„å±æ€§.  </p>
<h3 id="thisç»‘å®š-This-binding"><a href="#thisç»‘å®š-This-binding" class="headerlink" title="thisç»‘å®š(This binding)"></a>thisç»‘å®š(This binding)</h3><p>Thisçš„å€¼ç°åœ¨ç§°ä¸ºthisç»‘å®š,ç„¶è€Œé™¤äº†æœ¯è¯­æ”¹å˜äº†å…¶ä»–çš„ä»è¯­ä¹‰ä¸Š(é™¤äº†åœ¨ä¸¥æ ¼æ¨¡å¼ä¸Šï¼Œthiså¯èƒ½ä¸ºundefined)æ²¡æœ‰ä»€ä¹ˆæ”¹å˜,åœ¨å…¨å±€æ¨¡å¼ä¸‹, thisä»»ç„¶ç»‘å®šçš„æ˜¯å…¨å±€å¯¹è±¡æœ¬èº«ï¼š  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(function (global) &#123;</span><br><span class="line">  global.a = 10;</span><br><span class="line">&#125;)(this);</span><br><span class="line"> </span><br><span class="line">console.log(a); // 10</span><br></pre></td></tr></table></figure>

<p>å¹¶ä¸”åœ¨å‡½æ•°ä¸Šä¸‹æ–‡ä¸­thisçš„å€¼ä»ç”±å‡½æ•°å¦‚ä½•è°ƒç”¨æ‰€å†³å®š.å¦‚æœä»–æ˜¯é€šè¿‡ä¸€ä¸ª<a href="http://dmitrysoshnikov.com/ecmascript/chapter-3-this/#-reference-type">å¼•ç”¨</a>è°ƒç”¨,é‚£ä¹ˆthisçš„åŸºæœ¬å€¼ç”±å¼•ç”¨å†³å®š,å…¶ä»–æƒ…å†µâ€“è¦ä¹ˆå…¨å±€å¯¹è±¡æˆ–è€…åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹çš„undefined.  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var foo = &#123;</span><br><span class="line">  bar: function () &#123;</span><br><span class="line">    console.log(this);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">// --- Reference cases ---</span><br><span class="line"> </span><br><span class="line">// with a reference</span><br><span class="line">foo.bar(); // &quot;this&quot; is &quot;foo&quot; - the base</span><br><span class="line"> </span><br><span class="line">var bar = foo.bar;</span><br><span class="line"> </span><br><span class="line">// with the reference</span><br><span class="line">bar(); // &quot;this&quot; is the global, implicit base</span><br><span class="line">this.bar(); // the same, explicit base, the global</span><br><span class="line"> </span><br><span class="line">// with also but another reference</span><br><span class="line">bar.prototype.constructor(); // &quot;this&quot; is &quot;bar.prototype&quot;</span><br><span class="line"> </span><br><span class="line">// --- non-Reference cases ---</span><br><span class="line"> </span><br><span class="line">(foo.bar = foo.bar)(); // &quot;this&quot; is &quot;global&quot; or &quot;undefined&quot;</span><br><span class="line">(foo.bar || foo.bar)(); // &quot;this&quot; is &quot;global&quot; or &quot;undefined&quot;</span><br><span class="line">(function () &#123; this; &#125;)(); // &quot;this&quot; is &quot;global&quot; or &quot;undefined&quot;</span><br></pre></td></tr></table></figure>

<p>å†æ¬¡æ³¨æ„,åœ¨ä¸¥æ ¼æ¨¡å¼,ä¸èƒ½é€šè¿‡å¦‚ä¸‹æ¨¡å¼è·å¾—å…¨å±€å¯¹è±¡:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(function () &#123;</span><br><span class="line">  &quot;use strict&quot;;</span><br><span class="line">  var global = (function () &#123; return this; &#125;)();</span><br><span class="line">  console.log(global); // undefined!</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>å¦‚å’Œåœ¨è¿™ç§æƒ…å†µä¸‹(åŒ…æ‹¬é—´æ¥è°ƒç”¨å’Œeval)å¤„ç†è¿™ç§æŠ€æœ¯å°†åœ¨<a href="http://dmitrysoshnikov.com/ecmascript/es5-chapter-2-strict-mode/#codethiscode-value-restrictions">ä¸¥æ ¼æ¨¡å¼</a>ç« èŠ‚ä»‹ç».  </p>
<p>è®©æˆ‘ä»¬å›åˆ°ç¯å¢ƒæ¥çœ‹è§„èŒƒä¸­ä¸Šä¸‹æ–‡ä¸­çš„å˜é‡ç¯å¢ƒå’Œè¯æ³•ç¯å¢ƒ,è¿™ä¸¤éƒ¨åˆ†å¸¸å¸¸é€ æˆè¯¯è§£å¹¶ä¸”åœ¨ä¸€äº›è§£é‡Šä¸­æè¿°å¸¸å¸¸ä¸æ­£ç¡®.  </p>
<h3 id="å˜é‡ç¯å¢ƒ-Variable-environment"><a href="#å˜é‡ç¯å¢ƒ-Variable-environment" class="headerlink" title="å˜é‡ç¯å¢ƒ(Variable environment)"></a>å˜é‡ç¯å¢ƒ(Variable environment)</h3><p>å˜é‡ç¯å¢ƒéƒ¨åˆ†å­˜å‚¨ç€åˆå§‹åŒ–å˜é‡å’Œå‡½æ•°çš„ä¸Šä¸‹æ–‡.å‡†ç¡®çš„è¯´å®ƒçš„ç¯å¢ƒå­˜å‚¨åŒ…å«ç€è¿›å…¥ä¸Šä¸‹æ–‡æ˜¯å¡«å……çš„æ•°æ®.è¿™å’ŒES3ä¸­çš„<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core/#variable-object">å˜é‡å¯¹è±¡</a>å¾ˆåƒ.  </p>
<p>å½“è¿›å…¥ä¸€ä¸ªå‡½æ•°çš„ä¸Šä¸‹æ–‡æ—¶,å›æƒ³ä¸€ä¸‹è¿™æ—¶ä¸€ä¸ªç‰¹åˆ«çš„argumnetså¯¹è±¡ç”¨äºè¡¨ç¤ºä¼ å…¥çš„å½¢å‚å€¼è¢«åˆ›å»º.åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹argumentså¯¹è±¡ç»å†äº†<a href="http://dmitrysoshnikov.com/ecmascript/es5-chapter-2-strict-mode/#codeevalcode-and-codeargumentscode-restrictions">å¾ˆå¤šæ”¹å˜</a>,å…¶ä¸­argumentså°†ä¸èƒ½é€šè¿‡å…¶å±æ€§æ”¹å˜å…¶çœŸæ­£çš„å‚æ•°å€¼.è¿˜æœ‰callee(è°ƒç”¨å‡½æ•°æœ¬èº«çš„å¼•ç”¨)å°†åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹åºŸé™¤.  </p>
<p>åœ¨è¿™ä¸ªä»£ç é‡Œ:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function foo(a) &#123;</span><br><span class="line">  var b = 20;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">foo(10);</span><br></pre></td></tr></table></figure>

<p>ç†è®ºä¸Šæˆ‘ä»¬æœ‰å¦‚ä¸‹VariableEnvironmentæ„æˆfooå‡½æ•°çš„ä¸Šä¸‹æ–‡:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fooContext.VariableEnvironment = &#123;</span><br><span class="line">  environmentRecord: &#123;</span><br><span class="line">    arguments: &#123;0: 10, length: 1, callee: foo&#125;,</span><br><span class="line">    a: 10,</span><br><span class="line">    b: 20</span><br><span class="line">  &#125;,</span><br><span class="line">  outer: globalEnvironment</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>é‚£LexicalEnvironmentæ˜¯å¦‚ä½•ç»„æˆçš„?å¥½ç¬‘çš„æ˜¯è¯æ³•ç¯å¢ƒåˆå§‹åŒ–åªæ˜¯VariableEnvironmentçš„å¤åˆ¶.  </p>
<h3 id="è¯æ³•ç¯å¢ƒ-lexical-environment"><a href="#è¯æ³•ç¯å¢ƒ-lexical-environment" class="headerlink" title="è¯æ³•ç¯å¢ƒ(lexical environment)"></a>è¯æ³•ç¯å¢ƒ(lexical environment)</h3><p>è¯æ³•ç¯å¢ƒå’Œå˜é‡ç¯å¢ƒæœ¬è´¨ä¸Šéƒ½æ˜¯çš„è¯æ³•ç¯å¢ƒ(ä¸ç®¡å®ƒä»¬æ€ä¹ˆå‘½å)i.e.éƒ½æ˜¯åœ¨å†…éƒ¨å‡½æ•°åˆ›å»ºæ—¶é™æ€(è¯æ³•)æ•è·å¤–éƒ¨ç»‘å®š.  </p>
<p>æ­£å¦‚æˆ‘ä»¬å…ˆå‰æåˆ°çš„åˆå§‹åŒ–LexicalEnvironmentåªæ˜¯å¯¹VariableEnvironmentçš„è“æœ¬å¤åˆ¶,çœ‹çœ‹ä¸‹é¢ä¾‹å­:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fooContext.LexicalEnvironment = copy(fooContext.VariableEnvironment);</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œæ¥ä¸‹æ¥ä¼šå‘ç”Ÿä»€ä¹ˆ,åœ¨<a href="http://dmitrysoshnikov.com/ecmascript/chapter-2-variable-object/#code-execution">ä»£ç æ‰§è¡Œé˜¶æ®µ</a>,æå‰åœ¨åŸæœ‰çš„è¯æ³•ç¯å¢ƒé€šè¿‡withè¯­å¥å’Œcatchä»å¥æ¥æ‰©å±•(å°½ç®¡å¦‚æˆ‘ä»¬æ‰€è¯´,åœ¨ES5ä¸­æå‰æ›¿æ¢ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œä½†æ˜¯åœ¨ES3ä¸­æ²¡æœ‰æ‰©å±•).    </p>
<p>withè¯­å¥å’Œcatchä»å¥å¦‚ä¸Šé¢æ‰€ç¤ºçš„åœ¨æ‰§è¡Œæ—¶æ›¿æ¢ä¸Šä¸‹æ–‡ç¯å¢ƒ,å¹¶ä¸”è¿™ç§æƒ…å†µå’Œå‡½æ•°è¡¨è¾¾å¼æœ‰å…³.  </p>
<p>ä»<a href="http://dmitrysoshnikov.com/ecmascript/es5-chapter-3-1-lexical-environments-common-theory/#rules-of-function-creation-and-application">å‡½æ•°åˆ›å»ºçš„è§„åˆ™</a>çš„è®¨è®ºä¸­,æˆ‘ä»¬çŸ¥é“é—­åŒ…å°†åœ¨å‡½æ•°åˆ›å»ºæ—¶å°†è¯æ³•ç¯å¢ƒä¿å­˜.  </p>
<p>å¦‚æœä¸€ä¸ªå‡½æ•°è¡¨è¾¾å¼åœ¨ä¸€ä¸ªwithè¯­å¥(æˆ–è€…cacthä»å¥)åˆ›å»º,é‚£ä¹ˆå®ƒåº”è¯¥ä¿å­˜(æ›¿æ¢)å½“å‰è¯æ³•ç¯å¢ƒ.  </p>
<p>æˆ‘ä»¬æ˜¯ç›´æ¥å°†VariableEnvironmentæ›¿æ¢(è€Œä¸æ˜¯å®ƒçš„å‰¯æœ¬LexicalEnvironment),ç„¶åå†å…¶withè¯­å¥æ‰§è¡Œç»“æŸåæ¢å¤è¿‡æ¥,ç„¶è€Œè¿™å°±æ„å‘³ç€FEå°†ä¸èƒ½å¼•ç”¨åˆ›å»ºæ—¶çš„ç»‘å®š,ä½†æ˜¯FEéœ€è¦with-ç»‘å®š.  </p>
<p>å…¶å®æˆ‘ä»¬ä¸ä¼šæ›¿æ¢VariableEnvironmentæœ¬èº«,å› ä¸ºFDä¹Ÿå¯ä»¥åœ¨withè¯­å¥å†…è°ƒç”¨,FDä¸FEç›¸åçš„æ˜¯å¯ä»¥ä½¿ç”¨åˆå§‹åŒ–çš„çŠ¶æ€,è€Œä¸æ˜¯ä»with-å¯¹è±¡(æˆ‘ä»¬å°†çœ‹ä¸‹é¢çš„ä¾‹å­)</p>
<ul>
<li>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ,å½“å‡½æ•°å£°æ˜(FD)æ—¶ä¿å­˜VariableEnvironmentéƒ¨åˆ†ä½œä¸ºå…¶[[Scope]]å±æ€§,è€Œå‡½æ•°è¡¨è¾¾å¼(ES)ä¿å­˜å…¶LexicalEnvironmentéƒ¨åˆ†.è¿™æ˜¯å”¯ä¸€å¯ä»¥åŒºåˆ†å®ƒä»¬ä¸¤çš„åœ°æ–¹.</li>
</ul>
<p>è¿™ä¸ªäº‹å®å¥½ç¬‘çš„æ˜¯åœ¨ä¸‹ä¸€ä»£ESæˆ–è€…ES5ä¸¥æ ¼æ¨¡å¼withè¯­å¥å°†å½»åº•æ¶ˆå¤±ï¼Œè¿™æ ·ESè§„èŒƒå°†åœ¨è¿™ä¸ªæ–¹é¢å°‘äº†å¾ˆå¤šè¯¯è§£.  </p>
<p>è®©æˆ‘ä»¬åœ¨çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„åˆ†æï¼šFEä¿å­˜LexicalEnvironment,å› ä¸ºå®ƒéœ€è¦åœ¨withæ‰§è¡Œæ—¶åŠ¨æ€ç»‘å®š,ä½†æ˜¯FDå°†ä¿å­˜VariableEnvironment,å› ä¸ºæ ¹æ®è§„èŒƒFDä¸èƒ½åœ¨ä¸€ä¸ªå—çº§å†…åˆ›å»ºï¼Œå¹¶ä¸”å®ƒä¼š<a href="http://dmitrysoshnikov.com/notes/note-4-two-words-about-hoisting/">æå‡</a>åˆ°é¡¶éƒ¨.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var a = 10;</span><br><span class="line"> </span><br><span class="line">// FD</span><br><span class="line">function foo() &#123;</span><br><span class="line">  console.log(a);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">with (&#123;a: 20&#125;) &#123;</span><br><span class="line"> </span><br><span class="line">  // FE</span><br><span class="line">  var bar = function () &#123;</span><br><span class="line">    console.log(a);</span><br><span class="line">  &#125;;</span><br><span class="line"> </span><br><span class="line">  foo(); // 10!, from VariableEnvrionment</span><br><span class="line">  bar(); // 20,  from LexicalEnvrionment</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">foo(); // 10</span><br><span class="line">bar(); // still 20</span><br></pre></td></tr></table></figure>

<p>ç†è®ºä¸Šå¯ä»¥å¦‚ä¸‹é¢: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// &quot;foo&quot; is created</span><br><span class="line">foo.[[Scope]] = globalContext.[[VariableEnvironment]];</span><br><span class="line"> </span><br><span class="line">// &quot;with&quot; is executed</span><br><span class="line">previousEnvironment = globalContext.[[LexicalEnvironment]];</span><br><span class="line"> </span><br><span class="line">globalContext.[[LexicalEnvironment]] = &#123;</span><br><span class="line">  environmentRecord: &#123;a: 20&#125;,</span><br><span class="line">  outer: previousEnvironment</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">// &quot;bar&quot; is created</span><br><span class="line">bar.[[Scope]] = globalContext.[[LexicalEnvironment]];</span><br><span class="line"> </span><br><span class="line">// &quot;with&quot; is completed, restore the environment</span><br><span class="line">globalContext.[[LexicalEnvironment]] = previousEnvironment;</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†ä»å®ä¾‹ä¸­æ›´æ˜æ˜¾çš„çœ‹æ¸…åŒºåˆ«,æˆ‘ä»¬å¯ä»¥é‡‡ç”¨éæ ‡å‡†æ¨¡å¼åœ¨å—çº§å†…åˆ›å»ºFD,æ ¹æ®æˆ‘ä»¬<a href="http://dmitrysoshnikov.com/ecmascript/chapter-5-functions/#implementations-extension-function-statement">æ‰€è®°å¾—</a>è§„èŒƒå°†ä¼šæŠ¥å¼‚å¸¸,ä½†æ˜¯å¦‚ä»Šçš„å®ç°ç¯å¢ƒæ²¡æœ‰ä¸€ä¸ªä¼šæŠ¥é”™.Firefoxçš„å‡½æ•°è¯­å¥æœ‰è‡ªå·±çš„éæ ‡å‡†æ–¹å¼æ‰§è¡Œå¾ˆå¤šå¹´,å¹¶ä¸”åœ¨å…¶ä»–å®ç°ç¯å¢ƒå¦‚v8å¼•æ“ä¹Ÿéµå¾ªä¸‹é¢è¡Œä¸º:  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var a = 10;</span><br><span class="line"> </span><br><span class="line">with (&#123;a: 20&#125;) &#123;</span><br><span class="line"> </span><br><span class="line">  // FD</span><br><span class="line">  function foo() &#123; // do not test in Firefox!</span><br><span class="line">    console.log(a);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  // FE</span><br><span class="line">  var bar = function () &#123;</span><br><span class="line">    console.log(a);</span><br><span class="line">  &#125;;</span><br><span class="line"> </span><br><span class="line">  foo(); // 10!, from VariableEnvrionment</span><br><span class="line">  bar(); // 20,  from LexicalEnvrionment</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">foo(); // 10</span><br><span class="line">bar(); // still 20</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç è¿™æ ·è¿è¡Œçš„åŸå› æ˜¯å› ä¸ºFD(è¢«æå‡åˆ°é¡¶éƒ¨)ä¿å­˜VariableEnvironmentå½“åšå…¶[[Scope]],è€ŒFEä¿å­˜å…¶LexicalEnvironment(å½“withæˆ–catchæ‰§è¡Œæ—¶å°†è¢«æ›¿æ¢).  </p>
<p>æ³¨æ„ï¼šå› ä¸ºES6æ ‡å‡†çš„å—çº§å‡½æ•°å£°æ˜ï¼Œè¿™ä¸ªä¾‹å­æ´ªfooå‡½æ•°å°±ä¿å­˜è¯æ³•ç¯å¢ƒ</p>
<h2 id="æ ‡è¯†ç¬¦æ±‚å€¼-Identifier-resolution"><a href="#æ ‡è¯†ç¬¦æ±‚å€¼-Identifier-resolution" class="headerlink" title="æ ‡è¯†ç¬¦æ±‚å€¼(Identifier resolution)"></a>æ ‡è¯†ç¬¦æ±‚å€¼(Identifier resolution)</h2><ul>
<li>æ ‡è¯†ç¬¦çš„æ±‚å€¼æ˜¯åˆ¤æ–­å“ªä¸ªæ ‡è¯†ç¬¦å‡ºç°åœ¨é‚£ä¸ªè¯æ³•ç¯å¢ƒç»‘å®šä¸Š</li>
</ul>
<p>æ¢å¥è¯è¯´,å®ƒå’Œå˜é‡çš„<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core/#scope-chain">ä½œç”¨åŸŸé“¾æŸ¥è¯¢</a>å¾ˆåƒ.å¦‚ä¸Šè¯´çš„ä¹Ÿå’ŒåŸå‹é“¾æŸ¥è¯¢å¾ˆåƒ,åªæ˜¯å°†prototypeçš„è¿æ¥æ¢æˆäº†è¿æ¥ç€ç¯å¢ƒçš„outerè¿æ¥.  </p>
<p>çœ‹å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var a = 10;</span><br><span class="line"> </span><br><span class="line">(function foo() &#123;</span><br><span class="line"> </span><br><span class="line">  var b = 20;</span><br><span class="line"> </span><br><span class="line">  (function bar() &#123;</span><br><span class="line"> </span><br><span class="line">    var c = 30;</span><br><span class="line">    console.log(a + b + c); // 60</span><br><span class="line">     </span><br><span class="line">  &#125;)();</span><br><span class="line"> </span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>æ ‡è¯†ç¬¦æ±‚å€¼è¿‡ç¨‹å¦‚aç»‘å®šä¸€æ ·çš„è¿­ä»£æ±‚å€¼. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function resolveIdentifier(lexicalEnvironment, identifier) &#123;</span><br><span class="line">  </span><br><span class="line">  // if it&#x27;s the final link, and we didn&#x27;t find</span><br><span class="line">  // anything, we have a case of a reference error</span><br><span class="line">  if (lexicalEnvironment == null) &#123;</span><br><span class="line">    throw ReferenceError(identifier + &quot; is not defined&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // return the binding (reference) if it exists;</span><br><span class="line">  // later we&#x27;ll be able to get the value from the reference</span><br><span class="line">  if (lexicalEnvironment.hasBinding(identifier)) &#123;</span><br><span class="line">    return new Reference(lexicalEnvironment, identifier);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // else try to find in the parent scope,</span><br><span class="line">  // recursively analyzing the outer environment</span><br><span class="line">  return resolveIdentifier(lexicalEnvironment.outer, identifier);</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">resolveIdentifier(bar.[[LexicalEnvironment]], &quot;a&quot;) -&gt;</span><br><span class="line"> </span><br><span class="line">-- bar.[[LexicalEnvironment]] - not found,</span><br><span class="line">-- bar.[[LexicalEnvironment]].outer (i.e. foo.[[LexicalEnvironment]]) -&gt; not found</span><br><span class="line">-- bar.[[LexicalEnvironment]].outer.outer -&gt; found reference, value 10</span><br></pre></td></tr></table></figure>

<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>è¿™ä¸€ç« ä¸­æˆ‘ä»¬æ¾„æ¸…äº†ECMAScriptä¸­è¯æ³•ç¯å¢ƒçš„æ¦‚å¿µ.æˆ‘ä»¬ä¹Ÿè®²è¿°äº†ä¸ºä»€ä¹ˆè¦å°†åŸæ¥çš„ å˜é‡&#x2F;æ¿€æ´» å¯¹è±¡ä»¥åŠä½œç”¨åŸŸé“¾æ¢æˆè¯æ³•ç¯å¢ƒé“¾â€“å®ƒä»¬å¤§å¤šæ•°çš„æ”¹å˜æ˜¯ä¸ºç›¸å…³çš„é«˜æ•ˆå®ç°.  </p>
<p>æˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº†è¯æ³•ç¯å¢ƒä¸é—­åŒ…çš„ç›¸å…³æ€§(å†æ¬¡æ³¨æ„,EDåˆFEåœ¨ECMScriptéƒ½ä¼šå‚æ•°é—­åŒ…),æˆ‘ä»¬å†æ¬¡å›å¿†äº†thisç»‘å®šæ˜¯å¦‚ä½•åœ¨ä¸åŒçš„æ‰§è¡Œä¸Šä¸‹æ–‡å–å€¼.  </p>
<p>æ­¤å¤–æˆ‘ä»¬åœ¨æåˆ°äº†ä¸‹ä¸€ä»£ESå…³äºç¯å¢ƒçš„è®¡åˆ’,å¦‚å»é™¤å…¨å±€å¯¹è±¡.</p>
]]></content>
      <tags>
        <tag>ES</tag>
      </tags>
  </entry>
  <entry>
    <title>é—­åŒ…ä¸­çš„å†…å­˜æ³„æ¼</title>
    <url>/2017/10/30/%E9%97%AD%E5%8C%85%E4%B8%AD%E7%9A%84%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F/</url>
    <content><![CDATA[<p>é—­åŒ…çš„å®šä¹‰ï¼šA closure is the combination of a function and the lexical environment within which that function was declared.(å‡½æ•°å£°æ˜æ—¶å‡½æ•°å†…éƒ¨å˜é‡æœ‰è®¿é—®å½“å‰ä½œç”¨åŸŸé“¾ä¸Šå˜é‡çš„èƒ½åŠ›ï¼Œå“ªæ€•å˜é‡è¢«å‡½æ•°returnå‡ºå»ä»¥åã€‚)</p>
<span id="more"></span>


<p>é—­åŒ…å…·ä½“åœºæ™¯ï¼šå‡½æ•°åµŒå¥—å‡½æ•°æ—¶ï¼Œå†…å±‚å‡½æ•°å¼•ç”¨äº†å¤–å±‚å‡½æ•°ä½œç”¨åŸŸä¸‹çš„å˜é‡ï¼Œå¹¶ä¸”å†…å±‚å‡½æ•°è¢«å…¨å±€ç¯å¢ƒä¸‹çš„å˜é‡å¼•ç”¨ï¼Œå°±å½¢æˆäº†é—­åŒ…ã€‚</p>
<p>æµè§ˆå™¨åƒåœ¾å›æ”¶æœºåˆ¶è¦ç‚¹ï¼š  </p>
<ul>
<li>ä»æ ¹å¯¹è±¡å¼€å§‹å¯»æ‰¾ï¼Œåªè¦èƒ½é¡ºç€å¼•ç”¨æ‰¾åˆ°çš„ï¼Œéƒ½ä¸èƒ½è¢«å›æ”¶ã€‚é¡ºç€å¼•ç”¨æ‰¾ä¸åˆ°çš„å¯¹è±¡è¢«è§†ä¸ºåƒåœ¾ï¼Œåœ¨ä¸‹ä¸€ä¸ªåƒåœ¾å›æ”¶èŠ‚ç‚¹è¢«å›æ”¶ã€‚</li>
<li>å˜é‡æ˜¾ç¤ºå¼•ç”¨æ¬¡æ•°å¦‚æœæ ‡è®°ä¸º0ä¹Ÿä¼šè¢«å›æ”¶ã€‚</li>
</ul>
<p>å†…å­˜æ³„æ¼å®šä¹‰ï¼šé€šä¿—çš„è®²ä¹Ÿå°±æ˜¯å½“æŸä¸ªå¯¹è±¡æˆ‘ä»¬ä¸å†éœ€è¦ï¼Œä½†æ˜¯ä»åœ¨é•¿æ—¶é—´åœ¨å†…å­˜ä¸­ã€‚  </p>
<p>å†…å­˜æ³„æ¼æ¡ˆä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var t = null;</span><br><span class="line">  var replaceThing = function() &#123;</span><br><span class="line">      var o = t</span><br><span class="line">      var unused = function() &#123;</span><br><span class="line">          if (o)</span><br><span class="line">              console.log(&quot;hi&quot;)</span><br><span class="line">      &#125;</span><br><span class="line">      t = &#123;</span><br><span class="line">              longStr: new Array(1000000).join(&#x27;*&#x27;),</span><br><span class="line">              someMethod: function() &#123;</span><br><span class="line">                console.log(&quot;this is a test&quot;)</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  setInterval(replaceThing, 1)</span><br></pre></td></tr></table></figure>
<p>åœ¨replaceThingæ‰§è¡Œè¿”å›å˜é‡tä»¥åï¼Œå…¨å±€å˜é‡tæœ‰å¯¹replaceThingå‡½æ•°å†…å˜é‡è®¿é—®çš„æƒåˆ©ï¼Œè¿™ä¹Ÿæ˜¯è¯´å†…å­˜ä¿å­˜ç€å¯¹oè®¿é—®æƒåˆ©ï¼ˆæ³¨æ„æ­¤æ¬¡oçš„å¼•ç”¨æ¬¡æ•°å› ä¸ºåœ¨unsedæœ‰å¼•ç”¨ä¸ä¸º0ï¼‰ï¼Œè€Œoå˜é‡ä¿å­˜ç€ä¸Šæ¬¡æ‰§è¡Œçš„tï¼Œä¾æ¬¡ç´¢å¼•é€ æˆä¸¥é‡å†…å­˜æ³„æ¼ã€‚ä¸‹å›¾æ˜¯replaceThingæ‰§è¡Œä¸‰æ¬¡åçš„æƒ…å†µï¼š<br><img src="/2017/10/30/%E9%97%AD%E5%8C%85%E4%B8%AD%E7%9A%84%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F/threeTimesCircle.png" alt="å†…å­˜æ³„æ¼"><br>è¿™é‡Œåœ¨å‡½æ•°æœ€åå¯ä»¥å°†o&#x3D;nullè§£å†³å†…å­˜æ³„æ¼ï¼Œä¹Ÿå¯ä»¥å°†unsedå»æ‰è§£å†³å†…å­˜æ³„æ¼ã€‚</p>
]]></content>
      <categories>
        <category>javascript</category>
      </categories>
  </entry>
</search>
